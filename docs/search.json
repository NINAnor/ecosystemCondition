[{"path":"index.html","id":"about","chapter":"About ","heading":"About ","text":"site may view details certain indicators ecosystem condition Norway calculated.web page made document work related R&D project develop indicators ecosystem condition three main ecosystems Norway: wetlands, open areas forest line, semi-natural land. indicators yet used real assessments, may represent unfinished work pending future data availability. addition, may chose also present analyses documenting indicators used existing assessments ecosystem condition.","code":""},{"path":"index.html","id":"eatools","chapter":"About ","heading":"eaTools ","text":"eaTools R package aimed solving common tasks GIS oriented ecosystem accounting, especially ecosystem condition accounting. use functions package, function normalise condition variables seen Figure 0.1.\nFigure 0.1: normalised condition variable called indicator. indicator transformed sigmoid function.\nSee package documentation, especially Articles information examples use.","code":"\n#devtools::install_github(\"NINAnor/eaTools\")\nlibrary(eaTools)\n\n# Import example data\ndata(\"ex_polygons\")\n\n# Use the questionmark to readabout the example data sets or to view the  function documentation \n#?ex_polygons\n\neaTools::ea_normalise(data = ex_polygons,\n             vector = \"condition_variable_2\",\n             upper_reference_level = 7,\n             scaling_function = \"sigmoid\",\n             plot = T)"},{"path":"index.html","id":"community-review","chapter":"About ","heading":"Community review","text":"want work transparent credible. Therefor encourage types feedback analyses indicators ecological condition can read web site. submit comments, please github repository open new issue answer .","code":""},{"path":"index.html","id":"author-guidelines","chapter":"About ","heading":"Author guidelines","text":"project uses type standardised reporting reproducible workflows (typically code) calculating indicator presented separate webpages within shared website. website built GitHub repo using seperate RMarkdown files chapter. files must English. process authoring sharing/distributing Rmarkdown-files explained .highly encouraged indicators delivered georeferenced maps, hereafter called indicator maps, simple tables. common structure indicator maps follow. indicator maps can vector formats raster formats. vector data, .Rdata .rds files can used, example shape files allow field names (.e. column names) long ones use. georeferenced data use EPSG:25833 - ETRS89 / UTM zone 33N.Indicator maps highest possible spatial resolution possible weighing need spatial representativity. example, may need aggregate x number data points get average stable representative given region. need spatially aggregate indicator maps , example produce national estimate.indicator values, reference values ect mapped following columns (vector data) bands (raster data):v_YYYY variable value (.e. un-scaled raw indicator values) year YYYY.sd_YYYY standard deviation associated v_YYYY. measures uncertainty currently supported.referance_high reference value, .e. value variable v reference conditions. value vary years.referance_low lower limit reference value, .e. worst possible value variable v. value vary years. missing, value assumed zero.thr threshold value defining good condition variable v. missing, value default 0.6.i_YYYY indicator value year YYYY. value depends values, also scaling function (.e. linear, exponential, two-sided, ect.). scaling function needs presented documentation.rest workflow follows.Obtain go ahead signal coordination group make sure free start workRead template.Rmd file. Make copy store , (root) folder DRAFT_myIndicator.Rmd. (example, see DRAFT_breareal.Rmd). Finish documentation analyses .\ncan load data internal NINA servers, web hosts, store smaller data set data. data folder also contains supporting data sets may want use, delineation five regions used ecosystem assessment (data/regions.shp), outline Norway (outlineOfNorway_EPSG25833.shp).\npreview rmarkdown file html R, type rmarkdown::render('DRAFT_myIndicator.Rmd', output_format = \"html_document\", output_dir = \"temp\") console (knitr shortcuts don’t work expected inside bookdown projects).\nfilling template.Rmd file work, try change headers much.\nFinal result analyses written indicators folder. preferred output georeferenced data (rasters shape files), placed indators/indicatorMaps. Non-georeferenced data, like data tables, can stored indicators.\ncan load data internal NINA servers, web hosts, store smaller data set data. data folder also contains supporting data sets may want use, delineation five regions used ecosystem assessment (data/regions.shp), outline Norway (outlineOfNorway_EPSG25833.shp).preview rmarkdown file html R, type rmarkdown::render('DRAFT_myIndicator.Rmd', output_format = \"html_document\", output_dir = \"temp\") console (knitr shortcuts don’t work expected inside bookdown projects).filling template.Rmd file work, try change headers much.Final result analyses written indicators folder. preferred output georeferenced data (rasters shape files), placed indators/indicatorMaps. Non-georeferenced data, like data tables, can stored indicators.Make pull request main GitHub repository submit file. comfortable using GitHub, contac Anders rrange sending files via email.Anders someone else project wil conduct rapid code review, making sure code reproducible, interpretable renders locally R Studio server.approved, reviewer make copy DRAFT_ file, removing DRAFT_ part name, well YML header, well updating rmd_files part _bookdown.yml. (example file, see breareal.Rmd.)update web site (web site), admin user needs pull repo R Studio server, compile book (Ctr+Shift+B), commit push main. html version book docs folder.","code":""},{"path":"index.html","id":"citation","chapter":"About ","heading":"Citation","text":"cite book please use following citation:Kolstad, .L., Topper, J. Grainger, M.J., Sandvik, H., Venter, Z., Töpper, J., Speed, J.D.M, Nater, C.R., Evju, M., Åström, J. (2023) Indicators Ecosystem Condition Norway. https://doi.org/10.5281/zenodo.7854835Contributions\nlist authors include code developers reviewers. authors interacted GitHub user, , theiy contributions can tracked, example .","code":""},{"path":"index.html","id":"license","chapter":"About ","heading":"License","text":"book licensed CC 4.0 licence means can share adapt material\npurpose. However, must give appropriate credit, provide link license, indicate changes made. can add additional restrictions material even adapted.","code":""},{"path":"gjengroing.html","id":"gjengroing","chapter":"1 Enchroachment","heading":"1 Enchroachment","text":"Norwegian name: GjengroingVegetation regrowth/encroachmentAuthor date:Zander VenterSeptember 2023","code":""},{"path":"gjengroing.html","id":"intro-enc","chapter":"1 Enchroachment","heading":"1.1 Introduction","text":"Norwegian word “gjengroing” directly translated “regrowing” English. gjengroing indicator describes regrowth woody vegetation (trees bushes) open ecosystems (wetland, semi- naturally open areas) across Norway. use spatial reference approach reference areas define good optimal vegetation regrowth heights.workflow spans two platforms including RStudio Google Earth Engine (GEE). reproduce workflow need GEE account access NINA RStudio R/GeoSpatialData servers.","code":""},{"path":"gjengroing.html","id":"about-data-enc","chapter":"1 Enchroachment","heading":"1.2 About the underlying data","text":"rely following datasets:NiN polygons used identify reference areas good ecological condition.NIBIO’s AR5 used population sample ecosystem type. population sample areas used determine ecological condition relative reference areas. also use AR5 data identify forest surrounding population polygons defining lower limit ecological condition index (.e.. poor condition),LiDAR-derived digital elevation model Kartverket’s høydedata. includes terrain (DTM) surface mode (DSM). calculate canopy height model (DSM - DTM) get height objects ground. remove buildings, remains vegetation - mostly trees also bushes smaller woody plants.Kartverket’s national 10m elevation model. use stratify reference (good condition) forest (poor condition) heights elevational band. done combination bioclimatic zones - see next point.Moen’s bioclimatic zones. use stratify reference (good condition) forest (poor condition) heights bioclimatic (also referred vegetation/climatic) zones.FKB building footprints used isolate vegetation LiDAR height data.European satellite-based map forest clear cuts used identifying AR5 forest patches near-climax successional stages.SSB 10km grid used visualization purposes.regional delineation Norway (five regions) used aggregating reporting gjengroing condition values.","code":""},{"path":"gjengroing.html","id":"rep-enc","chapter":"1 Enchroachment","heading":"1.2.1 Representativity in time and space","text":"index cover mainland Norway. analysis stratified (1) åpne (2) våtmark ecosystems. former includes semi-naturlig mark naturlig åpne områder skoggrensa (due fact AR5 differentiate ), latter includes våtmark . LiDAR data cover range years therefore indicator represents conditions circa 2010 2021.","code":""},{"path":"gjengroing.html","id":"units-enc","chapter":"1 Enchroachment","heading":"1.2.2 Original units","text":"original units ecological condition meters. height vegetation within referecne, polygon forest areas.","code":""},{"path":"gjengroing.html","id":"temp-enc","chapter":"1 Enchroachment","heading":"1.2.3 Temporal coverage","text":"Circa 2010 2021. single snapshot change analysis. future, LiDAR data repeated across country, may possible change assessment. addition, use optical radar satellite imagery may serve proxy vegetation height using machine learning. allow annual updates, depending uncertainty satellite-based maps vegetation height.","code":""},{"path":"gjengroing.html","id":"comm-enc","chapter":"1 Enchroachment","heading":"1.2.4 Additional comments about the dataset","text":"None.","code":""},{"path":"gjengroing.html","id":"ecosystem-characteristic","chapter":"1 Enchroachment","heading":"1.3 Ecosystem characteristic","text":"","code":""},{"path":"gjengroing.html","id":"norwegian-standard","chapter":"1 Enchroachment","heading":"1.3.1 Norwegian standard","text":"sure means??","code":""},{"path":"gjengroing.html","id":"collinearities-with-other-indicators","chapter":"1 Enchroachment","heading":"1.4 Collinearities with other indicators","text":"possibly collinearity primary production indicator (primærproduksjon). primary production indicator uses normalized difference vegetation index (NDVI) proxy vegetation production. NDVI can correlated vegetation height consequently yield similar results LiDAR-based gjengroing indicator.","code":""},{"path":"gjengroing.html","id":"reference-state-and-values","chapter":"1 Enchroachment","heading":"1.5 Reference state and values","text":"methodology used calculate gjengroing indicator outlined schematic . workflow schematic conducted reference population polygons Norway repeated ecosystem type (åpne våtmark), respectively. indicator values aggregated 50km grid regional level end. individual steps discussed turn following subsections.","code":""},{"path":"gjengroing.html","id":"state-enc","chapter":"1 Enchroachment","heading":"1.5.1 Reference state","text":"NiN polygons including “Naturlig åpne områder skoggrensa”, “Semi-naturlig mark”, “Våtmark” good ecological condition used define reference gjengroing state. use -encompassing “Tilstand” variable assigned NiN polygon. 50th percentile LiDAR-derived vegetation heights within polygons used define upper limit (ie. 1) scaled indicator value. define local reference values based proximity, NiN polygons spatially biased close AR5 population polygons. Therefore calculate regional reference values using elevation (300m bands) bioclimatic zones stratification. calculate mean reference value unique combination elevation-bioclimatic zone. calculating index population polygon, reference value inherited elevation-bioclimatic zone falls within.","code":""},{"path":"gjengroing.html","id":"ref-enc","chapter":"1 Enchroachment","heading":"1.5.2 Reference values, thresholds for defining good ecological condition, minimum and/or maximum values","text":"reference vegetation height given ecosystem type elevation-bioclimatic zone, need define minimum (worst/bad) condition. use 50th percentile LiDAR-derived vegetation heights within AR5 skog polygons define climax vegetation successional stage gjengroing extreme. order include forest patches recently harvested, mask forest clear-cut since 1986. , 1986 hard limit defined clear-cut dataset based Landsat imagery. Therefore can assured measuring forest least 35 years old.use local regional “reference” approaches defining poor ecological condition. calculate forest heights AR5 forest patches fall within 200m population polygon (local reference). population polygons forest within proximity, use mean forest height within unique elevation-bioblimatic zone population falls within (regional reference).define ecological condition population polygon, measure 50th percentile LiDAR-derived vegetation height. reminder, use AR5 polygons types approximately compatible NiN ecosystem types. våtmark use AR5 polygons defined “Myr”. åpne ecosystems use AR5 polygons defined either “Åpent fastmark” “Innmarksbeite”.vegetation height percentiles scaled 0 1 using sigmoid transformation Oliver al. (2021).","code":""},{"path":"gjengroing.html","id":"err-enc","chapter":"1 Enchroachment","heading":"1.6 Uncertainties","text":"indicator map polygon level uncertainty associated indicator values. aggregated indicator values (e.g. 50km grid regions), uncertainty indicator value calculated spatial variation polygon-level reference height values. use alternative calculating spatial variation indicator values via bootstrapping using EAtools package. However, given extreme number population polygons, uncertainty values extremely small therefore choose use standard deviation reference vegetation heights, converted indicator scale.","code":""},{"path":"gjengroing.html","id":"references","chapter":"1 Enchroachment","heading":"1.7 References","text":"Links data resources provided hyperlinks -line.","code":""},{"path":"gjengroing.html","id":"analyses-enc","chapter":"1 Enchroachment","heading":"1.8 Analyses","text":"","code":""},{"path":"gjengroing.html","id":"data-enc","chapter":"1 Enchroachment","heading":"1.8.1 Data sets","text":"several datasets used GEE imported R session . datasets obtained source ingested GEE Zander Venter Vegard Bakkestuen help Miljædata section NINA. includeAR5LiDAR-derived digital elevation model høydedata.Kartverket’s national 10m elevation modelFKB building footprintsEuropean forest clear-cut mapThe remaining datasets imported R session.","code":""},{"path":"gjengroing.html","id":"reg-enc","chapter":"1 Enchroachment","heading":"1.8.1.1 Regions","text":"regional delineation Norway (five regions) used aggregating reporting gjengroing condition values.","code":"\nregions <- st_read('/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/gjengroing/R_project/DATA/regions.shp') %>%\n  mutate(region = factor(region) )\n#> Reading layer `regions' from data source \n#>   `/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/gjengroing/R_project/DATA/regions.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 5 features and 2 fields\n#> Geometry type: POLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -99551.21 ymin: 6426048 xmax: 1121941 ymax: 7962744\n#> Projected CRS: ETRS89 / UTM zone 33N\n# Rename regions with correct Norwegian characters\nlevels(regions$region) <- c(\"Østlandet\", \"Midt-Norge\",\"Nord-Norge\",\"Sørlandet\",\"Vestlandet\")"},{"path":"gjengroing.html","id":"ssb-10-and-50km-grids","chapter":"1 Enchroachment","heading":"1.8.1.2 SSB 10 and 50km grids","text":"SSB 10km 50km grids used visualizing distribution available data aggregating gjengroing index scores.","code":"\nssb10km <- st_read('/data/R/GeoSpatialData/Population_demography/Norway_SSB/Original/ssb_10km/ssb10km.shp')%>%\n  # mutate the id value so that it aligns with the data coming from GEE\n  mutate(SSBID = as.numeric(SSBID)/1000)\n#> Reading layer `ssb10km' from data source \n#>   `/data/R/GeoSpatialData/Population_demography/Norway_SSB/Original/ssb_10km/ssb10km.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 4218 features and 6 fields\n#> Geometry type: POLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -80000 ymin: 6440000 xmax: 1120000 ymax: 7940000\n#> Projected CRS: WGS 84 / UTM zone 33N\n# Transform to the correct projection\nssb10km <- st_transform(ssb10km, st_crs(regions))\n\nssb50km <- st_read('/data/R/GeoSpatialData/Population_demography/Norway_SSB/Original/ssb_50km/ssb50km.shp')%>%\n  # mutate the id value so that it aligns with the data coming from GEE\n  mutate(SSBID = as.numeric(SSBID)/1000)\n#> Reading layer `ssb50km' from data source \n#>   `/data/R/GeoSpatialData/Population_demography/Norway_SSB/Original/ssb_50km/ssb50km.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 273 features and 6 fields\n#> Geometry type: POLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -150000 ymin: 6400000 xmax: 1150000 ymax: 8e+06\n#> Projected CRS: WGS 84 / UTM zone 33N\n# Transform to the correct projection\nssb50km <- st_transform(ssb50km, st_crs(regions))"},{"path":"gjengroing.html","id":"bioclimatic-regions","chapter":"1 Enchroachment","heading":"1.8.1.3 Bioclimatic regions","text":"Moen’s bioclimatic regions imported NINA R/GeoSpatialData/ server.","code":"\nbioclim <- st_read('/data/R/GeoSpatialData/BiogeographicalRegions/Norway_VegetationZones_Moen/Original/Vector/soner.shp') %>%\n  mutate(NAVN = ifelse(NAVN == 'S°rboreal', 'Sørboreal', NAVN))\n#> Reading layer `soner' from data source \n#>   `/data/R/GeoSpatialData/BiogeographicalRegions/Norway_VegetationZones_Moen/Original/Vector/soner.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 3050 features and 7 fields\n#> Geometry type: POLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -75844 ymin: 6449504 xmax: 1114610 ymax: 7939790\n#> Projected CRS: WGS 84 / UTM zone 33N\nbioclim <- st_transform(bioclim, st_crs(regions))"},{"path":"gjengroing.html","id":"nin-polygons","chapter":"1 Enchroachment","heading":"1.8.1.4 NiN polygons","text":"NiN polygons imported NINA servers:Export cleaned NiN data upload GEE proceedingNow run following GEE JavaScript code clicking hyperlink: GEE script script also found SCR repository “GEE_script.js”. run script, click Tasks tab GEE code editor run export tasks. export files appear Google Drive. Download files Google Drive /data/gjengroing/From_GEE directory. script extracts three CSV files:\n‘area_cover_grid.csv’ - gives area coverage NiN, AR5 LiDAR data 10x10km SSB grid cell.\n‘elevation_stratified.shp’ - 300m elevation band stratification simply used visualizing strata R.\n‘vegHeights.zip’ - folder hundreds CSV files. files contain vegetation heights reference, population, forest polygons Norway. exports split 50km grid prevent hitting user memory limits GEE. Unzip folder upload ./DATA/From_GEE/\n‘area_cover_grid.csv’ - gives area coverage NiN, AR5 LiDAR data 10x10km SSB grid cell.‘elevation_stratified.shp’ - 300m elevation band stratification simply used visualizing strata R.‘vegHeights.zip’ - folder hundreds CSV files. files contain vegetation heights reference, population, forest polygons Norway. exports split 50km grid prevent hitting user memory limits GEE. Unzip folder upload ./DATA/From_GEE/","code":"\nnin <- st_read('/data/R/GeoSpatialData/Habitats_biotopes/Norway_Miljodirektoratet_Naturtyper_nin/Original/versjon20221231/Natur_Naturtyper_NiN_norge_med_svalbard_25833/Natur_Naturtyper_NiN_norge_med_svalbard_25833.gdb')%>%\n  # Simplify ecosystem names\n  mutate(hovedøkosystem = recode(hovedøkosystem, \n                                 \"Våtmark\" = 'Våtmark',\n                                 \"Skog\" = \"Skog\",\n                                 \"Ingen\" = \"Ingen\",\n                                 \"Fjell\" = \"Fjell\",\n                                 \"Semi-naturlig mark\" = 'Semi-naturlig',\n                                 \"Naturlig åpne områder i lavlandet\" = 'Naturlig åpne',\n                                 \"Naturlig åpne områder under skoggrensa\" = 'Naturlig åpne')) %>% \n  # Fix any invalid geometries\n  mutate(validGeo = st_is_valid(SHAPE)) %>%\n  filter(validGeo) %>%\n  # Filter out the ecosystems we are not interested in\n  filter(!hovedøkosystem %in% c('Skog','Ingen','Fjell')) %>%\n  # Get the main ecosystem codes in case we need them later\n  mutate(hovedtype = substr(ninkartleggingsenheter, 4, 6),\n         hovedtype = str_remove(hovedtype, '-'),\n         id = identifikasjon_lokalid) %>%\n  # Drop polygons with no condition score\n  drop_na(tilstand) %>%\n  dplyr::select(id, hovedøkosystem, hovedtype, naturtypekode, tilstand)\n#> Reading layer `Naturtyper_NiN_norge_med_svalbard' from data source `/data/R/GeoSpatialData/Habitats_biotopes/Norway_Miljodirektoratet_Naturtyper_nin/Original/versjon20221231/Natur_Naturtyper_NiN_norge_med_svalbard_25833/Natur_Naturtyper_NiN_norge_med_svalbard_25833.gdb' \n#>   using driver `OpenFileGDB'\n#> Simple feature collection with 95469 features and 35 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -74953.5 ymin: 6448986 xmax: 1075080 ymax: 7921283\n#> Projected CRS: ETRS89 / UTM zone 33N\n# Only run if you are repeating this workflow for the first time\n# nin %>%\n#   dplyr::select(id, hovedøkosystem, tilstand) %>%\n#   st_transform(st_crs(fylker_wgs84)) %>%\n#   st_write('nin_cleaned.shp', append=FALSE)"},{"path":"gjengroing.html","id":"data-from-google-earth-engine","chapter":"1 Enchroachment","heading":"1.8.1.5 Data from Google Earth Engine","text":"run GEE script , downloaded data /data/gjengroing/From_GEE directory, can proceed R workflow.Create functions import vegetation height files stratify data elevation band vegetation/climate zoneImport CSV files generated GEE related area covers elevation bands:Import CSV files generated GEE vegetation heights (circa 15 min runtime):","code":"\n# Function to read in multiple files resulting from GEE exports\nreadVegHeightFiles <- function(uniqueString){\n  dir <- '/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/gjengroing/R_project/DATA/From_GEE/vegHeights/'\n  files <- list.files(dir)[str_detect(list.files(dir), uniqueString)]\n  #print(files)\n  \n  dat <- tibble()\n  for (i in files){\n    dat <- dat %>% \n      bind_rows(read_csv(paste0(dir, i)) %>%\n                  mutate(ssbid = substr(str_split(i, '_')[[1]][3], 1, 14)))\n  }\n  return (dat)\n}\n\n# Vegetation type lookup\nvegLookup <- tibble(\n  vegClimZone = c(1,2,3,4,5,6), \n  vegClimZoneLab = c('Nemoral','Boreonemoral','Sørboreal','Mellomboreal','Nordboreal','Alpin')\n  )\n\n# Elevation stratification and vegetation type cleaning function\ncleanElevVegType <- function(data){\n  \n  dataOut <- data %>%\n    mutate(e = elevation) %>%\n    mutate(elevation = ifelse(e < 300, '0-300',\n                              ifelse(e > 300 & e < 600, '300-600',\n                                     ifelse(e > 600 & e < 900, '600-900',\n                                     ifelse(e > 900 & e < 1200, '900-1200', '>1200'))))) %>%\n    mutate(vegClimZone = round(vegClimZone)) %>%\n    left_join(vegLookup, by = 'vegClimZone') %>%\n    dplyr::select(-e, -vegClimZone) %>%\n    drop_na(vegClimZoneLab, elevation)\n  \n  return (dataOut)\n  \n}\n# Import data coverages per SSB 10km grid cell\nareaCovers <- read_csv('/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/gjengroing/R_project/DATA/From_GEE/area_cover_grid.csv') %>%\n  dplyr::select(-'.geo', -'system:index')\n\n# Calculate percentage cover relative to the land area in each cell\nareaCoversPerc <- areaCovers %>%\n  gather(key, val, aapne_ar5, vaatmark_ar5,aapne_nin, vaatmark_nin, lidarCover, skog) %>%\n  mutate(type = ifelse(str_detect(key, 'ar5'), 'ar5', \n                       ifelse(str_detect(key, 'nin'), 'nin', \n                              ifelse(key == 'lidarCover', 'lidar', NA)))) %>%\n  mutate(ecosystem = ifelse(str_detect(key, 'aapne'), 'Semi-/Naturlig åpne', \n                       ifelse(str_detect(key, 'vaatmark'), 'Våtmark', NA))) %>%\n  mutate(areaPerc = val/land*100,\n         areaPerc = ifelse(is.na(areaPerc), 0, areaPerc)) %>%\n  dplyr::select(SSBID, key, type,ecosystem, areaPerc)\n\nelevStrata <- st_read('/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/gjengroing/R_project/DATA/From_GEE/elevation_stratified.shp') %>%\n  mutate(elevBand = ifelse(mode == 1, '0-300',\n                           ifelse(mode == 2, '300-600',\n                                  ifelse(mode == 3, '600-900',\n                                         ifelse(mode == 4, '900-1200', '>1200')))),\n         elevBand = factor(elevBand, levels=c('0-300','300-600','600-900','900-1200','>1200')))\n#> Reading layer `elevation_stratified' from data source \n#>   `/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/gjengroing/R_project/DATA/From_GEE/elevation_stratified.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 10293 features and 2 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: 4.078351 ymin: 57.8515 xmax: 31.78239 ymax: 71.29928\n#> Geodetic CRS:  WGS 84\nelevStrata <- st_transform(elevStrata, st_crs(regions))\n\nif (runFromScratch){\n  \n  # Import median LiDAR heights for NiN polygons\n  refVaatmarkRaw <- readVegHeightFiles('vaatmark_ref') %>%\n    mutate(ref = chm) %>%\n    dplyr::select(-'.geo', -'system:index', -chm)\n  refAapneRaw <- readVegHeightFiles('aapne_ref') %>%\n    mutate(ref = chm) %>%\n    dplyr::select(-'.geo', -'system:index', -chm)\n  \n  # Add elevation and veg/clim zones and summarise per strata\n    # this will form the upper limit of the ecological condition score (ie. good condition)\n  refVaatmark <- cleanElevVegType(refVaatmarkRaw) %>%\n    group_by(elevation, vegClimZoneLab) %>%\n    summarise(ref = mean(ref, na.rm=T))\n  refAapne <- cleanElevVegType(refAapneRaw) %>%\n    group_by(elevation, vegClimZoneLab) %>%\n    summarise(ref = mean(ref, na.rm=T))\n  \n  # Export to file for reference\n  refVaatmark %>%\n    st_write('data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/gjengroing/R_project/DATA/refVaatmark.csv')\n  refAapne %>%\n    st_write('data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/gjengroing/R_project/DATA/refAapne.csv')\n  \n  # Import median LiDAR heights for AR5 polygons for population measurement\n  popVaatmarkHt <- readVegHeightFiles('vaatmark_pop')  %>%\n    mutate(pop = chm)%>%\n    dplyr::select(-chm)\n  popAapneHt <- readVegHeightFiles('aapne_pop')  %>%\n    mutate(pop = chm)%>%\n    dplyr::select(-chm)\n  \n  # Turn into spatial objects using the .geo column in the CSV\n  popVaatmarkHt <- st_as_sf(bind_cols(popVaatmarkHt,geojsonsf::geojson_sf(popVaatmarkHt$.geo)))\n  popAapneHt <- st_as_sf(bind_cols(popAapneHt,geojsonsf::geojson_sf(popAapneHt$.geo)))\n  \n  # Import median LiDAR heights for forest (skog) within 200m of population polygons\n    # this will form the lower limit of the ecological condition score (ie. poor condition)\n  popVaatmarkSkog <- readVegHeightFiles('vaatmark_skog') %>%\n    mutate(skog = chm)%>%\n    dplyr::select(-chm, -'.geo', -ssbid)\n  popAapneSkog <- readVegHeightFiles('aapne_skog') %>%\n    mutate(skog = chm)%>%\n    dplyr::select(-chm, -'.geo', -ssbid)\n  \n  # Combine the population heights with the forest heights\n  popVaatmark <- popVaatmarkHt %>%\n    left_join(popVaatmarkSkog, by = 'system:index')%>%\n    dplyr::select(-'.geo')\n  popAapne <- popAapneHt %>%\n    left_join(popAapneSkog, by = 'system:index')%>%\n    dplyr::select(-'.geo')\n  \n  # Add elevation and veg/clim zones to the combined population and forest heights\n  popVaatmark <- cleanElevVegType(popVaatmark)\n  popAapne <- cleanElevVegType(popAapne)\n  \n  # Get regional reference values for forest height\n    # this is to fill in for population polygons which did not have any forest within 200m\n  vaatmarkSkogRegionalRef <- popVaatmark %>%\n    as_tibble() %>%\n    group_by(elevation, vegClimZoneLab) %>%\n    summarise(skogFill = mean(skog, na.rm=TRUE)) %>%\n    drop_na(skogFill)\n  aapneSkogRegionalRef <- popAapne %>%\n    as_tibble() %>%\n    group_by(elevation, vegClimZoneLab) %>%\n    summarise(skogFill = mean(skog, na.rm=TRUE)) %>%\n    drop_na(skogFill)\n  \n  # Combine all the above into one data frame\n  #set.seed(123)\n  vaatmarkHts <- popVaatmark %>%\n    #sample_n(100000) %>%\n    as_tibble() %>% dplyr::select(-geometry) %>%\n    left_join(refVaatmark, by=c('vegClimZoneLab', 'elevation')) %>%\n    gather(type, height, ref, pop, skog) %>%\n    group_by(`system:index`, elevation, vegClimZoneLab, type) %>%\n    summarise(height = mean(height)) %>%\n    pivot_wider(values_from = height, names_from = type) %>%\n    # If population height is less than the reference value, then it is automatically \"good\" condition - ie. it inherits the reference height so that the rescaled value will be 1\n    mutate(pop = ifelse(pop < ref, ref, pop)) %>%\n    drop_na(pop, ref) %>%\n    left_join(vaatmarkSkogRegionalRef, by = c('vegClimZoneLab', 'elevation')) %>%\n    mutate(skog = ifelse(is.na(skog), skogFill, skog)) %>%\n    dplyr::select(-skogFill) %>%\n    filter(skog < 30)\n  #colSums(is.na(vaatmarkHts))\n  \n  aapneHts <- popAapne %>%\n    #sample_n(100000) %>%\n    as_tibble() %>% dplyr::select(-geometry) %>%\n    left_join(refAapne, by=c('vegClimZoneLab', 'elevation')) %>%\n    gather(type, height, ref, pop, skog) %>%\n    group_by(`system:index`, elevation, vegClimZoneLab, type) %>%\n    summarise(height = mean(height)) %>%\n    pivot_wider(values_from = height, names_from = type) %>%\n    # If population height is less than the reference value, then it is automatically \"good\" condition - ie. it inherits the reference height so that the rescaled index will be 1\n    mutate(pop = ifelse(pop < ref, ref, pop)) %>%\n    drop_na(pop, ref) %>%\n    left_join(aapneSkogRegionalRef, by = c('vegClimZoneLab', 'elevation')) %>%\n    mutate(skog = ifelse(is.na(skog), skogFill, skog)) %>%\n    dplyr::select(-skogFill) %>%\n    filter(skog < 30)\n  #colSums(is.na(aapneHts))\n  \n} else {\n  \n  refVaatmark  <- read_csv('/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/gjengroing/R_project/DATA/refVaatmark.csv')\n  refAapne <- read_csv('/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/gjengroing/R_project/DATA/refAapne.csv')\n  \n}"},{"path":"gjengroing.html","id":"explore-data-coverages","chapter":"1 Enchroachment","heading":"1.8.2 Explore data coverages","text":"make maps NiN, AR5 LiDAR coverage Norway get feel data distributions. areas calculated GEE exported CSV GEE script provided . need now join SSB 10km grid visualize.","code":"\n\n\nc1 <- ssb10km %>% \n  left_join(areaCoversPerc %>%\n              filter(type == 'nin') %>%\n              group_by(SSBID) %>%\n              summarise(areaPerc = sum(areaPerc, na.rm=T)))  %>%\n  ggplot() +\n  geom_sf(aes(fill=areaPerc), color=NA) +\n  geom_sf(data=regions, fill=NA, size=0.3) +\n  scale_fill_gradientn(colours = c('#e6bf6b', '#91b5a2'),\n                       name = '% cover',\n                       limits=c(0, 2),\n                       oob=scales::squish) +\n  theme_void() +\n  theme(legend.position = c(0.7, 0.4)) +\n  ggtitle('A) NiN polygons with good condition')\n#c1\nc2 <- ssb10km %>% \n  left_join(areaCoversPerc %>%\n              filter(type == 'ar5') %>%\n              group_by(SSBID) %>%\n              summarise(areaPerc = sum(areaPerc, na.rm=T)))  %>%\n  ggplot() +\n  geom_sf(aes(fill=areaPerc), color=NA) +\n  geom_sf(data=regions, fill=NA, size=0.3) +\n  scale_fill_gradientn(colours = c('#e6bf6b', '#91b5a2'),\n                       name = '% cover',\n                       limits=c(0, 100),\n                       oob=scales::squish) +\n  theme_void() +\n  theme(legend.position = c(0.7, 0.4)) +\n  ggtitle('B) AR5 polygons')\n#c2\nc3 <- ssb10km %>% \n  left_join(areaCoversPerc %>%\n              filter(type == 'lidar') %>%\n              group_by(SSBID) %>%\n              summarise(areaPerc = sum(areaPerc, na.rm=T)))  %>%\n  ggplot() +\n  geom_sf(aes(fill=areaPerc), color=NA) +\n  geom_sf(data=regions, fill=NA, size=0.3) +\n  scale_fill_gradientn(colours = c('#e6bf6b', '#91b5a2'),\n                       name = '% cover',\n                       limits=c(0, 100),\n                       oob=scales::squish) +\n  theme_void() +\n  theme(legend.position = c(0.7, 0.4)) +\n  ggtitle('C) LiDAR canopy height model')\n#c3\n\ncoverageFig <- grid.arrange(c1, c2, c3, ncol=3, widths=c(1,1,1), padding = unit(0, \"line\"), newpage = T) "},{"path":"gjengroing.html","id":"bioclimatic-zone-and-elevation-strata-for-regional-reference-values","chapter":"1 Enchroachment","heading":"1.8.3 Bioclimatic zone and elevation strata for regional reference values","text":"visualize elevation bands bioclimatic zones used define regional reference values poor (forest vegetation height) good (NiN vegetation height) ecological condition. unique spatial combination strata (n = 21), calculate mean reference value later analysis. Note poor ecological condition preferably calculated using local reference (forest height within 200m population polygon), regional reference used nearby forest patches.can see AR5 polygons well distributed across country, NiN polygons clustered biased toward low elevation regions country. LiDAR data covers nearly entire country exceptions north. Future iterations work need attempt quantify biases introduced relative distributions reference population polygons datasets used quantify gjengroing (case LiDAR).","code":"\n\nbioclimPlot <- bioclim %>%\n  ggplot() + \n  geom_sf(aes(fill = NAVN), color=NA)+\n    scale_fill_manual(values=brewer.pal(10, 'Paired'), name = 'Zone')+\n    ggtitle('A) Bioclimatic zones') +\n    theme_void()\n\nelevPlot <- elevStrata %>%\n  ggplot() +\n  geom_sf(aes(fill = elevBand), color=NA, size=0.001)+\n    scale_fill_manual(values=brewer.pal(5, 'Pastel1'), name = 'HASL (M)')+\n    ggtitle('B) Elevation bands')+\n    theme_void()\n\n\nstrataPlot <- grid.arrange(bioclimPlot, elevPlot, ncol=2, widths=c(1,1), padding = unit(0, \"line\"), newpage = T) "},{"path":"gjengroing.html","id":"scaled-indicator-values-at-polygon-level-circa-120-min-runtime","chapter":"1 Enchroachment","heading":"1.8.4 Scaled indicator values at polygon level (circa 120 min runtime)","text":"calculate gjengroing index population polygon Norway using Sigmoid scaling function.visualize spatial variation scaled gjengroind indicator values, well vegetation heights reference (good condition), indicator, mature forest (poor condition) country. plot polygons, computationally intensive difficult visualize spatial variations entire country. Therefore calculate area-weighted mean values bioclimatic-elevation strata (n = 21) country.can see overall, condition scores ecosystem types poor along coastal areas lower-altitude zones country (E). higher altitudes gjengroing condition scores higher.comparing våtmark semi-/naturlig-åpne ecosystems, can see reference heights våtmark generally higher terms good (B F) poor (D H) ecological condition. makes ecological sense wetlands can naturally occur forest therefore våtmark good condition can tree cover without necessarily gjengroing.","code":"\n\n# Define Sigmoid scaling function\nscaleSigmoid <- function(variable){\n  refLow <- min(variable)\n  refHigh <- max(variable)\n  thr <- (refHigh-refLow)/2\n  indicator_LowHigh <- (variable - refLow)/(refHigh - refLow)\n  indicator_LowHigh[indicator_LowHigh[] < 0] <- 0\n  indicator_LowHigh[indicator_LowHigh[] > 1] <- 1\n  indicator_sigmoid <- 100.68*(1-exp(-5*(indicator_LowHigh)^2.5))/100\n  return (round(indicator_sigmoid, 4))\n}\n\nif (runFromScratch){\n  \n  # Calcualte gjengroing index values\n  vaatmarkIndexPoly <- vaatmarkHts  %>%\n    # Gather into long format so taht we can mutate the scaleSigmoid() function\n    gather(type, height, ref, pop, skog) %>%\n    group_by(`system:index`) %>%\n    mutate(index = scaleSigmoid(height)) %>%\n    # Because short vegetation is good condition, we must invert the scaled indicator\n    mutate(index = 1-index) %>%\n    # Get the indicator values for the population polygons only (ref and skog will be 1 and 0)\n    filter(type == 'pop') %>%\n    dplyr::select(-type, -height) %>%\n    # Join with original data to get the actual median vegetaiton heights for each indicator score\n    left_join(vaatmarkHts %>% dplyr::select(\"system:index\", pop, ref, skog)) %>%\n    left_join(popVaatmark %>% dplyr::select(\"system:index\", ssbid))\n  \n  # do the same for åpne polygons - will not comment this because same as above\n  aapneIndexPoly <- aapneHts  %>%\n    gather(type, height, ref, pop, skog) %>%\n    group_by(`system:index`) %>%\n    mutate(index = scaleSigmoid(height)) %>%\n    mutate(index = 1-index) %>%\n    filter(type == 'pop') %>%\n    dplyr::select(-type, -height) %>%\n    left_join(aapneHts %>% dplyr::select(\"system:index\", pop, ref, skog)) %>%\n    left_join(popAapne %>% dplyr::select(\"system:index\", ssbid))\n  \n  \n  # Make into spatial objects\n  vaatmarkIndexPolySpat <- popVaatmark %>%\n    dplyr::select(\"system:index\") %>%\n    left_join(vaatmarkIndexPoly) %>%\n    filter(!is.na(index))\n  aapneIndexPolySpat <- popAapne %>%\n    dplyr::select(\"system:index\") %>%\n    left_join(aapneIndexPoly) %>%\n    filter(!is.na(index))\n  \n  # Transform to correct projection\n  vaatmarkIndexPolySpat <- st_transform(vaatmarkIndexPolySpat, st_crs(regions))\n  aapneIndexPolySpat <- st_transform(aapneIndexPolySpat, st_crs(regions))\n  \n} else {\n  \n  vaatmarkIndexPolySpat <- st_read('/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/gjengroing/R_project/OUTPUT/vaatmark_index.shp')%>%\n    mutate(`system:index` = id,\n           elevation = elev, \n           vegClimZoneLab = vegZn) %>%\n    dplyr::select(-id, -elev, -vegZn)\n  aapneIndexPolySpat <- st_read('/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/gjengroing/R_project/OUTPUT/aapne_index.shp')%>%\n    mutate(`system:index` = id,\n           elevation = elev, \n           vegClimZoneLab = vegZn) %>%\n    dplyr::select(-id, -elev, -vegZn)\n  \n}\n#> Reading layer `vaatmark_index' from data source \n#>   `/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/gjengroing/R_project/OUTPUT/vaatmark_index.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 1069897 features and 8 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -75794.71 ymin: 6449710 xmax: 1108262 ymax: 7939216\n#> Projected CRS: ETRS89 / UTM zone 33N\n#> Reading layer `aapne_index' from data source \n#>   `/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/gjengroing/R_project/OUTPUT/aapne_index.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 1763446 features and 8 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -76208.98 ymin: 6448886 xmax: 1108352 ymax: 7939986\n#> Projected CRS: ETRS89 / UTM zone 33N\n\n# Create intersection of the two strata layers\n#elevStrata <- st_transform(elevStrata, st_crs(regions))\nbioClimElev <- bioclim %>%\n  st_intersection(elevStrata) %>%\n  mutate(elevation = elevBand,\n         vegClimZoneLab = NAVN)%>%\n  dplyr::select(elevation, vegClimZoneLab) %>%\n  rowid_to_column(\"ID\")\n\nif (runFromScratch){\n  \n  # Get area-weighted mean for reference, forest and population vegetation heights \n  # for each unique bioclimatic-elevation zone combination\n  vaatmarkIndexStrata <- bioClimElev %>% \n    #sample_n(10000) %>%\n    st_join(vaatmarkIndexPolySpat %>% \n                mutate(area = as.numeric(st_area(geometry))) ,st_intersects) %>%\n    group_by(ID) %>%\n    summarise_at(vars(pop, ref, skog, index), funs(weighted.mean(., w=area, na.rm=TRUE)))%>% \n                as_tibble() %>% \n                dplyr::select(-geometry)\n  \n  \n  aapneIndexStrata <- bioClimElev %>% \n    #sample_n(10000) %>%\n    st_join(aapneIndexPolySpat %>% \n                mutate(area = as.numeric(st_area(geometry))) ,st_intersects) %>%\n    group_by(ID) %>%\n    summarise_at(vars(pop, ref, skog, index), funs(weighted.mean(., w=area, na.rm=TRUE)))%>% \n                as_tibble() %>% \n                dplyr::select(-geometry)\n  \n  \n  # Write out for import later\n  vaatmarkIndexStrata %>% write_csv('/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/gjengroing/R_project/DATA/vaatmarkIndexStrata.csv')\n  aapneIndexStrata %>% write_csv('/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/gjengroing/R_project/DATA/aapneIndexStrata.csv')\n  \n\n} else {\n  \n  vaatmarkIndexStrata <- read_csv('/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/gjengroing/R_project/DATA/vaatmarkIndexStrata.csv')\n  aapneIndexStrata <- read_csv('/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/gjengroing/R_project/DATA/aapneIndexStrata.csv')\n  \n  \n}\n\n# Make plots of indicator heights and scaled condition values for each strata polygon\n\ntheme_legend_1 <- theme(legend.key.size = unit(0.25, 'cm'), #change legend key size\n                        legend.key.height = unit(0.25, 'cm'), #change legend key height\n                        legend.key.width = unit(0.25, 'cm'), #change legend key width\n                        legend.title = element_text(size=6), #change legend title font size\n                        legend.text = element_text(size=6)) #change legend text font size\n\nmakeStrataHeightMap <- function(data, var, title, limits){\n  p <- bioClimElev %>%\n    left_join(data, by = c('ID'))  %>%\n    mutate(response = .[[var]]) %>%\n    ggplot() + \n    geom_sf(aes(fill = response), color=NA)+\n      scale_fill_gradientn(colors=viridis::viridis(10),\n                           limits = limits,\n                           oob = scales::squish,\n                           name = 'Veg ht (m)')+\n      ggtitle(title) +\n      theme_void() +\n    theme(plot.title = element_text(size=9)) +\n    theme_legend_1\n    \n  return (p)\n}\n\nmakeStrataIndicatorMap <- function(data, title){\n  p <- bioClimElev %>%\n    left_join(data, by = c('ID'))  %>%\n    ggplot() + \n    geom_sf(aes(fill = index), color=NA)+\n      scale_fill_gradientn(colors=brewer.pal(10, 'Spectral'),\n                           limits = c(0,1),\n                           name = 'Index')+\n      ggtitle(title) +\n      theme_void()+\n    theme(plot.title = element_text(size=9)) +\n    theme_legend_1\n    \n  return (p)\n}\n\na1 <- makeStrataIndicatorMap(aapneIndexStrata,  'A) Semi-/Naturlig-åpne scaled indicator')\na2 <- makeStrataHeightMap(aapneIndexStrata, \"ref\", 'B) Semi-/Naturlig-åpne reference height', c(0,5))\na3 <- makeStrataHeightMap(aapneIndexStrata, \"pop\", 'C) Semi-/Naturlig-åpne indicator height', c(0,5))\na4 <- makeStrataHeightMap(aapneIndexStrata, \"skog\", 'D) Semi-/Naturlig-åpne forest height', c(0,5))\n\nv1 <- makeStrataIndicatorMap(vaatmarkIndexStrata,  'E) Våtmark scaled indicator')\nv2 <- makeStrataHeightMap(vaatmarkIndexStrata, \"ref\", 'F) Våtmark reference height', c(0,5))\nv3 <- makeStrataHeightMap(vaatmarkIndexStrata, \"pop\", 'G) Våtmark indicator height', c(0,5))\nv4 <- makeStrataHeightMap(vaatmarkIndexStrata, \"skog\", 'H) Mature forest height', c(0,5))\n\nstrataHeightPlot <- grid.arrange(a1,a2,a3,a4, v1,v2,v3,v4, ncol=4, widths=c(1,1,1,1), padding = unit(0, \"line\"), newpage = T) "},{"path":"gjengroing.html","id":"scaled-indicator-values-at-50km-grid-level-circa-45-min-runtime","chapter":"1 Enchroachment","heading":"1.8.5 Scaled indicator values at 50km grid level (circa 45 min runtime)","text":"Using polygon-level indicator scores, aggregate 50km grid level explore spatial variation Norway. alternative way visualizing broad-scale patterns presented section used bioclimatic-elevation strata.use weighted average, test eaTools::ea_spread function! takes time run best overnight, parallelize way.Visualize spatial distribution gjengroing indicator scores grid level.patterns mirror previous section higher condition scores higher elevations lower scores along coastal zone low-lying parts country.see low condition scores coastal 50km grid cells - may artifact creating average population polygons therefore vulnerable skewed average indicator scores.","code":"\n\nif (runFromScratch){\n  \n  # Aggregate polygon index scores to grid level using eaTools ea_spread function\n  vaatmarkIndexGrid <- eaTools::ea_spread(indicator_data = vaatmarkIndexPolySpat,\n                                            indicator = index,\n                                            regions = ssb50km,\n                                            groups = SSBID,\n                                            threshold = 1) %>%\n    mutate(index = w_mean, ssbid = ID) %>%\n    dplyr::select(ssbid, index, sd)\n\n  aapneIndexGrid <- eaTools::ea_spread(indicator_data = aapneIndexPolySpat,\n                                            indicator = index,\n                                            regions = ssb50km,\n                                            groups = SSBID,\n                                            threshold = 1) %>%\n    mutate(index = w_mean, ssbid = ID) %>%\n    dplyr::select(ssbid, index, sd)\n  \n} else {\n  \n  print('Will import pre-exported data')\n  \n  vaatmarkIndexGrid <- st_read('/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/gjengroing/R_project/OUTPUT/vaatmark_index_grid.shp')\n  aapneIndexGrid <- st_read('/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/gjengroing/R_project/OUTPUT/aapne_index_grid.shp')\n  \n}\n#> [1] \"Will import pre-exported data\"\n#> Reading layer `vaatmark_index_grid' from data source \n#>   `/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/gjengroing/R_project/OUTPUT/vaatmark_index_grid.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 273 features and 3 fields\n#> Geometry type: POLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -150000 ymin: 6400000 xmax: 1150000 ymax: 8e+06\n#> Projected CRS: ETRS89 / UTM zone 33N\n#> Reading layer `aapne_index_grid' from data source \n#>   `/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/gjengroing/R_project/OUTPUT/aapne_index_grid.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 273 features and 3 fields\n#> Geometry type: POLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -150000 ymin: 6400000 xmax: 1150000 ymax: 8e+06\n#> Projected CRS: ETRS89 / UTM zone 33N\n\nvGrid1 <- aapneIndexGrid %>%\n  ggplot() +\n  geom_sf(aes(fill=index), color=NA) +\n  geom_sf(data=regions, fill=NA, size=0.5) +\n  scale_fill_gradientn(colors=brewer.pal(10, 'Spectral'),\n                       limits = c(0,1),\n                       name = 'Index') +\n  theme_void() +\n  theme(legend.position = c(0.7, 0.4)) +\n  ggtitle('A) Semi-/Naturlig gjengroing condition')\n#vGrid1\n\nvGrid2 <- vaatmarkIndexGrid %>%\n  ggplot() +\n  geom_sf(aes(fill=index), color=NA) +\n  geom_sf(data=regions, fill=NA, size=0.5) +\n  scale_fill_gradientn(colors=brewer.pal(10, 'Spectral'),\n                       limits = c(0,1),\n                       name = 'Index') +\n  theme_void() +\n  theme(legend.position = c(0.7, 0.4)) +\n  ggtitle('B) Våtmark gjengroing condition')\n#vGrid2\n\n\nindexGridFig <- grid.arrange(vGrid1, vGrid2, ncol=2, widths=c(1,1), padding = unit(0, \"line\"), newpage = T) "},{"path":"gjengroing.html","id":"scaled-indicator-values-at-regional-level-circa-120-min-runtime","chapter":"1 Enchroachment","heading":"1.8.6 Scaled indicator values at regional level (circa 120 min runtime)","text":"Now aggregate regional level final reporting. use method section , except use different method calculate uncertainty value around indicator values. ea_spread function eaTools uses bootstrapping method calculate standard error indicator values aggregating polygon regional level. hundreds thousands polygons per region, resulting standard errors extremely small. Therefore use standard deviation reference values per region. standard deviation, percentage average reference value used calculate uncertainty scaled indicator value.Present indicator values table, plots, maps:tables, figures maps can see gjengroing condition indicator scores average 0.8 therefore indicate good overall condition Norway. Østlandet comes best våtmark semi-naturlig åpne ecosystems. Nord-Norge poorest condition semi-naturlig åpne ecosystems, vestlandet poorest scores våtmark.","code":"\n\nif (runFromScratch){\n  \n  # Get the mean population, reference and forest heights per region for interpreting index values\n  # The standard deviation is used later to define uncertainty around the indicator score\n  vaatmarkHeightsRegion <- regions %>%\n    st_join(vaatmarkIndexPolySpat) %>%\n    as_tibble() %>%\n    drop_na(index) %>%\n    group_by(region) %>%\n    summarise(pop_mean = mean(pop),\n              skog_mean = mean(skog),\n              ref_mean = mean(ref),\n              sd_ref = sd(ref))\n  aapneHeightsRegion <- regions %>%\n    st_join(aapneIndexPolySpat) %>%\n    as_tibble() %>%\n    drop_na(index) %>%\n    group_by(region)  %>%\n    summarise(pop_mean = mean(pop),\n              skog_mean = mean(skog),\n              ref_mean = mean(ref),\n              sd_ref = sd(ref))\n  \n  # Aggregate polygon index scores to regional level using eaTools\n  vaatmarkIndexRegion <- eaTools::ea_spread(indicator_data = vaatmarkIndexPolySpat,\n                                            indicator = index,\n                                            regions = regions,\n                                            groups = region,\n                                            threshold = 1) %>%\n    mutate(index = w_mean, region = ID) %>%\n    dplyr::select(region, index, sd) %>%\n    left_join(vaatmarkHeightsRegion)\n  \n  # Only run on first iteration - takes a long time\n  aapneIndexRegion <- eaTools::ea_spread(indicator_data = aapneIndexPolySpat,\n                                            indicator = index,\n                                            regions = regions,\n                                            groups = region,\n                                            threshold = 1) %>%\n    mutate(index = w_mean, region = ID) %>%\n    dplyr::select(region, index, sd) %>%\n    left_join(aapneHeightsRegion)\n  \n} else {\n  \n  print('Will import pre-exported data')\n  \n  vaatmarkIndexRegion <- st_read('/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/gjengroing/R_project/OUTPUT/vaatmark_index_region.shp')\n  aapneIndexRegion <- st_read('/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/gjengroing/R_project/OUTPUT/aapne_index_region.shp')\n  \n  \n}\n#> [1] \"Will import pre-exported data\"\n#> Reading layer `vaatmark_index_region' from data source \n#>   `/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/gjengroing/R_project/OUTPUT/vaatmark_index_region.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 5 features and 7 fields\n#> Geometry type: POLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -99551.21 ymin: 6426048 xmax: 1121941 ymax: 7962744\n#> Projected CRS: ETRS89 / UTM zone 33N\n#> Reading layer `aapne_index_region' from data source \n#>   `/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/gjengroing/R_project/OUTPUT/aapne_index_region.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 5 features and 7 fields\n#> Geometry type: POLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -99551.21 ymin: 6426048 xmax: 1121941 ymax: 7962744\n#> Projected CRS: ETRS89 / UTM zone 33N\n\n# Join into a table to present values\naapentTable <- aapneIndexRegion %>% as_tibble() \nvaatmarkTable <- vaatmarkIndexRegion %>% as_tibble() \n\n# Join ecosystem types and calculate uncertainty\nindicatorTable <- aapentTable %>% mutate(Ecosystem = 'Semi-/Naturlig åpne') %>%\n  bind_rows(vaatmarkTable %>% mutate(Ecosystem = 'Våtmark')) %>%\n  # Calculate the error based on the standard deviation in reference polygon heights\n  # as a percentage of the reference height, and multiply by index score\n  mutate(sd = (sd_ref/ref_mean)*index)\n\n# Format the table for presentation\nindicatorTable_formatted <- regions %>%\n  left_join(indicatorTable) %>% as_tibble() %>%\n  dplyr::select(-geometry)  %>%\n  dplyr::select( region, Ecosystem, index, sd, pop_mean, ref_mean, skog_mean) %>%\n  mutate_if(is.numeric, round, 2)\nnames(indicatorTable_formatted) <- c( \"Region\", \"Ecosystem\",\n                                      \"Scaled indicator\",  \"Scaled Std.dev\",\n                                      \"Indicator height\",\"Reference height\",\n                                      \"Mature forest height\")\n\n# Use knitr to visualize\nknitr::kable(indicatorTable_formatted)\n\n# Make plots of regional index values\ngetIndicatorPlot <- function(label){\n  regions %>%\n    left_join(indicatorTable %>%\n                filter(Ecosystem == label)) %>%\n    mutate(lowError = index-sd, \n           upError = index+sd,\n           upError = ifelse(upError > 1, 1, upError)) %>%\n    ggplot(aes(y=region, x=index)) +\n    geom_point() +\n    geom_segment(aes(yend=region, x=lowError, xend=upError)) +\n    coord_cartesian(xlim=c(0,1)) +\n    geom_vline(xintercept = 1) +\n    geom_vline(xintercept = 0) +\n    labs(x = 'Tilstandsverdi') +\n    theme(axis.title.y=element_blank()) +\n    ggtitle(label) \n}\ni1 <- getIndicatorPlot('Semi-/Naturlig åpne')\ni2 <- getIndicatorPlot('Våtmark')\nindicatorGraphFig <- grid.arrange(i1, i2, ncol=2, widths=c(1,1), padding = unit(0, \"line\"), newpage = T) \n\n\n# Make maps of regional index values\ngetIndicatorMap <- function(data, label){\n  regions %>%\n    left_join(data) %>%\n    ggplot() +\n    geom_sf(aes(fill=index)) +\n    scale_fill_gradientn(colors=brewer.pal(10, 'Spectral'),\n                         limits = c(0,1))+\n    ggtitle(label)+\n    theme_void()\n}\nm1 <- getIndicatorMap(aapentTable, 'A) Semi-/Naturlig åpne')\nm2 <- getIndicatorMap(vaatmarkTable, 'B) Våtmark')\nindicatorGMapFig <- grid.arrange(m1, m2, ncol=2, widths=c(1,1), padding = unit(0, \"line\"), newpage = T) "},{"path":"gjengroing.html","id":"uncertainty-and-validation","chapter":"1 Enchroachment","heading":"1.8.7 Uncertainty and validation","text":"calculation indicator involves many small decisions can significant effects resulting conditions cores. Therefore future good perform sensitivity analyses decision test effect outcome. decisions benefit exploration include:Selection reference population areas. limited using NiN AR5 arguably best datasets currently available exercise. However, NiN AR5 spatially thematically biased ways. Therefore, may worth exploring alternative datasets future. NiN polygons biased towards low lying areas generally warmer productive. given bioclimatic-elevation strata, lead higher reference values vegetation height one expect representative reference sample. consequently result high elevation population polygons appearing good condition compared (relatively) high productivity polygons bioclimatic-elevation strata. possible explanation high elevation parts Norway appear good ecological condition.Selection reference population areas. limited using NiN AR5 arguably best datasets currently available exercise. However, NiN AR5 spatially thematically biased ways. Therefore, may worth exploring alternative datasets future. NiN polygons biased towards low lying areas generally warmer productive. given bioclimatic-elevation strata, lead higher reference values vegetation height one expect representative reference sample. consequently result high elevation population polygons appearing good condition compared (relatively) high productivity polygons bioclimatic-elevation strata. possible explanation high elevation parts Norway appear good ecological condition.Definition good condition states NiN data. used overall “tilstand” score NiN reference polygon. However, overall score combination several sub-scores may may relevant ecological condition. instance, ditches wheel marks wetlands common condition score NiN, however debatable whether considered part ecological condition. Therefore may beneficial attempt repeating indicator calculation using sub-categories “tilstand” NiN data.Definition good condition states NiN data. used overall “tilstand” score NiN reference polygon. However, overall score combination several sub-scores may may relevant ecological condition. instance, ditches wheel marks wetlands common condition score NiN, however debatable whether considered part ecological condition. Therefore may beneficial attempt repeating indicator calculation using sub-categories “tilstand” NiN data.Definition climax successional stage tree regrowth. use 50th percentile LiDAR-derived tree heights AR5 forest polygons harvested since 1986. defines zero scaled indicator score. resulting indicator scores vary widely depending define zero-point. Therefore, testing different definitions (.e. tree height percentiles) may important.Definition climax successional stage tree regrowth. use 50th percentile LiDAR-derived tree heights AR5 forest polygons harvested since 1986. defines zero scaled indicator score. resulting indicator scores vary widely depending define zero-point. Therefore, testing different definitions (.e. tree height percentiles) may important.Quantifying regional vs local references poor good condition. good condition, used NiN polygons restricted due lack better data. However, poor condition use climax successional stage trees (explained ) within 200m population polygon. polygons surrounding forest, impute regional reference values (mean forest height elevation-bioclamic zone). choice 200m buffer zone largely based computational limitations. Calculating average LiDAR vegetation height within 200m nearly 2 million complex polygons takes time, even GEE. may make ecological sense define larger buffer zone use defining reference poor condition. However, longer processing times need expected.Quantifying regional vs local references poor good condition. good condition, used NiN polygons restricted due lack better data. However, poor condition use climax successional stage trees (explained ) within 200m population polygon. polygons surrounding forest, impute regional reference values (mean forest height elevation-bioclamic zone). choice 200m buffer zone largely based computational limitations. Calculating average LiDAR vegetation height within 200m nearly 2 million complex polygons takes time, even GEE. may make ecological sense define larger buffer zone use defining reference poor condition. However, longer processing times need expected.Quantification uncertainty around indicator scores. used standard deviation vegetation heights reference (NiN) polygons within region quantify uncertainty around scaled indicator scores. method used eaTools::ea_spread() function bootstrapping approach resulted extremely small uncertainty estimates due large number polygons included analysis. future, better method quantifying uncertainty needed. Perhaps running sensitivity analyses test several variations points mentioned can form basis quantifying error margin around indicator values.Quantification uncertainty around indicator scores. used standard deviation vegetation heights reference (NiN) polygons within region quantify uncertainty around scaled indicator scores. method used eaTools::ea_spread() function bootstrapping approach resulted extremely small uncertainty estimates due large number polygons included analysis. future, better method quantifying uncertainty needed. Perhaps running sensitivity analyses test several variations points mentioned can form basis quantifying error margin around indicator values.","code":""},{"path":"gjengroing.html","id":"validation-of-random-polygons","chapter":"1 Enchroachment","heading":"1.8.7.1 Validation of random polygons","text":"exporting final polygon-level indicator scores, imported QGIS explored look landscape scale. chose random locations spread across 5 regions Norway. figures show våtmark åpne (semi- naturlig-åpne) ecosystem polygons AR5. polygons jagged edges chose low resolution geometry export GEE save computing time minimize storage space. polygon colored based final scaled gjengroing indicator score (0 1). polygons also labelled median LiDAR-derived forest height. orthophoto Norgeibilder displayed background reference.first example midt-norge, see våtmark polygon colored red (ie. poor condition) due growth forest northern section. looks like plantation forest possibly occurred wetland drained. height forest vegetation equates median 2.4m higher reference value region (1.09m) almost high mature forest height reference 2.8m. Therefore gets scaped indicator score 0.1. contrast wetland polygon middle image good condition median vegetation height 1.1m fractionally higher regional reference good ecological condition.second example Sørlandet shows three AR5 semi-naturlig åpne polygons different indicator values. lower polygon poor ecological condition median vegetation height 6.2m close local reference value mature forest (7.9m). Although central polygon appears greater coverage forest orthophoto, LiDAR data tells us mostly covered short trees results median vegetation height 2.8 - therefore good condition.third example Østlandet shows range indicator values våtmark polygons. Although many polygons partly covered trees, indicator values show good condition local reference mature forest (zero indicator scale) high landscape productive forest.fourth example Nord-norge shows AR5 semi-naturlig åpne polygons low high condition scores. large polygon poor condition score median vegetation height 2.7 nearly high local reference mature forest (3.8m).fifth final example north Nord-norge shows two våtmark polygons contrasting condition scores, yet exactly median vegetation heights 0.6m. difference scaled indicator value due different local reference values surrounding forest. polygon left surrounding forest (within 200m buffer zone) median height 0.5m, polygon right surrounding forest 0.7m. creates contrast final indicator value illustrates effect local reference value can defining good poor ecological condition.","code":""},{"path":"gjengroing.html","id":"exp-enc","chapter":"1 Enchroachment","heading":"1.8.8 Eksport file (final product)","text":"export gjengroing indicator values three levels: - polygon level - 50km grid level - regional level","code":"\n\nif (runFromScratch){\n  # Polygon level\n  vaatmarkIndexPolySpat  %>%\n    #mutate(area = as.numeric(st_area(geometry)))%>% \n    #filter(area > 7500) %>%\n    mutate(id = `system:index`,\n           elev = elevation, \n           vegZn = vegClimZoneLab) %>%\n    dplyr::select(-\"system:index\", -vegClimZoneLab, -elevation) %>%\n    st_write('/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/gjengroing/R_project/OUTPUT/vaatmark_index.shp', append=FALSE)\n  \n  aapneIndexPolySpat %>% \n    #mutate(area = as.numeric(st_area(geometry)))%>% \n    #filter(area > 7500) %>%\n    mutate(id = `system:index`,\n           elev = elevation, \n           vegZn = vegClimZoneLab) %>%\n    dplyr::select(-\"system:index\", -vegClimZoneLab, -elevation) %>%\n    st_write('/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/gjengroing/R_project/OUTPUT/aapne_index.shp', append=FALSE)\n  \n  # Grid level\n  vaatmarkIndexGrid %>%\n    st_write('/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/gjengroing/R_project/OUTPUT/vaatmark_index_grid.shp', append = FALSE)\n  aapneIndexGrid %>%\n    st_write('/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/gjengroing/R_project/OUTPUT/aapne_index_grid.shp', append = FALSE)\n  \n  # Region level\n  vaatmarkIndexRegion %>%\n    st_write('/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/gjengroing/R_project/OUTPUT/vaatmark_index_region.shp', append = FALSE)\n  aapneIndexRegion %>%\n    st_write('/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/gjengroing/R_project/OUTPUT/aapne_index_region.shp', append = FALSE)\n}"},{"path":"nature-index-product.html","id":"nature-index-product","chapter":"2 Nature index product","heading":"2 Nature index product","text":"Author date:Chloé R. NaterSeptember 2023","code":""},{"path":"nature-index-product.html","id":"introduction","chapter":"2 Nature index product","heading":"2.1 Introduction","text":"Norwegian Nature Index (NI) composite metric quantifying state biodiversity abundance-context.\nestablished published first time 2010 since updated years 2011, 2012, 2013,2014, 2019.\nowned presented Norwegian Environmental Agency latest iteration, including lot information, can found webpage: https://www.naturindeks./NI composite index made single- multi-species (abundance) indicators scaled fall 0 1 (0 = absent/extinct 1 = abundance corresponding expected abundance natural environment minimum human disturbance).\naggregation process, indicators weighed three levels: functional group (trophic weights), spatial coverage (area weights)key function (key weights).methodology calculating NI well established described detail NINA reports 347,1 425,2 797,3 1130,4 18865 several international scientific articles6 elaborated .important note NI products used indicators Ecosystem Condition Assessment Norwegian Nature Index previously published, published 2025, national biodiversity assessment identical.\nuse modified versions NI Ecosystem Condition Assessments, details described .\nMoving forward, important stress distinction, therefore start talking “NI products” referring composite indices built based data Nature Index Database (see ) identical regularly published national assessments (.e. published https://www.naturindeks./).","code":""},{"path":"nature-index-product.html","id":"about-the-underlying-data","chapter":"2 Nature index product","heading":"2.2 About the underlying data","text":"data underlying NI products stored Nature Index Database https://naturindeks.nina./.\ndatabase needs login credentials access.database, data large number indicators stored separately different areas different years.\nareas years available indicator vary indicators data years 2000, 2010, 2014, 2019.\ndatabase currently also holds data 1990, many indicators, data available year.\nNew data added 2024, currently working extending database may also hold data years official NI updates.data held NI database mixture observational data, modelled estimates, quantitative expert assessments., focus primarily NI product wetlands, following table gives overview indicators included official NI wetlands 2020.\nalso provides information indicators trophic level, underlying data, whether expect updated indicator data towards NI 2025, additional notes.\nTable 2.1: Overview indicators used wetlands NI 2020:\n","code":""},{"path":"nature-index-product.html","id":"representativity-in-time-and-space","chapter":"2 Nature index product","heading":"2.2.1 Representativity in time and space","text":"NI products inclusion Ecological Condition Assessments can currently calculated years 1990, 2000, 2010, 2014, 2019, correspond years official NI updates took place.\nEcosystem level NI products calculated 5 major regions Norway: “Nord-Norge” (northern Norway), “Sør-Norge” (southern Norway), “Midt-Norge” (central Norway), “Vestlandet” (western Norway), “Østlandet”.\ntheory, possible calculate NI products also , including smaller, spatial units, require additional coding.\nalso important note spatial resolution indicators make specific NI product can vary substantially.\nmany indicators rather crude spatial resolution, scaling NI products smaller spatial units may make lot sense.\nConsequently, important keep mind NI products, even plotted map, quantify trends biodiversity relatively large spatial scales, suitable quantifying comparing biodivseristy small localised areas.","code":""},{"path":"nature-index-product.html","id":"original-units","chapter":"2 Nature index product","heading":"2.2.2 Original units","text":"NI composite index made scaled indicators.\nNI products therefore numbers 0 1 (specifically set simulated numbers resulting bootstrap, derived summary metrics including mean, median, 95 % confidence intervals) unit.","code":""},{"path":"nature-index-product.html","id":"temporal-coverage","chapter":"2 Nature index product","heading":"2.2.3 Temporal coverage","text":"mentioned , NI products can currently calculated years 1990, 2000, 2010, 2014, 2019.\n2025, calculations based new data 2024 become available.","code":""},{"path":"nature-index-product.html","id":"aditional-comments-about-the-dataset","chapter":"2 Nature index product","heading":"2.2.4 Aditional comments about the dataset","text":"missing values NI database.\nproportion missing data values depends individual indicators included NI product.\npart NI analysis workflow, missing data values can imputed using MICE (Multivariate Imputation Chained Equations) algorithm.\nimputation procedure uses (temporal) correlations among included indicators make inference missing values.\nUncertainty due NA imputation propagated final NI product.\nSince imputation procedure based correlations, influenced composition dataset, .e. choice indicators, years, locations affect parameters imputation routine.\nnow, recommend using data official NI years calculating products NA imputation approach closely resembles routine used official regular NI analyses.","code":""},{"path":"nature-index-product.html","id":"ecosystem-characteristic-1","chapter":"2 Nature index product","heading":"2.3 Ecosystem characteristic","text":"","code":""},{"path":"nature-index-product.html","id":"norwegain-standard","chapter":"2 Nature index product","heading":"2.3.1 Norwegain standard","text":"NI products regarded indicators biodiversity (“biologisk mangfold”).\nimportant note though NI products represent species abundance context indicators species richness species distribution.","code":""},{"path":"nature-index-product.html","id":"seea-ea-un-standard","chapter":"2 Nature index product","heading":"2.3.2 SEEA EA (UN standard)","text":"NI products tagged “Compositional state characteristic”.\nseems like obvious choice biodiversity indicators focus species richness, may need revisiting NI products, indicators species abundance.","code":""},{"path":"nature-index-product.html","id":"collinearities-with-other-indicators-1","chapter":"2 Nature index product","heading":"2.4 Collinearities with other indicators","text":"substantial potential collinearity NI products indicators, primarily due fact range indicators may part NI product given ecosystem may also enter Ecological Condition Assessment indicators right composite indicators.\nwetlands ecosystem, case, example, bird indicators based data “Hekkefuglovervåkingen”.\nindicators form important proportion wetlands NI products (least defined now) also enter Ecological Condition Assessment composite bird indicator.\nCollinearity two indicators/indices checked.","code":""},{"path":"nature-index-product.html","id":"reference-condition-and-values","chapter":"2 Nature index product","heading":"2.5 Reference condition and values","text":"","code":""},{"path":"nature-index-product.html","id":"reference-condition","chapter":"2 Nature index product","heading":"2.5.1 Reference condition","text":"reference condition defined along lines NI indicators Ecological Condition Assessments.","code":""},{"path":"nature-index-product.html","id":"reference-values-thresholds-for-defining-good-ecological-condition-minimum-andor-maximum-values","chapter":"2 Nature index product","heading":"2.5.2 Reference values, thresholds for defining good ecological condition, minimum and/or maximum values","text":"NI products already scaled range 0 1 reference conditions set according approach, reference value 1.\nwetlands ecosystems particular, yet discussed definition “good ecological condition”, seems Ecological Condition Assessments forest mountain ecosystems, 0.6 used “good ecological condition” consistent approach “Vanndirektivet”.\ndegree appropriate difficult judge.\nmay well best use 0.6 due consistency frameworks (e.g. Vanndirektivet) challenging otherwise determine “good enough” condition highly derived variable NI products.","code":""},{"path":"nature-index-product.html","id":"uncertainties","chapter":"2 Nature index product","heading":"2.6 Uncertainties","text":"Calculated NI products actually composed pre-defined number random samples probability distribution drawn internal bootstrap implemented R package NIcalc.\ndraws can summarised metrics mean, median, confidence intervals.\netc.\ndegree uncertainty determined ) uncertainty associated indicator’s data deposited NI database b) uncertainty resulting imputation missing values.Besides “quantitative” sources uncertainty, also “qualitative” uncertainty linked using NI products indicators Ecological Condition Assessments.\nlinked methodological questions regarding (perhaps ) highly processed composite indices included indicators make composite indices.\nquestions philosohpical nature, pragmatic ones include decisions indicators include/exclude (especially considering indicators may get used directly via NI products indicators really quantify species abundance), weigh indicators, whether impute NA values part generating NI product.present thoughts suggestions regarding latter questions next section.\n## Suggestions using NI products Ecological Condition Assessments [section hold insights suggestions based discussion held Anders back leave.\nContent added later.]","code":""},{"path":"nature-index-product.html","id":"references-1","chapter":"2 Nature index product","heading":"2.7 References","text":"","code":""},{"path":"nature-index-product.html","id":"analyses","chapter":"2 Nature index product","heading":"2.8 Analyses","text":"following analysis workflow almost entirely arranged functions.\nfunctions different steps NIflex R package (https://github.com/NINAnor/NIflex).Many NIflex functions call functions NIcalc (https://github.com/NINAnor/NIcalc), R package written entering extracting data NI database calculating NI products .\nproceeding , therefore need make sure packages dependencies installed:NIflex written provide flexible workflow calculating range NI products including original NI seven main ecosystems, range previously used thematic indices, fully custom indices – important – NI products aimed use Ecological Condition Assessments forest, mountain, wetland ecosystems.walk workflow NI product Ecosystem Condition Assessment wetlands.\nprovide lot additional details functions arguments necessary information included function documentation.","code":"\nif(system.file(package = 'NIcalc') == \"\"){\n  devtools::install_github(\"NINAnor/NIcalc\", build_vignettes = TRUE)\n}\n\nif(system.file(package = 'NIflex') == \"\"){\n  devtools::install_github(\"NINAnor/NIflex\", build_vignettes = TRUE)\n}"},{"path":"nature-index-product.html","id":"data-sets","chapter":"2 Nature index product","heading":"2.8.1 Data sets","text":"","code":""},{"path":"nature-index-product.html","id":"nature-index-database","chapter":"2 Nature index product","heading":"2.8.1.1 Nature Index database","text":"data required making NI product contained NI database (https://naturindeks.nina./).\nAccessing database requires username password.\npresent, setup works username password saved personal environmental variables NIDB_USERNAME NIDB_PASSWORD.User credentials can requested NINA.","code":"\nNIdb_username <- Sys.getenv(\"NIDB_USRNAME\")\nNIdb_password <- Sys.getenv(\"NIDB_PASSWORD\")"},{"path":"nature-index-product.html","id":"regions","chapter":"2 Nature index product","heading":"2.8.1.2 Regions","text":"mentioned , ecosystem-level NI products calculated five major regions Norway: “Nord-Norge” (northern Norway), “Sør-Norge” (southern Norway), “Midt-Norge” (central Norway), “Vestlandet” (western Norway), “Østlandet”.\ngeoreferencing values plotting onto map, shapefiles regions required.\nrelevant files can downloaded JSON format NI API (https://ninweb08.nina./NaturindeksAPI/index.html) subsequently need transformed shapefiles.workflow, access shapefiles deposited NINA’s internal file system:","code":"\nshapeLibraryPath <- \"/data/P-Prosjekter/41201611_naturindeks_2021_2023_vitenskapelig_ansvar/Shapefiles\""},{"path":"nature-index-product.html","id":"workflow-options","chapter":"2 Nature index product","heading":"2.8.2 Workflow options","text":"NIflex offers workflow calculating NI products can customized terms range options.\nnext, set global options calculating wetlands NI product, starting years data want include.\nSince may want use NA imputation, select official NI years:Next, decide type output want whether impute missing valuesand continue set want indicators weighed.\npresent, use key indicator weights, still weigh according area trophic group:also need state want use Norwegian indicator namesand set way want specify indicators dropped.\ntwo options : “pre-defined” drops hard-coded set indicators dropped case.\nfar, one indicator gets dropped wetlands “lavhei” (due low representativeness ecosystem).\n’s also possible set “custom” specify indicators dropped, .final options, choose whether want dataset diagnostics calculated also whether want run test run full run:difference latter test run, run NA imputation bootstrap 10 iterations instead 1000, makes runtime workflow lot “practical” (1000 even iterations run final results).","code":"\nyears <- c(\"1990\", \"2000\", \"2010\", \"2014\", \"2019\")\nOutputType <- \"EcologicalCondition\"\nEC_ecosystem <- c(\"Wetlands\", \"Våtmark\")\n\nNAImputation <- TRUE \nKeyIndicators <- FALSE\nKeyWeight <- 0.5\n\nAreaWeights <- TRUE \n\nTrophicWeights <- TRUE\nnorwegianNames <- TRUE\nDropIndMode <- \"pre-defined\"\nif(DropIndMode == \"pre-defined\"){DropIndList <- NULL}\nDiagnostics <- TRUE # Yes\nTestRun <- TRUE # Yes"},{"path":"nature-index-product.html","id":"scaled-indicator-values","chapter":"2 Nature index product","heading":"2.8.3 Scaled indicator values","text":"beginning index calculation, conditional variables need set, namely Norwegian name ecosystem lists indicators use indicators drop.Note set indicators_use NULL working pre-defined set indicators (.e. set linked NI wetlands).also need set variables “theme” “funArguments” “none” NULL, respectivel (used controlling workflow elements linked thematic indices):, ready move ahead calculation wetlands NI product.\n, use NIflex::calculateCustomNI(), wrapper function downloads data, runs dataset diagnostics (requested), imputes NA values (requested), calculates NI product using functions NIcalc package:calculating index values, can extract summary metrics specified year match geospatial data analysis /inclusion Ecosystem Condition framework:Next can look visualizations NI product.\nFirst, can plot “traditional” time-series plot index averaged across regions calculate corresponding summary metrics:summary metrics (median) given year can plotted onto map matching shapefiles:","code":"\necosystem_use <- EC_ecosystem[2]\nindicators_use <- NULL\n\ndropInd <- selectDropIndicators(DropIndMode = DropIndMode,\n                                OutputType = OutputType,\n                                ecosystem = ifelse(OutputType %in% c(\"NatureIndex\", \"EcologicalCondition\"), ecosystem_use, NULL),\n                                customList = DropIndList)\ntheme <- \"none\"\nfunArguments <- NULL\nCustomNI <- calculateCustomNI(ecosystem = ecosystem_use,\n                              indicators = indicators_use,\n                              theme = theme,\n                              dropInd = dropInd,\n                              username = NIdb_username,\n                              password = NIdb_password,\n                              KeyIndicators = KeyIndicators,\n                              KeyWeight = KeyWeight,\n                              AreaWeights = AreaWeights,\n                              TrophicWeights = TrophicWeights,\n                              NAImputation = NAImputation,\n                              years = years,\n                              OutputType = OutputType,\n                              funArguments = funArguments,\n                              Diagnostics = Diagnostics,\n                              TestRun = TestRun,\n                              norwegianNames = norwegianNames,\n                              saveSteps = FALSE)\nCustomNI_map <- geomapNI(Index = CustomNI$CustomIndex, \n                         year = 2019, \n                         OutputType = OutputType, \n                         ecosystem = ecosystem_use,\n                         shapeLibraryPath = shapeLibraryPath)\nIndex <- CustomNI$CustomIndex\nplot(Index$wholeArea, main = \"Custom index\", cex = 1, lwd = 2, shade = TRUE)\nsummary(Index$wholeArea)#>      Length Class   Mode\n#> 1990 19     niValue list\n#> 2000 19     niValue list\n#> 2010 19     niValue list\n#> 2014 19     niValue list\n#> 2019 19     niValue list\nplotNI_Map(shp = CustomNI_map,\n           year = 2019,\n           OutputType = OutputType,\n           ecosystem = ecosystem_use,\n           plotMedian = TRUE, plotCI = FALSE, plotDisplacement = FALSE,\n           interactiveMap = FALSE)"},{"path":"nature-index-product.html","id":"uncertainty","chapter":"2 Nature index product","heading":"2.8.4 Uncertainty","text":"Based recent work done part pilot study visualizing NI products (https://ninanor.github.io/NIviz/index.html) also implemented advanced plotting functions.\nfirst one plots time-series well, including entire uncertainty distribution, just summary statistics:works plotting values averaged across entire Norway , also area:Uncertainty can also visualized map alongside median:Finally, plotNI_Map() function also supports option plotting “displacement”, statistical artifact generated NI calculation routine.\nshort, ’s negative number quantifies degree mean index shifted away 1 scaling indicators.\nhigher displacement value, cautious one may want making inference based summary metrics alone:Preparing export matter renaming columns stage.\nUsing geomapNI() already extracted summaries matched spatial data.\ncan take resulting object, CustomNI_map, rename required columns match naming conventions outlined main document, add information reference state, remove columns needed:Note Nature Index products exist scaled variables.\nreason, difference i_yyyy v_yyyy.","code":"\nIndex <- Index <- CustomNI$CustomIndex\n\nplotNI_DensityRidgeTS(Index = Index, \n                      OutputType = OutputType, \n                      ecosystem = ecosystem_use, \n                      theme = theme,\n                      allAreas = FALSE, \n                      selectedArea  = \"wholeArea\")\nplotNI_DensityRidgeTS(Index = Index, \n                      OutputType = OutputType, \n                      ecosystem = ecosystem_use, \n                      theme = theme,\n                      allAreas = TRUE)\nplotNI_Map(shp = CustomNI_map,\n           year = 2019,\n           OutputType = OutputType,\n           ecosystem = ecosystem_use,\n           plotMedian = TRUE, plotCI = TRUE, plotDisplacement = FALSE,\n           interactiveMap = FALSE)\nplotNI_Map(shp = CustomNI_map,\n           year = 2019,\n           OutputType = OutputType,\n           ecosystem = ecosystem_use,\n           plotMedian = TRUE, plotCI = FALSE, plotDisplacement = TRUE,\n           interactiveMap = FALSE)\nCustomNI_map <- CustomNI_map %>%\n  dplyr::rename(v_2019 = meanValue,\n                sd_2019 = standardDev) %>%\n  dplyr::mutate(i_2019 = v_2019,\n                reference_high = 1,\n                reference_low = 0,\n                thr = 0.6) %>%\n  dplyr::select(-medianValue, -widthCI, -displacement)"},{"path":"nature-index-product.html","id":"eksport-file-final-product","chapter":"2 Nature index product","heading":"2.8.5 Eksport file (final product)","text":"Lastly, can save results designated folder:","code":"\nsaveRDS(CustomNI, \"indicators/naturindeks.rds\")\nsaveRDS(CustomNI_map, \"indicators/indicatorMaps/naturindeks_map.rds\")"},{"path":"slitasje.html","id":"slitasje","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","text":"Author date:Anders L. KolstadSeptember 2023Norwegian indicator name: Slitasje","code":""},{"path":"slitasje.html","id":"introduction-1","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.1 Introduction","text":"indicator represent human caused damage disturbance soils vegetation, typically things like recreational activities -road vehicle traffic. data come combination non-random field surveys area-representative surveys. Disturbance soils vegetation recorded various data sets NiN variables 7SE 7TK, similar, fine-scaled variable, PRSL PRTK. Effects domestic animals included definition variables, upper reference value therefore set 0% disturbance.indicator calculated separately three ecosystems, nature types associated ecosystem pooled treated equally. means assume nature types mapped data , pooled, representative main ecosystem. less true Naturally open ecosystems two. can read .Since data sampled systematic random way, must take extra care -extrapolate space. delineate homogeneous impact areas (HIA) based four classes increasing infrastructure, say field data representative inside HIA region (five regions Norway) recorded. calculate area weighted mean (error) indicator value HIA region combination, long 150 data points give combination HIA region.general workflow calculation indicator.Import Nature type data data set ANO data\nsetImport Nature type data data set ANO data\nsetIdentify relevant nature types subset\ndataIdentify relevant nature types subset\ndataConvert ANO points polygonsConvert ANO points polygonsFor polygon, extract variable lowest value\n(one--principle), e.g. Fig. 3.8. four variables 7TK, 7SE (NiN2-variables) PRTK PRSL (defined Norwegain Environmental Agency)polygon, extract variable lowest value\n(one--principle), e.g. Fig. 3.8. four variables 7TK, 7SE (NiN2-variables) PRTK PRSL (defined Norwegain Environmental Agency)Combine data sets (nature types ANO) keep ecosystems separate.Combine data sets (nature types ANO) keep ecosystems separate.Scale slitasje variable based \nreference values.Scale slitasje variable based \nreference values.Define homogeneous impact areas (HIA)Define homogeneous impact areas (HIA)Aggregate spread indicator value across HIAs\nassessment regionsAggregate spread indicator value across HIAs\nassessment regionsConfirm relationship infrastructure index indicator\nvalues justify extrapolationConfirm relationship infrastructure index indicator\nvalues justify extrapolationTO : Prepare ecosystem delineation maps us ethese mask extrapolated indicator mapsTO : Prepare ecosystem delineation maps us ethese mask extrapolated indicator mapsSpatial aggregation indicator values uncertainties accounting areasSpatial aggregation indicator values uncertainties accounting areasExport indicator maps regional extrapolated mapsExport indicator maps regional extrapolated mapsNote besides wetland map, ecosystem delineation maps complete step 10 workflow.Variables used composite ADSV indicator","code":""},{"path":"slitasje.html","id":"about-the-underlying-data-1","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.2 About the underlying data","text":"indicator uses data set standardised field survey nature\ntypes. can read preliminary analyses\n. See also official\nsite\nEnvironment Agency. also import data set called\nANO, can read \n","code":""},{"path":"slitasje.html","id":"representativity-in-time-and-space-1","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.2.1 Representativity in time and space","text":"nature type mapping random said area\nrepresentative. ANO data set however, area representative. \ndata 2018 present. data one field season usually\nbecomes available early following year.","code":""},{"path":"slitasje.html","id":"original-units-1","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.2.2 Original units","text":"variables recorded coarse four-step ordinal scale (Fig.\n3.4) eigth-step scale.","code":""},{"path":"slitasje.html","id":"temoporal-sli","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.2.3 Temporal coverage","text":"data goes back 2018. therefore bulk data 2018 2022 one time step. use mean date raw data,\ndefine variable belonging year 2020 (read \n).Regarding update frequency, Nature type data set replicated, future. must therefore trust selection criteria areas survey change drastically systematically time. example, now surveying lot pressure areas, meaning lowland areas close human population centers. future allocate time surveying wilderness areas, indicator becomes biased. hand, ANO replicated every 5 years.","code":""},{"path":"slitasje.html","id":"aditional-comments-about-the-dataset-1","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.2.4 Aditional comments about the dataset","text":"run nature type data set, see .","code":""},{"path":"slitasje.html","id":"ecosystem-characteristic-2","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.3 Ecosystem characteristic","text":"","code":""},{"path":"slitasje.html","id":"norwegain-standard-1","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.3.1 Norwegain standard","text":"indicator tagged Økologisk egenskap called\nPrimærproduksjon (Primary productivity). somewhat tentative, \nperhaps abiotiske forhold suited. thought behind \nchoice ADSV affect potential primary productivity.","code":""},{"path":"slitasje.html","id":"un-standard","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.3.2 UN standard","text":"indicator tagged Physical state characteristics\nindicator. quite clear. ’s type abiotic characteristic \nphysical structure rather chemical\ncomposition.","code":""},{"path":"slitasje.html","id":"collinearities-with-other-indicators-2","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.4 Collinearities with other indicators","text":"ADSV thought exhibit collinearity indicator \npresent.","code":""},{"path":"slitasje.html","id":"reference-condition-and-values-1","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.5 Reference condition and values","text":"","code":""},{"path":"slitasje.html","id":"reference-condition-1","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.5.1 Reference condition","text":"reference condition one minimal negative human impact. \nalso true semi-natural ecosystems. example, reference\ncondition, ADSV semi-natural ecosystems defined zero,\neven though point time condition realized.","code":""},{"path":"slitasje.html","id":"reference-values-thresholds-for-defining-good-ecological-condition-minimum-andor-maximum-values-1","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.5.2 Reference values, thresholds for defining good ecological condition, minimum and/or maximum values","text":"discussion topic, see GitHub issue 88.Upper = 0%Upper = 0%Threshold = 10%Threshold = 10%Lower = 100%Lower = 100%upper reference value 0% (damage), lower reference\nvalue 100%. Note 100% damage mean area\nmust scarred damaged, hypothetical quadrats around \npoint affected (variable frequency-driven, \namount-driven).threshold good ecosystem condition set 10%\ndamage. expert judgement, rather weak one .\nfuture try empirically validate dose-response relationship,\nexample comparing different variable scores erosion rates potential plant growth.\nneed done specifically nature type.indicator value interpreted differently polygon\nvs landscape scale. polygon scale, 10% damage may seem\nlike much, whilst landscape scale, 10% seems serious.Read normalisation .","code":""},{"path":"slitasje.html","id":"uncertainties-1","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.6 Uncertainties","text":"Uncertainties/errors estimated aggregated indicator values \nbootstrapping individual indicator values 1000 times calculating \ndistribution area weighted means. See documentation eaTools::ea_spread .\nuncertainty different \nspatial variation get straight forward without\nbootstrapping. aggregating second time,\nhomogeneous impact areas accounting areas, assume normal\ndistribution around indicator values, already mentioned\nerrors, sample n times combine resamples \nnew, area weighted, distribution. errors accounting areas\nthus represents spatial variation, precision, \nindicator values within accounting areas.","code":""},{"path":"slitasje.html","id":"references-2","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.7 References","text":"Halvorsen, R. & Bratli, H. 2019. Dokumentasjon av NiN versjon 2.2 tilrettelagt praktisk naturkartlegging: utvalgte variabler fra beskrivelsessystemet. – Natur Norge, Artikkel 11 (versjon 2.2.0): 1–218 (Artsdatabanken, Trondheim; http://www.artsdatabanken..)Miljødirektoratet 2022. Kartleggingsinstruks - kartlegging av terrestriske Naturtyper etter NiN2. URL: https://www.miljodirektoratet./publikasjoner/2022/januar/kartleggingsinstruks-kartlegging-av-terrestriske-naturtyper-etter-nin/Miljødirektoratet 2023. Arealrepresnetativ Naturovervåking. Webpage. URL: https://www.miljodirektoratet./ansvarsomrader/overvaking-arealplanlegging/miljoovervaking/overvakingsprogrammer/natur-pa-land/arealrepresentativ-naturovervakning-ano/","code":""},{"path":"slitasje.html","id":"analyses-1","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.8 Analyses","text":"","code":""},{"path":"slitasje.html","id":"data-sets-1","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.8.1 Data sets","text":"","code":""},{"path":"slitasje.html","id":"NTM","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.8.1.1 Nature type mapping","text":"indicator uses data set\nNaturtyper etter Miljødirektoratets Instruks, can found\n.\nSee also detailed description data set.also separate summary file \nnature types manually mapped correct NiN-main typesand NiN variables recorded nature type. can use find nature types associated NiN main types\ninterested .interested mapping units include target variables.deleted 17 nature types left us :Importing sub-setting main data file, fix duplicate hovedøkosystem, calculate area, split one column two, make numeric, select target variables:\nFigure 3.1: overview naturetypes calculate indicator. Colours refer main ecosystem affiliation.\nColumn names starting number problematic, adding prefix\nFigure 3.2: Distribution data points time.\nNow need create single row per locality new variable \nproduct/function four variables “7SE”, “7TK”, “PRTK” \n“PRSL”.initially baseed indicator whichever variables highest value (worst condition), thought discussion now use additive approach (adding variable values togther). first convert ordinal scale continuous scale, using median value ordinal step.variables use slightly different scales. PRSL PRTK use 8\nstep scale:\nFigure 3.3: Eight step condition scale\n7TK 7SE use 4 step scale\nFigure 3.4: Four step condition scale\ntransfer ordinal variables continuous scale. data strongly right skewed, simply taking center value value range work.\nFigure 3.5: Histogram showing distribution four variables used indicator.\ntable shows , assume ADSV therefore exlude case variable value <1, median value variables 1. common % value range category lower limit category. example, category 1/2 - 1 % value likely 50%, 75% center value value range. One issue variable value 1, lower limit variable value 0. think must manually assign something bit higher 0.can read issue .scaling variable implies difficult measure location \ndegraded form (100% disturbed), since highest % value one can use 75% PRSL PRTK just 50% two.\nproblem original data resolution.\ncompensate somewhat \nusing non-linear transformation.create new data table calculate new\nvariable paste back sf object.First combine 7TK PRTK, also 7SE PRSL.SE 10064\nNA’s, TK \n7007.\nFigure 3.6: 7SE scores naturetype dataset\nNA fraction quite big. localities 7TK PRTK recorded,\n7SE PRSL.\nFigure 3.7: 7TK scores nature type dataset\ncan add two variables together composite variable called\nslitasjeChekhing -InfNo issues .\nFigure 3.8: ADSV scores.\nappears localities good condition. Note also theoretically can get >100% unscaled variable.also like know, TK SE recorded,\none likely worst (best) condition.\ncan taking difference.\nFigure 3.9: Counting number cases TK SE worst condition given locality.\nLooks like SE (= 7SE PRSL) likely detrimental state.Now copy ADVS-values sf object.","code":"\nnaturetypes_summary_import <- readRDS(\"data/naturetypes/natureType_summary.rds\")\nmyVars <- c('7TK', '7SE', 'PRTK', 'PRSL')\nnaturetypes_summary <- naturetypes_summary_import %>%\n  rowwise() %>%\n  mutate(keepers = sum(c_across(\n    all_of(myVars))>0, na.rm=T)) %>%\n  filter(keepers > 0) %>%\n  select(Nature_type, NiN_mainType, Year)\nDT::datatable(naturetypes_summary)\nnaturetypes <- sf::st_read(dsn = path) %>%\n  filter(naturtype %in% naturetypes_summary$Nature_type) %>%\n  mutate(hovedøkosystem = recode(hovedøkosystem,\n                                 \"naturligÅpneOmråderUnderSkoggrensa\" = \"naturligÅpneOmråderILavlandet\"),\n         area = st_area(.)) %>%\n  separate_rows(ninBeskrivelsesvariable, sep=\",\") %>%\n  separate(col = ninBeskrivelsesvariable,\n           into = c(\"NiN_variable_code\", \"NiN_variable_value\"),\n           sep = \"_\",\n           remove=F) %>%\n  mutate(NiN_variable_value = as.numeric(NiN_variable_value)) %>%\n  filter(NiN_variable_code %in% myVars)\n#> Reading layer `Naturtyper_nin_0000_norge' from data source \n#>   `/data/R/GeoSpatialData/Habitats_biotopes/Norway_Miljodirektoratet_Naturtyper_nin/Original/Naturtyper_nin_0000_norge_25833_FILEGDB/Naturtyper_nin_0000_norge_25833_FILEGDB.gdb' \n#>   using driver `OpenFileGDB'\n#> Simple feature collection with 117427 features and 36 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -74953.52 ymin: 6448986 xmax: 1075081 ymax: 7921284\n#> Projected CRS: ETRS89 / UTM zone 33N\n#> Warning: There was 1 warning in `stopifnot()`.\n#> ℹ In argument: `NiN_variable_value =\n#>   as.numeric(NiN_variable_value)`.\n#> Caused by warning:\n#> ! NAs introduced by coercion\nggplot(data = naturetypes, aes(x = naturtype, fill = hovedøkosystem))+\n  geom_bar()+\n  coord_flip()+\n  theme_bw(base_size = 12)+\n  theme(legend.position = \"top\",\n        legend.title = element_blank(),\n        legend.direction = \"vertical\")+\n  #guides(fill = \"none\")+\n  xlab(\"\")+\n  ylab(\"Number of localities\")\nnaturetypes$NiN_variable_code <- paste0(\"var_\", naturetypes$NiN_variable_code)\nbarplot(table(naturetypes$kartleggingsår))\nknitr::include_graphics(\"images/ninAR8.PNG\")\nknitr::include_graphics(\"images/ninAR4b.PNG\")\nnaturetypes %>% \n  ggplot()+\n  theme_bw() +\n  geom_histogram(aes(x = NiN_variable_value),\n                 binwidth = 1) +\n  facet_wrap(.~NiN_variable_code)\n#> Warning: Removed 20 rows containing non-finite values\n#> (`stat_bin()`).\nnaturetypes %>%\n  as.tibble() %>%\n  filter(NiN_variable_value >0) %>%\n  group_by(NiN_variable_code)%>%\n  summarise(mean = mean(NiN_variable_value, na.rm=T),\n            median = median(NiN_variable_value, na.rm=T))\n#> Warning: `as.tibble()` was deprecated in tibble 2.0.0.\n#> ℹ Please use `as_tibble()` instead.\n#> ℹ The signature and semantics have changed, see\n#>   `?as_tibble`.\n#> This warning is displayed once every 8 hours.\n#> Call `lifecycle::last_lifecycle_warnings()` to see where\n#> this warning was generated.\n#> # A tibble: 4 × 3\n#>   NiN_variable_code  mean median\n#>   <chr>             <dbl>  <dbl>\n#> 1 var_7SE            1.18      1\n#> 2 var_7TK            1.14      1\n#> 3 var_PRSL           1.54      1\n#> 4 var_PRTK           1.63      1\nnaturetypes <- naturetypes %>%\n  mutate(NiN_variable_value = case_when(\n    NiN_variable_code %in% c(\"var_7TK\", \"var_7SE\") ~ \n      case_match(NiN_variable_value,\n             0 ~ 0,\n             1 ~ mean(c(0, 1/16))*100,\n             2 ~ 1/16*100,\n             3 ~ 50),\n    NiN_variable_code %in% c('var_PRTK', 'var_PRSL') ~ \n      case_match(NiN_variable_value,\n             0 ~ 0,\n             1 ~ 1.5,\n             2 ~ 3,\n             3 ~ 6.25,\n             4 ~ 12.5,\n             5 ~ 25,\n             6 ~ 50,\n             7 ~ 75)\n    )\n  )\nnaturetypes_wide <- pivot_wider(naturetypes,\n                                names_from = \"NiN_variable_code\",\n                                values_from = \"NiN_variable_value\",\n                                id_cols = \"identifikasjon_lokalId\")\nnaturetypes_wide <- as.data.frame(naturetypes_wide)\nhead(naturetypes_wide, 10)\n#>    identifikasjon_lokalId var_PRSL var_7TK var_7SE var_PRTK\n#> 1         NINFP2210087853      0.0       0      NA       NA\n#> 2         NINFP2210087857      0.0       0      NA       NA\n#> 3         NINFP1910012022       NA      NA   0.000       NA\n#> 4         NINFP1910005432      1.5      NA      NA       NA\n#> 5         NINFP2210089748       NA       0   0.000       NA\n#> 6         NINFP2210096062       NA      NA   0.000      0.0\n#> 7         NINFP1910029434       NA      NA   3.125      1.5\n#> 8         NINFP2010029112       NA       0   0.000       NA\n#> 9         NINFP2010029325       NA       0   0.000       NA\n#> 10        NINFP1910057556       NA      NA   0.000       NA\nnaturetypes_wide <- naturetypes_wide %>%\n  mutate(TK = if_else(\n    is.na(var_PRTK), var_7TK, var_PRTK),\n    SE = if_else(\n      is.na(var_PRSL), var_7SE, var_PRSL)\n    )\ntemp <- naturetypes_wide %>%\n  group_by(SE) %>%\n  summarise(sum = n())\n\nggplot(temp, aes(x = factor(SE),\n                 y = sum))+\n  geom_bar(stat=\"identity\",\n           fill=\"grey\",\n           colour = \"black\")+\n  theme_bw(base_size = 12)+\n  labs(x = \"7SE or PRSL score\",\n       y = \"Number of localities\")\ntemp <- naturetypes_wide %>%\n  group_by(TK) %>%\n  summarise(sum = n())\n\nggplot(temp, aes(x = factor(TK),\n                 y = sum))+\n  geom_bar(stat=\"identity\",\n           fill=\"grey\",\n           colour = \"black\")+\n  theme_bw(base_size = 12)+\n  labs(x = \"7TK og PRTK score\",\n       y = \"Number of localities\")\nnaturetypes_wide$slitasje <- apply(naturetypes_wide[,c(\"TK\", \"SE\")], 1, sum, na.rm=T)\nnrow(naturetypes_wide[naturetypes_wide$slitasje<0,])\n#> [1] 0\ntemp <- naturetypes_wide %>%\n  group_by(slitasje) %>%\n  summarise(sum = n())\n\nggplot(temp, aes(x = slitasje,\n                 y = sum))+\n  geom_bar(stat=\"identity\",\n           fill=\"grey\",\n           colour = \"black\")+\n  theme_bw(base_size = 12)+\n  labs(x = \"ADSV score converted to percentage\",\n       y = \"Number of localities\") + \n  theme(axis.text.x = element_text(angle=90, vjust=0.5))+\n  scale_x_continuous(\n    labels = scales::label_number(accuracy = 1))\n\n\ndiff <- naturetypes_wide$SE - naturetypes_wide$TK\n\ndiff <- ifelse(diff == 0, \"TK and SE\",\n               ifelse(diff <0, \"TK\", \"SE\"))\n\ndiff_tbl <- as.data.frame(table(diff))\n\nggplot(diff_tbl, aes(x = diff, y = Freq))+\n  geom_bar(stat = \"identity\",\n           colour = \"black\",\n           fill = \"grey\")+\n  theme_bw(base_size = 12)+\n  labs(x = \"Variable indicating the worst state\",\n       y = \"Number of localities\")\nnaturetypes$slitasje <- naturetypes_wide$slitasje[match(naturetypes$identifikasjon_lokalId, naturetypes_wide$identifikasjon_lokalId)]\n#nrow(naturetypes[is.na(naturetypes$slitasje),])  # 13 cases\nnaturetypes <- naturetypes[!is.na(naturetypes$slitasje),]"},{"path":"slitasje.html","id":"gruk","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.8.1.2 GRUK","text":"variable also recorded \nGRUK.\nstratified intensive monitoring program calcareous naturally open areas around Oslo fjord.\nnature type data set ’m working includes data GRUK already\n(presently 2021 included). full GRUK data set also contains related variable:\n% cover 5m radii circles, much detailed four variable looked far. data \npublished. case might better use harmonized data set\ncase.","code":""},{"path":"slitasje.html","id":"ANO-import","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.8.1.3 ANO","text":"Arealrepresentativ Naturovervåking (ANO) consist 1000 systematically\nplaced locations 18 sample points. sample point \ncircle 250 m2 visualised, main ecosystem recorded.\nDepending main ecosystem, certain NiN variables also\nrecorded. 7SE recorded våtmark (wetlands), semi-natural areas \nnaturally open areas. 7TK recorded wetlands naturally open\nareas .Table showing main ecosystems two NiN variables 7SE 7TK\nrecorded withing ANO data set.nice 7SE recorded naturally open areas.\nvariable relevant .think use wetlands since approach \n‘worst value’ variable 7SE 7TK (see ). think \n7SE naturally open areas underestimate degree \ndegradation areas.ANO harmonise better Naturetype data set included\n7SE 7TK Naturally open Semi natural ecosystem.data set contains data year 2019 2021. need \nupdate data set later. clear data \n2020. topic maintained GitHub issue.point/row 250 square meters. data also contains\ninformation big proportion area made \ndominant main ecosystem. However, \n130\nNA’s , 19% data.appears proportion circle made dominant\necosystem recorded year 2019. fact, main ecosystem\nrecorded 2019:can remove NA’s, thus 2019 data.2019 ANO data excluded missing informationLet’s look variation recorded proportion ecosystem\ncover\nFigure 3.10: Distribution ANO variable andel_hovedoekosystem_punkt wetland localities.\nzero obvious mistake.’s another plot distribution variable:\nFigure 3.11: Percentage cover Våtmark main ecosystem 250m2 circle\ncan see people tend record variable steps 5%, \nsample points 100% belonging main ecosystem.want use area weighting indicator, can use \npercentage cover data calculate area. Note data sets\nuse m2 area units.Let’s now look distribution variables. First need \nseparate variable name values . Now data\nlooks like :create new variable prefixed var_:NA’s case blank cells. field app allow\nusers leaving field blank. need remove rows. \nfourteen cases:variable 7TKNo NA’s time.ANO field app allow user leave blank cells. \nresulted exclusion data.\nFigure 3.12: Distribution 7TK 7SE scores ANO data\nANO sites seem even better condition localities naturtype data set.Combining two variables 7TK 7SE one, nature\ntype data.First convert range categories percentages, like previously nature type data set.\nFigure 3.13: Distribution slitasje scores ANO data\n","code":"\nano <- sf::st_read(paste0(pData, \"Naturovervaking_eksport.gdb\"),\n                   layer = \"ANO_SurveyPoint\") %>%\n  dplyr::filter(hovedoekosystem_punkt == \"vaatmark\")\n#> Reading layer `ANO_SurveyPoint' from data source \n#>   `/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/Naturovervaking_eksport.gdb' \n#>   using driver `OpenFileGDB'\n#> Simple feature collection with 8974 features and 71 fields\n#> Geometry type: POINT\n#> Dimension:     XY\n#> Bounding box:  xmin: -51950 ymin: 6467050 xmax: 1094950 ymax: 7923950\n#> Projected CRS: ETRS89 / UTM zone 33N\ntable(ano$aar)\n#> \n#> 2019 2021 \n#>  130  558\n# Hard coding name change\n#unique(ano$hovedtype_250m2)[3]\n#ano$hovedtype_250m2[ano$hovedtype_250m2==unique(ano$hovedtype_250m2)[3]] <- \"Aapen jordvassmyr\"\ntable(ano$hovedtype_250m2, ano$aar)\n#>                             \n#>                              2019 2021\n#>   Åpen jordvannsmyr             0  416\n#>   Boreal hei                    0    1\n#>   Fjellhei leside og tundra     0    3\n#>   Grøftet torvmark              0    5\n#>   Helofytt-ferskvannssump       0    3\n#>   Kaldkilde                     0    2\n#>   Myr- og sumpskogsmark         0   51\n#>   Nedbørsmyr                    0   53\n#>   Rasmark                       0    1\n#>   Semi-naturlig myr             0    7\n#>   Semi-naturlig våteng          0    2\n#>   Skogsmark                     0    2\n#>   Strandsumpskogsmark           0    2\n#>   Våtsnøleie og snøleiekilde    0    6\nano <- ano[!is.na(ano$andel_hovedoekosystem_punkt),]\npar(mar=c(5,6,4,2))\nplot(ano$andel_hovedoekosystem_punkt[order(ano$andel_hovedoekosystem_punkt)],\n     ylab=\"Percentage of the 250 m2 area\\ncovered by the main ecosystem\")\nano <- ano[ano$andel_hovedoekosystem_punkt>20,]\nggplot(ano, aes(x = andel_hovedoekosystem_punkt))+\n         geom_histogram(fill = \"grey\",\n                        colour=\"black\",\n                        binwidth = 1)+\n  theme_bw(base_size = 12)+\n  xlab(\"Percentage cover of the Våtmark main ecosystem\\n in the 250m2 circle\")+\n  scale_x_continuous(limits = c(0,101),\n                     breaks = seq(0,100,10))\nano$area <- (ano$andel_hovedoekosystem_punkt/100)*250\nano$bv_7se[1:6]\n#> [1] \"7SE_0\" \"7SE_0\" \"7SE_0\" \"7SE_0\" \"7SE_0\" \"7SE_0\"\nano$var_7SE <- as.numeric(sub(pattern = \"7SE_\",\n                 replacement = \"\",\n                 x = ano$bv_7se))\n#> Warning: NAs introduced by coercion\nnrow(ano[is.na(ano$var_7SE),])\n#> [1] 14\nano <- ano[!is.na(ano$var_7SE),]\nano$var_7TK <- as.numeric(sub(pattern = \"7TK_\",\n                 replacement = \"\",\n                 x = ano$bv_7tk))\npar(mfrow=c(1,2))\nbarplot(table(ano$var_7TK), xlab=\"7TK scores\")\nbarplot(table(ano$var_7SE), xlab=\"7SE scores\")\nano <- ano %>%\n  mutate(var_7TK = case_match(var_7TK,\n             0 ~ 0,\n             1 ~ mean(c(0, 1/16))*100,\n             2 ~ 1/16*100,\n             3 ~ 50)) %>%\n  mutate(var_7SE = case_match(var_7SE,\n             0 ~ 0,\n             1 ~ mean(c(0, 1/16))*100,\n             2 ~ 1/16*100,\n             3 ~ 50))\ntemp <- as.data.frame(ano)\ntemp$slitasje <- apply(temp[,c(\"var_7TK\", \"var_7SE\")], 1, sum, na.rm=T)\nano$slitasje <- temp$slitasje\nbarplot(table(ano$slitasje), xlab=\"ADVS variable score\", ylab = \"Number of localities\", las=2)"},{"path":"slitasje.html","id":"combine-nt-ano","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.8.1.3.1 Combine Naturtype data and ANO","text":"need combine nature type data set ANO data set. \nadd column origin show data comes . \nalso add column main ecosystem.Fix classI use dplyr::select reduce number columns keep things \nbit tidy.","code":"\nano$origin <- \"ANO\"\nnaturetypes$origin <- \"Nature type mapping\"\nano$hovedøkosystem <- \"Våtmark\"\nano$kartleggingsår <- ano$aar\nnaturetypes$kartleggingsår <- as.numeric(naturetypes$kartleggingsår)\nnaturetypes$area <- units::drop_units(naturetypes$area)\nslitasje_data <- dplyr::bind_rows(select(ano,\n                                  GlobalID,\n                                  origin,\n                                  kartleggingsår,\n                                  hovedøkosystem,\n                                  area,\n                                  slitasje,\n                                  SHAPE), \n                           select(naturetypes,\n                                  identifikasjon_lokalId,\n                                  origin,\n                                  hovedøkosystem,\n                                  kartleggingsår,\n                                  area,\n                                  slitasje,\n                                  SHAPE))\n\nunique(st_geometry_type(slitasje_data))\n#> [1] POINT        MULTIPOLYGON\n#> 18 Levels: GEOMETRY POINT LINESTRING POLYGON ... TRIANGLE"},{},{"path":"slitasje.html","id":"distribution-of-advs-scores","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.8.1.4 Distribution of ADVS scores","text":"\nFigure 3.15: ADVS variable scores (ANO Naturetype data combined). score locality equals sum related variables 7TK, 7SE, PRSL PRTK.\nLet’s see proportion data points (area) origination \ndata set\nFigure 3.16: Barplot show contribution (number localities) different data sets ADVS indicator.\nANO data important , can become \nimportant future good included workflow.","code":"\ntemp <- as.data.frame(table(slitasje_data$slitasje))\ntemp$Var1 <- as.numeric(as.character(temp$Var1))\nggplot(temp, aes(x = Var1,\n                 y = Freq))+\n  geom_bar(stat=\"identity\",\n           fill=\"grey\",\n           colour = \"black\")+\n  theme_bw(base_size = 12)+\n  labs(x = \"ADVS score\",\n       y = \"Number of localities\")+\n  scale_x_continuous(\n    labels = scales::label_number(accuracy = 1))\ntemp <- as.data.frame(table(slitasje_data$origin))\n\nggplot(temp, aes(x = Var1,\n                 y = Freq))+\n  geom_bar(stat=\"identity\",\n           fill=\"grey\",\n           colour = \"black\")+\n  theme_bw(base_size = 12)+\n  labs(x = \"Data origin\",\n       y = \"Number of localities\")"},{"path":"slitasje.html","id":"outline-of-norway-and-regions","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.8.1.5 Outline of Norway and regions","text":"GIS layers used crop marine areas, define\naccounting areas, respectively.","code":"\noutline <- sf::read_sf(\"data/outlineOfNorway_EPSG25833.shp\")\nregions <- sf::read_sf(\"data/regions.shp\", options = \"ENCODING=UTF8\")\nunique(regions$region)\n#> [1] \"Nord-Norge\" \"Midt-Norge\" \"Østlandet\"  \"Vestlandet\"\n#> [5] \"Sørlandet\""},{"path":"slitasje.html","id":"scale-slitasje-ind","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.8.2 Scaled indicator values","text":"can scale indicator polygon, can chose aggregate\nfirst. scaled value representative precise \npolygon level, scale level. think .However, combined surveyed area small fraction \ntotal area Norway, producing indicator values \nmapped areas leaves indicator without much value regional\nassessments. regional assessments calculate regional\nindicator values, simply area weighting polygons\nregion. don’t want assume \npolygons representative far outside mapped area. perhaps\ncan assume representative inside homogeneous ecological\nareas, Homoegeneous Impact Areas (HIAs). ’s \ninfrastructure index comes . ’s plan:normalise indicators polygon level.normalise indicators polygon level.take simplified infrastructure index (vector data set HIAs)\nextract corresponding indicator values intersect \ngiven HIA, extrapolate area weighted mean values \nentire HIA withing given geographical region. Errors \ncalculated bootstrapping.take simplified infrastructure index (vector data set HIAs)\nextract corresponding indicator values intersect \ngiven HIA, extrapolate area weighted mean values \nentire HIA withing given geographical region. Errors \ncalculated bootstrapping.Take new area weighted indicator values HIAs match\necosystem occurrences HIA (possibly using\nrandomly sampled points available ecosystem occurrences).\nerrors HIAs.Take new area weighted indicator values HIAs match\necosystem occurrences HIA (possibly using\nrandomly sampled points available ecosystem occurrences).\nerrors HIAs.calculate indicator value region (accounting area) \nweighted average based relative area ecosystem\noccurrences. Errors carried somehow, perhaps via weighted\nresampling.calculate indicator value region (accounting area) \nweighted average based relative area ecosystem\noccurrences. Errors carried somehow, perhaps via weighted\nresampling.","code":""},{"path":"slitasje.html","id":"scaled-slitasje-variable","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.8.2.1 Scaled variable","text":"use reference levels/values Norway:Also, threshold value set quite conservatively (think), \ndiscussed.need little trick reverse upper lower reference\nvalues normalisation work. bug can fixed\ninside eaTools.\nFigure 3.17: Performing linear break-point type normalisation ADSV variable.\nnormalisation seems reasonable . can save indicator\nvalues. point yet making time series, \nassign indicator value average year data.Assigning indicator year 2020.","code":"\nupper <- 0\nlower <- 100\nthreshold <- 10\neaTools::ea_normalise(data = slitasje_data,\n                      vector = \"slitasje\",\n                      upper_reference_level = lower,\n                      lower_reference_level = upper,\n                      break_point = threshold,\n                      plot=T,\n                      reverse = T\n                      )\nmean(slitasje_data$kartleggingsår)\n#> [1] 2020.254\nslitasje_data$i_2020 <- eaTools::ea_normalise(data = slitasje_data,\n                      vector = \"slitasje\",\n                      upper_reference_level = lower,\n                      lower_reference_level = upper,\n                      break_point = threshold,\n                      reverse = T\n                      )"},{"path":"slitasje.html","id":"HIA-slitasje","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.8.3 Homogeneous impact areas","text":"want use Homogeneous Impact Areas (HIA) define\nsmaller regions can extrapolate indicator values. \ndata generated discretizing Norwegian Infrastructure Index. \nrefer ordinal values four HIA classes Human\nImpact Factor (HIF). just keep approach separate \nNorwegian Infrastructure Index.want check HIF fact good predictor slitasje.also want split four HIA classes based region. \nneed two layers CRS.Since HIA map region map completely overlapping (HIA masked using region map), can get \nintersectionsCreate new column crossing region HIF","code":"\nHIA <- readRDS(paste0(pData, \"infrastrukturindeks/homogeneous_impact_areas.rds\"))\nst_crs(HIA) == st_crs(regions)\n#> [1] TRUE\nHIA_regions <- eaTools::ea_homogeneous_area(HIA,\n                             regions,\n                             keep1 = \"infrastructureIndex\",\n                             keep2 = \"region\")\nsaveRDS(HIA_regions, \"P:/41201785_okologisk_tilstand_2022_2023/data/cache/HIA_regions.rds\")\nHIA_regions <- HIA_regions %>%\n  mutate(region_HIF = paste(region, infrastructureIndex))"},{"path":"slitasje.html","id":"validate-slitasje","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.8.3.1 Validate","text":"now 20 unique areas (main ecosystem) , given\ndata, extrapolate indicator values .","code":""},{},{"path":"slitasje.html","id":"looking-at-the-hia","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.8.3.2 Looking at the HIA","text":"view data zooming TrondheimCropping raster bboxGet map major roads, context\nFigure 3.23: closer look HIA designation Trondheim\nLet’s calculate areas polygons compare HIF \nfive regions.\nFigure 3.24: Stacked barplot showing distribution human impact factor across five regions Norway.\nfigure shows Nord-Norge example, lot \nrelatively untouched areas, Østlandet highest\nproportion impacted areas. expected.","code":"\nmyBB <- st_bbox(c(xmin=260520.12, xmax = 278587.56,\n                ymin = 7032142.5, ymax = 7045245.27),\n                crs = st_crs(HIA_regions))\nHIA_trd <- sf::st_crop(HIA_regions, myBB)\n#> Warning: attribute variables are assumed to be spatially\n#> constant throughout all geometries\nhw_utm <- readRDS(\"data/cache/highways_trondheim.rds\")\n(HIA_trd <- tm_shape(HIA_trd)+\n  tm_polygons(col = \"infrastructureIndex\",\n    title=\"Infrastructure index\\n(modified 4-step scale)\",\n    palette = \"-viridis\",\n    style=\"cat\")+\n  tm_layout(legend.outside = T)+\n  tm_shape(hw_utm)+\n  tm_lines(col=\"red\")+\n  tm_shape(outline)+\n  tm_borders(col = \"black\", lwd=2))\nHIA_regions$area <- sf::st_area(HIA_regions)\ntemp <- as.data.frame(HIA_regions) %>%\n  group_by(region, infrastructureIndex) %>%\n  summarise(area = mean(area))\n#> `summarise()` has grouped output by 'region'. You can\n#> override using the `.groups` argument.\n\nggplot(temp, aes(x = region, y = area, fill = factor(infrastructureIndex)))+\n  geom_bar(position = \"stack\", stat = \"identity\")+\n  guides(fill = guide_legend(\"HIF\"))"},{"path":"slitasje.html","id":"spread-slitasje","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.8.4 Aggregate and spread (extrapolate)","text":"now want find mean indicator value HIA (.e. \naggregate) spread spatially entire HIA within\nregion (.e. extrapolate).want add threshold don’t end extrapolating\nbased data points. previousl used 150 data pionts, think right.’s easier see ’s happening zoom bit. Lets get \nboundary box around Trondheim.Cropping data bbox\nFigure 3.25: ADSV indicator extrapolated Trondheim, one map ecosystem. map masked ecosystem delineation maps, make easy missinterpret.\nNote wetland semi-natural areas \nextrapolate values urban areas, naturally open\nareas extrapolate least affected areas.\nregions generally excluded HIFs.maps easy misunderstand, therefor \ncommunicated caution. considered temporary\nfiles -products.next step now toPrepare ecosystem delineation maps EPSG25833 perfectly aligned master gridPrepare ecosystem delineation maps EPSG25833 perfectly aligned master gridRasterize extrapolated indicator map, using ET map template (see Fig. @ref(fig:#masking-example))Rasterize extrapolated indicator map, using ET map template (see Fig. @ref(fig:#masking-example))mask using perfectly aligned ET map.mask using perfectly aligned ET map.faster way :Draw n random point samples ET map, andDraw n random point samples ET map, andextract indicator values points (extrapolated\nindicator map (stars object)).extract indicator values points (extrapolated\nindicator map (stars object)).… provide spatially explicit indicator values \nentire ecosystem delineation.","code":"\nwetlands_slitasje_extr <- ea_spread(indicator_data = wetlands,\n                         indicator = i_2020,\n                         regions = HIA_regions,\n                         groups = region_HIF,\n                         threshold = 150)\n\nseminat_slitasje_extr <- ea_spread(indicator_data = seminat,\n                         indicator = i_2020,\n                         regions = HIA_regions,\n                         groups = region_HIF,\n                         threshold = 150)\n\nnatOpen_slitasje_extr <- ea_spread(indicator_data = natOpen,\n                         indicator = i_2020,\n                         regions = HIA_regions,\n                         groups = region_HIF,\n                         threshold = 150)\n#saveRDS(wetlands_slitasje_extr, \"/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/cache/wetlands_slitasje_extr.rds\")\n#saveRDS(seminat_slitasje_extr,  \"/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/cache/seminat_slitasje_extr.rds\")\n#saveRDS(natOpen_slitasje_extr,  \"/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/cache/natOpen_slitasje_extr.rds\")\nmyBB <- st_bbox(c(xmin=260520.12, xmax = 278587.56,\n                ymin = 7032142.5, ymax = 7045245.27),\n                crs = st_crs(wetlands_slitasje_extr))\nwetlands_slitasje_extr_trd <- sf::st_crop(wetlands_slitasje_extr, myBB)\nseminat_slitasje_extr_trd <- sf::st_crop(seminat_slitasje_extr, myBB)\nnatOpen_slitasje_extr_trd <- sf::st_crop(natOpen_slitasje_extr, myBB)\nmyCol <- \"RdYlGn\"\ntmap_arrange(\ntm_shape(wetlands_slitasje_extr_trd)+\n  tm_polygons(col = \"w_mean\",\n    title=\"Indicator value\",\n    palette = myCol,\n    style=\"cont\",\n    breaks = c(0,1))+\n  tm_layout(legend.outside = T)+\n  tm_shape(hw_utm)+\n  tm_lines(col=\"blue\")+\n  tm_layout(title = \"Wetland\"),\n\ntm_shape(seminat_slitasje_extr_trd)+\n  tm_polygons(col = \"w_mean\",\n    title=\"Indicator value\",\n    palette = myCol,\n    style=\"cont\",\n    breaks = c(0,1))+\n  tm_layout(legend.outside = T)+\n  tm_shape(hw_utm)+\n  tm_lines(col=\"blue\")+\n  tm_layout(title = \"Semi-natural areas\"),\n\ntm_shape(natOpen_slitasje_extr_trd)+\n  tm_polygons(col = \"w_mean\",\n    title=\"Indicator value\",\n    palette = myCol,\n    style=\"cont\",\n    breaks = c(0,1))+\n  tm_layout(legend.outside = T)+\n  tm_shape(hw_utm)+\n  tm_lines(col=\"blue\")+\n  tm_layout(title = \"Naturally open areas\"),\nHIA_trd)"},{"path":"slitasje.html","id":"ecosystem-map","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.8.5 Ecosystem map","text":"See .","code":""},{"path":"slitasje.html","id":"aggregate-to-region","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.8.6 Aggregate to region","text":"need aggreate ET occurence indicator values, \nregional delineation. functionality can developed eaTools,\ncase build around exactextratr::exact_extract().carry errors, can example\nproduce distributions indicator values ET\noccurrence (groups ) resample distributions \narea weighting.","code":""},{"path":"slitasje.html","id":"uncertainty-1","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.8.7 Uncertainty","text":"calculations indicator uncertainty done bootstrapping, \ndescribed eaTools.","code":""},{"path":"slitasje.html","id":"eksport-files-final-product","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.9 Eksport files (final product)","text":"According workflow specifications, export indicator\nmap highest resolution, use various web interfaces etc.\nfinest resolution indicator map include columns \nuncertainty (estimated aggregated\nlevel), reference levels (spatial variation).can also export map indicator extrapolate \nindicator values homogeneous areas (e.g. Fig. 3.25 . map \ninterpreted caution, since appear providing explicit indicator\nvalues areas data. map mainly \naggregation purposes. mark map prefix\nhomogeneous-areas. also export map masking \nET map, output must come disclaimers.Finally export map five accounting areas \nwall--wall indicator value errors (e.g. Fig 4.6). map can also contain data\ncovering ETs. Otherwise maps visually\ninterpretative.","code":""},{"path":"slitasje.html","id":"adsv-in-wetlands","chapter":"3 Anthropogenic disturbance to soils and vegetation (ADSV)","heading":"3.9.1 ADSV in wetlands","text":"plan export final product.Write file","code":"\n# keep col names short and standardized\nexp_wetland <- ...exp_wetland_HIAextrapolated <- …exp_wetland_AAextrapolated <- …\nst_write(exp_wetland, \"indicators/indicatorMaps/slitasje/wetland_slitasje.shp\",\n         append = F)\n\nst_write(exp_wetlandHIAextrapolated, \n         \"indicators/indicatorMaps/extrapolated_to_homogeneous_areas/slitasje/homogeneous_areas_wetland_slitasje.shp\",\n         append = F)\n\nst_write(exp_wetland, \"indicators/indicatorMaps/extrapolated_to_accounting_areas/slitasje/accounting_areas_wetland_slitasje.shp\",\n         append = F)"},{"path":"median-summer-temp.html","id":"median-summer-temp","chapter":"4 Median Summer Temperature","heading":"4 Median Summer Temperature","text":"Author date:Anders L. KolstadMarch 2023","code":""},{"path":"median-summer-temp.html","id":"introduction-2","chapter":"4 Median Summer Temperature","heading":"4.1 Introduction","text":"chapters describes workflow indicator describing median summer temperature. comprehensive documentation development workflow , see . data comes interpolated climate surfaces SeNorge contain one 1x1km raster day since 1957 present. reference levels extracted time period 1961-1990 (temporal reference condition).WorkflowCollate variable data series, ending one raster per year aggregating across days within yearCollate variable data series, ending one raster per year aggregating across days within yearCalculate spatially explicit reference values aggregating across years 1961-1990. upper reference value equal median value period, lower reference values (two-sided) equal 5 SD units. indicator value mean five year period.Calculate spatially explicit reference values aggregating across years 1961-1990. upper reference value equal median value period, lower reference values (two-sided) equal 5 SD units. indicator value mean five year period.Calculate indicator values spatially explicit rescaling based reference valuesCalculate indicator values spatially explicit rescaling based reference valuesMask ecosystem type (step yet done ready available ecosystem maps)Mask ecosystem type (step yet done ready available ecosystem maps)Aggregate space (accounting areas) take mean five year period get final indicator valuesAggregate space (accounting areas) take mean five year period get final indicator valuesMake trend figure spatially aggregated mapsMake trend figure spatially aggregated maps","code":""},{"path":"median-summer-temp.html","id":"about-the-underlying-data-2","chapter":"4 Median Summer Temperature","heading":"4.2 About the underlying data","text":"data raster format extends back 1957 form multiple interpolated climate variables. spatial resolution 1 x 1 km.","code":""},{"path":"median-summer-temp.html","id":"representativity-in-time-and-space-2","chapter":"4 Median Summer Temperature","heading":"4.2.1 Representativity in time and space","text":"data includes last normal period (1961-1990) defines reference condition climate variables. Therefore temporal resolution good. Also considering daily resolution data.Spatially, 1x1 km resolution sufficient climate variables, esp. homogeneous terrain, needs evaluation variable scenario specifically.","code":""},{"path":"median-summer-temp.html","id":"original-units-2","chapter":"4 Median Summer Temperature","heading":"4.2.2 Original units","text":"Varied. Specified parameter.","code":""},{"path":"median-summer-temp.html","id":"temporal-coverage-1","chapter":"4 Median Summer Temperature","heading":"4.2.3 Temporal coverage","text":"1957 - present","code":""},{"path":"median-summer-temp.html","id":"additional-comments-about-the-data-set","chapter":"4 Median Summer Temperature","heading":"4.2.4 Additional comments about the data set","text":"data format recently changed .BIL .nc (netcdf) now single file contains rasters one year (365 days), sometimes multiple variables also.","code":""},{"path":"median-summer-temp.html","id":"ecosystem-characteristic-3","chapter":"4 Median Summer Temperature","heading":"4.3 Ecosystem characteristic","text":"","code":""},{"path":"median-summer-temp.html","id":"norwegian-standard-1","chapter":"4 Median Summer Temperature","heading":"4.3.1 Norwegian standard","text":"variables typically fall abiotiske egenskaper class.","code":""},{"path":"median-summer-temp.html","id":"seea-ea","chapter":"4 Median Summer Temperature","heading":"4.3.2 SEEA EA","text":"SEEA EA, variables typically fall A1 - Physical state characteristics.","code":""},{"path":"median-summer-temp.html","id":"collinearities-with-other-indicators-3","chapter":"4 Median Summer Temperature","heading":"4.4 Collinearities with other indicators","text":"Climate variables likely correlated (e.g. temperature snow). Also, climate variables better classed pressure indicators, might causal association several condition indicators.","code":""},{"path":"median-summer-temp.html","id":"reference-condition-and-values-2","chapter":"4 Median Summer Temperature","heading":"4.5 Reference condition and values","text":"","code":""},{"path":"median-summer-temp.html","id":"reference-condition-2","chapter":"4 Median Summer Temperature","heading":"4.5.1 Reference condition","text":"reference condition climate variables defined normal period 1961-1990.","code":""},{"path":"median-summer-temp.html","id":"reference-values-thresholds-for-defining-good-ecological-condition-minimum-andor-maximum-values-2","chapter":"4 Median Summer Temperature","heading":"4.5.2 Reference values, thresholds for defining good ecological condition, minimum and/or maximum values","text":"Un-scaled indicator value = median value 5 year periods (5 years pragmatic choice. long enough smooth lot inter-annual variation, ’s long enough enable estimating errors)Un-scaled indicator value = median value 5 year periods (5 years pragmatic choice. long enough smooth lot inter-annual variation, ’s long enough enable estimating errors)Upper reference level (best possible condition) = median value reference periodUpper reference level (best possible condition) = median value reference periodThresholds good ecosystem condition = 2 standard deviation units away upper reference level climate variable reference period.Thresholds good ecosystem condition = 2 standard deviation units away upper reference level climate variable reference period.Lower reference values (two-directional) = 5 standard deviation units climate variable reference period (implies linear scaling).Lower reference values (two-directional) = 5 standard deviation units climate variable reference period (implies linear scaling).choice use 2 SD units threshold values subjective choice many ways, founded empirical known relationship indicators ecosystem integrity. value comes common practice calling something extreme weather outside 2 SD units current running average. , indicator value today <0.6 implies mean variable last year referred extreme occurred 1961 1990. think conservative threshold, since one /call extreme one year outside 2SD range, mean 5 years outside range really extreme.","code":""},{"path":"median-summer-temp.html","id":"uncertainties-2","chapter":"4 Median Summer Temperature","heading":"4.6 Uncertainties","text":"indicator map (1 x 1 km raster) uncertainty associated indicator values. aggregated indicator values (e.g. regions), uncertainty indicator value calculated spatial variation indicator values via bootstrapping. might, however, changed later temporal variation five years period.","code":""},{"path":"median-summer-temp.html","id":"references-3","chapter":"4 Median Summer Temperature","heading":"4.7 References","text":"https://senorge./rr tm download : https://thredds.met./thredds/catalog/senorge/seNorge_2018/Archive/catalog.html","code":""},{"path":"median-summer-temp.html","id":"additional-resources","chapter":"4 Median Summer Temperature","heading":"4.7.1 Additional resources","text":"Stars packageR GIS economists chapter 7","code":""},{"path":"median-summer-temp.html","id":"analyses-2","chapter":"4 Median Summer Temperature","heading":"4.8 Analyses","text":"","code":""},{"path":"median-summer-temp.html","id":"data-set","chapter":"4 Median Summer Temperature","heading":"4.8.1 Data set","text":"data downloaded local NINA server, updated regularly.folder contains folder different parametersWe interested tm, temperatur celcius. reason variable called tg data .","code":"\npath <- ifelse(dir == \"C:\", \n      \"R:/GeoSpatialData/Meteorology/Norway_SeNorge2018_v22.09/Original\",\n      \"/data/R/GeoSpatialData/Meteorology/Norway_SeNorge2018_v22.09/Original\")\n(files <- list.files(path))\n#>  [1] \"age\"        \"fsw\"        \"gwb_eva\"    \"gwb_gwtcl\" \n#>  [5] \"gwb_q\"      \"gwb_sssdev\" \"gwb_sssrel\" \"lwc\"       \n#>  [9] \"qsw\"        \"rr_tm\"      \"sd\"         \"sdfsw\"     \n#> [13] \"swe\""},{"path":"median-summer-temp.html","id":"regions-1","chapter":"4 Median Summer Temperature","heading":"4.8.1.1 Regions","text":"Importing shape file regional delineation.Outline NorwayRemove marine areas regions\nFigure 3.1: Five accounting areas (regions) Norway.\n","code":"\nreg <- sf::st_read(\"data/regions.shp\", options = \"ENCODING=UTF8\")\n#> options:        ENCODING=UTF8 \n#> Reading layer `regions' from data source \n#>   `/data/Egenutvikling/41001581_egenutvikling_anders_kolstad/github/ecosystemCondition/data/regions.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 5 features and 2 fields\n#> Geometry type: POLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -99551.21 ymin: 6426048 xmax: 1121941 ymax: 7962744\n#> Projected CRS: ETRS89 / UTM zone 33N\n#st_crs(reg)\nnor <- sf::st_read(\"data/outlineOfNorway_EPSG25833.shp\")\n#> Reading layer `outlineOfNorway_EPSG25833' from data source \n#>   `/data/Egenutvikling/41001581_egenutvikling_anders_kolstad/github/ecosystemCondition/data/outlineOfNorway_EPSG25833.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 1 feature and 2 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -113472.7 ymin: 6448359 xmax: 1114618 ymax: 7939917\n#> Projected CRS: ETRS89 / UTM zone 33N\nreg <- st_intersection(reg, nor)\ntm_shape(reg) +\n  tm_polygons(col=\"region\")"},{"path":"median-summer-temp.html","id":"ecosystem-map-1","chapter":"4 Median Summer Temperature","heading":"4.8.1.2 Ecosystem map","text":"Coming soon ….climate indicators need masked ecosystem type maps. step part chapter.","code":""},{"path":"median-summer-temp.html","id":"conceptual-workflow","chapter":"4 Median Summer Temperature","heading":"4.8.2 Conceptual workflow","text":"general, conceptual workflow like :Collate variable data series\nImport .nc files (loop though year 1961-1990) subset correct attribute\nFilter data dates (optional) (dplyr::filter). means reading 365 rasters memory, much quicker filter correct rasters importing step (see examples later chapter)\nAggregate across time within year (stars::st_apply). time consuming operation workflow.\nJoin data one data cube (stars:c)\nCollate variable data seriesImport .nc files (loop though year 1961-1990) subset correct attributeImport .nc files (loop though year 1961-1990) subset correct attributeFilter data dates (optional) (dplyr::filter). means reading 365 rasters memory, much quicker filter correct rasters importing step (see examples later chapter)Filter data dates (optional) (dplyr::filter). means reading 365 rasters memory, much quicker filter correct rasters importing step (see examples later chapter)Aggregate across time within year (stars::st_apply). time consuming operation workflow.Aggregate across time within year (stars::st_apply). time consuming operation workflow.Join data one data cube (stars:c)Join data one data cube (stars:c)Calculate reference values\nAggregate (st_apply) across reference years (dplyr::filter) get median sd values\nJoin existing data cube (stars:c)\nCalculate reference valuesAggregate (st_apply) across reference years (dplyr::filter) get median sd valuesAggregate (st_apply) across reference years (dplyr::filter) get median sd valuesJoin existing data cube (stars:c)Join existing data cube (stars:c)Calculate indicator values\nNormalize climate variable individual grid cell level using three reference values (mutate(across()))\nCalculate indicator valuesNormalize climate variable individual grid cell level using three reference values (mutate(across()))Mask ecosystem type (also done step one, doesn’t speed things set cells NA)Mask ecosystem type (also done step one, doesn’t speed things set cells NA)Aggregate space (accounting areas) (zonal statistics)\nAggregate across 5 year time steps smooth random inter-annual variation leave climate signal\nIntersect accounting area polygons exactextrar::exact_extract get mean/median (spatial) sd. (Alternatively, get temporal sd grid cell level step .)\nAggregate space (accounting areas) (zonal statistics)Aggregate across 5 year time steps smooth random inter-annual variation leave climate signalAggregate across 5 year time steps smooth random inter-annual variation leave climate signalIntersect accounting area polygons exactextrar::exact_extract get mean/median (spatial) sd. (Alternatively, get temporal sd grid cell level step .)Intersect accounting area polygons exactextrar::exact_extract get mean/median (spatial) sd. (Alternatively, get temporal sd grid cell level step .)Make trend figure spatially aggregated mapsMake trend figure spatially aggregated maps","code":""},{"path":"median-summer-temp.html","id":"step-1---temporal-aggregation-within-a-year","chapter":"4 Median Summer Temperature","heading":"4.8.3 Step 1 - temporal aggregation within a year","text":"takes 20 sec per file/year, 22 min total. bad. 6000 rasters read memory. ’s test effect splitting cores.Note GTiff automatically renames third dimension band also renames attribute. can rename .\nFigure 4.1: Showing three random slices year dimension.\n","code":"\npath <- path <- ifelse(dir == \"C:\", \n      \"R:/\",\n      \"/data/R/\")\n  \npath2 <- paste0(path, \"GeoSpatialData/Meteorology/Norway_SeNorge2018_v22.09/Original/rr_tm/\")\n\nmyFiles <- list.files(path2, pattern=\".nc$\",full.names = T)\n# The last file (the last year) is incomplete and don't include all julian dates that we select below, so I will not include it:\nmyFiles <- myFiles[-length(myFiles)]\n\nreal_temp_summer <- NULL\n\n# set up parallel cluster using 10 cores\ncl <- makeCluster(10L)\n\n# Get julian days after defining months\ntemp <- stars::read_ncdf(paste(myFiles[1]), var=\"tg\")\nstart_month_num <-  6\nend_month_num <- 8\n\njulian_start <- yday(st_get_dimension_values(temp, \"time\")[1] %m+%\n                       months(+start_month_num))\njulian_end <- yday(st_get_dimension_values(temp, \"time\")[1] %m+%\n                     months(+end_month_num))\nstep <- julian_end-julian_start\n\n\n\nfor(i in 1:length(myFiles)){\n  \n  tic(\"init\")\n  temp <- stars::read_ncdf(paste(myFiles[i]), var=\"tg\", proxy=F,\n                           ncsub = cbind(start = c(1, 1, julian_start), \n                              count = c(NA, NA, step)))\n  year_temp <- year(st_get_dimension_values(temp, \"time\")[1])\n  print(year_temp)\n  lookup <- setNames(\"mean\", paste0(\"v_\", year_temp)) \n    # Perhaps leave out the v_ to get a numeric vector instead, \n    # which is easier to subset\n  st_crs(temp) <- 25833\n  toc()\n\n  tic(\"filter and st_apply\")\n  temp <- temp %>%\n    #filter(time %within% myInterval) %>%\n    st_apply(1:2, mean, CLUSTER = cl) %>%\n    rename(all_of(lookup)) \n  toc()\n  \n  tic(\"c()\")\n  real_temp_summer <- c(temp, real_temp_summer)\n  #rm(temp)\n  toc()\n}\n\ntic(\"Merge\")\nreal_temp_summer <- real_temp_summer %>%\n  merge(name = \"Year\") %>%\n  setNames(\"climate_variable\")\ntoc()\n\nstopCluster(cl)\nwrite_stars(real_temp_summer, \"/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/climate_indicators/aggregated_climate_time_series/real_temp_summer.tiff\")\nsummer_median_temp <- real_temp_summer %>% \n  st_set_dimensions(names = c(\"x\", \"y\", \"v_YEAR\")) %>%\n  setNames(\"temperature\")\nggplot()+\n  geom_stars(data = summer_median_temp[,,,c(1,11,66)], downsample = c(10, 10, 0)) +\n  coord_equal() +\n  theme_void() +\n  scale_fill_viridis_c(option = \"D\") +  \n  scale_x_discrete(expand = c(0, 0)) +\n  scale_y_discrete(expand = c(0, 0))+\n  facet_wrap(~v_YEAR)"},{"path":"median-summer-temp.html","id":"step-2---calculate-reference-values","chapter":"4 Median Summer Temperature","heading":"4.8.4 Step 2 - calculate reference values","text":"need first define reference period subset data summer_median_temp.First need rename dimension values turn back dates.can filter leave reference period.calculate median sd like abovePivot turn dimension attributes, rename attributes:\nFigure 4.2: Showing upper reference levels standard deviation actual data median summer temperatures.\nneed combine variables ref values one data cube","code":"\nnew_dims <- as.Date(paste0(\n  substr(st_get_dimension_values(summer_median_temp, \"v_YEAR\"), 3, 6), \"-01-01\"))\nsummer_median_temp_ref <- summer_median_temp %>%\n  st_set_dimensions(\"v_YEAR\", values = new_dims)\nsummer_median_temp_ref <- summer_median_temp_ref %>%\n  filter(v_YEAR %within% interval(\"1961-01-01\", \"1990-12-31\"))\nst_get_dimension_values(summer_median_temp_ref, \"v_YEAR\")\n#>  [1] \"1990-01-01\" \"1989-01-01\" \"1988-01-01\" \"1987-01-01\"\n#>  [5] \"1986-01-01\" \"1985-01-01\" \"1984-01-01\" \"1983-01-01\"\n#>  [9] \"1982-01-01\" \"1981-01-01\" \"1980-01-01\" \"1979-01-01\"\n#> [13] \"1978-01-01\" \"1977-01-01\" \"1976-01-01\" \"1975-01-01\"\n#> [17] \"1974-01-01\" \"1973-01-01\" \"1972-01-01\" \"1971-01-01\"\n#> [21] \"1970-01-01\" \"1969-01-01\" \"1968-01-01\" \"1967-01-01\"\n#> [25] \"1966-01-01\" \"1965-01-01\" \"1964-01-01\" \"1963-01-01\"\n#> [29] \"1962-01-01\" \"1961-01-01\"\nmedian_sd <- function(x) { c(median = median(x), sd = sd(x))}\nsystem.time({\ncl <- makeCluster(10L)\nsummer_median_temp_ref <- summer_median_temp_ref %>%\n  st_apply(c(\"x\", \"y\"), \n           FUN =  median_sd,\n           CLUSTER = cl)\nstopCluster(cl)\n})\nwrite_stars(summer_median_temp_ref, \"/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/climate_indicators/aggregated_climate_time_series/summer_median_temp_ref.tiff\")\nsummer_median_temp_ref_long <- summer_median_temp_ref %>% \n  split(\"band\") %>%\n  setNames(c(\"reference_upper\", \"sd\"))\ntmap_arrange(\ntm_shape(st_downsample(summer_median_temp_ref_long, 10))+\n  tm_raster(\"reference_upper\")\n,\ntm_shape(st_downsample(summer_median_temp_ref_long, 10))+\n  tm_raster(\"sd\",\n            palette = \"-viridis\")\n)\ny_var <- summer_median_temp %>%\n  split(\"v_YEAR\") %>%\n  c(summer_median_temp_ref_long)"},{"path":"median-summer-temp.html","id":"step-3---normalise-variable","chapter":"4 Median Summer Temperature","heading":"4.8.5 Step 3 - normalise variable","text":"\nFigure 4.3: Example showing median summer tempretur 1970, upper lwoer reference temperture, .e. median 5 SD units temperature 1961-1990, finally, scaled indicator values.\nreal indicator values means 5 year periods. Calculating running mean time steps time consuming. Therefore, scaled, regional indicator values calculated distinct time steps. time series can perhaps still presented yearly resolution.","code":"\n# select the columns to normalise\ncols <- names(y_var)[!names(y_var) %in% c(\"reference_upper\", \"sd\") ]\ncols_new <- cols\nnames(cols_new) <- gsub(\"v_\", \"i_\", cols)\n# The break point scaling is actually not needed here, since \n# having the lower ref value to be 5 sd implies that the threshold is\n# 2 sd in a linear scaling.\n\nsystem.time(\ny_var_norm <- y_var %>%\n  mutate(reference_low = reference_upper - 5*sd ) %>%\n  mutate(reference_low2 = reference_upper + 5*sd ) %>%\n  mutate(threshold_low = reference_upper -2*sd ) %>%\n  mutate(threshold_high = reference_upper +2*sd ) %>%\n  mutate(across(all_of(cols), ~ \n                  if_else(.x < reference_upper,\n                  if_else(.x < threshold_low, \n                                        (.x - reference_low) / (threshold_low - reference_low),\n                                        (.x - threshold_low) / (reference_upper - threshold_low),\n                                        ),\n                  if_else(.x > threshold_high, \n                                        (reference_low2 - .x) / (reference_low2 - threshold_high),\n                                        (threshold_high - .x) / (threshold_high - reference_upper),\n                                        )\n                ))) %>%\n  mutate(across(all_of(cols), ~ if_else(.x > 1, 1, .x))) %>%\n  mutate(across(all_of(cols), ~ if_else(.x < 0, 0, .x))) %>%\n  rename(all_of(cols_new)) %>%\n  c(select(y_var, all_of(cols)))\n)\ngc()\nsaveRDS(y_var_norm, \"/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/climate_indicators/aggregated_climate_time_series/summer_median_temp_normalised.RData\")\n\n# Tiff dont allow for multiple attributes:\n#write_stars(y_var_norm, \"/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/climate_indicators/aggregated_climate_time_series/summer_median_temp_normalised.tiff\")\n\nlims <- c(-5, 22)\n\nggarrange(\nggplot() + \n  geom_stars(data = st_downsample(y_var_norm[\"v_1970\"],10)) +\n  coord_equal() +\n  theme_void() +\n  scale_fill_viridis_c(option = \"D\",\n                       limits = lims) +  \n  scale_x_discrete(expand = c(0, 0)) +\n  scale_y_discrete(expand = c(0, 0))\n,\nggplot() + \n  geom_stars(data = st_downsample(y_var_norm[\"reference_upper\"], 10)) +\n  coord_equal() +\n  theme_void() +\n  scale_fill_viridis_c(option = \"D\",\n                       limits = lims) +  \n  scale_x_discrete(expand = c(0, 0)) +\n  scale_y_discrete(expand = c(0, 0))\n,\nggplot() + \n  geom_stars(data = st_downsample(y_var_norm[\"reference_low\"], 10)) +\n  coord_equal() +\n  theme_void() +\n  scale_fill_viridis_c(option = \"D\",\n                       limits = lims) +  \n  scale_x_discrete(expand = c(0, 0)) +\n  scale_y_discrete(expand = c(0, 0))\n,\n\nggplot() + \n  geom_stars(data = st_downsample(y_var_norm[\"reference_low2\"], 10)) +\n  coord_equal() +\n  theme_void() +\n  scale_fill_viridis_c(option = \"D\",\n                       limits = lims) +  \n  scale_x_discrete(expand = c(0, 0)) +\n  scale_y_discrete(expand = c(0, 0))\n,\n\nggplot() + \n  geom_stars(data = st_downsample(y_var_norm[\"i_1970\"],10)) +\n  coord_equal() +\n  theme_void() +\n  scale_fill_viridis_c(option = \"A\",\n                       limits = c(0, 1)) +  \n  scale_x_discrete(expand = c(0, 0)) +\n  scale_y_discrete(expand = c(0, 0))\n, ncol=2, nrow=3, align = \"hv\"\n)"},{"path":"median-summer-temp.html","id":"step-4---mask-with-ecosystem-delineation-map","chapter":"4 Median Summer Temperature","heading":"4.8.6 Step 4 - Mask with ecosystem delineation map","text":"step simply ignore now. relatively easy , maps.","code":""},{"path":"median-summer-temp.html","id":"step-5---make-figures","chapter":"4 Median Summer Temperature","heading":"4.8.7 Step 5 - Make figures","text":"plot time series first need spatial aggregation.user; system; elapsed: 7.603; 3.071; 10.697I also get sd like , wanted base indicator uncertainty measure spatial variation:user; system; elapsed: 7.420; 2.921; 10.355Reshape plot\nFigure 4.4: Times series median summer temperature centered median value reference period. reference period indicated thick horizontal line. Dottet horisontal lines 2 sd units reference period.\ncan take mean sd last 5 years add spatial representation.\nFigure 4.5: Scaled indicator values, aggregated 5 year intervals. Errors represent temporal variation (standard errors) within regions across 5 years.\nFinally, can add values sp object accounting areas.\nFigure 4.6: Summer tempreature indicator values five accounting areas Norway. SD spatial variation.\n","code":"\nsystem.time(\nregional_means <- rast(y_var_norm) %>%\n  exact_extract(reg, fun = 'mean', append_cols = \"region\", progress=T) %>%\n  setNames(c(\"region\", names(y_var_norm)))\n  )\nsystem.time(\nregional_sd <- rast(y_var_norm) %>%\n  exact_extract(reg, fun = 'stdev', append_cols = \"region\", progress=T) %>%\n  setNames(c(\"region\", names(y_var_norm)))\n  )\nsaveRDS(regional_means, \"temp/regional_means.rds\")\nsaveRDS(regional_sd, \"temp/regional_sd.rds\")\ndiv <- c(\"reference_upper\",\n         \"reference_low\",\n         \"reference_low2\",\n         \"threshold_low\",\n         \"threshold_high\",\n         \"sd\")\n\ntemp <- regional_means %>%\n  as.data.frame() %>%\n  select(region, div)\n  \nregional_means_long <- regional_means %>%\n  as.data.frame() %>%\n  select(!all_of(div)) %>%\n  pivot_longer(!region) %>%\n  separate(name, into=c(\"type\", \"year\")) %>%\n  pivot_wider(#id_cols = region,\n              names_from = type)  %>%\n  left_join(temp, by=join_by(region)) %>% \n  mutate(diff = v-reference_upper) %>%\n  mutate(threshold_low_centered = threshold_low-reference_upper) %>%\n  mutate(threshold_high_centered = threshold_high-reference_upper)\n\n#Adding the spatial sd\n#(\n#regional_means_long <- regional_sd %>%\n#  select(!all_of(div)) %>%\n#  pivot_longer(!region) %>%\n#  separate(name, into=c(\"type\", \"year\")) %>%\n#  pivot_wider(names_from = type) %>%\n#  rename(i_sd = i,\n#         v_sd = v) %>%\n#  left_join(regional_means_long, by=join_by(region, year))\n#)\nregOrder = c(\"Østlandet\",\"Sørlandet\",\"Vestlandet\",\"Midt-Norge\",\"Nord-Norge\")\n\nregional_means_long %>%\n  mutate(col = if_else(diff>0, \"1\", \"2\")) %>%\n  ggplot(aes(x = as.numeric(year), \n           y = diff, fill = col))+\n  geom_bar(stat=\"identity\")+\n  geom_hline(aes(yintercept = threshold_low_centered),\n        linetype=2)+\n  geom_hline(aes(yintercept = threshold_high_centered),\n        linetype=2)+\n  geom_segment(x = 1961, xend=1990,\n               y = 0, yend = 0,\n               linewidth=2)+\n  scale_fill_hue(l=70, c=60)+\n  theme_bw(base_size = 12)+\n  ylab(\"Sommertemperatur\\navvik fra 1961-1990\")+\n  xlab(\"\")+\n  guides(fill=\"none\")+\n  facet_wrap( .~ factor(region, levels = regOrder),\n              ncol=3,\n              scales = \"free_y\")\n(\ni_aggregatedToPeriods <- regional_means_long %>%\n  mutate(year = as.numeric(year)) %>%\n  mutate(period = case_when(\n    year %between% c(2018, 2022) ~ \"2018-2022\",\n    year %between% c(2013, 2017) ~ \"2013-2017\",\n    year %between% c(2008, 2012) ~ \"2008-2012\",\n    year %between% c(2003, 2007) ~ \"2003-2007\",\n    .default = \"pre 2003\"\n  )) %>%\n  mutate(period_rank = case_when(\n   period == \"2018-2022\" ~ 5,\n   period == \"2013-2017\" ~ 4,\n   period == \"2008-2012\" ~ 3,\n   period == \"2003-2007\" ~ 2,\n    .default = 1\n  )) %>%\n  group_by(region, period, period_rank) %>%\n  summarise(indicator = mean(i),\n            sd = sd(i)\n            # If I inluded a spatial measure for the uncertainty, here is how I would carry the errors:\n            #spatial_sd = sqrt(sum(i_sd^2))/length(i_sd)\n            )\n)\n#> `summarise()` has grouped output by 'region', 'period'. You\n#> can override using the `.groups` argument.\n#> # A tibble: 25 × 5\n#> # Groups:   region, period [25]\n#>    region     period    period_rank indicator     sd\n#>    <chr>      <chr>           <dbl>     <dbl>  <dbl>\n#>  1 Midt-Norge 2003-2007           2     0.427 0.139 \n#>  2 Midt-Norge 2008-2012           3     0.573 0.0992\n#>  3 Midt-Norge 2013-2017           4     0.536 0.212 \n#>  4 Midt-Norge 2018-2022           5     0.607 0.179 \n#>  5 Midt-Norge pre 2003            1     0.642 0.182 \n#>  6 Nord-Norge 2003-2007           2     0.460 0.149 \n#>  7 Nord-Norge 2008-2012           3     0.675 0.0602\n#>  8 Nord-Norge 2013-2017           4     0.641 0.127 \n#>  9 Nord-Norge 2018-2022           5     0.625 0.110 \n#> 10 Nord-Norge pre 2003            1     0.625 0.194 \n#> # … with 15 more rows\nlabs <- unique(i_aggregatedToPeriods$period[order(i_aggregatedToPeriods$period_rank)])\n\ni_aggregatedToPeriods %>%\n  ggplot(aes(x = period_rank, \n             y = indicator,\n             colour=region))+\n  geom_line() +\n  geom_point() +\n  geom_errorbar(aes(ymin=indicator-sd, \n                    ymax=indicator+sd), \n                    width=.2,\n                 position=position_dodge(0.2)) +\n  theme_bw(base_size = 12)+\n  scale_x_continuous(breaks = 1:5,\n                     labels = labs)+\n  labs(x = \"\", y = \"indikatorverdi\")\nreg2 <- reg %>%\n  left_join(i_aggregatedToPeriods[i_aggregatedToPeriods$period_rank==5,], by=join_by(region))\nmyCol <- \"RdYlGn\"\nmyCol2 <- \"-RdYlGn\"\n\ntm_main <- tm_shape(reg2)+\n  tm_polygons(col=\"indicator\",\n              title=\"Indikator:\\nsommertemperatur\",\n    palette = myCol,\n    style=\"fixed\",\n    breaks = seq(0,1,.2)) \n  \ntm_inset <- tm_shape(reg2)+\n  tm_polygons(col=\"sd\",\n              title=\"SD\",\n              palette = myCol2,\n              style=\"cont\")+\n  tm_layout(legend.format = list(digits=2))\n\ntmap_arrange(tm_main, \n             tm_inset)"},{"path":"alien-species.html","id":"alien-species","chapter":"5 Alien species","heading":"5 Alien species","text":"Norwegian name: Fravær av fremmede arterAuthor date:Anders L. KolstadSeptember 2023","code":""},{"path":"alien-species.html","id":"intro-ali","chapter":"5 Alien species","heading":"5.1 Introduction","text":"indicator represent ecological -site effect alien species. practice, indicator restricted alien vascular plants. Whilst introduction alien species best considered pressure variable, relative abundance alien species given location seen manifestation negative anthropogenic impact, therefore valid condition indicator.related variable used previously alpine forest ecosystems Norway. indicators based ANO, national monitoring program, alien species cover estimated closest whole percent. upper lower reference levels used back 0 100% species composition made alien species, respectively. threshold value good reduced condition defined 5%. approach, indicator represented relative area absence alien species. way flip-side alien species abundance. latter said pressure variable, whilst former reacts direct linear consequence changes variable, therefore accepted condition indicator. make distinction .time using nature type mapping dataset records assumed effect alien species, rather direct measure abundance percentage cover. recording scale called R7 (Fig. 5.1) ordinal scale non-linear relationship percentage cover recorded ANO (Fig. 5.2). order combine two data sets, must convert one scales match .base indicator R7 scale, since , presumably, bigger data set. therefore convert percentage cover R7 classes based can interpret Fig. 5.2.Upper reference value 1, lower reference value 7, R7 scale.\nthreshold value set value 3 R7 scale.\nbased interpretation author based definition value Fig. 5.1.\nStep 3 R7 scale step , concordantly, best matches 5% threshold old approach, seen Fig. 5.2.indicator calculated separately three ecosystems, nature types associated ecosystem pooled treated equally. means assume nature types mapped data , pooled, representative main ecosystem. less true Naturally open ecosystems two. can read .\nFigure 5.1: R7 scale used recording effect alien species nature type monitoring program\n\nFigure 5.2: Comparing R7 scale (x axis) used nature type monitoring program percentage cover (y-axis), alien species recorded GRUK. assuming x axis shifted downwards compared original R7 scale range 1 7, value 0 equals R7 value 1. Note also relationship based limited data just one nature type smaller diameter circles data use indicator. Cropped Evju et al (2022).\nSince nature type data sampled systematic random way, must take extra care -extrapolate space. delineate homogeneous impact areas (HIA) based four classes increasing infrastructure intersected municipality borders, say n data points field data representative inside entire HIA. related indicator used accounting areas define HIA (5 accounting areas Norway), addition infrastructure classes. indicator, expect gradients also inside accounting areas, therefore define HIAs based municipalities. means missing data final indicator maps, since municipalities sufficient data points estimate indicator values.calculate area weighted mean (error) indicator value HIA, long n data points given combination HIA municipality.general workflow calculation indicator.Import Nature type data data set (incl. GRUK) ANO data\nsetImport Nature type data data set (incl. GRUK) ANO data\nsetIdentify relevant nature types subset\ndataIdentify relevant nature types subset\ndataConvert ANO points polygonsConvert ANO points polygonsCombine data setsCombine data setsScale alien species variable based \nreference values.Scale alien species variable based \nreference values.Define homogeneous impact areas (HIA) based infrastructure index municipalitiesDefine homogeneous impact areas (HIA) based infrastructure index municipalitiesAggregate spread indicator value across HIAs\n(municipalities)Aggregate spread indicator value across HIAs\n(municipalities)Confirm relationship infrastructure index indicator\nvalues justify extrapolationConfirm relationship infrastructure index indicator\nvalues justify extrapolationTO : Prepare ecosystem delineation maps use mask extrapolated indicator mapsTO : Prepare ecosystem delineation maps use mask extrapolated indicator mapsSpatial aggregation indicator values uncertainties accounting areasSpatial aggregation indicator values uncertainties accounting areasExport indicator maps regional extrapolated mapsExport indicator maps regional extrapolated maps","code":"\nknitr::include_graphics(\"images/R7 scale.PNG\")\nknitr::include_graphics(\"images/fremmedart_prosentVSinnslag.PNG\")"},{"path":"alien-species.html","id":"about-data-ali","chapter":"5 Alien species","heading":"5.2 About the underlying data","text":"indicator uses data set standardised field survey nature\ntypes. can read data set preliminary analyses\n. See also official\nsite\nEnvironment Agency. also import data set called\nANO, can read \n.","code":""},{"path":"alien-species.html","id":"representativity-in-time-and-space-3","chapter":"5 Alien species","heading":"5.2.1 Representativity in time and space","text":"nature type mapping random said area\nrepresentative.\nimprove time either.ANO data set however, area representative. \ndata 2018 present. data one field season usually\nbecomes available early following year.Regarding update frequency, Nature type data set replicated, future. must therefore trust selection criteria areas survey change drastically systematically time. example, now surveying lot pressure areas, meaning lowland areas close human population centers. future allocate time surveying wilderness areas, indicator becomes biased. hand, ANO replicated every 5 years.","code":""},{"path":"alien-species.html","id":"original-units-3","chapter":"5 Alien species","heading":"5.2.2 Original units","text":"variables recorded unitless seven-step ordinal scale (Fig.\n5.1) percentage cover alien species.","code":""},{"path":"alien-species.html","id":"temporal-coverage-2","chapter":"5 Alien species","heading":"5.2.3 Temporal coverage","text":"data goes back 2018. therefore bulk data 2018 2022 one time step. use mean date raw data,\ndefine variable belonging year 2020 (read \n).","code":""},{"path":"alien-species.html","id":"aditional-comments-about-the-dataset-2","chapter":"5 Alien species","heading":"5.2.4 Aditional comments about the dataset","text":"run nature type data set, see .","code":""},{"path":"alien-species.html","id":"ecosystem-characteristic-4","chapter":"5 Alien species","heading":"5.3 Ecosystem characteristic","text":"","code":""},{"path":"alien-species.html","id":"norwegian-standard-2","chapter":"5 Alien species","heading":"5.3.1 Norwegian standard","text":"indicator tagged Økologisk egenskap called\nBiologisk mangfold.\nemphasises negative effect alien species example supressing excluding native species.\ncases, alien species can also affect nutrient cycling recruitment also appropriate funksjonelt viktige arter og strukturer.","code":""},{"path":"alien-species.html","id":"un-standard-1","chapter":"5 Alien species","heading":"5.3.2 UN standard","text":"indicator tagged B1 Compositional state characteristics\nindicator.","code":""},{"path":"alien-species.html","id":"collinearities-with-other-indicators-4","chapter":"5 Alien species","heading":"5.4 Collinearities with other indicators","text":"Alien species thought exhibit collinearity indicator \npresent.","code":""},{"path":"alien-species.html","id":"reference-condition-and-values-3","chapter":"5 Alien species","heading":"5.5 Reference condition and values","text":"","code":""},{"path":"alien-species.html","id":"reference-condition-3","chapter":"5 Alien species","heading":"5.5.1 Reference condition","text":"reference condition one minimal negative human impact. \nalso true semi-natural ecosystems. sense, reference condition pre-1800,\nsince Alien Species List Norway contains species established 1800.","code":""},{"path":"alien-species.html","id":"ref-vals-ali","chapter":"5 Alien species","heading":"5.5.2 Reference values, thresholds for defining good ecological condition, minimum and/or maximum values","text":"Upper = 1 (R7 scale), corresponding 0% alien speciesUpper = 1 (R7 scale), corresponding 0% alien speciesThreshold = 3 (R7 scale), corresponding 2-5% alien species cover.Threshold = 3 (R7 scale), corresponding 2-5% alien species cover.Lower = 7 (R7 scale), corresponding 100% alien species cover.Lower = 7 (R7 scale), corresponding 100% alien species cover.discussion around reference values, see hereRead normalisation .","code":""},{"path":"alien-species.html","id":"uncertainties-3","chapter":"5 Alien species","heading":"5.6 Uncertainties","text":"Uncertainties/errors estimated aggregated indicator values \nbootstrapping individual indicator values 1000 times calculating \ndistribution area weighted means. uncertainty different \nspatial variation get straightforward without\nbootstrapping. aggregating second time,\nhomogeneous impact areas accounting areas, assume normal\ndistribution around indicator values, already mentioned\nerrors, sample n times combine resamples \nnew, area-weighted, distribution. errors accounting areas\nthus represents spatial variation precision \nindicator values within accounting areas.","code":""},{"path":"alien-species.html","id":"references-4","chapter":"5 Alien species","heading":"5.7 References","text":"Nature type dataANOEvju, M., Skrindo, .B. & Solstad, H. (red.) 2022. Overvåking av åpen grunnlendt kalkmark 2021‒2024. Årsrapport 2022. NINA Rapport 2195. Norsk institutt naturforskning.","code":""},{"path":"alien-species.html","id":"analyses-analyses-ali","chapter":"5 Alien species","heading":"5.8 Analyses {analyses-ali}","text":"","code":""},{"path":"alien-species.html","id":"data-sets-2","chapter":"5 Alien species","heading":"5.8.1 Data sets","text":"","code":""},{"path":"alien-species.html","id":"NTM2","chapter":"5 Alien species","heading":"5.8.1.1 Nature type mapping","text":"indicator uses data set\nNaturtyper etter Miljødirektoratets Instruks, can found\n.\nSee also detailed description data set.also separate summary file \nnature types manually mapped NiN variables correct NiN-main types.\ncan use find nature types interest.interested mapping units include target variables. variable fremmedartsinnslag (presence alien species) coded 7FA.deleted 30 nature types left us 24 nature types 7FA recorded:Importing sub-setting main data file, fix duplicate hovedøkosystem, calculate area, split one column two, make numeric, select target variables:\nFigure 3.1: overview naturetypes calculate indicator.\nNote lot data semi-natural ecosystem compared two.Column names starting number problematic, adding prefixRemoving NA’sShift variable start 1 rather 0.\nFigure 5.3: Alien species variable scores nature type data set.\nappears localities good condition; actually, localities alien species .","code":"\nnaturetypes_summary_import <- readRDS(\"data/naturetypes/natureType_summary.rds\")\nmyVars <- '7FA'\nnaturetypes_summary <- naturetypes_summary_import %>%\n  rowwise() %>%\n  mutate(keepers = sum(c_across(\n    all_of(myVars))>0, na.rm=T)) %>%\n  filter(keepers >0) %>%\n  select(Nature_type, NiN_mainType, Year)\nDT::datatable(naturetypes_summary)\nnaturetypes <- sf::st_read(dsn = path) %>%\n  filter(naturtype %in% naturetypes_summary$Nature_type) %>%\n  mutate(hovedøkosystem = case_match(hovedøkosystem,\n                                  \"naturligÅpneOmråderILavlandet\" ~ \"naturligÅpneOmråderUnderSkoggrensa\",\n                                  .default = hovedøkosystem),\n         area = st_area(.)) %>%\n  separate_rows(ninBeskrivelsesvariable, sep=\",\") %>%\n  separate(col = ninBeskrivelsesvariable,\n           into = c(\"NiN_variable_code\", \"NiN_variable_value\"),\n           sep = \"_\",\n           remove=F) %>%\n  mutate(NiN_variable_value = as.numeric(NiN_variable_value)) %>%\n  filter(NiN_variable_code %in% myVars)\n#> Reading layer `Naturtyper_nin_0000_norge' from data source \n#>   `/data/R/GeoSpatialData/Habitats_biotopes/Norway_Miljodirektoratet_Naturtyper_nin/Original/Naturtyper_nin_0000_norge_25833_FILEGDB/Naturtyper_nin_0000_norge_25833_FILEGDB.gdb' \n#>   using driver `OpenFileGDB'\n#> Simple feature collection with 117427 features and 36 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -74953.52 ymin: 6448986 xmax: 1075081 ymax: 7921284\n#> Projected CRS: ETRS89 / UTM zone 33N\nggplot(data = naturetypes, aes(x = naturtype, fill = hovedøkosystem))+\n  geom_bar()+\n  coord_flip()+\n  theme_bw(base_size = 10)+\n  theme(legend.position = \"top\",\n        legend.title = element_blank(),\n        legend.direction = \"vertical\")+\n  guides(fill = \"none\")+\n  xlab(\"\")+\n  ylab(\"Number of localities\")+\n  facet_wrap(.~hovedøkosystem, ncol=1, scale=\"free\")\nnaturetypes$NiN_variable_code <- paste0(\"var_\", naturetypes$NiN_variable_code)\nnaturetypes <- naturetypes[!is.na(naturetypes$NiN_variable_value),]\nnaturetypes$NiN_variable_value <- naturetypes$NiN_variable_value+1\nggplot(naturetypes, aes(x = NiN_variable_value))+\n  geom_histogram(fill=\"grey\",\n           colour = \"black\",\n           binwidth = 1)+\n  theme_bw(base_size = 12)+\n  labs(x = \"Alien species variable score\") +\n  facet_wrap(.~hovedøkosystem, scales=\"free_y\")"},{"path":"alien-species.html","id":"gruk-1","chapter":"5 Alien species","heading":"5.8.1.2 GRUK","text":"variable (7FA) also recorded \nGRUK.\nnature type data set ’m working includes data already\n(presently 2021 included). GRUK also records related variable:\n% cover 5m radii circles, much detailed. data \npublished. case better use harmonized data set\ncase.See also GitHub issue.","code":""},{"path":"alien-species.html","id":"ANO-import2","chapter":"5 Alien species","heading":"5.8.1.3 ANO","text":"Arealrepresentativ Naturovervåking (ANO) consist 1000 systematically\nplaced locations Norway, 18 sample points. sample point, \ncircle 250 m2 inspected, main ecosystem recorded.percentage cover alien vascular plant estimated, irrespective main ecosystem type.\ncontrast nature type data set, ANO looks vascular plants, also three highest impact categories\nAlien Species List (SE, HI, PH). therefore completely unproblematic combine data sets,\nanyway. expect plants far common species group influence 7FA variable well.\nsimilarly, expect three highest impact categories contain widespread species, \ndrive 7FA variable categories.data set contains data year 2019 2021. need \nupdate data set later. clear data \n2020.point/row 250 square meters. data also contains\ninformation big proportion area made \ndominant main ecosystem. However, \n215\nNA’s , 20% data.appears proportion circle made dominant\necosystem recorded year 2019. fact, main ecosystem\nrecorded 2019:can remove NA’s, thus 2019 data.2019 ANO data excluded missing informationLet’s look variation recorded proportion ecosystem\ncover\nFigure 3.7: Distribution ANO variable andel_hovedoekosystem_punkt.\nzero obvious mistake. Removing :’s another plot distribution variable:\nFigure 5.4: Percentage cover main ecosystem 250m2 circle\ncan see people tend record variable steps 5%, \nsample points 100% belonging main ecosystem.want use area weighting indicator, can use \npercentage cover data calculate area. Note data sets\nuse m2 area units.Let’s now look distribution variable. coded fa_total_dekning.\nFirst, 73 NA’s column can remove.Let us plot distribution values.\nFigure 5.5: Distribution percentage cover alien plants variable ANO data set\nANO localities seemingly less alien plants nature type localities. can due sampling biases latter.Now convert percentage cover values 7FA classes. critical step, since one--one mapping ,\nrather considerable overlap, can seen Fig. 5.2.\nFigure 5.6: Distribution R7 values ANO data set\n","code":"\nano_eco <- c(\"vaatmark\", \"naturlig_apne\", \"semi_naturlig_mark\")\nano <- sf::st_read(paste0(pData, \"Naturovervaking_eksport.gdb\"),\n                   layer = \"ANO_SurveyPoint\") %>%\n  dplyr::filter(hovedoekosystem_punkt %in% ano_eco) %>%\n   mutate(hovedoekosystem_punkt = case_match(hovedoekosystem_punkt,\n                                       \"vaatmark\" ~ \"våtmark\",\n                                       \"naturlig_apne\" ~ \"naturligÅpneOmråderUnderSkoggrensa\",\n                                       \"semi_naturlig_mark\" ~ \"semi-naturligMark\",\n                                       .default = hovedoekosystem_punkt))\n#> Reading layer `ANO_SurveyPoint' from data source \n#>   `/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/Naturovervaking_eksport.gdb' \n#>   using driver `OpenFileGDB'\n#> Simple feature collection with 8974 features and 71 fields\n#> Geometry type: POINT\n#> Dimension:     XY\n#> Bounding box:  xmin: -51950 ymin: 6467050 xmax: 1094950 ymax: 7923950\n#> Projected CRS: ETRS89 / UTM zone 33N\ntable(ano$aar)\n#> \n#> 2019 2021 \n#>  215  887\ntable(ano$hovedtype_250m2, ano$aar)\n#>                             \n#>                              2019 2021\n#>   Åpen flomfastmark             0    1\n#>   Åpen grunnlendt mark          0   90\n#>   Åpen jordvannsmyr             0  417\n#>   Boreal hei                    0   81\n#>   Fjellhei leside og tundra     0    5\n#>   Grøftet torvmark              0    5\n#>   Helofytt-ferskvannssump       0    3\n#>   Historisk skredmark           0    3\n#>   Isinnfrysingsmark             0    1\n#>   Kaldkilde                     0    3\n#>   Kystlynghei                   0   26\n#>   Løs sterkt endret fastmark    0    1\n#>   Myr- og sumpskogsmark         0   51\n#>   Nakent berg                   0   35\n#>   Nedbørsmyr                    0   53\n#>   Rasmark                       0   23\n#>   Rasmarkhei og -eng            0    3\n#>   Semi-naturlig eng             0   44\n#>   Semi-naturlig myr             0   14\n#>   Semi-naturlig våteng          0    2\n#>   Skogsmark                     0    3\n#>   Strandberg                    0    5\n#>   Strandeng                     0    2\n#>   Strandsumpskogsmark           0    2\n#>   Våtsnøleie og snøleiekilde    0    6\nano <- ano[!is.na(ano$andel_hovedoekosystem_punkt),]\npar(mar=c(5,6,4,2))\nplot(ano$andel_hovedoekosystem_punkt[order(ano$andel_hovedoekosystem_punkt)],\n     ylab=\"Percentage of the 250 m2 area\\ncovered by the main ecosystem\")\nano <- ano[ano$andel_hovedoekosystem_punkt>20,]\nggplot(ano, aes(x = andel_hovedoekosystem_punkt))+\n         geom_histogram(fill = \"grey\",\n                        colour=\"black\",\n                        binwidth = 1)+\n  theme_bw(base_size = 12)+\n  xlab(\"Percentage cover of the main ecosystem\\n in the 250m2 circle\")+\n  scale_x_continuous(limits = c(0,101),\n                     breaks = seq(0,100,10))\nano$area <- (ano$andel_hovedoekosystem_punkt/100)*250\nano <- ano[!is.na(ano$fa_total_dekning),]\nggplot(ano, aes(x = fa_total_dekning))+\n  geom_histogram(fill=\"grey\",\n           colour = \"black\",\n           binwidth = 1)+\n  theme_bw(base_size = 12)+\n  labs(x = \"Percentage cover alien vascular plants\") +\n  facet_wrap(.~hovedoekosystem_punkt, scales=\"free_y\")\nano <- ano %>%\n  mutate(var_7FA = case_when(\n             fa_total_dekning>90 ~ 7,\n             fa_total_dekning>25 ~ 6,\n             fa_total_dekning>10 ~ 5,\n             fa_total_dekning>5 ~ 4,\n             fa_total_dekning>2 ~ 3,\n             fa_total_dekning>1 ~ 2,\n             fa_total_dekning<1 ~ 1))\nggplot(ano, aes(x = var_7FA))+\n  geom_histogram(fill=\"grey\",\n           colour = \"black\",\n           binwidth = 1)+\n  theme_bw(base_size = 12)+\n  labs(x = \"Percentage cover alien vascular plants\\n converted to the R7 scale\") +\n  facet_wrap(.~hovedoekosystem_punkt, scales=\"free_y\")\n#> Warning: Removed 6 rows containing non-finite values\n#> (`stat_bin()`)."},{"path":"alien-species.html","id":"combine-nt-ano2","chapter":"5 Alien species","heading":"5.8.1.3.1 Combine Naturtype data and ANO","text":"need combine nature type data set ANO data set. \nadd column origin show data comes . \nalso add column main ecosystem.Fix classI use dplyr::select reduce number columns keep things \nbit tidy.","code":"\nano$origin <- \"ANO\"\nnaturetypes$origin <- \"Nature type mapping\"\nano$hovedøkosystem <- ano$hovedoekosystem_punkt\nano$kartleggingsår <- ano$aar\nnaturetypes$kartleggingsår <- as.numeric(naturetypes$kartleggingsår)\nnaturetypes$area <- units::drop_units(naturetypes$area)\nalien_data <- dplyr::bind_rows(select(ano,\n                                  GlobalID,\n                                  origin,\n                                  kartleggingsår,\n                                  hovedøkosystem,\n                                  area,\n                                  var_7FA,\n                                  SHAPE), \n                           select(naturetypes,\n                                  identifikasjon_lokalId,\n                                  origin,\n                                  hovedøkosystem,\n                                  kartleggingsår,\n                                  area,\n                                  var_7FA = NiN_variable_value,\n                                  SHAPE))"},{},{"path":"alien-species.html","id":"distribution-of-7fa-scores","chapter":"5 Alien species","heading":"5.8.1.4 Distribution of 7FA scores","text":"\nFigure 3.11: 7FA (alien species) scores (ANO Naturetype (GRUK) data combined).\nLet’s see proportion data points (area) originating \ndata set\nFigure 5.8: Barplot showing contribution (number localities) different data sets alien species indicator.\nANO data important , can become \nimportant future, good included workflow.","code":"\ntemp <- as.data.frame(table(alien_data$var_7FA))\nggplot(temp, aes(x = Var1,\n                 y = Freq))+\n  geom_bar(stat=\"identity\",\n           fill=\"grey\",\n           colour = \"black\")+\n  theme_bw(base_size = 12)+\n  labs(x = \"7FA score\",\n       y = \"Number of localities\")\ntemp <- as.data.frame(table(alien_data$origin))\n\nggplot(temp, aes(x = Var1,\n                 y = Freq))+\n  geom_bar(stat=\"identity\",\n           fill=\"grey\",\n           colour = \"black\")+\n  theme_bw(base_size = 12)+\n  labs(x = \"Data origin\",\n       y = \"Number of localities\")"},{"path":"alien-species.html","id":"outline-of-norway-and-regions-1","chapter":"5 Alien species","heading":"5.8.1.5 Outline of Norway and regions","text":"layers used crop marine areas, define\naccounting areas, respectively.MunicipalitiesThere multi-surfaces convert multi-polygons plotting.\nFigure 5.9: Municipalities Norway.\n","code":"\noutline <- sf::read_sf(\"data/outlineOfNorway_EPSG25833.shp\")\nregions <- sf::read_sf(\"data/regions.shp\", options = \"ENCODING=UTF8\")\nunique(regions$region)\n#> [1] \"Nord-Norge\" \"Midt-Norge\" \"Østlandet\"  \"Vestlandet\"\n#> [5] \"Sørlandet\"\npath1 <- ifelse(dir == \"C:\", \n               \"R:/\",\n               \"/data/R/\")\n\npath <- paste0(path1, \"GeoSpatialData/AdministrativeUnits/Norway_AdministrativeUnits/Original/Norway_Municipalities/Basisdata_0000_Norge_25833_Kommuner_FGDB.gdb\")\n\n# find the correct layer\n#st_layers(path)\nmuni <- sf::read_sf(path, options = \"ENCODING=UTF8\", layer = \"kommune\")\n# function to make sure that mutipolygons are returned \nensure_multipolygons <- function(X) {\n    tmp1 <- tempfile(fileext = \".gpkg\")\n    tmp2 <- tempfile(fileext = \".gpkg\")\n    st_write(X, tmp1)\n    gdalUtilities::ogr2ogr(tmp1, tmp2, f = \"GPKG\", nlt = \"MULTIPOLYGON\")\n    Y <- st_read(tmp2)\n    st_sf(st_drop_geometry(X), geom = st_geometry(Y))\n}\n\nmuni <- ensure_multipolygons(muni)\n#> Writing layer `file326c8018276bd7' to data source \n#>   `/tmp/RtmpCL07EH/file326c8018276bd7.gpkg' using driver `GPKG'\n#> Writing 363 features with 13 fields and geometry type Unknown (any).\n#> Reading layer `file326c8018276bd7' from data source \n#>   `/tmp/RtmpCL07EH/file326c804833f713.gpkg' \n#>   using driver `GPKG'\n#> Simple feature collection with 363 features and 13 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -99551.21 ymin: 6426048 xmax: 1121941 ymax: 7962744\n#> Projected CRS: ETRS89 / UTM zone 33N\n\ntm_shape(muni)+\n  tm_polygons(col=\"kommunenummer\")+\n  tm_layout(legend.outside = T)"},{"path":"alien-species.html","id":"scale-alien-ind","chapter":"5 Alien species","heading":"5.8.2 Scaled indicator values","text":"can scale indicator polygon, can chose aggregate\nfirst. scaled value representative precise \npolygon level, scale level. think .However, combined surveyed area small fraction \ntotal area Norway, producing indicator values \nmapped areas leaves indicator without much value regional\nassessments. simply area weighting polygons\nregion. expect considerable sampling bias\ncan’t assume \npolygons representative far outside mapped area. perhaps\ncan assume representative inside homogeneous ecological\nareas, Homogeneous Impact Areas (HIAs). ’s \ninfrastructure index comes . ’s plan:normalise indicators polygon level.normalise indicators polygon level.take simplified infrastructure index (vector data) intersect municipality borders produce map homogeneous impact areas (HIAs).take simplified infrastructure index (vector data) intersect municipality borders produce map homogeneous impact areas (HIAs).extract corresponding indicator values intersect \ngiven HIA, extrapolate area weighted mean values \nentire HIA. Errors \ncalculated bootstrapping.extract corresponding indicator values intersect \ngiven HIA, extrapolate area weighted mean values \nentire HIA. Errors \ncalculated bootstrapping.Take new area weighted indicator values HIAs, rasterize , mask \necosystem occurrences. errors HIAs.Take new area weighted indicator values HIAs, rasterize , mask \necosystem occurrences. errors HIAs.calculate indicator value region (accounting area) \nweighted average based relative area ecosystem\noccurrences. Errors carried somehow, perhaps via weighted\nresampling.calculate indicator value region (accounting area) \nweighted average based relative area ecosystem\noccurrences. Errors carried somehow, perhaps via weighted\nresampling.","code":""},{"path":"alien-species.html","id":"scaled-alien-variable","chapter":"5 Alien species","heading":"5.8.2.1 Scaled variable","text":"use reference levels/values Norway:\nFigure 5.10: Performing linear break-point type normalisation alien species variable.\npoint yet making time series, \nassign indicator values average year data.Assigning indicator year 2020.","code":"\nlow <- 1\nhigh <- 7\nthreshold <- 3\neaTools::ea_normalise(data = alien_data,\n                      vector = \"var_7FA\",\n                      upper_reference_level = high,\n                      lower_reference_level = low,\n                      break_point = threshold,\n                      plot=T,\n                      reverse = T\n                      )\n#> Warning: Removed 6 rows containing missing values\n#> (`geom_point()`).\nmean(alien_data$kartleggingsår)\n#> [1] 2020.12\nalien_data$i_2020 <- eaTools::ea_normalise(data = alien_data,\n                      vector = \"var_7FA\",\n                      upper_reference_level = high,\n                      lower_reference_level = low,\n                      break_point = threshold,\n                      reverse = T\n                      )"},{"path":"alien-species.html","id":"HIA","chapter":"5 Alien species","heading":"5.8.3 Homogeneous impact areas","text":"want use Homogeneous Impact Areas (HIA) define\nsmaller regions can extrapolate indicator values. \ndata generated discretizing Norwegian Infrastructure Index. \nrefer ordinal values four HIA classes Human\nImpact Factor (HIF). just keep approach separate \nNorwegian Infrastructure Index.want check HIF fact good predictor alien species.also want split four HIA classes based municipality.\nrelated indicator used combinations HIA region, alien species think\nmuch variation also inside region (esp north-south) need finer division strata.\nneed two layers CRS.get intersections (unique combinations)Create new column crossing municipality number HIFHere view data zooming TrondheimCropping raster bboxGet map major roads, context\nFigure 3.16: closer look HIA designation Trondheim\nSee Fig. 3.24 closer look distribution HIA classes across Norway.","code":"\nHIA <- readRDS(paste0(pData, \"infrastrukturindeks/homogeneous_impact_areas.rds\"))\nst_crs(HIA) == st_crs(muni)\n#> [1] TRUE\nHIA_muni <- eaTools::ea_homogeneous_area(HIA,\n                             muni,\n                             keep1 = \"infrastructureIndex\",\n                             keep2 = \"kommunenummer\")\nsaveRDS(HIA_muni, \"P:/41201785_okologisk_tilstand_2022_2023/data/cache/HIA_muni.rds\")\nHIA_muni <- HIA_muni %>%\n  mutate(muni_HIF = paste(\"ID\", kommunenummer, infrastructureIndex, sep=\"_\"))\nmyBB <- st_bbox(c(xmin=260520.12, xmax = 278587.56,\n                ymin = 7032142.5, ymax = 7045245.27),\n                crs = st_crs(HIA_muni))\nHIA_trd <- sf::st_crop(HIA_muni, myBB)\n#> Warning: attribute variables are assumed to be spatially\n#> constant throughout all geometries\nhw_utm <- readRDS(\"data/cache/highways_trondheim.rds\")\n(HIA_trd <- tm_shape(HIA_trd)+\n  tm_polygons(col = \"infrastructureIndex\",\n    title=\"Infrastructure index\\n(modified 4-step scale)\",\n    palette = \"-viridis\",\n    style=\"cat\")+\n  tm_layout(legend.outside = T)+\n  tm_shape(hw_utm)+\n  tm_lines(col=\"red\")+\n  tm_shape(outline)+\n  tm_borders(col = \"black\", lwd=2))"},{"path":"alien-species.html","id":"validate-ali","chapter":"5 Alien species","heading":"5.8.3.1 Validate","text":"now 1350 HIAs (main ecosystem) , given\ndata, extrapolate indicator values . first want validate assumption HIF\nexplains considerable portion variation indicator values.subset alien_data three ecosystems.Creating summary statistics.data 277 363 municipalities. figure shows many municipalities least one data point , specific human impact factor level:\nFigure 5.11: Number municipalities least one data point , specific human impact factor level.\nsay need 20 data points HIA municipality combination order extrapolate entire HIA municipality, get much less work :\nFigure 5.12: Number municipalities least 20 data points , specific human impact factor level.\n\nFigure 5.13: Indicator-pressure relationship across ecosystems.\ntrend , strong perhaps.similar figure, looking relative frequency indicator level polygons within HIA.\nFigure 5.14: Relative frequency plot showing distribution polygons different indicator values.\nfigure think supports indicator-pressure relationship\njustifies using HIA x municipality intersections local reference\nareas.Let us look effect sample size indicator uncertainty.\nFigure 5.15: Sample size indicator uncertainty.\nshows uncertainty really inflated sample sizes less 50-100.\nFigure 5.16: Summary statistics alien species indicator.\n","code":"\n#make geometries valid \nalien_data <- st_make_valid(alien_data)\n\n#subset\nwetlands <- alien_data[alien_data$hovedøkosystem == \"våtmark\",]\nseminat <- alien_data[alien_data$hovedøkosystem == \"semi-naturligMark\",]\nnatOpen <- alien_data[alien_data$hovedøkosystem == \"naturligÅpneOmråderUnderSkoggrensa\",]\nwetland_stats <- ea_spread(indicator_data = wetlands,\n          indicator = i_2020,\n          regions = HIA_muni,\n          groups = muni_HIF,\n          summarise = TRUE)\n\nseminat_stats <- ea_spread(indicator_data = seminat,\n          indicator = i_2020,\n          regions = HIA_muni,\n          groups = muni_HIF,\n          summarise = TRUE)\n\nnatOpen_stats <- ea_spread(indicator_data = natOpen,\n          indicator = i_2020,\n          regions = HIA_muni,\n          groups = muni_HIF,\n          summarise = TRUE)\n\nwetland_stats <- wetland_stats %>%\n  add_column(eco = \"wetland\")\n\nseminat_stats <- seminat_stats %>%\n  add_column(eco = \"semi-natural\")\n\nnatOpen_stats <- natOpen_stats %>%\n  add_column(eco = \"Naturally-open\")\n\nall_stats <- rbind(wetland_stats,\n                   seminat_stats,\n                   natOpen_stats)\nall_stats <- all_stats %>%\n  separate(muni_HIF,\n           into = c(\"tempLink\", \"municipalityNumber\", \"HIF\"),\n           sep = \"_\")\n\n#saveRDS(all_stats, \"/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/cache/all_stats_alienSpecies.rds\")\nsaveRDS(all_stats, \"P:/41201785_okologisk_tilstand_2022_2023/data/cache/all_stats_alienSpecies.rds\")\nall_stats %>%\n  group_by(HIF, eco) %>%\n  summarise(n = n()) %>%\n  ggplot()+\n  geom_bar(aes(x = HIF, y = n), stat =\"identity\")+\n  theme_bw()+\n  ylab(\"Number of municipalities\")+\n  facet_wrap(.~eco)\n#> `summarise()` has grouped output by 'HIF'. You can override\n#> using the `.groups` argument.\nall_stats %>%\n  filter(n>20) %>%\n  group_by(HIF, eco) %>%\n  summarise(n = n()) %>%\n  ggplot()+\n  geom_bar(aes(x = HIF, y = n), stat =\"identity\")+\n  theme_bw()+\n  ylab(\"Number of municipalities\")+\n  facet_wrap(.~eco)\n#> `summarise()` has grouped output by 'HIF'. You can override\n#> using the `.groups` argument.\nall_stats %>%\n  filter(n > 20) %>%\n  ggplot(aes(x = HIF, y = w_mean))+\n  geom_point(size=2, position = position_dodge2(.1))+\n  geom_violin(alpha=0)+\n  theme_bw()+\n  labs(x = \"Human impact factor\",\n       y = \"Indicator value (area weighted means)\")corrCheck <- st_intersection(alien_data, HIA)\nsaveRDS(corrCheck, paste0(pData, \"cache/corrCheck_alienSpecies.rds\")\nggplot(corrCheck, aes(x = factor(infrastructureIndex), fill = factor(round(i_2020,2))))+\n  geom_bar(position=\"fill\")+\n  theme_bw(base_size = 12)+\n  guides(fill = guide_legend(\"Alien species indicator\"))+\n  ylab(\"Fraction of data points\")+\n  xlab(\"HIF\")+\n  scale_fill_brewer(palette = \"RdYlGn\")+\n  facet_wrap(.~hovedøkosystem)\nall_stats %>%\n  filter(n > 5) %>%\n  ggplot(aes(x = n, y = sd))+\n  geom_point(size=2, position = position_dodge2(.1))+\n  theme_bw()+\n    facet_wrap(.~eco, scales=\"free\")\nDT::datatable(all_stats) %>%\n  formatRound(columns=3:8, digits=2)"},{"path":"alien-species.html","id":"spread-alien","chapter":"5 Alien species","heading":"5.8.4 Aggregate and spread (extrapolate)","text":"now want find mean indicator value HIA (.e. \naggregate) spread spatially entire HIA (.e. extrapolate).want add threshold don’t end extrapolating\nbased data points. use 20 data points minimum.’s easier see ’s happening zoom bit. look closely three example municipalities:Trondheim (municipality nr 5001), Nordre Follo (3020) Målselv (5418).\nFigure 5.17: Alien species indicator extrapolated Nordre Follo (3020), Trondheim (5001) Målselv (5418). Note maps masked ecosystem type, three ecosystem specific indicators overlaping. bottom row shows location four human impact sones.\nFigure 5.17 indicates indicator lot missing data (see also ). Nordre Follo Trondheim example, indicator values tied naturally open wetland ecosystems, semi natural ecosystems data HIF class 2. , however, still lot better discarding entire data set due issues related area representativity. amount missing data indicator maps closely tied chosen threshold value many data points must order calculate (area weighted) mean indicator value. used 20 threshold . Målselv (far right column), ended enough data wetlands HIF class 0, since municipality HIF class get lot indicator coverage.following table contains data values underlying Figure 5.17, including HIAs <20 data points.\nFigure 3.21: Summary statistics three example municipalities.\nNote can also show uncertainties maps:\nFigure 5.18: Map showing uncertainties (spatial variation) around indicator values alien species three example municipalities Semi-natural ecosystems.\n","code":"\nwetland_alien_extr <- ea_spread(indicator_data = wetlands,\n                         indicator = i_2020,\n                         regions = HIA_muni,\n                         groups = muni_HIF,\n                         threshold = 20)\n\nseminat_alien_extr <- ea_spread(indicator_data = seminat,\n                         indicator = i_2020,\n                         regions = HIA_muni,\n                         groups = muni_HIF,\n                         threshold = 20)\n\nnatOpen_alien_extr <- ea_spread(indicator_data = natOpen,\n                         indicator = i_2020,\n                         regions = HIA_muni,\n                         groups = muni_HIF,\n                         threshold = 20)\nwetland_alien_extr <- wetland_alien_extr %>%\n  separate(ID,\n           into = c(\"ID\", \"municipalityNumber\", \"HIF\"),\n           sep = \"_\") %>%\n  add_column(eco = \"wetlands\")\n\nseminat_alien_extr <- seminat_alien_extr %>%\n  separate(ID,\n           into = c(\"ID\", \"municipalityNumber\", \"HIF\"),\n           sep = \"_\") %>%\n  add_column(eco = \"semi_natural\")\n\nnatOpen_alien_extr <- natOpen_alien_extr %>%\n  separate(ID,\n           into = c(\"ID\", \"municipalityNumber\", \"HIF\"),\n           sep = \"_\") %>%\n  add_column(eco = \"naturally_open\")\n\nalien_extr <- rbind(\n  wetland_alien_extr,\n  seminat_alien_extr,\n  natOpen_alien_extr\n)\nalien_extr_trd_nf <- alien_extr %>%\n  filter(municipalityNumber %in% c(\"5001\", \"3020\", \"5418\"))\nmyCol <- \"RdYlGn\"\n\ntmap_arrange(\ntm_shape(alien_extr_trd_nf)+\n  tm_polygons(col = \"w_mean\",\n    title=\"Alien species indicator\",\n    palette = myCol,\n     style=\"fixed\",\n    breaks = seq(0,1,.1))+\n  tm_layout(legend.outside = T)+\n  tm_facets(by=c(\"eco\", \"municipalityNumber\"))\n,\ntm_shape(alien_extr_trd_nf)+\n  tm_polygons(col = \"HIF\",\n    title=\"Human impact factor\",\n    palette = \"-viridis\",\n    style=\"cont\",\n    breaks = c(0,1))+\n  tm_layout(legend.outside = T)+\n  tm_facets(by=c(\"municipalityNumber\"))\n,\nncol=1,\nheights = c(1,0.3))\nall_stats %>%\n  filter(municipalityNumber %in% c(\"5001\", \"3020\", \"5418\")) %>%\n  arrange(municipalityNumber, eco, HIF) %>%\n  DT::datatable()%>%\n  formatRound(columns=3:8, digits=2)\ntm_shape(alien_extr_trd_nf[alien_extr_trd_nf$eco==\"semi_natural\",])+\n  tm_polygons(col = \"sd\",\n    title=\"SD(alien\\nspecies indicator)\",\n    palette = \"-viridis\"\n     )+\n  tm_layout(legend.outside = T)+\n  tm_facets(by=\"municipalityNumber\")"},{"path":"alien-species.html","id":"exploring-the-indicator-values","chapter":"5 Alien species","heading":"5.8.5 Exploring the indicator values","text":"HIAs good condition:\nFigure 5.19: Number HIAs >20 data points (sum three ecosystems)\n","code":"\nalien_extr %>%\n  filter(!is.na(w_mean)) %>%\n  ggplot()+\n  geom_histogram(aes(x = w_mean))+\n  theme_bw()+\n  labs(x = \"Area weighted indicator value\",\n       y = \"Number of HIAs with >20 data points\")\n#> `stat_bin()` using `bins = 30`. Pick better value with\n#> `binwidth`."},{"path":"alien-species.html","id":"alien-data-coverage","chapter":"5 Alien species","heading":"5.8.5.1 Data coverage","text":"Let’s see big proportion Norway ended data . Ideally masking indicator maps ecosystem delineations,\ncan also get good feel data coverage like well.area Norway isAnd total relative area indicator maps\nFigure 5.20: Relative area cover indicator maps alien species indicator (.e. value 1 means HIAs > 20 data points, 0.2 means 20% ). assuming ecosystems equally common mapped , measure data coverage representative real indicator coverage masking maps ecosystem delineations.\nFigure 5.20 shows us indicator provide indicator values 20% semi-natural ecosystem, considerably less two ecosystems. data coverage sensitive threshold minimum data points, set >20 case. Also, nature type data accumulating time, data coverage increase. Therefore think indicator worthwhile, considerably better alternative discard entire data set.","code":"\n(total_area <- st_area(outline))\n#> 325694265348 [m^2]\nalien_extr %>%\n  filter(!is.na(w_mean)) %>%\n  mutate(m2 = st_area(.)) %>%\n  group_by(eco) %>%\n  summarise(sum_area = sum(m2)) %>%\n  add_column(total_area = total_area) %>%\n  mutate(relative_area = units::drop_units(sum_area/total_area)) %>%\n  ggplot()+\n  geom_bar(aes(x = eco, y = relative_area),\n           stat = \"identity\")+\n  labs(x = \"Ecosystem\", y = \"Relative indicator data coverage\")+\n  theme_bw()"},{"path":"alien-species.html","id":"effect-of-latitude","chapter":"5 Alien species","heading":"5.8.5.2 Effect of latitude","text":"Alien species can expected decrease towards north. Let us see effect latitude.Extracting x y coordinates\nFigure 5.21: Effect latitude alien species indicator values. blue line loess smoother (span=0.75).\nquite clear association latitude -site effect alien species.","code":"\ntemp <- alien_extr %>%\n  filter(!is.na(w_mean)) %>%\n  st_centroid() %>%\n  st_coordinates()\n\ntemp2 <- alien_extr %>%\n  filter(!is.na(w_mean))  %>%\n  cbind(temp)\ntemp2 %>%\n  ggplot(aes(x = X, y = w_mean))+\n  geom_point()+\n  theme_bw()+\n  geom_smooth(linewidth=2,\n              method=\"loess\",\n              span=0.75)+\n  labs(x = \"Latitude (UTM with offset)\",\n       y = \"Alien species indicator value\\n(area weighted)\")+\n  facet_wrap(~eco)"},{"path":"alien-species.html","id":"next-steps","chapter":"5 Alien species","heading":"5.9 Next steps","text":"next steps now toPrepare ecosystem delineation maps EPSG:25833 perfectly aligned master gridPrepare ecosystem delineation maps EPSG:25833 perfectly aligned master gridRasterize extrapolated indicator map, using ET map templateRasterize extrapolated indicator map, using ET map templateand mask using perfectly aligned ET map.mask using perfectly aligned ET map., look Median Summer Temperature aggregate spatially accounting areas (regions), look Median Summer Temperature aggregate spatially accounting areas (regions)workflow synchronized slitasje indicator. attempt little proof concept .","code":""},{"path":"alien-species.html","id":"masking-example","chapter":"5 Alien species","heading":"5.10 Masking with an ecosystem delineation - example","text":"Let’s try steps 2 3 reduced data set. ’ll work wetlands Gran municipality.\nFigure 3.23: Alien species indicator wetlands Gran municipality.\ncan import crop ecosystem delineation map (EDM).EDM UTM32 actually want UTM33. transforming takes long, transform indicator map instead.\nFigure 5.22: Wetlands Gran municipality\nrasterize indicator map match EDM. takes , even just one municipality. ’m sure work entire country.\nFigure 5.23: Indictor values (alien species, extrapolated area weighted values) Gran municipality. Note pixelation small (10 x 10 m), larger squares remnants HIA map 1 x 1 km resolution.\nmask remove areas actually wetlands.\nFigure 5.24: Stratified, area weighted indictor values (alien species) Gran municipality masked wetland ecosystem delimination map.\neasy get zonal statistics using exactextratr. kind map Norway can get mean value regions (defined via polygon set) course area weighted (weight given ecosystem occurences don’t indicator values).","code":"\ngran <- wetland_alien_extr %>%\n  filter(municipalityNumber == \"3446\")\ntm_shape(gran)+\n  tm_polygons(col = \"w_mean\",\n    title=\"Alien species indicator - wetlands\",\n    palette = myCol,\n     style=\"fixed\",\n    breaks = seq(0,1,.1))+\n  tm_layout(legend.outside = T,\n            title = \"Gran municipality\")\nfile <- \"P:/41201785_okologisk_tilstand_2022_2023/data/Myrmodell/myrmodell90pros.tif\"\nEDM <- stars::read_stars(file, proxy=F)\ngran <- st_transform(gran, st_crs(EDM))\nmire_gran <- st_crop(EDM, gran)\nsaveRDS(mire_gran, paste0(pData, \"cache/mire_gran.rds\"))\nggplot()+\n  geom_stars(data = st_downsample(mire_gran, 10))\ngran_rast <- st_rasterize(gran, template = mire_gran)  \nsaveRDS(gran_rast, paste0(pData, \"cache/gran_rast.rds\"))\ngran_outline <- muni %>%\n  filter(kommunenummer == \"3446\")\ntm_shape(st_downsample(gran_rast, 10))+\n  tm_raster(col=\"w_mean\")+\n  tm_shape(gran_outline)+\n  tm_borders(col=\"red\")\ngran_rast_masked <- gran_rast\ngran_rast_masked[mire_gran == 0] <- NA\ntm_shape(st_downsample(gran_rast_masked, 10))+\n  tm_raster(col=\"w_mean\",\n            palette = \"red\")+\n  tm_shape(gran_outline)+\n  tm_borders(col=\"red\")"},{"path":"Functional-plant-indicators-wetland.html","id":"Functional-plant-indicators-wetland","chapter":"6 Functional Plant Indicators - Wetlands","heading":"6 Functional Plant Indicators - Wetlands","text":"Norwegian name: PlanteindikatorerAuthor date:Joachim TöpperMay 2023Indicators described chaper:MoistureLightpHNitrogen","code":""},{"path":"Functional-plant-indicators-wetland.html","id":"intro-fpiw","chapter":"6 Functional Plant Indicators - Wetlands","heading":"6.1 Introduction","text":"Functional plant indicators can used describe functional signature plant communities calculating community-weighted means plant indicator values plant communities (Diekmann 2003). functional signature plant communities may indicative ecosystem identity, depending functional plant indicator look (cf. Töpper et al. 2018). instance, using indicator moisture one find functional signature higher moisture values plant communities mires compared e.g. grasslands forests. Deviations functional signature indicator beyond certain range indicator values (course natural variation functional signatures within ecosystem type) may related reduction ecological condition. , combine functional indicator data field sampled plant community data Norwegian nature monitoring program ANO (Tingstad et al. 2019) wetland ecosystems. calculate functional signature plant communities monitored sites respect light, moisture, pH nitrogen. functional signatures compared reference distributions functional signature, separately wetland ecosystem type, calculated ‘generalized species lists’ underlying Norwegian categorization system eco-diversity (Halvorsen et al. 2020). plant functional type indicators developed following principles technical protocol IBECA framework (Jakobsson et al. 2021, Töpper & Jakobsson 2021).","code":""},{"path":"Functional-plant-indicators-wetland.html","id":"about-the-underlying-data-3","chapter":"6 Functional Plant Indicators - Wetlands","heading":"6.2 About the underlying data","text":"‘plant functional indicator’ project wetlands, use three sets data building indicators ecological condition:test data use plant community data ANO monitoring scheme (cf. Tingstad et al. 2019)reference data use generalized species lists Norwegian categorization system eco-diversity (NiN) (cf. Halvorsen et al. 2020)Swedish plant indicator data light, moisture, pH, nitrogen Tyler et al. (2021)ANO monitoring data:\nANO stands ‘areal-representativ naturovervåking’, .e. ‘area representative nature monitoring’. 1000 sites randomly distributed across mainland Norway visitied within 5-year cycle. ANO site spans 500 x 500 m grid cell, data collection ANO site includes 12 evenly distributed vegetation analyses 1 x 1 m plots (12, evenly distributed points may water otherwise inaccessible). vegetation analyses, cover vascular plant species plot recorded. Every vegetation analysis accompanied assessment ecosystem plot lies , including ecosystem type additional variables related ecosystem-specific drivers state. wetland-analysis document, use plots classified one wetland ecosystem types Norwegian categorization system eco-diversity (NiN).\nanalysis document, use data available Miljødirektoratets kartkatalog (https://kartkatalog.miljodirektoratet./Dataset/Details/2054), comprises data first three ANO-years, 2019-2021, total 8887 plots 498 sites.ANO monitoring data:\nANO stands ‘areal-representativ naturovervåking’, .e. ‘area representative nature monitoring’. 1000 sites randomly distributed across mainland Norway visitied within 5-year cycle. ANO site spans 500 x 500 m grid cell, data collection ANO site includes 12 evenly distributed vegetation analyses 1 x 1 m plots (12, evenly distributed points may water otherwise inaccessible). vegetation analyses, cover vascular plant species plot recorded. Every vegetation analysis accompanied assessment ecosystem plot lies , including ecosystem type additional variables related ecosystem-specific drivers state. wetland-analysis document, use plots classified one wetland ecosystem types Norwegian categorization system eco-diversity (NiN).\nanalysis document, use data available Miljødirektoratets kartkatalog (https://kartkatalog.miljodirektoratet./Dataset/Details/2054), comprises data first three ANO-years, 2019-2021, total 8887 plots 498 sites.NiN reference data:\ngeneralized species lists underlying ecosystem categorization NiN represent expert-compiled species lists based empirical evidence literature expert knowledge systems species. lists, every species assigned abundance value 6-step scale, step representing range ‘expected combination frequency cover’ occurrence (1: < 1/32, 2: 1/32 - 1/8 , 3: 1/8 - 3/8, 4: 3/8 - 4/5, 5: 3/8 - 4/5 + dominance, 6: > 4/5). purpose project, steps simplified maximum ‘expected combination frequency cover’, whereby steps 4 & 5 assigned 0.6 0.8, respectively, order distinguish .NiN reference data:\ngeneralized species lists underlying ecosystem categorization NiN represent expert-compiled species lists based empirical evidence literature expert knowledge systems species. lists, every species assigned abundance value 6-step scale, step representing range ‘expected combination frequency cover’ occurrence (1: < 1/32, 2: 1/32 - 1/8 , 3: 1/8 - 3/8, 4: 3/8 - 4/5, 5: 3/8 - 4/5 + dominance, 6: > 4/5). purpose project, steps simplified maximum ‘expected combination frequency cover’, whereby steps 4 & 5 assigned 0.6 0.8, respectively, order distinguish .Swedish plant indicator set published Tyler et al. (2021) contains large collection plant indicators based Swedish flora, well representative Norwegian flora well. set, decided include indicator data light, moisture, pH, nitrogen wetlands thought subject potential change due shrub/tree encroachment, drainage, pollution.Swedish plant indicator set published Tyler et al. (2021) contains large collection plant indicators based Swedish flora, well representative Norwegian flora well. set, decided include indicator data light, moisture, pH, nitrogen wetlands thought subject potential change due shrub/tree encroachment, drainage, pollution.","code":""},{"path":"Functional-plant-indicators-wetland.html","id":"representativity-in-time-and-space-4","chapter":"6 Functional Plant Indicators - Wetlands","heading":"6.2.1 Representativity in time and space","text":"wetlands, ANO data contain 1351 plots 330 sites, principle distributed randomly across country. wetlands occur often certain regions Norway others, amount plots sites equal among Norway’s five regions. 1351 plots distributed across regions following way:Northern Norway: 416Central Norway: 361Eastern Norway: 294Western Norway: 150Southern Norway: 126","code":""},{"path":"Functional-plant-indicators-wetland.html","id":"temporal-coverage-3","chapter":"6 Functional Plant Indicators - Wetlands","heading":"6.2.2 Temporal coverage","text":"evaluation data cover first three years, 2019-2021, first 5-year-cycle ANO monitoring scheme. Thus actual time series data, indicator evaluation therefore include temporal analyses.","code":""},{"path":"Functional-plant-indicators-wetland.html","id":"collinearities-with-other-indicators-5","chapter":"6 Functional Plant Indicators - Wetlands","heading":"6.3 Collinearities with other indicators","text":"","code":""},{"path":"Functional-plant-indicators-wetland.html","id":"reference-state-and-values-1","chapter":"6 Functional Plant Indicators - Wetlands","heading":"6.4 Reference state and values","text":"","code":""},{"path":"Functional-plant-indicators-wetland.html","id":"reference-state","chapter":"6 Functional Plant Indicators - Wetlands","heading":"6.4.1 Reference state","text":"reference state defined via functional signature generalized species lists NiN (see also Töpper et al. 2018). bootstrapping species lists (see details ) calculating community-weighted means functional plant indicators every re-sampled community, describe reference state distribution indicator values respective plant functional indicator. distributions calculated minor ecosystem types (“grunntyper” “kartleggingsenheter” 1:5000 mapping scale) within major ecosystem types (hovedtyper) NiN. extensive discussion use reference communities can found Jakobsson et al. (2020).","code":""},{"path":"Functional-plant-indicators-wetland.html","id":"ref-values-fpiw","chapter":"6 Functional Plant Indicators - Wetlands","heading":"6.4.2 Reference values, thresholds for defining good ecological condition, minimum and/or maximum values","text":"analysis, derive scaling values statistical (, non-parametric) distributions (see Jakobsson et al. 2010). ecosystem sub-type plant functional indicator, reference value defined median value indicator value distribution. cases distributions naturally two-sided (see Heat-requirement indicator mountain assessment example one-sided plant functional indicator, Fremstad et al. 2022), deviation optimal state thus may occur direction (e.g. indicating low high pH), need define two threshold values good ecological condition well minimum maximum value. line previous assessments ecological condition Norwegian forests mountains, define lower upper threshold value via 95% confidence interval reference distribution, .e. 0.025 0.975 quantiles. minimum maximum values given minimum maximum possible indicator values respective plant functional indicator. details scaling principles IBECA, please see Töpper & Jakobsson (2021).","code":""},{"path":"Functional-plant-indicators-wetland.html","id":"uncertainties-4","chapter":"6 Functional Plant Indicators - Wetlands","heading":"6.5 Uncertainties","text":"can calculate mean indicator value (scaling) every region (delimited area interest) well corresponding standard error measure spatial uncertainty geographical area.","code":""},{"path":"Functional-plant-indicators-wetland.html","id":"references-5","chapter":"6 Functional Plant Indicators - Wetlands","heading":"6.6 References","text":"Diekmann, M. 2003. Species indicator values important tool applied plant ecology - review. Basic Applied Ecology 4: 493-506, doi:10.1078/1439-1791-00185Framstad, E., Kolstad, . L., Nybø, S., Töpper, J. & Vandvik, V. 2022. condition forest mountain ecosystems Norway. Assessment IBECA method. NINA Report 2100. Norwegian Institute Nature Research.Halvorsen, R., Skarpaas, O., Bryn, ., Bratli, H., Erikstad, L., Simensen, T., & Lieungh, E. (2020). Towards systematics ecodiversity: EcoSyst framework. Global Ecology Biogeography, 29(11), 1887-1906. doi:10.1111/geb.13164Jakobsson, S., Töpper, J.P., Evju, M., Framstad, E., Lyngstad, ., Pedersen, B., Sickel, H., Sverdrup-Thygeson, ., Vandvik. V., Velle, L.G., Aarrestad, P.. & Nybø, S. 2020. Setting reference levels limits good ecological condition terrestrial ecosystems. Insights case study based IBECA approach. Ecological Indicators 116: 106492.Jakobsson, S., Evju, M., Framstad, E., Imbert, ., Lyngstad, ., Sickel, H., Sverdrup-Thygeson, ., Töpper, J., Vandvik, V., Velle, L.G., Aarrestad, P.. & Nybø, S. 2021. index-based assessment ecological condition links international frameworks. Ecological Indicators 124: 107252.Tingstad, L., Evju, M., Sickel, H., & Töpper, J. 2019. Utvikling av nasjonal arealrepresentativ naturovervåking (ANO). Forslag til gjennomføring, protokoller og kostnadsvurderinger med utgangspunkt erfaringer fra uttesting Trøndelag. NINA Rapport 1642.Töpper, J. & Jakobsson, S. 2021. Index-Based Ecological Condition Assessment (IBECA) - Technical protocol, version 1.0. NINA Report 1967. Norwegian Institute Nature Research.Töpper, J., Velle, L.G. & Vandvik, V. 2018. Developing method assessment ecological state based indicator values Ellenberg Grime (revised edition). NINA Report 1529b. Norwegian Institute Nature Research.Tyler, T., Herbertsson, L., Olofsson, J., & Olsson, P. . 2021. Ecological indicator traits values Swedish vascular plants. Ecological -dicators, 120. doi:10.1016/j.ecolind.2020.106923","code":""},{"path":"Functional-plant-indicators-wetland.html","id":"analyses-fpiw","chapter":"6 Functional Plant Indicators - Wetlands","heading":"6.7 Analyses","text":"","code":""},{"path":"Functional-plant-indicators-wetland.html","id":"data-sets-3","chapter":"6 Functional Plant Indicators - Wetlands","heading":"6.7.1 Data sets","text":"ANO dataPlant indicators Tyler et al. (2021)Generalized species lists NiN","code":""},{"path":"Functional-plant-indicators-wetland.html","id":"data-handling","chapter":"6 Functional Plant Indicators - Wetlands","heading":"6.7.1.1 Data handling","text":"Checking errorsChecking species nomenclature different species lists make species indicator data possible mergeMerging indicator data monitoring data indicator data reference data\n(shown , documented code)leaving us monitoring data including plant indicators (ANO.sp.ind) reference data including plant indicators (NiN.wetland.cov)ecosystem type NiN species list, can calculate community weighted mean (CWM) relevant functional plant indicators.\nwetland ecosystem testing “Light”, “Moisture”, “Soil_reaction_pH”, “Nitrogen”. order get distributions CWMs rather one single value (comparison empirical testing data) NiN lists can bootstrapped.","code":"\nhead(ANO.sp.ind)\n#>      Species art_dekning\n#> 1 Abies alba           0\n#> 2 Abies alba           0\n#> 3 Abies alba           0\n#> 4 Abies alba           0\n#> 5 Abies alba           0\n#> 6 Abies alba           0\n#>                           ParentGlobalID Light Moisture\n#> 1 {CB1796B9-01F5-4109-B44E-4582CA855F93}     2        5\n#> 2 {AB9ED5C2-E906-4C73-B543-EC6CB28B39D5}     2        5\n#> 3 {32A9B462-5483-4D47-ADAF-78F11AF201AA}     2        5\n#> 4 {004C000D-459B-4244-96F4-4FF8B06454D4}     2        5\n#> 5 {B7DD61EE-A113-4486-A4B8-D50ACAAC648B}     2        5\n#> 6 {0431743B-F268-4819-98F7-FFB7006E55BA}     2        5\n#>   Soil_reaction_pH Nitrogen\n#> 1                5        5\n#> 2                5        5\n#> 3                5        5\n#> 4                5        5\n#> 5                5        5\n#> 6                5        5\nhead(NiN.wetland.cov)\n#>                        sp V3-C1a V3-C1b V3-C1c V3-C1d\n#> 1    Abietinella abietina      0      0      0      0\n#> 2        Acer platanoides      0      0      0      0\n#> 3    Achillea millefolium      0      0      0      0\n#> 4       Achillea ptarmica      0      0      0      0\n#> 5         Acinos arvensis      0      0      0      0\n#> 6 Aconitum septentrionale      0      0      0      0\n#>   V3-C1e V1-C1a V1-C1b V1-C1c V1-C1d V1-C1e V1-C2a V1-C2b\n#> 1      0      0      0      0      0      0      0      0\n#> 2      0      0      0      0      0      0      0      0\n#> 3      0      0      0      0      0      0      0      0\n#> 4      0      0      0      0      0      0      0      0\n#> 5      0      0      0      0      0      0      0      0\n#> 6      0      0      0      0      0      0      0      0\n#>   V1-C2c V1-C2d V1-C3a V1-C3b V1-C3c V1-C3d V1-C4a V1-C4b\n#> 1      0      0      0      0      0      0      0      0\n#> 2      0      0      0      0      0      0      0      0\n#> 3      0      0      0      0      0      0      0      0\n#> 4      0      0      0      0      0      0      0      0\n#> 5      0      0      0      0      0      0      0      0\n#> 6      0      0      0      0      0      0      0      0\n#>   V1-C4c V1-C4d V1-C4e V1-C4f V1-C4g V1-C4h V3-C2 V1-C5\n#> 1      0      0      0      0      0      0     0     0\n#> 2      0      0      0      0      0      0     0     0\n#> 3      0      0      0      0      0      0     0     0\n#> 4      0      0      0      0      0      0     0     0\n#> 5      0      0      0      0      0      0     0     0\n#> 6      0      0      0      0      0      0     0     0\n#>   V1-C6a V1-C6b V1-C7a V1-C7b V1-C8a V1-C8b V2-C1a V2-C1b\n#> 1      0      0      0      0      0      0      0      0\n#> 2      0      0      0      0      0      0      0      0\n#> 3      0      0      0      0      0      0      0      0\n#> 4      0      0      0      0      0      0      0      0\n#> 5      0      0      0      0      0      0      0      0\n#> 6      0      0      0      0      0      0      0      0\n#>   V2-C2a V2-C2b V2-C3a V2-C3b V4-C2 V4-C3 V8-C1 V8-C2 V8-C3\n#> 1      0      0      0      0     0     0     0     0     0\n#> 2      0      0      0      0     0     0     0     0     0\n#> 3      0      0      0      0     0     0     0     0     0\n#> 4      0      0      0      0     0     0     0     0     0\n#> 5      0      0      0      0     0     0     0     0     0\n#> 6      0      0      0      0     0     0     0     0     0\n#>   Light Moisture Soil_reaction_pH Nitrogen\n#> 1    NA       NA               NA       NA\n#> 2     4        4                6        5\n#> 3     6        2                5        5\n#> 4     5        6                4        4\n#> 5     7        1                7        3\n#> 6     4        5                7        7"},{"path":"Functional-plant-indicators-wetland.html","id":"bootstrap-function-for-frequency-abundance","chapter":"6 Functional Plant Indicators - Wetlands","heading":"6.7.1.1.1 bootstrap function for frequency abundance","text":"function calculate community weighted means selected indicator values (ind)species lists (sp) given abundances percent (scale 0 1) one ‘sites’ (abun)given number iterations (iter),species given certain minimum abundance occurring bootstraps (obl), andwith given re-sampling ratio original species list (rat)every bootstrap iteration abundance sampled species can randomly changed limited amount wished introducing re-sampling abundance values adjacent abundance steps certain probability (var.abun)Running bootstrapsThis results R-list slot every selected indicator, every slot ’s data frame many columns NiN species lists many rows iterations bootstrap.\nNext, need derive scaling values bootstrap-lists (columns) every mapping unit NiN. , define things following way:Median = reference values0.025 0.975 quantiles = lower upper limit valuesmin max respective indicator’s scale = min/max valuesOnce test data (ANO) scaling values reference data (NiN) place, can calculate CWMs selected indicators ANO community data scale scaling values reference distribution. Note scale ANO plot’s CWM either lower threshold value min value upper threshold value max value based whether CWM smaller higher reference value. Since scaled values sides range 0 1, generate separate lower upper indicators plant functional indicator type. ANO plot can scaled value either lower upper indicator (one ‘NA’), except unlikely event CWM exactly matches reference value, case lower upper indicator receive scaled indicator value 1.scaling functionWe can prepare list data frames hold results perform scaling according principles described NINA report 1967 (Töpper Jakobsson 2021)","code":"\ncolnames(NiN.wetland)\n# 1st column is the species\n# 2nd-46th column is the abundances of sp in different ecosystem types\n# 47th-50th column is the indicator values of the respective species\n# we choose 1000 iterations\n# species with abundance 1 (i.e. a max of 100%, must be included in each sample)\n# each sample re-samples 2/3 of the number of species\n# the abundance of the re-sampled species may vary (see bootstrap function for details)\nwetland.ref.cov <- indBoot.freq(sp=NiN.wetland.cov[,1],abun=NiN.wetland.cov[,2:46],ind=NiN.wetland.cov[,47:50],\n                          iter=1000,obl=1,rat=2/3,var.abun=T)\n\n# fixing NaNs\nfor (i in 1:length(wetland.ref.cov) ) {\n  for (j in 1:ncol(wetland.ref.cov[[i]]) ) {\n    v <- wetland.ref.cov[[i]][,j]\n    v[is.nan(v)] <- NA\n    wetland.ref.cov[[i]][,j] <- v\n  }\n}\nhead(wetland.ref.cov[[1]])\n#>     V3-C1a   V3-C1b   V3-C1c   V3-C1d   V3-C1e   V1-C1a\n#> 1 6.336842 5.702703 5.891986 5.407407 5.284661 5.682713\n#> 2 6.162896 5.603412 5.233202 5.353870 5.077465 5.908840\n#> 3 5.807692 6.099119 5.567627 5.296296 5.269912 6.087065\n#> 4 6.775087 5.789572 5.493739 5.475034 5.269912 6.352518\n#> 5 5.903114 5.789572 5.641694 5.492308 5.007634 6.364508\n#> 6 6.336842 5.726054 5.668407 5.569579 5.178284 5.616307\n#>     V1-C1b   V1-C1c   V1-C1d   V1-C1e   V1-C2a   V1-C2b\n#> 1 5.723592 5.291436 5.353811 5.171986 5.823009 5.360731\n#> 2 5.667160 5.929448 5.263294 5.245902 6.299618 5.416517\n#> 3 6.065979 5.575145 5.536041 5.169304 5.894265 5.898420\n#> 4 5.483051 5.570014 5.728625 5.022152 5.849462 5.354067\n#> 5 5.517544 5.720264 5.458237 5.034188 5.867384 5.418605\n#> 6 5.634868 5.710968 5.466031 4.925319 5.891344 5.359712\n#>     V1-C2c   V1-C2d   V1-C3a   V1-C3b   V1-C3c   V1-C3d\n#> 1 5.617886 5.255973 5.879501 5.451770 5.150421 5.454386\n#> 2 5.716802 5.514938 6.344234 5.197347 5.304290 5.319415\n#> 3 5.455844 5.415879 5.713128 5.320140 5.617048 5.505593\n#> 4 5.591304 5.561783 5.722591 5.573379 5.204703 5.590814\n#> 5 5.108579 5.505747 5.830116 5.317019 5.466457 5.370787\n#> 6 5.739508 5.353218 5.906937 5.390173 5.092166 5.493927\n#>     V1-C4a   V1-C4b   V1-C4c   V1-C4d   V1-C4e   V1-C4f\n#> 1 6.036179 5.361275 5.287129 5.246544 5.826291 6.096953\n#> 2 5.798913 5.616487 5.851117 5.579498 6.095665 5.593711\n#> 3 6.293651 5.648649 5.619327 5.577703 5.855586 5.934783\n#> 4 5.889374 5.685484 5.371715 5.093677 5.851802 5.616374\n#> 5 5.776280 5.713755 5.469660 5.717724 5.981818 5.697906\n#> 6 6.177054 5.651599 5.235872 5.522613 5.779343 5.812823\n#>     V1-C4g   V1-C4h    V3-C2    V1-C5   V1-C6a   V1-C6b\n#> 1 5.435681 4.918367 4.994775 4.727076 4.996255 4.630435\n#> 2 5.651721 5.438084 5.015432 4.652138 5.033333 4.773573\n#> 3 5.580581 5.851128 4.773709 4.726855 4.904824 4.773680\n#> 4 5.151030 5.386395 4.870244 4.667209 4.994337 4.894553\n#> 5 5.566054 5.235374 4.886616 4.814668 4.880233 4.836431\n#> 6 5.526852 5.490647 4.876712 4.749831 5.161597 4.823015\n#>     V1-C7a   V1-C7b   V1-C8a   V1-C8b   V2-C1a   V2-C1b\n#> 1 5.005076 4.927380 4.901750 4.761329 4.395683 4.030844\n#> 2 4.801927 4.846557 5.127968 4.896014 4.188559 4.155105\n#> 3 4.572449 4.504233 5.070941 4.808081 4.110694 4.091158\n#> 4 4.884762 4.812344 4.881336 5.094451 4.260394 4.165308\n#> 5 4.783305 4.893412 4.988858 4.848684 4.273535 4.234498\n#> 6 4.814433 4.869048 4.859482 4.702290 4.174721 4.005499\n#>     V2-C2a   V2-C2b   V2-C3a   V2-C3b    V4-C2    V4-C3\n#> 1 4.660793 3.813056 4.138365 3.871470 4.859013 4.983607\n#> 2 4.615487 4.059268 4.056991 3.942257 5.042409 5.249798\n#> 3 4.479858 3.668596 4.187162 4.057981 5.047048 4.992795\n#> 4 4.733990 3.914540 4.233787 4.077534 4.738647 5.027458\n#> 5 4.586890 3.797063 4.404070 3.836165 4.844905 4.734485\n#> 6 4.520000 4.033181 4.377852 3.859554 4.999081 4.966232\n#>      V8-C1    V8-C2    V8-C3\n#> 1 4.767647 4.595033 4.620053\n#> 2 4.660854 4.547687 4.647333\n#> 3 4.679577 4.609576 4.564313\n#> 4 4.835616 4.512004 4.539221\n#> 5 4.500463 4.502172 4.762053\n#> 6 4.805742 4.491489 4.608948#>     V3-C1a   V3-C1b   V3-C1c   V3-C1d   V3-C1e   V1-C1a\n#> 1 6.336842 5.702703 5.891986 5.407407 5.284661 5.682713\n#> 2 6.162896 5.603412 5.233202 5.353870 5.077465 5.908840\n#> 3 5.807692 6.099119 5.567627 5.296296 5.269912 6.087065\n#> 4 6.775087 5.789572 5.493739 5.475034 5.269912 6.352518\n#> 5 5.903114 5.789572 5.641694 5.492308 5.007634 6.364508\n#> 6 6.336842 5.726054 5.668407 5.569579 5.178284 5.616307\n#>     V1-C1b   V1-C1c   V1-C1d   V1-C1e   V1-C2a   V1-C2b\n#> 1 5.723592 5.291436 5.353811 5.171986 5.823009 5.360731\n#> 2 5.667160 5.929448 5.263294 5.245902 6.299618 5.416517\n#> 3 6.065979 5.575145 5.536041 5.169304 5.894265 5.898420\n#> 4 5.483051 5.570014 5.728625 5.022152 5.849462 5.354067\n#> 5 5.517544 5.720264 5.458237 5.034188 5.867384 5.418605\n#> 6 5.634868 5.710968 5.466031 4.925319 5.891344 5.359712\n#>     V1-C2c   V1-C2d   V1-C3a   V1-C3b   V1-C3c   V1-C3d\n#> 1 5.617886 5.255973 5.879501 5.451770 5.150421 5.454386\n#> 2 5.716802 5.514938 6.344234 5.197347 5.304290 5.319415\n#> 3 5.455844 5.415879 5.713128 5.320140 5.617048 5.505593\n#> 4 5.591304 5.561783 5.722591 5.573379 5.204703 5.590814\n#> 5 5.108579 5.505747 5.830116 5.317019 5.466457 5.370787\n#> 6 5.739508 5.353218 5.906937 5.390173 5.092166 5.493927\n#>     V1-C4a   V1-C4b   V1-C4c   V1-C4d   V1-C4e   V1-C4f\n#> 1 6.036179 5.361275 5.287129 5.246544 5.826291 6.096953\n#> 2 5.798913 5.616487 5.851117 5.579498 6.095665 5.593711\n#> 3 6.293651 5.648649 5.619327 5.577703 5.855586 5.934783\n#> 4 5.889374 5.685484 5.371715 5.093677 5.851802 5.616374\n#> 5 5.776280 5.713755 5.469660 5.717724 5.981818 5.697906\n#> 6 6.177054 5.651599 5.235872 5.522613 5.779343 5.812823\n#>     V1-C4g   V1-C4h    V3-C2    V1-C5   V1-C6a   V1-C6b\n#> 1 5.435681 4.918367 4.994775 4.727076 4.996255 4.630435\n#> 2 5.651721 5.438084 5.015432 4.652138 5.033333 4.773573\n#> 3 5.580581 5.851128 4.773709 4.726855 4.904824 4.773680\n#> 4 5.151030 5.386395 4.870244 4.667209 4.994337 4.894553\n#> 5 5.566054 5.235374 4.886616 4.814668 4.880233 4.836431\n#> 6 5.526852 5.490647 4.876712 4.749831 5.161597 4.823015\n#>     V1-C7a   V1-C7b   V1-C8a   V1-C8b   V2-C1a   V2-C1b\n#> 1 5.005076 4.927380 4.901750 4.761329 4.395683 4.030844\n#> 2 4.801927 4.846557 5.127968 4.896014 4.188559 4.155105\n#> 3 4.572449 4.504233 5.070941 4.808081 4.110694 4.091158\n#> 4 4.884762 4.812344 4.881336 5.094451 4.260394 4.165308\n#> 5 4.783305 4.893412 4.988858 4.848684 4.273535 4.234498\n#> 6 4.814433 4.869048 4.859482 4.702290 4.174721 4.005499\n#>     V2-C2a   V2-C2b   V2-C3a   V2-C3b    V4-C2    V4-C3\n#> 1 4.660793 3.813056 4.138365 3.871470 4.859013 4.983607\n#> 2 4.615487 4.059268 4.056991 3.942257 5.042409 5.249798\n#> 3 4.479858 3.668596 4.187162 4.057981 5.047048 4.992795\n#> 4 4.733990 3.914540 4.233787 4.077534 4.738647 5.027458\n#> 5 4.586890 3.797063 4.404070 3.836165 4.844905 4.734485\n#> 6 4.520000 4.033181 4.377852 3.859554 4.999081 4.966232\n#>      V8-C1    V8-C2    V8-C3\n#> 1 4.767647 4.595033 4.620053\n#> 2 4.660854 4.547687 4.647333\n#> 3 4.679577 4.609576 4.564313\n#> 4 4.835616 4.512004 4.539221\n#> 5 4.500463 4.502172 4.762053\n#> 6 4.805742 4.491489 4.608948\n#>  [1] V3-C1a V3-C1b V3-C1c V3-C1d V3-C1e V1-C1a V1-C1b V1-C1c\n#>  [9] V1-C1d V1-C1e V1-C2a V1-C2b V1-C2c V1-C2d V1-C3a V1-C3b\n#> [17] V1-C3c V1-C3d V1-C4a V1-C4b V1-C4c V1-C4d V1-C4e V1-C4f\n#> [25] V1-C4g V1-C4h V3-C2  V1-C5  V1-C6a V1-C6b V1-C7a V1-C7b\n#> [33] V1-C8a V1-C8b V2-C1a V2-C1b V2-C2a V2-C2b V2-C3a V2-C3b\n#> [41] V4-C2  V4-C3  V8-C1  V8-C2  V8-C3 \n#> <0 rows> (or 0-length row.names)\n#>  [1] \"V3-C1\" \"V1-C1\" \"V1-C2\" \"V1-C3\" \"V1-C4\" \"V3-C2\" \"V1-C5\"\n#>  [8] \"V1-C6\" \"V1-C7\" \"V1-C8\" \"V2-C1\" \"V2-C2\" \"V2-C3\" \"V4-C2\"\n#> [15] \"V4-C3\" \"V8-C1\" \"V8-C2\" \"V8-C3\"\n#>  [1] \"V3-C1a\" \"V3-C1b\" \"V3-C1c\" \"V3-C1d\" \"V3-C1e\" \"V1-C1a\"\n#>  [7] \"V1-C1b\" \"V1-C1c\" \"V1-C1d\" \"V1-C1e\" \"V1-C2a\" \"V1-C2b\"\n#> [13] \"V1-C2c\" \"V1-C2d\" \"V1-C3a\" \"V1-C3b\" \"V1-C3c\" \"V1-C3d\"\n#> [19] \"V1-C4a\" \"V1-C4b\" \"V1-C4c\" \"V1-C4d\" \"V1-C4e\" \"V1-C4f\"\n#> [25] \"V1-C4g\" \"V1-C4h\" \"V3-C2\"  \"V1-C5\"  \"V1-C6a\" \"V1-C6b\"\n#> [31] \"V1-C7a\" \"V1-C7b\" \"V1-C8a\" \"V1-C8b\" \"V2-C1a\" \"V2-C1b\"\n#> [37] \"V2-C2a\" \"V2-C2b\" \"V2-C3a\" \"V2-C3b\" \"V4-C2\"  \"V4-C3\" \n#> [43] \"V8-C1\"  \"V8-C2\"  \"V8-C3\"\n#>  [1] \"V3-C1\" \"V1-C1\" \"V1-C2\" \"V1-C3\" \"V1-C4\" \"V1-C6\" \"V1-C7\"\n#>  [8] \"V1-C8\" \"V2-C1\" \"V2-C2\" \"V2-C3\"\n#> [1] 1 2 3 4 5\n#>          V1       V2       V3       V4       V5       V6\n#> 1  4.736150 4.900265 5.120000 5.201878 5.736585 6.151852\n#> 2  4.597880 4.760764 4.902329 5.391473 5.821132 6.265910\n#> 3  4.610424 4.901870 5.232242 6.708205 7.088321 7.496453\n#> 4  4.677531 4.996095 5.309336 6.599488 6.935913 7.284055\n#> 5  4.464570 4.709785 4.972819 6.803539 7.217742 7.663696\n#> 6  4.425727 4.586035 4.779277 6.925680 7.251258 7.577229\n#> 7  4.490343 4.635103 4.790331 7.024416 7.382590 7.755543\n#> 8  4.892675 5.594595 6.567474 5.528728 6.907166 8.486166\n#> 9  4.958721 5.575057 6.315900 5.735756 7.280132 8.718040\n#> 10 5.139566 5.522530 6.264477 6.426842 7.915167 8.924438\n#> 11 5.089261 5.450281 6.152334 7.113426 8.216718 9.016390\n#> 12 5.126794 5.647878 6.162793 7.065646 8.040734 8.935004\n#> 13 4.525242 4.816224 5.124243 6.016056 7.233970 8.688171\n#> 14 4.504224 4.804565 5.059866 6.326991 7.271581 8.463120\n#> 15 4.558245 4.915094 5.303735 6.258498 7.091729 7.784715\n#> 16 3.974819 4.173047 4.598703 5.112448 5.859056 8.126484\n#> 17 3.685444 4.256174 4.700616 5.513549 6.488092 7.920221\n#> 18 3.631843 4.125515 4.457248 6.004292 6.772113 7.759210\n#>          V7       V8       V9      V10      V11      V12\n#> 1  1.831766 2.243827 2.533659 1.811728 1.952862 2.142723\n#> 2  2.155809 2.516520 2.836431 1.853110 2.167561 2.438285\n#> 3  3.437916 3.787654 4.212773 3.008428 3.323729 3.678983\n#> 4  3.953983 4.388411 4.813829 3.262604 3.807000 4.234730\n#> 5  3.889345 4.163711 4.486426 4.148721 4.462636 4.812027\n#> 6  4.381745 4.575937 4.795270 5.142488 5.459677 5.816705\n#> 7  4.682191 4.876376 5.070794 5.629958 5.900868 6.152190\n#> 8  1.494071 2.013841 2.868778 1.072464 1.494737 1.996790\n#> 9  1.697084 2.099490 3.207349 1.389752 1.667114 2.134328\n#> 10 2.076494 2.837740 3.691609 1.567785 1.974614 2.519928\n#> 11 2.768193 3.604344 4.317389 1.746634 2.396491 3.048414\n#> 12 3.410753 4.508963 5.601644 2.053753 2.685903 3.184157\n#> 13 2.655389 3.091580 3.699116 2.303992 2.761761 3.191950\n#> 14 3.246374 3.547120 3.916825 2.846378 3.186189 3.487493\n#> 15 3.808178 4.212409 4.677554 3.058802 3.517028 4.025923\n#> 16 2.628539 2.942611 3.685835 2.899263 3.211879 3.767787\n#> 17 3.196779 3.618644 4.074977 3.605832 4.032121 4.559970\n#> 18 3.783875 4.097649 4.434308 4.489434 4.900636 5.338214\n#>      NiN\n#> 1  V3-C2\n#> 2  V1-C5\n#> 3  V4-C2\n#> 4  V4-C3\n#> 5  V8-C1\n#> 6  V8-C2\n#> 7  V8-C3\n#> 8  V3-C1\n#> 9  V1-C1\n#> 10 V1-C2\n#> 11 V1-C3\n#> 12 V1-C4\n#> 13 V1-C6\n#> 14 V1-C7\n#> 15 V1-C8\n#> 16 V2-C1\n#> 17 V2-C2\n#> 18 V2-C3\n#>      V1   V2   V3   V4   V5   V6   V7   V8   V9  V10  V11\n#> 1  4.74 4.90 5.12 5.20 5.74 6.15 1.83 2.24 2.53 1.81 1.95\n#> 2  4.60 4.76 4.90 5.39 5.82 6.27 2.16 2.52 2.84 1.85 2.17\n#> 3  4.61 4.90 5.23 6.71 7.09 7.50 3.44 3.79 4.21 3.01 3.32\n#> 4  4.68 5.00 5.31 6.60 6.94 7.28 3.95 4.39 4.81 3.26 3.81\n#> 5  4.46 4.71 4.97 6.80 7.22 7.66 3.89 4.16 4.49 4.15 4.46\n#> 6  4.43 4.59 4.78 6.93 7.25 7.58 4.38 4.58 4.80 5.14 5.46\n#> 7  4.49 4.64 4.79 7.02 7.38 7.76 4.68 4.88 5.07 5.63 5.90\n#> 8  4.89 5.59 6.57 5.53 6.91 8.49 1.49 2.01 2.87 1.07 1.49\n#> 9  4.96 5.58 6.32 5.74 7.28 8.72 1.70 2.10 3.21 1.39 1.67\n#> 10 5.14 5.52 6.26 6.43 7.92 8.92 2.08 2.84 3.69 1.57 1.97\n#> 11 5.09 5.45 6.15 7.11 8.22 9.02 2.77 3.60 4.32 1.75 2.40\n#> 12 5.13 5.65 6.16 7.07 8.04 8.94 3.41 4.51 5.60 2.05 2.69\n#> 13 4.53 4.82 5.12 6.02 7.23 8.69 2.66 3.09 3.70 2.30 2.76\n#> 14 4.50 4.80 5.06 6.33 7.27 8.46 3.25 3.55 3.92 2.85 3.19\n#> 15 4.56 4.92 5.30 6.26 7.09 7.78 3.81 4.21 4.68 3.06 3.52\n#> 16 3.97 4.17 4.60 5.11 5.86 8.13 2.63 2.94 3.69 2.90 3.21\n#> 17 3.69 4.26 4.70 5.51 6.49 7.92 3.20 3.62 4.07 3.61 4.03\n#> 18 3.63 4.13 4.46 6.00 6.77 7.76 3.78 4.10 4.43 4.49 4.90\n#>     V12\n#> 1  2.14\n#> 2  2.44\n#> 3  3.68\n#> 4  4.23\n#> 5  4.81\n#> 6  5.82\n#> 7  6.15\n#> 8  2.00\n#> 9  2.13\n#> 10 2.52\n#> 11 3.05\n#> 12 3.18\n#> 13 3.19\n#> 14 3.49\n#> 15 4.03\n#> 16 3.77\n#> 17 4.56\n#> 18 5.34\n#>    Light_q2.5      Light_q50      Light_q97.5   \n#>  Min.   :3.632   Min.   :4.126   Min.   :4.457  \n#>  1st Qu.:4.471   1st Qu.:4.654   1st Qu.:4.818  \n#>  Median :4.578   Median :4.858   Median :5.122  \n#>  Mean   :4.561   Mean   :4.909   Mean   :5.323  \n#>  3rd Qu.:4.854   3rd Qu.:5.337   3rd Qu.:5.942  \n#>  Max.   :5.140   Max.   :5.648   Max.   :6.567  \n#>    Moist_q2.5      Moist_q50      Moist_q97.5   \n#>  Min.   :5.112   Min.   :5.737   Min.   :6.152  \n#>  1st Qu.:5.580   1st Qu.:6.806   1st Qu.:7.599  \n#>  Median :6.293   Median :7.155   Median :7.852  \n#>  Mean   :6.209   Mean   :7.028   Mean   :7.945  \n#>  3rd Qu.:6.780   3rd Qu.:7.278   3rd Qu.:8.638  \n#>  Max.   :7.113   Max.   :8.217   Max.   :9.016  \n#>     pH_q2.5          pH_q50         pH_q97.5    \n#>  Min.   :1.494   Min.   :2.014   Min.   :2.534  \n#>  1st Qu.:2.274   1st Qu.:2.864   1st Qu.:3.687  \n#>  Median :3.222   Median :3.611   Median :4.144  \n#>  Mean   :3.061   Mean   :3.507   Mean   :4.051  \n#>  3rd Qu.:3.802   3rd Qu.:4.200   3rd Qu.:4.630  \n#>  Max.   :4.682   Max.   :4.876   Max.   :5.602  \n#>  Nitrogen_q2.5    Nitrogen_q50   Nitrogen_q97.5 \n#>  Min.   :1.072   Min.   :1.495   Min.   :1.997  \n#>  1st Qu.:1.822   1st Qu.:2.225   1st Qu.:2.652  \n#>  Median :2.873   Median :3.199   Median :3.583  \n#>  Mean   :2.883   Mean   :3.272   Mean   :3.696  \n#>  3rd Qu.:3.520   3rd Qu.:3.976   3rd Qu.:4.479  \n#>  Max.   :5.630   Max.   :5.901   Max.   :6.152  \n#>      NiN           \n#>  Length:18         \n#>  Class :character  \n#>  Mode  :character  \n#>                    \n#>                    \n#> \n#>    Light_q2.5 Light_q50 Light_q97.5 Moist_q2.5 Moist_q50\n#> 1    4.736150  4.900265    5.120000   5.201878  5.736585\n#> 2    4.597880  4.760764    4.902329   5.391473  5.821132\n#> 3    4.610424  4.901870    5.232242   6.708205  7.088321\n#> 4    4.677531  4.996095    5.309336   6.599488  6.935913\n#> 5    4.464570  4.709785    4.972819   6.803539  7.217742\n#> 6    4.425727  4.586035    4.779277   6.925680  7.251258\n#> 7    4.490343  4.635103    4.790331   7.024416  7.382590\n#> 8    4.892675  5.594595    6.567474   5.528728  6.907166\n#> 9    4.958721  5.575057    6.315900   5.735756  7.280132\n#> 10   5.139566  5.522530    6.264477   6.426842  7.915167\n#> 11   5.089261  5.450281    6.152334   7.113426  8.216718\n#> 12   5.126794  5.647878    6.162793   7.065646  8.040734\n#> 13   4.525242  4.816224    5.124243   6.016056  7.233970\n#> 14   4.504224  4.804565    5.059866   6.326991  7.271581\n#> 15   4.558245  4.915094    5.303735   6.258498  7.091729\n#> 16   3.974819  4.173047    4.598703   5.112448  5.859056\n#> 17   3.685444  4.256174    4.700616   5.513549  6.488092\n#> 18   3.631843  4.125515    4.457248   6.004292  6.772113\n#>    Moist_q97.5  pH_q2.5   pH_q50 pH_q97.5 Nitrogen_q2.5\n#> 1     6.151852 1.831766 2.243827 2.533659      1.811728\n#> 2     6.265910 2.155809 2.516520 2.836431      1.853110\n#> 3     7.496453 3.437916 3.787654 4.212773      3.008428\n#> 4     7.284055 3.953983 4.388411 4.813829      3.262604\n#> 5     7.663696 3.889345 4.163711 4.486426      4.148721\n#> 6     7.577229 4.381745 4.575937 4.795270      5.142488\n#> 7     7.755543 4.682191 4.876376 5.070794      5.629958\n#> 8     8.486166 1.494071 2.013841 2.868778      1.072464\n#> 9     8.718040 1.697084 2.099490 3.207349      1.389752\n#> 10    8.924438 2.076494 2.837740 3.691609      1.567785\n#> 11    9.016390 2.768193 3.604344 4.317389      1.746634\n#> 12    8.935004 3.410753 4.508963 5.601644      2.053753\n#> 13    8.688171 2.655389 3.091580 3.699116      2.303992\n#> 14    8.463120 3.246374 3.547120 3.916825      2.846378\n#> 15    7.784715 3.808178 4.212409 4.677554      3.058802\n#> 16    8.126484 2.628539 2.942611 3.685835      2.899263\n#> 17    7.920221 3.196779 3.618644 4.074977      3.605832\n#> 18    7.759210 3.783875 4.097649 4.434308      4.489434\n#>    Nitrogen_q50 Nitrogen_q97.5    NiN\n#> 1      1.952862       2.142723 V3-C-2\n#> 2      2.167561       2.438285 V1-C-5\n#> 3      3.323729       3.678983 V4-C-2\n#> 4      3.807000       4.234730 V4-C-3\n#> 5      4.462636       4.812027 V8-C-1\n#> 6      5.459677       5.816705 V8-C-2\n#> 7      5.900868       6.152190 V8-C-3\n#> 8      1.494737       1.996790 V3-C-1\n#> 9      1.667114       2.134328 V1-C-1\n#> 10     1.974614       2.519928 V1-C-2\n#> 11     2.396491       3.048414 V1-C-3\n#> 12     2.685903       3.184157 V1-C-4\n#> 13     2.761761       3.191950 V1-C-6\n#> 14     3.186189       3.487493 V1-C-7\n#> 15     3.517028       4.025923 V1-C-8\n#> 16     3.211879       3.767787 V2-C-1\n#> 17     4.032121       4.559970 V2-C-2\n#> 18     4.900636       5.338214 V2-C-3\n#>          N1 hoved  grunn county region       Ind       Rv\n#> 1   wetland    NA V3-C-2    all    all    Light1 4.900265\n#> 2   wetland    NA V3-C-2    all    all    Light2 4.900265\n#> 3   wetland    NA V1-C-5    all    all    Light1 4.760764\n#> 4   wetland    NA V1-C-5    all    all    Light2 4.760764\n#> 5   wetland    NA V4-C-2    all    all    Light1 4.901870\n#> 6   wetland    NA V4-C-2    all    all    Light2 4.901870\n#> 7   wetland    NA V4-C-3    all    all    Light1 4.996095\n#> 8   wetland    NA V4-C-3    all    all    Light2 4.996095\n#> 9   wetland    NA V8-C-1    all    all    Light1 4.709785\n#> 10  wetland    NA V8-C-1    all    all    Light2 4.709785\n#> 11  wetland    NA V8-C-2    all    all    Light1 4.586035\n#> 12  wetland    NA V8-C-2    all    all    Light2 4.586035\n#> 13  wetland    NA V8-C-3    all    all    Light1 4.635103\n#> 14  wetland    NA V8-C-3    all    all    Light2 4.635103\n#> 15  wetland    NA V3-C-1    all    all    Light1 5.594595\n#> 16  wetland    NA V3-C-1    all    all    Light2 5.594595\n#> 17  wetland    NA V1-C-1    all    all    Light1 5.575057\n#> 18  wetland    NA V1-C-1    all    all    Light2 5.575057\n#> 19  wetland    NA V1-C-2    all    all    Light1 5.522530\n#> 20  wetland    NA V1-C-2    all    all    Light2 5.522530\n#> 21  wetland    NA V1-C-3    all    all    Light1 5.450281\n#> 22  wetland    NA V1-C-3    all    all    Light2 5.450281\n#> 23  wetland    NA V1-C-4    all    all    Light1 5.647878\n#> 24  wetland    NA V1-C-4    all    all    Light2 5.647878\n#> 25  wetland    NA V1-C-6    all    all    Light1 4.816224\n#> 26  wetland    NA V1-C-6    all    all    Light2 4.816224\n#> 27  wetland    NA V1-C-7    all    all    Light1 4.804565\n#> 28  wetland    NA V1-C-7    all    all    Light2 4.804565\n#> 29  wetland    NA V1-C-8    all    all    Light1 4.915094\n#> 30  wetland    NA V1-C-8    all    all    Light2 4.915094\n#> 31  wetland    NA V2-C-1    all    all    Light1 4.173047\n#> 32  wetland    NA V2-C-1    all    all    Light2 4.173047\n#> 33  wetland    NA V2-C-2    all    all    Light1 4.256174\n#> 34  wetland    NA V2-C-2    all    all    Light2 4.256174\n#> 35  wetland    NA V2-C-3    all    all    Light1 4.125515\n#> 36  wetland    NA V2-C-3    all    all    Light2 4.125515\n#> 37  wetland    NA V3-C-2    all    all    Moist1 5.736585\n#> 38  wetland    NA V3-C-2    all    all    Moist2 5.736585\n#> 39  wetland    NA V1-C-5    all    all    Moist1 5.821132\n#> 40  wetland    NA V1-C-5    all    all    Moist2 5.821132\n#> 41  wetland    NA V4-C-2    all    all    Moist1 7.088321\n#> 42  wetland    NA V4-C-2    all    all    Moist2 7.088321\n#> 43  wetland    NA V4-C-3    all    all    Moist1 6.935913\n#> 44  wetland    NA V4-C-3    all    all    Moist2 6.935913\n#> 45  wetland    NA V8-C-1    all    all    Moist1 7.217742\n#> 46  wetland    NA V8-C-1    all    all    Moist2 7.217742\n#> 47  wetland    NA V8-C-2    all    all    Moist1 7.251258\n#> 48  wetland    NA V8-C-2    all    all    Moist2 7.251258\n#> 49  wetland    NA V8-C-3    all    all    Moist1 7.382590\n#> 50  wetland    NA V8-C-3    all    all    Moist2 7.382590\n#> 51  wetland    NA V3-C-1    all    all    Moist1 6.907166\n#> 52  wetland    NA V3-C-1    all    all    Moist2 6.907166\n#> 53  wetland    NA V1-C-1    all    all    Moist1 7.280132\n#> 54  wetland    NA V1-C-1    all    all    Moist2 7.280132\n#> 55  wetland    NA V1-C-2    all    all    Moist1 7.915167\n#> 56  wetland    NA V1-C-2    all    all    Moist2 7.915167\n#> 57  wetland    NA V1-C-3    all    all    Moist1 8.216718\n#> 58  wetland    NA V1-C-3    all    all    Moist2 8.216718\n#> 59  wetland    NA V1-C-4    all    all    Moist1 8.040734\n#> 60  wetland    NA V1-C-4    all    all    Moist2 8.040734\n#> 61  wetland    NA V1-C-6    all    all    Moist1 7.233970\n#> 62  wetland    NA V1-C-6    all    all    Moist2 7.233970\n#> 63  wetland    NA V1-C-7    all    all    Moist1 7.271581\n#> 64  wetland    NA V1-C-7    all    all    Moist2 7.271581\n#> 65  wetland    NA V1-C-8    all    all    Moist1 7.091729\n#> 66  wetland    NA V1-C-8    all    all    Moist2 7.091729\n#> 67  wetland    NA V2-C-1    all    all    Moist1 5.859056\n#> 68  wetland    NA V2-C-1    all    all    Moist2 5.859056\n#> 69  wetland    NA V2-C-2    all    all    Moist1 6.488092\n#> 70  wetland    NA V2-C-2    all    all    Moist2 6.488092\n#> 71  wetland    NA V2-C-3    all    all    Moist1 6.772113\n#> 72  wetland    NA V2-C-3    all    all    Moist2 6.772113\n#> 73  wetland    NA V3-C-2    all    all       pH1 2.243827\n#> 74  wetland    NA V3-C-2    all    all       pH2 2.243827\n#> 75  wetland    NA V1-C-5    all    all       pH1 2.516520\n#> 76  wetland    NA V1-C-5    all    all       pH2 2.516520\n#> 77  wetland    NA V4-C-2    all    all       pH1 3.787654\n#> 78  wetland    NA V4-C-2    all    all       pH2 3.787654\n#> 79  wetland    NA V4-C-3    all    all       pH1 4.388411\n#> 80  wetland    NA V4-C-3    all    all       pH2 4.388411\n#> 81  wetland    NA V8-C-1    all    all       pH1 4.163711\n#> 82  wetland    NA V8-C-1    all    all       pH2 4.163711\n#> 83  wetland    NA V8-C-2    all    all       pH1 4.575937\n#> 84  wetland    NA V8-C-2    all    all       pH2 4.575937\n#> 85  wetland    NA V8-C-3    all    all       pH1 4.876376\n#> 86  wetland    NA V8-C-3    all    all       pH2 4.876376\n#> 87  wetland    NA V3-C-1    all    all       pH1 2.013841\n#> 88  wetland    NA V3-C-1    all    all       pH2 2.013841\n#> 89  wetland    NA V1-C-1    all    all       pH1 2.099490\n#> 90  wetland    NA V1-C-1    all    all       pH2 2.099490\n#> 91  wetland    NA V1-C-2    all    all       pH1 2.837740\n#> 92  wetland    NA V1-C-2    all    all       pH2 2.837740\n#> 93  wetland    NA V1-C-3    all    all       pH1 3.604344\n#> 94  wetland    NA V1-C-3    all    all       pH2 3.604344\n#> 95  wetland    NA V1-C-4    all    all       pH1 4.508963\n#> 96  wetland    NA V1-C-4    all    all       pH2 4.508963\n#> 97  wetland    NA V1-C-6    all    all       pH1 3.091580\n#> 98  wetland    NA V1-C-6    all    all       pH2 3.091580\n#> 99  wetland    NA V1-C-7    all    all       pH1 3.547120\n#> 100 wetland    NA V1-C-7    all    all       pH2 3.547120\n#> 101 wetland    NA V1-C-8    all    all       pH1 4.212409\n#> 102 wetland    NA V1-C-8    all    all       pH2 4.212409\n#> 103 wetland    NA V2-C-1    all    all       pH1 2.942611\n#> 104 wetland    NA V2-C-1    all    all       pH2 2.942611\n#> 105 wetland    NA V2-C-2    all    all       pH1 3.618644\n#> 106 wetland    NA V2-C-2    all    all       pH2 3.618644\n#> 107 wetland    NA V2-C-3    all    all       pH1 4.097649\n#> 108 wetland    NA V2-C-3    all    all       pH2 4.097649\n#> 109 wetland    NA V3-C-2    all    all Nitrogen1 1.952862\n#> 110 wetland    NA V3-C-2    all    all Nitrogen2 1.952862\n#> 111 wetland    NA V1-C-5    all    all Nitrogen1 2.167561\n#> 112 wetland    NA V1-C-5    all    all Nitrogen2 2.167561\n#> 113 wetland    NA V4-C-2    all    all Nitrogen1 3.323729\n#> 114 wetland    NA V4-C-2    all    all Nitrogen2 3.323729\n#> 115 wetland    NA V4-C-3    all    all Nitrogen1 3.807000\n#> 116 wetland    NA V4-C-3    all    all Nitrogen2 3.807000\n#> 117 wetland    NA V8-C-1    all    all Nitrogen1 4.462636\n#> 118 wetland    NA V8-C-1    all    all Nitrogen2 4.462636\n#> 119 wetland    NA V8-C-2    all    all Nitrogen1 5.459677\n#> 120 wetland    NA V8-C-2    all    all Nitrogen2 5.459677\n#> 121 wetland    NA V8-C-3    all    all Nitrogen1 5.900868\n#> 122 wetland    NA V8-C-3    all    all Nitrogen2 5.900868\n#> 123 wetland    NA V3-C-1    all    all Nitrogen1 1.494737\n#> 124 wetland    NA V3-C-1    all    all Nitrogen2 1.494737\n#> 125 wetland    NA V1-C-1    all    all Nitrogen1 1.667114\n#> 126 wetland    NA V1-C-1    all    all Nitrogen2 1.667114\n#> 127 wetland    NA V1-C-2    all    all Nitrogen1 1.974614\n#> 128 wetland    NA V1-C-2    all    all Nitrogen2 1.974614\n#> 129 wetland    NA V1-C-3    all    all Nitrogen1 2.396491\n#> 130 wetland    NA V1-C-3    all    all Nitrogen2 2.396491\n#> 131 wetland    NA V1-C-4    all    all Nitrogen1 2.685903\n#> 132 wetland    NA V1-C-4    all    all Nitrogen2 2.685903\n#> 133 wetland    NA V1-C-6    all    all Nitrogen1 2.761761\n#> 134 wetland    NA V1-C-6    all    all Nitrogen2 2.761761\n#> 135 wetland    NA V1-C-7    all    all Nitrogen1 3.186189\n#> 136 wetland    NA V1-C-7    all    all Nitrogen2 3.186189\n#> 137 wetland    NA V1-C-8    all    all Nitrogen1 3.517028\n#> 138 wetland    NA V1-C-8    all    all Nitrogen2 3.517028\n#> 139 wetland    NA V2-C-1    all    all Nitrogen1 3.211879\n#> 140 wetland    NA V2-C-1    all    all Nitrogen2 3.211879\n#> 141 wetland    NA V2-C-2    all    all Nitrogen1 4.032121\n#> 142 wetland    NA V2-C-2    all    all Nitrogen2 4.032121\n#> 143 wetland    NA V2-C-3    all    all Nitrogen1 4.900636\n#> 144 wetland    NA V2-C-3    all    all Nitrogen2 4.900636\n#>           Gv maxmin\n#> 1   4.736150      1\n#> 2   5.120000      7\n#> 3   4.597880      1\n#> 4   4.902329      7\n#> 5   4.610424      1\n#> 6   5.232242      7\n#> 7   4.677531      1\n#> 8   5.309336      7\n#> 9   4.464570      1\n#> 10  4.972819      7\n#> 11  4.425727      1\n#> 12  4.779277      7\n#> 13  4.490343      1\n#> 14  4.790331      7\n#> 15  4.892675      1\n#> 16  6.567474      7\n#> 17  4.958721      1\n#> 18  6.315900      7\n#> 19  5.139566      1\n#> 20  6.264477      7\n#> 21  5.089261      1\n#> 22  6.152334      7\n#> 23  5.126794      1\n#> 24  6.162793      7\n#> 25  4.525242      1\n#> 26  5.124243      7\n#> 27  4.504224      1\n#> 28  5.059866      7\n#> 29  4.558245      1\n#> 30  5.303735      7\n#> 31  3.974819      1\n#> 32  4.598703      7\n#> 33  3.685444      1\n#> 34  4.700616      7\n#> 35  3.631843      1\n#> 36  4.457248      7\n#> 37  5.201878      1\n#> 38  6.151852     12\n#> 39  5.391473      1\n#> 40  6.265910     12\n#> 41  6.708205      1\n#> 42  7.496453     12\n#> 43  6.599488      1\n#> 44  7.284055     12\n#> 45  6.803539      1\n#> 46  7.663696     12\n#> 47  6.925680      1\n#> 48  7.577229     12\n#> 49  7.024416      1\n#> 50  7.755543     12\n#> 51  5.528728      1\n#> 52  8.486166     12\n#> 53  5.735756      1\n#> 54  8.718040     12\n#> 55  6.426842      1\n#> 56  8.924438     12\n#> 57  7.113426      1\n#> 58  9.016390     12\n#> 59  7.065646      1\n#> 60  8.935004     12\n#> 61  6.016056      1\n#> 62  8.688171     12\n#> 63  6.326991      1\n#> 64  8.463120     12\n#> 65  6.258498      1\n#> 66  7.784715     12\n#> 67  5.112448      1\n#> 68  8.126484     12\n#> 69  5.513549      1\n#> 70  7.920221     12\n#> 71  6.004292      1\n#> 72  7.759210     12\n#> 73  1.831766      1\n#> 74  2.533659      8\n#> 75  2.155809      1\n#> 76  2.836431      8\n#> 77  3.437916      1\n#> 78  4.212773      8\n#> 79  3.953983      1\n#> 80  4.813829      8\n#> 81  3.889345      1\n#> 82  4.486426      8\n#> 83  4.381745      1\n#> 84  4.795270      8\n#> 85  4.682191      1\n#> 86  5.070794      8\n#> 87  1.494071      1\n#> 88  2.868778      8\n#> 89  1.697084      1\n#> 90  3.207349      8\n#> 91  2.076494      1\n#> 92  3.691609      8\n#> 93  2.768193      1\n#> 94  4.317389      8\n#> 95  3.410753      1\n#> 96  5.601644      8\n#> 97  2.655389      1\n#> 98  3.699116      8\n#> 99  3.246374      1\n#> 100 3.916825      8\n#> 101 3.808178      1\n#> 102 4.677554      8\n#> 103 2.628539      1\n#> 104 3.685835      8\n#> 105 3.196779      1\n#> 106 4.074977      8\n#> 107 3.783875      1\n#> 108 4.434308      8\n#> 109 1.811728      1\n#> 110 2.142723      9\n#> 111 1.853110      1\n#> 112 2.438285      9\n#> 113 3.008428      1\n#> 114 3.678983      9\n#> 115 3.262604      1\n#> 116 4.234730      9\n#> 117 4.148721      1\n#> 118 4.812027      9\n#> 119 5.142488      1\n#> 120 5.816705      9\n#> 121 5.629958      1\n#> 122 6.152190      9\n#> 123 1.072464      1\n#> 124 1.996790      9\n#> 125 1.389752      1\n#> 126 2.134328      9\n#> 127 1.567785      1\n#> 128 2.519928      9\n#> 129 1.746634      1\n#> 130 3.048414      9\n#> 131 2.053753      1\n#> 132 3.184157      9\n#> 133 2.303992      1\n#> 134 3.191950      9\n#> 135 2.846378      1\n#> 136 3.487493      9\n#> 137 3.058802      1\n#> 138 4.025923      9\n#> 139 2.899263      1\n#> 140 3.767787      9\n#> 141 3.605832      1\n#> 142 4.559970      9\n#> 143 4.489434      1\n#> 144 5.338214      9\n#>       N1               hoved               grunn   \n#>  Length:144         Length:144         V1-C-1 : 8  \n#>  Class :character   Class :character   V1-C-2 : 8  \n#>  Mode  :character   Mode  :character   V1-C-3 : 8  \n#>                                        V1-C-4 : 8  \n#>                                        V1-C-5 : 8  \n#>                                        V1-C-6 : 8  \n#>                                        (Other):96  \n#>     county             region                 Ind    \n#>  Length:144         Length:144         Light1   :18  \n#>  Class :character   Class :character   Light2   :18  \n#>  Mode  :character   Mode  :character   Moist1   :18  \n#>                                        Moist2   :18  \n#>                                        Nitrogen1:18  \n#>                                        Nitrogen2:18  \n#>                                        (Other)  :36  \n#>        Rv              Gv            maxmin     \n#>  Min.   :1.495   Min.   :1.072   Min.   : 1.00  \n#>  1st Qu.:3.469   1st Qu.:3.431   1st Qu.: 1.00  \n#>  Median :4.611   Median :4.605   Median : 4.00  \n#>  Mean   :4.679   Mean   :4.716   Mean   : 5.00  \n#>  3rd Qu.:5.758   3rd Qu.:5.864   3rd Qu.: 8.25  \n#>  Max.   :8.217   Max.   :9.016   Max.   :12.00  \n#> \nhead(wetland.ref.cov.val)\n#>        N1 hoved  grunn county region    Ind       Rv\n#> 1 wetland    NA V3-C-2    all    all Light1 4.900265\n#> 2 wetland    NA V3-C-2    all    all Light2 4.900265\n#> 3 wetland    NA V1-C-5    all    all Light1 4.760764\n#> 4 wetland    NA V1-C-5    all    all Light2 4.760764\n#> 5 wetland    NA V4-C-2    all    all Light1 4.901870\n#> 6 wetland    NA V4-C-2    all    all Light2 4.901870\n#>         Gv maxmin\n#> 1 4.736150      1\n#> 2 5.120000      7\n#> 3 4.597880      1\n#> 4 4.902329      7\n#> 5 4.610424      1\n#> 6 5.232242      7\n\n#### scaled values ####\nr.s <- 1    # reference value\nl.s <- 0.6  # limit value\na.s <- 0    # abscence of indicator, or indicator at maximum\n\n#### function for calculating scaled values for measured value ####\n\n## scaling function including truncation\nscal <- function() {\n  # place to hold the result\n   x <- numeric()\n  if (maxmin < ref) {\n    # values >= the reference value equal 1\n    if (val >= ref) {x <- 1}\n    # values < the reference value and >= the limit value can be deducted from the linear relationship between these two\n    if (val < ref & val >= lim) {x <- (l.s + (val-lim) * ( (r.s-l.s) / (ref-lim) ) )}\n    # values < the limit value and > maxmin can be deducted from the linear relationship between these two\n    if (val < lim & val > maxmin) {x <- (a.s + (val-maxmin) * ( (l.s-a.s) / (lim-maxmin) ) )}\n    # value equals or lower than maxmin\n    if (val <= maxmin) {x <-0}\n  } else {\n    # values <= the reference value equal 1\n    if (val <= ref) {x <- 1}\n    # values > the reference value and <= the limit value can be deducted from the linear relationship between these two\n    if (val > ref & val <= lim) {x <- ( r.s - ( (r.s - l.s) * (val - ref) / (lim - ref) ) )}\n    # values > the limit value and < maxmin can be deducted from the linear relationship between these two\n    if (val > lim) {x <- ( l.s - (l.s * (val - lim) / (maxmin - lim) ) )}\n    # value equals or larger than maxmin\n    if (val >= maxmin) {x <-0}\n  }\n  return(x)\n  \n}\n\n#### calculating scaled and non-truncated values for the indicators based on the dataset ####\nfor (i in 1:nrow(ANO.wetland) ) {  #\n  tryCatch({\n    print(i)\n    print(paste(ANO.wetland$ano_flate_id[i]))\n    print(paste(ANO.wetland$ano_punkt_id[i]))\n#    ANO.wetland$Hovedoekosystem_sirkel[i]\n#    ANO.wetland$Hovedoekosystem_rute[i]\n\n    # if the ANO.hovedtype exists in the reference\n    if (ANO.wetland$hovedtype_rute[i] %in% unique(substr(wetland.ref.cov.val$grunn,1,2)) ) {\n      \n      # if there is any species present in current ANO point  \n      if ( length(ANO.sp.ind[ANO.sp.ind$ParentGlobalID==as.character(ANO.wetland$GlobalID[i]),'Species']) > 0 ) {\n        \n\n          \n          # Light\n          dat <- ANO.sp.ind[ANO.sp.ind$ParentGlobalID==as.character(ANO.wetland$GlobalID[i]),c('art_dekning','Light')]\n          results.wetland[['original']][i,'richness'] <- nrow(dat)\n          dat <- dat[!is.na(dat$Light),]\n          \n          if ( nrow(dat)>0 ) {\n            \n            val <- sum(dat[,'art_dekning'] * dat[,'Light'],na.rm=T) / sum(dat[,'art_dekning'],na.rm=T)\n            # lower part of distribution\n            ref <- wetland.ref.cov.val[wetland.ref.cov.val$Ind=='Light1' & wetland.ref.cov.val$grunn==as.character(results.wetland[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n            lim <- wetland.ref.cov.val[wetland.ref.cov.val$Ind=='Light1' & wetland.ref.cov.val$grunn==as.character(results.wetland[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n            maxmin <- wetland.ref.cov.val[wetland.ref.cov.val$Ind=='Light1' & wetland.ref.cov.val$grunn==as.character(results.wetland[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n            # coercing x into results.wetland dataframe\n            results.wetland[['scaled']][i,'Light1'] <- scal() \n            results.wetland[['non-truncated']][i,'Light1'] <- scal.2() \n            results.wetland[['original']][i,'Light1'] <- val \n            \n            # upper part of distribution\n            ref <- wetland.ref.cov.val[wetland.ref.cov.val$Ind=='Light2' & wetland.ref.cov.val$grunn==as.character(results.wetland[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n            lim <- wetland.ref.cov.val[wetland.ref.cov.val$Ind=='Light2' & wetland.ref.cov.val$grunn==as.character(results.wetland[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n            maxmin <- wetland.ref.cov.val[wetland.ref.cov.val$Ind=='Light2' & wetland.ref.cov.val$grunn==as.character(results.wetland[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n            # coercing x into results.wetland dataframe\n            results.wetland[['scaled']][i,'Light2'] <- scal() \n            results.wetland[['non-truncated']][i,'Light2'] <- scal.2() \n            results.wetland[['original']][i,'Light2'] <- val\n          }\n          \n          \n          # Moisture\n          dat <- ANO.sp.ind[ANO.sp.ind$ParentGlobalID==as.character(ANO.wetland$GlobalID[i]),c('art_dekning','Moisture')]\n          results.wetland[['original']][i,'richness'] <- nrow(dat)\n          dat <- dat[!is.na(dat$Moisture),]\n          \n          if ( nrow(dat)>0 ) {\n            \n            val <- sum(dat[,'art_dekning'] * dat[,'Moisture'],na.rm=T) / sum(dat[,'art_dekning'],na.rm=T)\n            # lower part of distribution\n            ref <- wetland.ref.cov.val[wetland.ref.cov.val$Ind=='Moist1' & wetland.ref.cov.val$grunn==as.character(results.wetland[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n            lim <- wetland.ref.cov.val[wetland.ref.cov.val$Ind=='Moist1' & wetland.ref.cov.val$grunn==as.character(results.wetland[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n            maxmin <- wetland.ref.cov.val[wetland.ref.cov.val$Ind=='Moist1' & wetland.ref.cov.val$grunn==as.character(results.wetland[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n            # coercing x into results.wetland dataframe\n            results.wetland[['scaled']][i,'Moist1'] <- scal() \n            results.wetland[['non-truncated']][i,'Moist1'] <- scal.2() \n            results.wetland[['original']][i,'Moist1'] <- val \n            \n            # upper part of distribution\n            ref <- wetland.ref.cov.val[wetland.ref.cov.val$Ind=='Moist2' & wetland.ref.cov.val$grunn==as.character(results.wetland[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n            lim <- wetland.ref.cov.val[wetland.ref.cov.val$Ind=='Moist2' & wetland.ref.cov.val$grunn==as.character(results.wetland[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n            maxmin <- wetland.ref.cov.val[wetland.ref.cov.val$Ind=='Moist2' & wetland.ref.cov.val$grunn==as.character(results.wetland[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n            # coercing x into results.wetland dataframe\n            results.wetland[['scaled']][i,'Moist2'] <- scal() \n            results.wetland[['non-truncated']][i,'Moist2'] <- scal.2() \n            results.wetland[['original']][i,'Moist2'] <- val\n          }\n          \n          \n          # Soil_reaction_pH\n          dat <- ANO.sp.ind[ANO.sp.ind$ParentGlobalID==as.character(ANO.wetland$GlobalID[i]),c('art_dekning','Soil_reaction_pH')]\n          results.wetland[['original']][i,'richness'] <- nrow(dat)\n          dat <- dat[!is.na(dat$Soil_reaction_pH),]\n          \n          if ( nrow(dat)>0 ) {\n            \n            val <- sum(dat[,'art_dekning'] * dat[,'Soil_reaction_pH'],na.rm=T) / sum(dat[,'art_dekning'],na.rm=T)\n            # lower part of distribution\n            ref <- wetland.ref.cov.val[wetland.ref.cov.val$Ind=='pH1' & wetland.ref.cov.val$grunn==as.character(results.wetland[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n            lim <- wetland.ref.cov.val[wetland.ref.cov.val$Ind=='pH1' & wetland.ref.cov.val$grunn==as.character(results.wetland[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n            maxmin <- wetland.ref.cov.val[wetland.ref.cov.val$Ind=='pH1' & wetland.ref.cov.val$grunn==as.character(results.wetland[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n            # coercing x into results.wetland dataframe\n            results.wetland[['scaled']][i,'pH1'] <- scal() \n            results.wetland[['non-truncated']][i,'pH1'] <- scal.2() \n            results.wetland[['original']][i,'pH1'] <- val \n            \n            # upper part of distribution\n            ref <- wetland.ref.cov.val[wetland.ref.cov.val$Ind=='pH2' & wetland.ref.cov.val$grunn==as.character(results.wetland[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n            lim <- wetland.ref.cov.val[wetland.ref.cov.val$Ind=='pH2' & wetland.ref.cov.val$grunn==as.character(results.wetland[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n            maxmin <- wetland.ref.cov.val[wetland.ref.cov.val$Ind=='pH2' & wetland.ref.cov.val$grunn==as.character(results.wetland[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n            # coercing x into results.wetland dataframe\n            results.wetland[['scaled']][i,'pH2'] <- scal() \n            results.wetland[['non-truncated']][i,'pH2'] <- scal.2() \n            results.wetland[['original']][i,'pH2'] <- val\n          }\n          \n          \n          # Nitrogen\n          dat <- ANO.sp.ind[ANO.sp.ind$ParentGlobalID==as.character(ANO.wetland$GlobalID[i]),c('art_dekning','Nitrogen')]\n          results.wetland[['original']][i,'richness'] <- nrow(dat)\n          dat <- dat[!is.na(dat$Nitrogen),]\n          \n          if ( nrow(dat)>0 ) {\n            \n            val <- sum(dat[,'art_dekning'] * dat[,'Nitrogen'],na.rm=T) / sum(dat[,'art_dekning'],na.rm=T)\n            # lower part of distribution\n            ref <- wetland.ref.cov.val[wetland.ref.cov.val$Ind=='Nitrogen1' & wetland.ref.cov.val$grunn==as.character(results.wetland[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n            lim <- wetland.ref.cov.val[wetland.ref.cov.val$Ind=='Nitrogen1' & wetland.ref.cov.val$grunn==as.character(results.wetland[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n            maxmin <- wetland.ref.cov.val[wetland.ref.cov.val$Ind=='Nitrogen1' & wetland.ref.cov.val$grunn==as.character(results.wetland[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n            # coercing x into results.wetland dataframe\n            results.wetland[['scaled']][i,'Nitrogen1'] <- scal() \n            results.wetland[['non-truncated']][i,'Nitrogen1'] <- scal.2() \n            results.wetland[['original']][i,'Nitrogen1'] <- val \n            \n            # upper part of distribution\n            ref <- wetland.ref.cov.val[wetland.ref.cov.val$Ind=='Nitrogen2' & wetland.ref.cov.val$grunn==as.character(results.wetland[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n            lim <- wetland.ref.cov.val[wetland.ref.cov.val$Ind=='Nitrogen2' & wetland.ref.cov.val$grunn==as.character(results.wetland[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n            maxmin <- wetland.ref.cov.val[wetland.ref.cov.val$Ind=='Nitrogen2' & wetland.ref.cov.val$grunn==as.character(results.wetland[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n            # coercing x into results.wetland dataframe\n            results.wetland[['scaled']][i,'Nitrogen2'] <- scal() \n            results.wetland[['non-truncated']][i,'Nitrogen2'] <- scal.2() \n            results.wetland[['original']][i,'Nitrogen2'] <- val\n          }\n          \n        }\n      }\n      \n\n    \n  }, error=function(e){cat(\"ERROR :\",conditionMessage(e), \"\\n\")})\n}\n\n# for using both sides of the plant indicators\nresults.wetland[['2-sided']] <- results.wetland[['non-truncated']]\n\n# remove values >1 for 2-sided indicators\nresults.wetland[['2-sided']]$Light1[results.wetland[['2-sided']]$Light1>1] <- NA\nresults.wetland[['2-sided']]$Light2[results.wetland[['2-sided']]$Light2>1] <- NA\n\nresults.wetland[['2-sided']]$Moist1[results.wetland[['2-sided']]$Moist1>1] <- NA\nresults.wetland[['2-sided']]$Moist2[results.wetland[['2-sided']]$Moist2>1] <- NA\n\nresults.wetland[['2-sided']]$pH1[results.wetland[['2-sided']]$pH1>1] <- NA\nresults.wetland[['2-sided']]$pH2[results.wetland[['2-sided']]$pH2>1] <- NA\n\nresults.wetland[['2-sided']]$Nitrogen1[results.wetland[['2-sided']]$Nitrogen1>1] <- NA\nresults.wetland[['2-sided']]$Nitrogen2[results.wetland[['2-sided']]$Nitrogen2>1] <- NA\nhead(results.wetland[['2-sided']])\n#>                                 GlobalID\n#> 1 {36BAE83E-F412-4C90-8B56-DE6B4225BB17}\n#> 2 {662B047A-411B-42F1-8F2F-E24602CBF350}\n#> 3 {F003E630-94CD-4FFF-839B-772299BF697A}\n#> 4 {F8239C33-99BD-4EEE-85A9-04A10772858D}\n#> 5 {95E184F4-9560-4ADC-A7A9-75AD9A97D654}\n#> 6 {6C11D423-9559-4C61-9036-C1309E0C6328}\n#>      registeringsdato klokkeslett_start ano_flate_id\n#> 1 2019-08-16 11:59:59             13:19      ANO0003\n#> 2 2019-08-16 11:59:59             15:38      ANO0003\n#> 3 2019-08-16 11:59:59             15:07      ANO0003\n#> 4 2019-08-16 11:59:59             13:58      ANO0003\n#> 5 2019-08-16 11:59:59             12:06      ANO0003\n#> 6 2019-08-15 11:59:59             15:43      ANO0003\n#>   ano_punkt_id         ssb_id program\n#> 1   ANO0003_35 20940006559500     ANO\n#> 2   ANO0003_44 20940006559500     ANO\n#> 3   ANO0003_64 20940006559500     ANO\n#> 4   ANO0003_55 20940006559500     ANO\n#> 5   ANO0003_15 20940006559500     ANO\n#> 6   ANO0003_51 20940006559500     ANO\n#>                                                                   instruks\n#> 1 https://nedlasting.miljodirektoratet.no/naturovervaking/ano_instruks.pdf\n#> 2 https://nedlasting.miljodirektoratet.no/naturovervaking/ano_instruks.pdf\n#> 3 https://nedlasting.miljodirektoratet.no/naturovervaking/ano_instruks.pdf\n#> 4 https://nedlasting.miljodirektoratet.no/naturovervaking/ano_instruks.pdf\n#> 5 https://nedlasting.miljodirektoratet.no/naturovervaking/ano_instruks.pdf\n#> 6 https://nedlasting.miljodirektoratet.no/naturovervaking/ano_instruks.pdf\n#>    aar      dataansvarlig_mdir                   dataeier\n#> 1 2019 Ole Einar Butli Hårstad Miljødirektoratet, VAL/VMK\n#> 2 2019 Ole Einar Butli Hårstad Miljødirektoratet, VAL/VMK\n#> 3 2019 Ole Einar Butli Hårstad Miljødirektoratet, VAL/VMK\n#> 4 2019 Ole Einar Butli Hårstad Miljødirektoratet, VAL/VMK\n#> 5 2019 Ole Einar Butli Hårstad Miljødirektoratet, VAL/VMK\n#> 6 2019 Ole Einar Butli Hårstad Miljødirektoratet, VAL/VMK\n#>        vaer hovedoekosystem_punkt\n#> 1 overskyet              vaatmark\n#> 2       sol              vaatmark\n#> 3       sol              vaatmark\n#> 4       sol              vaatmark\n#> 5       sol              vaatmark\n#> 6    nedbør              vaatmark\n#>   andel_hovedoekosystem_punkt utilgjengelig_punkt\n#> 1                          NA                <NA>\n#> 2                          NA                <NA>\n#> 3                          NA                <NA>\n#> 4                          NA                <NA>\n#> 5                          NA                <NA>\n#> 6                          NA                <NA>\n#>   utilgjengelig_begrunnelse  gps noeyaktighet\n#> 1                      <NA> <NA>         <NA>\n#> 2                      <NA> <NA>         <NA>\n#> 3                      <NA> <NA>         <NA>\n#> 4                      <NA> <NA>         <NA>\n#> 5                      <NA> <NA>         <NA>\n#> 6                      <NA> <NA>         <NA>\n#>   kommentar_posisjon klokkeslett_karplanter_start\n#> 1               <NA>                         <NA>\n#> 2               <NA>                         <NA>\n#> 3               <NA>                         <NA>\n#> 4               <NA>                         <NA>\n#> 5               <NA>                         <NA>\n#> 6               <NA>                         <NA>\n#>   art_alle_registrert karplanter_dekning\n#> 1                <NA>               85.1\n#> 2                <NA>               81.0\n#> 3                <NA>               79.0\n#> 4                <NA>               51.1\n#> 5                <NA>               71.0\n#> 6                <NA>               11.3\n#>   klokkeslett_karplanter_slutt karplanter_feltsjikt\n#> 1                         <NA>                   NA\n#> 2                         <NA>                   NA\n#> 3                         <NA>                   NA\n#> 4                         <NA>                   NA\n#> 5                         <NA>                   NA\n#> 6                         <NA>                   NA\n#>   moser_dekning torvmoser_dekning lav_dekning stroe_dekning\n#> 1            20                20           0            60\n#> 2             5                 0           0            45\n#> 3            85                75           0            15\n#> 4            80                60           0            75\n#> 5            80                80           0            23\n#> 6            85                85           0             1\n#>   jord_grus_stein_berg_dekning stubber_kvister_dekning\n#> 1                           NA                      NA\n#> 2                           NA                      NA\n#> 3                           NA                      NA\n#> 4                           NA                      NA\n#> 5                           NA                      NA\n#> 6                           NA                      NA\n#>   alger_fjell_dekning\n#> 1                  NA\n#> 2                  NA\n#> 3                  NA\n#> 4                  NA\n#> 5                  NA\n#> 6                  NA\n#>                                 kommentar_ruteanalyse\n#> 1                                                <NA>\n#> 2                                                <NA>\n#> 3                                                <NA>\n#> 4 har noen arter som er i V1C2 men bare veldig lokalt\n#> 5                                                <NA>\n#> 6                                                <NA>\n#>   fastmerker kommentar_fastmerker kartleggingsenhet_1m2\n#> 1       <NA>                 <NA>                V1-C-5\n#> 2       <NA>                 <NA>                V1-C-1\n#> 3       <NA>                 <NA>                V1-C-1\n#> 4       <NA>                 <NA>                V1-C-1\n#> 5       <NA>                 <NA>                V1-C-1\n#> 6       <NA>                 <NA>                V1-C-1\n#>       hovedtype_1m2                      ke_beskrivelse_1m2\n#> 1 Åpen jordvannsmyr svært og temmelig kalkfattige myrkanter\n#> 2 Åpen jordvannsmyr svært og temmelig kalkfattige myrflater\n#> 3 Åpen jordvannsmyr svært og temmelig kalkfattige myrflater\n#> 4 Åpen jordvannsmyr svært og temmelig kalkfattige myrflater\n#> 5 Åpen jordvannsmyr svært og temmelig kalkfattige myrflater\n#> 6 Åpen jordvannsmyr svært og temmelig kalkfattige myrflater\n#>   kartleggingsenhet_250m2 hovedtype_250m2\n#> 1                    <NA>            <NA>\n#> 2                    <NA>            <NA>\n#> 3                    <NA>            <NA>\n#> 4                    <NA>            <NA>\n#> 5                    <NA>            <NA>\n#> 6                    <NA>            <NA>\n#>   ke_beskrivelse_250m2 andel_kartleggingsenhet_250m2\n#> 1                 <NA>                            NA\n#> 2                 <NA>                            NA\n#> 3                 <NA>                            NA\n#> 4                 <NA>                            NA\n#> 5                 <NA>                            NA\n#> 6                 <NA>                            NA\n#>   groeftingsintensitet bruksintensitet beitetrykk\n#> 1                    1               1         NA\n#> 2                    1               1         NA\n#> 3                    1               1         NA\n#> 4                    1               1         NA\n#> 5                    1               1         NA\n#> 6                    1               1         NA\n#>   slatteintensitet tungekjoretoy slitasje forekomst_ntyp\n#> 1                1             0        0            nei\n#> 2                1             0        0            nei\n#> 3                1             0        0            nei\n#> 4                1             0        0            nei\n#> 5                1             0        0            nei\n#> 6                1             0        0            nei\n#>   ntyp\n#> 1 <NA>\n#> 2 <NA>\n#> 3 <NA>\n#> 4 <NA>\n#> 5 <NA>\n#> 6 <NA>\n#>                                                    kommentar_naturtyperegistering\n#> 1                         en del gjengroing med bjørk og einer, noen store furuer\n#> 2                                                                            <NA>\n#> 3                        40% bærlyngskog T4C5, rute i overgang mellom myr og skog\n#> 4                                                   noen store furuer, litt bjørk\n#> 5 delvis myr, ganske mye lyng, virker som det gror igjen med bjørk, einer og furu\n#> 6                                             rute ligger i en streng i fattigmyr\n#>   side_5_note krypende_vier_dekning\n#> 1        <NA>                     0\n#> 2        <NA>                     0\n#> 3        <NA>                     0\n#> 4        <NA>                     0\n#> 5        <NA>                     0\n#> 6        <NA>                     0\n#>   ikke_krypende_vier_dekning vedplanter_total_dekning\n#> 1                          1                       30\n#> 2                          0                        7\n#> 3                          0                       45\n#> 4                          3                       17\n#> 5                          0                       53\n#> 6                          0                        5\n#>   busker_dekning tresjikt_dekning treslag_registrert\n#> 1             12               15               <NA>\n#> 2              1                3               <NA>\n#> 3             12                8               <NA>\n#> 4              8               12               <NA>\n#> 5             13                8               <NA>\n#> 6              2                0               <NA>\n#>   roesslyng_dekning roesslyngblad pa_dekning pa_note\n#> 1                NA          <NA>         NA    <NA>\n#> 2                NA          <NA>         NA    <NA>\n#> 3                NA          <NA>         NA    <NA>\n#> 4                NA          <NA>         NA    <NA>\n#> 5                NA          <NA>         NA    <NA>\n#> 6                NA          <NA>         NA    <NA>\n#>   pa_registrert fa_total_dekning fa_registrert\n#> 1          <NA>                0          <NA>\n#> 2          <NA>                0          <NA>\n#> 3          <NA>                0          <NA>\n#> 4          <NA>                0          <NA>\n#> 5          <NA>                0          <NA>\n#> 6          <NA>                0          <NA>\n#>        kommentar_250m2_flate klokkeslett_slutt\n#> 1          litt nakent berg              13:33\n#> 2                       <NA>             15:45\n#> 3                       <NA>             15:17\n#> 4                       <NA>             14:12\n#> 5 en bekk går gjennom flaten             12:19\n#> 6                       <NA>             15:50\n#>                                                                                             vedlegg_url\n#> 1 https://nin-felles-test.miljodirektoratet.no/api/Overvaking/list/36bae83e-f412-4c90-8b56-de6b4225bb17\n#> 2 https://nin-felles-test.miljodirektoratet.no/api/Overvaking/list/662b047a-411b-42f1-8f2f-e24602cbf350\n#> 3 https://nin-felles-test.miljodirektoratet.no/api/Overvaking/list/f003e630-94cd-4fff-839b-772299bf697a\n#> 4 https://nin-felles-test.miljodirektoratet.no/api/Overvaking/list/f8239c33-99bd-4eee-85a9-04a10772858d\n#> 5 https://nin-felles-test.miljodirektoratet.no/api/Overvaking/list/95e184f4-9560-4adc-a7a9-75ad9a97d654\n#> 6 https://nin-felles-test.miljodirektoratet.no/api/Overvaking/list/6c11d423-9559-4c61-9036-c1309e0c6328\n#>                    creator        creationdate\n#> 1 chrpot_miljodirektoratet 2019-09-09 10:54:17\n#> 2 chrpot_miljodirektoratet 2019-09-09 10:56:19\n#> 3 chrpot_miljodirektoratet 2019-09-09 10:57:21\n#> 4 chrpot_miljodirektoratet 2019-09-09 10:58:29\n#> 5 chrpot_miljodirektoratet 2019-09-09 10:59:26\n#> 6 chrpot_miljodirektoratet 2019-09-09 10:59:58\n#>                     editor            editdate\n#> 1 chrpot_miljodirektoratet 2019-09-09 10:54:17\n#> 2 chrpot_miljodirektoratet 2019-09-09 10:56:19\n#> 3 chrpot_miljodirektoratet 2019-09-09 10:57:21\n#> 4 chrpot_miljodirektoratet 2019-09-09 10:58:29\n#> 5 chrpot_miljodirektoratet 2019-09-09 10:59:26\n#> 6 chrpot_miljodirektoratet 2019-09-09 10:59:58\n#>   hovedtype_rute    Light1    Light2    Moist1    Moist2\n#> 1             V1        NA 0.9880821        NA 0.5073251\n#> 2             V1 0.5557351        NA        NA 0.9783315\n#> 3             V1 0.5506190        NA 0.5484802        NA\n#> 4             V1        NA 0.9702611        NA 0.7785145\n#> 5             V1 0.5998524        NA 0.5246274        NA\n#> 6             V1 0.9771330        NA        NA 0.9056025\n#>         pH1       pH2 Nitrogen1 Nitrogen2\n#> 1 0.5130170        NA        NA 0.6919856\n#> 2 0.9992800        NA        NA 0.5718196\n#> 3        NA 0.8622486        NA 0.5796588\n#> 4        NA 0.4743074        NA 0.5484617\n#> 5 0.8311036        NA        NA 0.7270619\n#> 6        NA 0.7803061        NA 0.9422970"},{"path":"Functional-plant-indicators-wetland.html","id":"scaled-value-analyses","chapter":"6 Functional Plant Indicators - Wetlands","heading":"6.7.1.2 Scaled value analyses","text":"order visualize results need rearrange results-objects wide long format (note lower upper condition indicator functional plant indicators).","code":"\n#### plotting scaled values by main ecosystem type ####\n## continuing with 2-sided\nres.wetland <- results.wetland[['2-sided']]\n\n# make long version of the scaled value part\nres.wetland <-\nres.wetland %>%\npivot_longer(\ncols = c(\"Light1\",\"Light2\",\"Moist1\",\"Moist2\",\"pH1\",\"pH2\",\"Nitrogen1\",\"Nitrogen2\"),\nnames_to = \"fp_ind\",\nvalues_to = \"scaled_value\",\nvalues_drop_na = FALSE\n)\n\n# add original values as well\nres.wetland <-\nres.wetland %>% add_column(original = results.wetland[['original']] %>%\npivot_longer(\ncols = c(\"Light1\",\"Light2\",\"Moist1\",\"Moist2\",\"pH1\",\"pH2\",\"Nitrogen1\",\"Nitrogen2\"),\nnames_to = NULL,\nvalues_to = \"original\",\nvalues_drop_na = FALSE\n) %>%\npull(original)\n)"},{"path":"Functional-plant-indicators-wetland.html","id":"ecosystem-sub-types","chapter":"6 Functional Plant Indicators - Wetlands","heading":"6.7.2 Ecosystem sub-types","text":"","code":""},{"path":"Functional-plant-indicators-wetland.html","id":"indicator-index-maps","chapter":"6 Functional Plant Indicators - Wetlands","heading":"6.7.3 Indicator index maps","text":"can also show results map, instance pH1 (lower pH indicator), either directly plotting data onto map…","code":"#> Reading layer `outlineOfNorway_EPSG25833' from data source \n#>   `/data/Egenutvikling/41001581_egenutvikling_anders_kolstad/github/ecosystemCondition/data/outlineOfNorway_EPSG25833.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 1 feature and 2 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -113472.7 ymin: 6448359 xmax: 1114618 ymax: 7939917\n#> Projected CRS: ETRS89 / UTM zone 33N\n#> Reading layer `regions' from data source \n#>   `/data/Egenutvikling/41001581_egenutvikling_anders_kolstad/github/ecosystemCondition/data/regions.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 5 features and 2 fields\n#> Geometry type: POLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -99551.21 ymin: 6426048 xmax: 1121941 ymax: 7962744\n#> Projected CRS: ETRS89 / UTM zone 33N\n#> [1] \"Nord-Norge\"      \"Midt-Norge\"      \"Ã\\u0098stlandet\"\n#> [4] \"Vestlandet\"      \"SÃ¸rlandet\""},{"path":"Functional-plant-indicators-wetland.html","id":"regions---maps-and-statistics","chapter":"6 Functional Plant Indicators - Wetlands","heading":"6.7.4 Regions - maps and statistics","text":"Alternatively can calculate show region-wise means related standard errors. note calculating simple mean inappropriate data. :\n() scaled data bound 0 1, thus follow beta-distribution rather Gaussian one\n(ii) ANO dataset nested structureTherefore, need () use beta-model, (ii) can account nested structure data.\n, apply following function using either glmmTMB null-model beta-distribution, logit link, nesting random intercept, simple betareg null-model logit link nesting extensive enough mixed model.","code":"\nlibrary(betareg)\nlibrary(glmmTMB)\n\nexpit <- function(L) exp(L) / (1+exp(L)) # since the beta-models use a logit link, we need to calculate the estimates back to the identity scale\n\n# the function performs a glmmTMB if there's >= 5 random levels in the nesting structure\n# if that is not the case, then the function performs a betareg if theres >= 2 observations\n# if that is not the case either, then the function returns the value of the single observation with NA standard error\n\nindmean.beta <- function(df) {\n\n  st_geometry(df) <- NULL\n  colnames(df) <- c(\"y\",\"ran\")\n  \n  if ( nrow(df[!is.na(df[,1]),]) >= 2 ) {\n    \n    if ( length(unique(df[!is.na(df[,1]),2])) >=5 ) {\n      \n      mod1 <- glmmTMB(y ~ 1 +(1|ran), family=beta_family(), data=df)\n      \n      return(c(\n        expit(summary( mod1 )$coefficients$cond[1]),\n        \n        expit( summary( mod1 )$coefficients$cond[1] + \n                 summary( mod1 )$coefficients$cond[2] )-\n          expit( summary( mod1 )$coefficients$cond[1] ),\n        \n        nrow(df[!is.na(df$y),]),\n        summary( mod1 )$coefficients$cond[1],\n        summary( mod1 )$coefficients$cond[2]\n      ))\n      \n    } else {\n      \n      mod2 <- betareg(y ~ 1, data=df)\n      \n      return(c(\n        expit(summary( mod2 )$coefficients$mean[1]),\n        expit( summary( mod2 )$coefficients$mean[1] + \n                 summary( mod2 )$coefficients$mean[2] )-\n          expit( summary( mod2 )$coefficients$mean[1] ),\n        nrow(df[!is.na(df$y),]),\n        summary( mod2 )$coefficients$mean[1],\n        summary( mod2 )$coefficients$mean[2]\n      ))\n      \n    }\n    \n  } else {\n    \n    return(c(df$y,NA,1,NA,NA))\n    \n  }\n\n}\n\nres.wetland2 = st_join(res.wetland2, regnor, left = TRUE)\n\nregnor <- regnor %>%\n  mutate(\n    pH1.reg.mean = c(indmean.beta(df=res.wetland2[res.wetland2$region==\"Northern Norway\",c(\"pH1\",\"ano_flate_id\")])[1],\n                                 indmean.beta(df=res.wetland2[res.wetland2$region==\"Central Norway\",c(\"pH1\",\"ano_flate_id\")])[1],\n                                 indmean.beta(df=res.wetland2[res.wetland2$region==\"Eastern Norway\",c(\"pH1\",\"ano_flate_id\")])[1],\n                                 indmean.beta(df=res.wetland2[res.wetland2$region==\"Western Norway\",c(\"pH1\",\"ano_flate_id\")])[1],\n                                 indmean.beta(df=res.wetland2[res.wetland2$region==\"Southern Norway\",c(\"pH1\",\"ano_flate_id\")])[1]\n    ),\n    pH1.reg.se = c(indmean.beta(df=res.wetland2[res.wetland2$region==\"Northern Norway\",c(\"pH1\",\"ano_flate_id\")])[2],\n                               indmean.beta(df=res.wetland2[res.wetland2$region==\"Central Norway\",c(\"pH1\",\"ano_flate_id\")])[2],\n                               indmean.beta(df=res.wetland2[res.wetland2$region==\"Eastern Norway\",c(\"pH1\",\"ano_flate_id\")])[2],\n                               indmean.beta(df=res.wetland2[res.wetland2$region==\"Western Norway\",c(\"pH1\",\"ano_flate_id\")])[2],\n                               indmean.beta(df=res.wetland2[res.wetland2$region==\"Southern Norway\",c(\"pH1\",\"ano_flate_id\")])[2]\n    ),\n    pH1.reg.n = c(nrow(res.wetland2[res.wetland2$region==\"Northern Norway\" & !is.na(res.wetland2$pH1),]),\n                              nrow(res.wetland2[res.wetland2$region==\"Central Norway\" & !is.na(res.wetland2$pH1),]),\n                              nrow(res.wetland2[res.wetland2$region==\"Eastern Norway\" & !is.na(res.wetland2$pH1),]),\n                              nrow(res.wetland2[res.wetland2$region==\"Western Norway\" & !is.na(res.wetland2$pH1),]),\n                              nrow(res.wetland2[res.wetland2$region==\"Southern Norway\" & !is.na(res.wetland2$pH1),])\n    )\n  )\n\n\n## scaled value maps for pH1 (lower indicator)\n# mean\ntm_shape(regnor) +\n  tm_polygons(col=\"pH1.reg.mean\", title=\"pH (lower), mean\", style=\"quantile\", palette=rev(get_brewer_pal(palette=\"OrRd\", n=5, plot=FALSE))) +\n  tm_text(\"pH1.reg.n\",col=\"black\",bg.color=\"grey\")\n# se\ntm_shape(regnor) +\n  tm_polygons(col=\"pH1.reg.se\", title=\"pH (lower), sd\", style=\"quantile\", palette=get_brewer_pal(palette=\"OrRd\", n=5, plot=FALSE)) +\n  tm_text(\"pH1.reg.n\",col=\"black\",bg.color=\"grey\")"},{"path":"Functional-plant-indicators-wetland.html","id":"unscaled-values-vs.-reference","chapter":"6 Functional Plant Indicators - Wetlands","heading":"6.7.5 unscaled values vs. reference","text":"can also compare unscaled values reference distribution order identify ecosystem types functional plant indicators showing deviation expectation. Since pH nitrogen show deviation lower indicator exemplify two indicators unscaled values.","code":"\nsummary(res.wetland$kartleggingsenhet_1m2)\n#>      V1  V1-C-1  V1-C-2  V1-C-3  V1-C-4  V1-C-5  V1-C-6 \n#>       8    2144    1224     448     160    2424    1248 \n#>  V1-C-7  V1-C-8 V10-C-1 V10-C-3 V11-C-1     V12 V12-C-1 \n#>     320      48      40       8      16      16     152 \n#> V12-C-2      V2  V2-C-1  V2-C-2  V2-C-3      V3  V3-C-1 \n#>       8       8     832     224      32      40     440 \n#>  V3-C-2      V4  V4-C-1  V4-C-2  V4-C-4  V6-C-1  V6-C-2 \n#>     472       8      32      72       8      64       8 \n#>  V6-C-3  V6-C-4  V6-C-5  V6-C-7  V6-C-9  V8-C-1  V8-C-2 \n#>      72      40       8       8       8      16       8 \n#>  V9-C-1  V9-C-2  V9-C-3 \n#>      80      16      16\nlength(unique(res.wetland$kartleggingsenhet_1m2))\n#> [1] 38\n# 16 NiN-types to plot\ncolnames(wetland.ref.cov[['Soil_reaction_pH']])\n#>  [1] \"V3-C1a\" \"V3-C1b\" \"V3-C1c\" \"V3-C1d\" \"V3-C1e\" \"V1-C1a\"\n#>  [7] \"V1-C1b\" \"V1-C1c\" \"V1-C1d\" \"V1-C1e\" \"V1-C2a\" \"V1-C2b\"\n#> [13] \"V1-C2c\" \"V1-C2d\" \"V1-C3a\" \"V1-C3b\" \"V1-C3c\" \"V1-C3d\"\n#> [19] \"V1-C4a\" \"V1-C4b\" \"V1-C4c\" \"V1-C4d\" \"V1-C4e\" \"V1-C4f\"\n#> [25] \"V1-C4g\" \"V1-C4h\" \"V3-C2\"  \"V1-C5\"  \"V1-C6a\" \"V1-C6b\"\n#> [31] \"V1-C7a\" \"V1-C7b\" \"V1-C8a\" \"V1-C8b\" \"V2-C1a\" \"V2-C1b\"\n#> [37] \"V2-C2a\" \"V2-C2b\" \"V2-C3a\" \"V2-C3b\" \"V4-C2\"  \"V4-C3\" \n#> [43] \"V8-C1\"  \"V8-C2\"  \"V8-C3\"\n\n### pH\npar(mfrow=c(2,4))\n## V1s\n# V1-C-1\nplot(density( as.matrix(wetland.ref.cov[['Soil_reaction_pH']][,c(\"V1-C1a\",\"V1-C1b\",\"V1-C1c\",\"V1-C1d\",\"V1-C1e\")]) ,na.rm=T),\n     xlim=c(1,7), type=\"l\", main='V1-C1',xlab='pH value')\npoints(density(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-1\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-1\",]$original,\n       rep(0,length(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-1\",]$original)),\n       col=\"red\")\n\n# V1-C-2\nplot(density( as.matrix(wetland.ref.cov[['Soil_reaction_pH']][,c(\"V1-C2a\",\"V1-C2b\",\"V1-C2c\",\"V1-C2d\")]) ,na.rm=T),\n     xlim=c(1,7), type=\"l\", main='V1-C2',xlab='pH value')\npoints(density(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-2\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-2\",]$original,\n       rep(0,length(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-2\",]$original)),\n       col=\"red\")\n\n# V1-C-3\nplot(density( as.matrix(wetland.ref.cov[['Soil_reaction_pH']][,c(\"V1-C3a\",\"V1-C3b\",\"V1-C3c\",\"V1-C3d\")]) ,na.rm=T),\n     xlim=c(1,7), type=\"l\", main='V1-C3',xlab='pH value')\npoints(density(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-3\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-3\",]$original,\n       rep(0,length(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-3\",]$original)),\n       col=\"red\")\n\n# V1-C-4\nplot(density( as.matrix(wetland.ref.cov[['Soil_reaction_pH']][,c(\"V1-C4a\",\"V1-C4b\",\"V1-C4c\",\"V1-C4d\",\"V1-C4e\",\"V1-C4f\",\"V1-C4g\",\"V1-C4h\")]) ,na.rm=T),\n     xlim=c(1,7), type=\"l\", main='V1-C4',xlab='pH value')\npoints(density(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-4\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-4\",]$original,\n       rep(0,length(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-4\",]$original)),\n       col=\"red\")\n\n# V1-C-5\nplot(density( as.matrix(wetland.ref.cov[['Soil_reaction_pH']][,c(\"V1-C5\")]) ,na.rm=T),\n     xlim=c(1,7), type=\"l\", main='V1-C5',xlab='pH value')\npoints(density(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-5\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-5\",]$original,\n       rep(0,length(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-5\",]$original)),\n       col=\"red\")\n\n# V1-C-6\nplot(density( as.matrix(wetland.ref.cov[['Soil_reaction_pH']][,c(\"V1-C6a\",\"V1-C6b\")]) ,na.rm=T),\n     xlim=c(1,7), type=\"l\", main='V1-C6',xlab='pH value')\npoints(density(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-6\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-6\",]$original,\n       rep(0,length(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-6\",]$original)),\n       col=\"red\")\n\n# V1-C-7\nplot(density( as.matrix(wetland.ref.cov[['Soil_reaction_pH']][,c(\"V1-C7a\",\"V1-C7b\")]) ,na.rm=T),\n     xlim=c(1,7), type=\"l\", main='V1-C7',xlab='pH value')\npoints(density(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-7\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-7\",]$original,\n       rep(0,length(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-7\",]$original)),\n       col=\"red\")\n\n# V1-C-8\nplot(density( as.matrix(wetland.ref.cov[['Soil_reaction_pH']][,c(\"V1-C8a\",\"V1-C8b\")]) ,na.rm=T),\n     xlim=c(1,7), type=\"l\", main='V1-C8',xlab='pH value')\npoints(density(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-8\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-8\",]$original,\n       rep(0,length(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-8\",]$original)),\n       col=\"red\")\n\npar(mfrow=c(2,4))\n## V2s\n# V2-C-1\nplot(density( as.matrix(wetland.ref.cov[['Soil_reaction_pH']][,c(\"V2-C1a\",\"V2-C1b\")]) ,na.rm=T),\n     xlim=c(1,7), type=\"l\", main='V2-C1',xlab='pH value')\npoints(density(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V2-C-1\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V2-C-1\",]$original,\n       rep(0,length(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V2-C-1\",]$original)),\n       col=\"red\")\n\n# V2-C-2\nplot(density( as.matrix(wetland.ref.cov[['Soil_reaction_pH']][,c(\"V2-C2a\",\"V2-C2b\")]) ,na.rm=T),\n     xlim=c(1,7), type=\"l\", main='V2-C2',xlab='pH value')\npoints(density(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V2-C-2\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V2-C-2\",]$original,\n       rep(0,length(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V2-C-2\",]$original)),\n       col=\"red\")\n\n# V2-C-3\nplot(density( as.matrix(wetland.ref.cov[['Soil_reaction_pH']][,c(\"V2-C3a\",\"V2-C3b\")]) ,na.rm=T),\n     xlim=c(1,7), type=\"l\", main='V2-C3',xlab='pH value')\npoints(density(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V2-C-3\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V2-C-3\",]$original,\n       rep(0,length(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V2-C-3\",]$original)),\n       col=\"red\")\n\n## V3s\n# V3-C-1\nplot(density( as.matrix(wetland.ref.cov[['Soil_reaction_pH']][,c(\"V3-C1a\",\"V3-C1b\",\"V3-C1c\",\"V3-C1d\",\"V3-C1e\")]) ,na.rm=T),\n     xlim=c(1,7), type=\"l\", main='V3-C1',xlab='pH value')\npoints(density(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V3-C-1\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V3-C-1\",]$original,\n       rep(0,length(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V3-C-1\",]$original)),\n       col=\"red\")\n\n# V3-C-2\nplot(density( as.matrix(wetland.ref.cov[['Soil_reaction_pH']][,c(\"V3-C2\")]) ,na.rm=T),\n     xlim=c(1,7), type=\"l\", main='V3-C2',xlab='pH value')\npoints(density(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V3-C-2\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V3-C-2\",]$original,\n       rep(0,length(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V3-C-2\",]$original)),\n       col=\"red\")\n\n## V4s\n# V4-C-2\nplot(density( as.matrix(wetland.ref.cov[['Soil_reaction_pH']][,c(\"V4-C2\")]) ,na.rm=T),\n     xlim=c(1,7), type=\"l\", main='V4-C2',xlab='pH value')\npoints(density(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V4-C-2\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V4-C-2\",]$original,\n       rep(0,length(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V4-C-2\",]$original)),\n       col=\"red\")\n\n\n## V8s\n# V8-C-1\nplot(density( as.matrix(wetland.ref.cov[['Soil_reaction_pH']][,c(\"V8-C1\")]) ,na.rm=T),\n     xlim=c(1,7), type=\"l\", main='V8-C1',xlab='pH value')\n#points(density(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V8-C-1\",]$original,na.rm=T),\n#       type=\"l\", col=\"red\")\npoints(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V8-C-1\",]$original,\n       rep(0,length(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V8-C-1\",]$original)),\n       col=\"red\")\n\n# V8-C-2\nplot(density( as.matrix(wetland.ref.cov[['Soil_reaction_pH']][,c(\"V8-C2\")]) ,na.rm=T),\n     xlim=c(1,7), type=\"l\", main='V8-C2',xlab='pH value')\n#points(density(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V8-C-2\",]$original,na.rm=T),\n#       type=\"l\", col=\"red\")\npoints(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V8-C-2\",]$original,\n       rep(0,length(res.wetland[res.wetland$fp_ind==\"pH1\" & res.wetland$fp_ind==\"pH1\" & res.wetland$kartleggingsenhet_1m2==\"V8-C-2\",]$original)),\n       col=\"red\")\nlegend(\"topleft\", legend=c(\"reference\",\"field data\"), pch=c(NA,1), lty=1, col=c(\"black\",\"red\"))\n\n\n\n\n### Nitrogen\npar(mfrow=c(2,4))\n## V1s\n# V1-C-1\nplot(density( as.matrix(wetland.ref.cov[['Nitrogen']][,c(\"V1-C1a\",\"V1-C1b\",\"V1-C1c\",\"V1-C1d\",\"V1-C1e\")]) ,na.rm=T),\n     xlim=c(1,7), type=\"l\", main='V1-C1',xlab='Nitrogen value')\npoints(density(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-1\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-1\",]$original,\n       rep(0,length(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-1\",]$original)),\n       col=\"red\")\n\n# V1-C-2\nplot(density( as.matrix(wetland.ref.cov[['Nitrogen']][,c(\"V1-C2a\",\"V1-C2b\",\"V1-C2c\",\"V1-C2d\")]) ,na.rm=T),\n     xlim=c(1,7), type=\"l\", main='V1-C2',xlab='Nitrogen value')\npoints(density(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-2\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-2\",]$original,\n       rep(0,length(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-2\",]$original)),\n       col=\"red\")\n\n# V1-C-3\nplot(density( as.matrix(wetland.ref.cov[['Nitrogen']][,c(\"V1-C3a\",\"V1-C3b\",\"V1-C3c\",\"V1-C3d\")]) ,na.rm=T),\n     xlim=c(1,7), type=\"l\", main='V1-C3',xlab='Nitrogen value')\npoints(density(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-3\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-3\",]$original,\n       rep(0,length(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-3\",]$original)),\n       col=\"red\")\n\n# V1-C-4\nplot(density( as.matrix(wetland.ref.cov[['Nitrogen']][,c(\"V1-C4a\",\"V1-C4b\",\"V1-C4c\",\"V1-C4d\",\"V1-C4e\",\"V1-C4f\",\"V1-C4g\",\"V1-C4h\")]) ,na.rm=T),\n     xlim=c(1,7), type=\"l\", main='V1-C4',xlab='Nitrogen value')\npoints(density(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-4\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-4\",]$original,\n       rep(0,length(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-4\",]$original)),\n       col=\"red\")\n\n# V1-C-5\nplot(density( as.matrix(wetland.ref.cov[['Nitrogen']][,c(\"V1-C5\")]) ,na.rm=T),\n     xlim=c(1,7), type=\"l\", main='V1-C5',xlab='Nitrogen value')\npoints(density(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-5\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-5\",]$original,\n       rep(0,length(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-5\",]$original)),\n       col=\"red\")\n\n# V1-C-6\nplot(density( as.matrix(wetland.ref.cov[['Nitrogen']][,c(\"V1-C6a\",\"V1-C6b\")]) ,na.rm=T),\n     xlim=c(1,7), type=\"l\", main='V1-C6',xlab='Nitrogen value')\npoints(density(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-6\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-6\",]$original,\n       rep(0,length(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-6\",]$original)),\n       col=\"red\")\n\n# V1-C-7\nplot(density( as.matrix(wetland.ref.cov[['Nitrogen']][,c(\"V1-C7a\",\"V1-C7b\")]) ,na.rm=T),\n     xlim=c(1,7), type=\"l\", main='V1-C7',xlab='Nitrogen value')\npoints(density(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-7\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-7\",]$original,\n       rep(0,length(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-7\",]$original)),\n       col=\"red\")\n\n# V1-C-8\nplot(density( as.matrix(wetland.ref.cov[['Nitrogen']][,c(\"V1-C8a\",\"V1-C8b\")]) ,na.rm=T),\n     xlim=c(1,7), type=\"l\", main='V1-C8',xlab='Nitrogen value')\npoints(density(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-8\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-8\",]$original,\n       rep(0,length(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V1-C-8\",]$original)),\n       col=\"red\")\n\npar(mfrow=c(2,4))\n## V2s\n# V2-C-1\nplot(density( as.matrix(wetland.ref.cov[['Nitrogen']][,c(\"V2-C1a\",\"V2-C1b\")]) ,na.rm=T),\n     xlim=c(1,7), type=\"l\", main='V2-C1',xlab='Nitrogen value')\npoints(density(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V2-C-1\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V2-C-1\",]$original,\n       rep(0,length(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V2-C-1\",]$original)),\n       col=\"red\")\n\n# V2-C-2\nplot(density( as.matrix(wetland.ref.cov[['Nitrogen']][,c(\"V2-C2a\",\"V2-C2b\")]) ,na.rm=T),\n     xlim=c(1,7), type=\"l\", main='V2-C2',xlab='Nitrogen value')\npoints(density(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V2-C-2\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V2-C-2\",]$original,\n       rep(0,length(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V2-C-2\",]$original)),\n       col=\"red\")\n\n# V2-C-3\nplot(density( as.matrix(wetland.ref.cov[['Nitrogen']][,c(\"V2-C3a\",\"V2-C3b\")]) ,na.rm=T),\n     xlim=c(1,7), type=\"l\", main='V2-C3',xlab='Nitrogen value')\npoints(density(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V2-C-3\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V2-C-3\",]$original,\n       rep(0,length(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V2-C-3\",]$original)),\n       col=\"red\")\n\n## V3s\n# V3-C-1\nplot(density( as.matrix(wetland.ref.cov[['Nitrogen']][,c(\"V3-C1a\",\"V3-C1b\",\"V3-C1c\",\"V3-C1d\",\"V3-C1e\")]) ,na.rm=T),\n     xlim=c(1,7), type=\"l\", main='V3-C1',xlab='Nitrogen value')\npoints(density(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V3-C-1\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V3-C-1\",]$original,\n       rep(0,length(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V3-C-1\",]$original)),\n       col=\"red\")\n\n# V3-C-2\nplot(density( as.matrix(wetland.ref.cov[['Nitrogen']][,c(\"V3-C2\")]) ,na.rm=T),\n     xlim=c(1,7), type=\"l\", main='V3-C2',xlab='Nitrogen value')\npoints(density(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V3-C-2\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V3-C-2\",]$original,\n       rep(0,length(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V3-C-2\",]$original)),\n       col=\"red\")\n\n## V4s\n# V4-C-2\nplot(density( as.matrix(wetland.ref.cov[['Nitrogen']][,c(\"V4-C2\")]) ,na.rm=T),\n     xlim=c(1,7), type=\"l\", main='V4-C2',xlab='Nitrogen value')\npoints(density(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V4-C-2\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V4-C-2\",]$original,\n       rep(0,length(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V4-C-2\",]$original)),\n       col=\"red\")\n\n## V8s\n# V8-C-1\nplot(density( as.matrix(wetland.ref.cov[['Nitrogen']][,c(\"V8-C1\")]) ,na.rm=T),\n     xlim=c(1,7), type=\"l\", main='V8-C1',xlab='Nitrogen value')\n#points(density(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V8-C-1\",]$original,na.rm=T),\n#       type=\"l\", col=\"red\")\npoints(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V8-C-1\",]$original,\n       rep(0,length(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V8-C-1\",]$original)),\n       col=\"red\")\n\n# V8-C-2\nplot(density( as.matrix(wetland.ref.cov[['Nitrogen']][,c(\"V8-C2\")]) ,na.rm=T),\n     xlim=c(1,7), type=\"l\", main='V8-C2',xlab='Nitrogen value')\n#points(density(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V8-C-2\",]$original,na.rm=T),\n#       type=\"l\", col=\"red\")\npoints(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V8-C-2\",]$original,\n       rep(0,length(res.wetland[res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$fp_ind==\"Nitrogen1\" & res.wetland$kartleggingsenhet_1m2==\"V8-C-2\",]$original)),\n       col=\"red\")\n\nlegend(\"topleft\", legend=c(\"reference\",\"field data\"), pch=c(NA,1), lty=1, col=c(\"black\",\"red\"))"},{"path":"Functional-plant-indicators-wetland.html","id":"exp-fpiw","chapter":"6 Functional Plant Indicators - Wetlands","heading":"6.7.6 Eksport file (final product)","text":"","code":""},{"path":"Functional-plant-indicators-seminat.html","id":"Functional-plant-indicators-seminat","chapter":"7 Functional Plant Indicators - Semi-Natural Ecosystems","heading":"7 Functional Plant Indicators - Semi-Natural Ecosystems","text":"\nNorwegian name: Planteindikatorer\nAuthor date:\nJoachim TöpperMay 2023Indicators described chapter:LightMoisturepHNitrogenPhosphorusGrazing_mowingSoil disturbance","code":""},{"path":"Functional-plant-indicators-seminat.html","id":"intro-fpis","chapter":"7 Functional Plant Indicators - Semi-Natural Ecosystems","heading":"7.1 Introduction","text":"Functional plant indicators can used describe functional signature plant communities calculating community-weighted means plant indicator values plant communities (Diekmann 2003). functional signature plant communities may indicative ecosystem identity, depending functional plant indicator look (cf. Töpper et al. 2018). instance, using indicator moisture one find functional signature higher moisture values plant communities mires compared e.g. grasslands forests. Deviations functional signature indicator beyond certain range indicator values (course natural variation functional signatures within ecosystem type) may related reduction ecological condition. , combine functional plant indicator data field sampled plant community data Norwegian nature monitoring program ANO (Tingstad et al. 2019) semi-natural ecosystems. calculate functional signature plant communities monitored sites respect light, moisture, pH, nitrogen, phosphorus, grazing_mowing, soil disturbance. functional signatures compared reference distributions functional signature, separately semi-natural ecosystem type, calculated ‘generalized species lists’ underlying Norwegian categorization system eco-diversity (Halvorsen et al. 2020). plant functional condition indicators developed following principles technical protocol IBECA framework (Jakobsson et al. 2021, Töpper & Jakobsson 2021). Note deviations reference may occur directions, e.g. soil disturbance signature testing data may higher lower reference. Deviations two directions indicate different environmental phenomena thus treated separately. Therefore, develop two condition indicators functional plant indicator, lower one upper one (see details).","code":""},{"path":"Functional-plant-indicators-seminat.html","id":"about-the-underlying-data-4","chapter":"7 Functional Plant Indicators - Semi-Natural Ecosystems","heading":"7.2 About the underlying data","text":"‘functional plant indicator’ project semi-natural ecosystems, use four sets data building indicators ecological condition:test data use plant community data (1) ANO monitoring scheme (cf. Tingstad et al. 2019) (2) ASO monitoring scheme (cf. Bär et al. 2021)reference data use (3) generalized species lists Norwegian categorization system eco-diversity (NiN) (cf. Halvorsen et al. 2020)Swedish plant indicator data light, moisture, pH, nitrogen, phosphorus, grazing_mowing, soil disturbance Tyler et al. (2021)\nSwedish plant indicator data light, moisture, pH, nitrogen, phosphorus, grazing_mowing, soil disturbance Tyler et al. (2021)ANO monitoring data:\nANO stands ‘areal-representativ naturovervåking’, .e. ‘area representative nature monitoring’. 1000 sites randomly distributed across mainland Norway visited within 5-year cycle. ANO site spans 500 x 500 m grid cell, data collection ANO site includes 18 evenly distributed vegetation analyses 1 x 1 m plots (18, evenly distributed points may water otherwise inaccessible). vegetation analyses, cover vascular plant species plot recorded. Every vegetation analysis accompanied assessment ecosystem plot lies , including ecosystem type additional variables related ecosystem-specific drivers state. analysis document, use plots classified one semi-natural ecosystem types Norwegian categorization system eco-diversity (NiN).\nanalysis document, use data available Miljødirektoratets kartkatalog (https://kartkatalog.miljodirektoratet./Dataset/Details/2054), comprises data first three ANO-years, 2019-2021, total 8887 plots 498 sites.ANO monitoring data:\nANO stands ‘areal-representativ naturovervåking’, .e. ‘area representative nature monitoring’. 1000 sites randomly distributed across mainland Norway visited within 5-year cycle. ANO site spans 500 x 500 m grid cell, data collection ANO site includes 18 evenly distributed vegetation analyses 1 x 1 m plots (18, evenly distributed points may water otherwise inaccessible). vegetation analyses, cover vascular plant species plot recorded. Every vegetation analysis accompanied assessment ecosystem plot lies , including ecosystem type additional variables related ecosystem-specific drivers state. analysis document, use plots classified one semi-natural ecosystem types Norwegian categorization system eco-diversity (NiN).\nanalysis document, use data available Miljødirektoratets kartkatalog (https://kartkatalog.miljodirektoratet./Dataset/Details/2054), comprises data first three ANO-years, 2019-2021, total 8887 plots 498 sites.ASO monitoring data\nASO stands ‘arealrepresentativ overvåking av semi-naturlig eng’, .e. ‘area representative monitoring semi-natural meadows’. ASO ca. 20 areas chosen annually based probabilistic distribution model semi-natural meadows Norway (see Johansen et al. 2017 details). ASO area (område) spans 10 x 10 km grid cell, maximum 10 sites (flate) 500 x 500 m chosen. site, semi-natural meadows (eng) area least 250 sqm delineated. three meadows per site plant species composition sampled using transect method. vegetation transect analyses, cover frequency vascular plant species along transect recorded. every meadow, species data collection accompanied assessment ecosystem, including ecosystem type additional variables related ecosystem-specific drivers state.\nanalysis document, use ASO data 2022 data 2021 ASO pilot 2019 sufficiently good shape yet. future, ASO data probably available Miljødirektoratets kartkatalog.ASO monitoring data\nASO stands ‘arealrepresentativ overvåking av semi-naturlig eng’, .e. ‘area representative monitoring semi-natural meadows’. ASO ca. 20 areas chosen annually based probabilistic distribution model semi-natural meadows Norway (see Johansen et al. 2017 details). ASO area (område) spans 10 x 10 km grid cell, maximum 10 sites (flate) 500 x 500 m chosen. site, semi-natural meadows (eng) area least 250 sqm delineated. three meadows per site plant species composition sampled using transect method. vegetation transect analyses, cover frequency vascular plant species along transect recorded. every meadow, species data collection accompanied assessment ecosystem, including ecosystem type additional variables related ecosystem-specific drivers state.\nanalysis document, use ASO data 2022 data 2021 ASO pilot 2019 sufficiently good shape yet. future, ASO data probably available Miljødirektoratets kartkatalog.NiN reference data:\ngeneralized species lists underlying ecosystem categorization NiN represent expert-compiled species lists based empirical evidence literature expert knowledge systems species. lists, every species assigned abundance value 6-step scale, step representing range ‘expected combination frequency cover’ occurrence (1: < 1/32, 2: 1/32 - 1/8 , 3: 1/8 - 3/8, 4: 3/8 - 4/5, 5: 3/8 - 4/5 + dominance, 6: > 4/5). purpose project, steps simplified maximum ‘expected combination frequency cover’, whereby steps 4 & 5 assigned 0.6 0.8, respectively, order distinguish .NiN reference data:\ngeneralized species lists underlying ecosystem categorization NiN represent expert-compiled species lists based empirical evidence literature expert knowledge systems species. lists, every species assigned abundance value 6-step scale, step representing range ‘expected combination frequency cover’ occurrence (1: < 1/32, 2: 1/32 - 1/8 , 3: 1/8 - 3/8, 4: 3/8 - 4/5, 5: 3/8 - 4/5 + dominance, 6: > 4/5). purpose project, steps simplified maximum ‘expected combination frequency cover’, whereby steps 4 & 5 assigned 0.6 0.8, respectively, order distinguish .Swedish plant indicator set published Tyler et al. (2021) contains large collection plant indicators based Swedish flora, well representative Norwegian flora well. set, decided include indicator data light, moisture, pH, nitrogen, phosphorus, grazing_mowing, soil disturbance semi-natural ecosystems thought subject potential change due abandonment, drainage/flooding, pollution, erosion.Swedish plant indicator set published Tyler et al. (2021) contains large collection plant indicators based Swedish flora, well representative Norwegian flora well. set, decided include indicator data light, moisture, pH, nitrogen, phosphorus, grazing_mowing, soil disturbance semi-natural ecosystems thought subject potential change due abandonment, drainage/flooding, pollution, erosion.","code":""},{"path":"Functional-plant-indicators-seminat.html","id":"representativity-in-time-and-space-5","chapter":"7 Functional Plant Indicators - Semi-Natural Ecosystems","heading":"7.2.1 Representativity in time and space","text":"semi-natural ecosystems, ANO data analysis contain 233 plots 83 sites, principle distributed randomly across country. semi-natural ecosystems occur often certain regions Norway others, amount plots sites equal among Norway’s five regions. 233 plots distributed across regions following way:Northern Norway: 74Central Norway: 36Eastern Norway: 30Western Norway: 84Southern Norway: 6For ASO, analysis covers 381 meadow transects 96 sites.381 transects, 61 missing coordinates, remaining 320 transects distributed across regions following way:Northern Norway: 107Central Norway: 83Eastern Norway: 49Western Norway: 78Southern Norway: 3","code":""},{"path":"Functional-plant-indicators-seminat.html","id":"temporal-coverage-4","chapter":"7 Functional Plant Indicators - Semi-Natural Ecosystems","heading":"7.2.2 Temporal coverage","text":"ANO evaluation data cover first three years, 2019-2021, first 5-year-cycle ANO monitoring scheme, well 2022 ASO-data. Thus actual time series data, indicator evaluation therefore include temporal analyses.","code":""},{"path":"Functional-plant-indicators-seminat.html","id":"collinearities-with-other-indicators-6","chapter":"7 Functional Plant Indicators - Semi-Natural Ecosystems","heading":"7.3 Collinearities with other indicators","text":"","code":""},{"path":"Functional-plant-indicators-seminat.html","id":"reference-state-and-values-2","chapter":"7 Functional Plant Indicators - Semi-Natural Ecosystems","heading":"7.4 Reference state and values","text":"","code":""},{"path":"Functional-plant-indicators-seminat.html","id":"reference-state-1","chapter":"7 Functional Plant Indicators - Semi-Natural Ecosystems","heading":"7.4.1 Reference state","text":"reference state defined via functional signature generalized species lists NiN (see also Töpper et al. 2018). bootstrapping species lists (see details ) calculating community-weighted means functional plant indicators every re-sampled community, describe reference state distribution indicator values respective plant functional indicator. distributions calculated minor ecosystem types (“grunntyper” “kartleggingsenheter” 1:5000 mapping scale) within major ecosystem types (hovedtyper) NiN. extensive discussion use reference communities can found Jakobsson et al. (2020).","code":""},{"path":"Functional-plant-indicators-seminat.html","id":"reference-values-thresholds-for-defining-good-ecological-condition-minimum-andor-maximum-values-3","chapter":"7 Functional Plant Indicators - Semi-Natural Ecosystems","heading":"7.4.2 Reference values, thresholds for defining good ecological condition, minimum and/or maximum values","text":"analysis, derive scaling values statistical (, non-parametric) distributions (see Jakobsson et al. 2010). ecosystem sub-type plant functional indicator, reference value defined median value indicator value distribution. cases distributions naturally two-sided (see Heat-requirement indicator mountain assessment example one-sided functional plant indicator, Fremstad et al. 2022), deviation optimal state thus may occur direction (e.g. indicating low high pH), need define two threshold values good ecological condition well minimum maximum value. line previous assessments ecological condition Norwegian forests mountains, define lower upper threshold value via 95% confidence interval reference distribution, .e. 0.025 0.975 quantiles. minimum maximum values given minimum maximum possible indicator values respective plant functional indicator. details scaling principles IBECA, please see Töpper & Jakobsson (2021).","code":""},{"path":"Functional-plant-indicators-seminat.html","id":"uncertainties-5","chapter":"7 Functional Plant Indicators - Semi-Natural Ecosystems","heading":"7.5 Uncertainties","text":"can calculate mean indicator value (scaling) every region (delimited area interest) well corresponding standard error measure spatial uncertainty geographical area.","code":""},{"path":"Functional-plant-indicators-seminat.html","id":"references-6","chapter":"7 Functional Plant Indicators - Semi-Natural Ecosystems","heading":"7.6 References","text":"Bär, ., Albertsen, E., Bele, B., Daugstad, K., Grenne, S.N., Jakobsson, S., Solbu, E.B., Thorvaldsen, P., Vesterbukt, P., Wehn, S. & Johansen, L. 2021. Utvikling av nasjonal arealrepresentativ overvåking av semi-naturlig eng (ASO). Uttesting, ferdigstilling og utvalg av områder. NIBIO Rapport 7 (7). 84 s.Diekmann, M. 2003. Species indicator values important tool applied plant ecology - review. Basic Applied Ecology 4: 493-506, doi:10.1078/1439-1791-00185Framstad, E., Kolstad, . L., Nybø, S., Töpper, J. & Vandvik, V. 2022. condition forest mountain ecosystems Norway. Assessment IBECA method. NINA Report 2100. Norwegian Institute Nature Research.Halvorsen, R., Skarpaas, O., Bryn, ., Bratli, H., Erikstad, L., Simensen, T., & Lieungh, E. (2020). Towards systematics ecodiversity: EcoSyst framework. Global Ecology Biogeography, 29(11), 1887-1906. doi:10.1111/geb.13164Jakobsson, S., Töpper, J.P., Evju, M., Framstad, E., Lyngstad, ., Pedersen, B., Sickel, H., Sverdrup-Thygeson, ., Vandvik. V., Velle, L.G., Aarrestad, P.. & Nybø, S. 2020. Setting reference levels limits good ecological condition terrestrial ecosystems. Insights case study based IBECA approach. Ecological Indicators 116: 106492.Jakobsson, S., Evju, M., Framstad, E., Imbert, ., Lyngstad, ., Sickel, H., Sverdrup-Thygeson, ., Töpper, J., Vandvik, V., Velle, L.G., Aarrestad, P.. & Nybø, S. 2021. index-based assessment ecological condition links international frameworks. Ecological Indicators 124: 107252.Johansen, L., S. Wehn, R. Halvorsen, og K. Hovstad. 2017. Metode overvåking av semi-naturlig eng Norge. NIBIO Rapport 3 (25). 35 s.Tingstad, L., Evju, M., Sickel, H., & Töpper, J. 2019. Utvikling av nasjonal arealrepresentativ naturovervåking (ANO). Forslag til gjennomføring, protokoller og kostnadsvurderinger med utgangspunkt erfaringer fra uttesting Trøndelag. NINA Rapport 1642.Töpper, J. & Jakobsson, S. 2021. Index-Based Ecological Condition Assessment (IBECA) - Technical protocol, version 1.0. NINA Report 1967. Norwegian Institute Nature Research.Töpper, J., Velle, L.G. & Vandvik, V. 2018. Developing method assessment ecological state based indicator values Ellenberg Grime (revised edition). NINA Report 1529b. Norwegian Institute Nature Research.Tyler, T., Herbertsson, L., Olofsson, J., & Olsson, P. . 2021. Ecological indicator traits values Swedish vascular plants. Ecological -dicators, 120. doi:10.1016/j.ecolind.2020.106923","code":""},{"path":"Functional-plant-indicators-seminat.html","id":"analyses-fpis","chapter":"7 Functional Plant Indicators - Semi-Natural Ecosystems","heading":"7.7 Analyses","text":"","code":""},{"path":"Functional-plant-indicators-seminat.html","id":"data-sets-4","chapter":"7 Functional Plant Indicators - Semi-Natural Ecosystems","heading":"7.7.1 Data sets","text":"ANO dataASO dataPlant indicators Tyler et al. (2021)Generalized species lists NiN","code":""},{"path":"Functional-plant-indicators-seminat.html","id":"data-handling-1","chapter":"7 Functional Plant Indicators - Semi-Natural Ecosystems","heading":"7.7.1.1 Data handling","text":"Checking errorsChecking species nomenclature different species lists make species indicator data possible mergeMerging indicator data monitoring data indicator data reference data\n(shown , documented code)leaving us monitoring data including plant indicators (ANO.sp.ind) reference data including plant indicators (NiN.wetland.cov)ecosystem type NiN species list, can calculate community weighted mean (CWM) relevant functional plant indicators.\nsemi-natural ecosystems, testing “Light”, “Moisture”, “Soil_reaction_pH”, “Nitrogen”, “Phosphorus”, “Grazing_mowing”, “Soil_disturbance”. order get distributions CWMs rather one single value (comparison empirical testing data) NiN lists can bootstrapped.","code":"\nhead(ANO.sp.ind)\n#>      Species art_dekning\n#> 1 Abies alba           0\n#> 2 Abies alba           0\n#> 3 Abies alba           0\n#> 4 Abies alba           0\n#> 5 Abies alba           0\n#> 6 Abies alba           0\n#>                           ParentGlobalID Light Moisture\n#> 1 {0431743B-F268-4819-98F7-FFB7006E55BA}     2        5\n#> 2 {CB1796B9-01F5-4109-B44E-4582CA855F93}     2        5\n#> 3 {4600826A-7E20-4136-9040-5F98356963CE}     2        5\n#> 4 {D880DE20-5DA3-433B-87D3-679C433471A3}     2        5\n#> 5 {AB9ED5C2-E906-4C73-B543-EC6CB28B39D5}     2        5\n#> 6 {B7DD61EE-A113-4486-A4B8-D50ACAAC648B}     2        5\n#>   Soil_reaction_pH Nitrogen Phosphorus Grazing_mowing\n#> 1                5        5          3              1\n#> 2                5        5          3              1\n#> 3                5        5          3              1\n#> 4                5        5          3              1\n#> 5                5        5          3              1\n#> 6                5        5          3              1\n#>   Soil_disturbance\n#> 1                1\n#> 2                1\n#> 3                1\n#> 4                1\n#> 5                1\n#> 6                1\nhead(NiN.seminat.cov)\n#>                        sp T34-C1 T34-C2a T34-C2b T34-C2c\n#> 1    Abietinella abietina      0       0       0       0\n#> 2        Acer platanoides      0       0       0       0\n#> 3    Achillea millefolium      0       0       0       0\n#> 4       Achillea ptarmica      0       0       0       0\n#> 5         Acinos arvensis      0       0       0       0\n#> 6 Aconitum septentrionale      0       0       0       0\n#>   T34-C3 T34-C4a T34-C4b T34-C4c T34-C4d T34-C5a T34-C5b\n#> 1      0       0 0.00000 0.00000       0       0 0.00000\n#> 2      0       0 0.00000 0.00000       0       0 0.00000\n#> 3      0       0 0.03125 0.03125       0       0 0.03125\n#> 4      0       0 0.00000 0.00000       0       0 0.00000\n#> 5      0       0 0.00000 0.00000       0       0 0.00000\n#> 6      0       0 0.00000 0.00000       0       0 0.00000\n#>   T34-C5c T34-C6a T34-C6b T34-C6c T32-C1C2 T32-C3C4\n#> 1 0.00000       0 0.00000 0.00000  0.00000  0.00000\n#> 2 0.00000       0 0.00000 0.00000  0.00000  0.00000\n#> 3 0.03125       0 0.03125 0.03125  0.03125  0.60000\n#> 4 0.00000       0 0.00000 0.00000  0.00000  0.03125\n#> 5 0.00000       0 0.00000 0.00000  0.00000  0.00000\n#> 6 0.00000       0 0.00000 0.00000  0.00000  0.00000\n#>   T32-C5C20a T32-C7C8 T32-C5C20b T32-C9a T32-C9b T32-C15\n#> 1    0.03125  0.37500    0.03125   0.000 0.00000 0.60000\n#> 2    0.00000  0.00000    0.00000   0.000 0.00000 0.00000\n#> 3    0.37500  0.37500    0.60000   0.125 0.03125 0.37500\n#> 4    0.03125  0.03125    0.03125   0.000 0.00000 0.03125\n#> 5    0.03125  0.12500    0.03125   0.000 0.00000 0.12500\n#> 6    0.03125  0.03125    0.00000   0.125 0.00000 0.00000\n#>   T32-C21C6a T32-C21C6b T32-C10a T32-C10b T32-C16    T41a\n#> 1    0.03125    0.03125  0.00000  0.00000 0.37500 0.00000\n#> 2    0.00000    0.00000  0.00000  0.00000 0.00000 0.00000\n#> 3    0.60000    0.80000  0.37500  0.12500 0.37500 0.12500\n#> 4    0.03125    0.03125  0.03125  0.03125 0.03125 0.03125\n#> 5    0.00000    0.00000  0.00000  0.00000 0.03125 0.00000\n#> 6    0.00000    0.00000  0.03125  0.00000 0.00000 0.00000\n#>      T41b T45-C1C2 T45-C3 V10-C1C2 V10-C3 Light Moisture\n#> 1 0.00000  0.00000      0        0      0    NA       NA\n#> 2 0.00000  0.00000      0        0      0     4        4\n#> 3 0.37500  0.03125      0        0      0     6        2\n#> 4 0.03125  0.00000      0        0      0     5        6\n#> 5 0.00000  0.00000      0        0      0     7        1\n#> 6 0.00000  0.00000      0        0      0     4        5\n#>   Soil_reaction_pH Nitrogen Phosphorus Grazing_mowing\n#> 1               NA       NA         NA             NA\n#> 2                6        5          3              2\n#> 3                5        5          5              5\n#> 4                4        4          3              4\n#> 5                7        3          1              6\n#> 6                7        7          5              3\n#>   Soil_disturbance\n#> 1               NA\n#> 2                5\n#> 3                2\n#> 4                2\n#> 5                7\n#> 6                2"},{"path":"Functional-plant-indicators-seminat.html","id":"bootstrap-function-for-frequency-abundance-1","chapter":"7 Functional Plant Indicators - Semi-Natural Ecosystems","heading":"7.7.1.1.1 bootstrap function for frequency abundance","text":"function calculate community weighted means selected indicator values (ind)species lists (sp) given abundances percent (scale 0 1) one ‘sites’ (abun)given number iterations (iter),species given certain minimum abundance occurring bootstraps (obl), andwith given re-sampling ratio original species list (rat)every bootstrap iteration abundance sampled species can randomly changed limited amount wished introducing re-sampling abundance values adjacent abundance steps certain probability (var.abun)Running bootstrapsThis results R-list slot every selected indicator, every slot ’s data frame many columns NiN species lists many rows iterations bootstrap.\nNext, need derive scaling values bootstrap-lists (columns) every mapping unit NiN. , define things following way:Median = reference values0.025 0.975 quantiles = lower upper limit valuesmin max respective indicator’s scale = min/max valuesOnce test data (ANO) scaling values reference data (NiN) place, can calculate CWMs selected indicators ANO community data scale scaling values reference distribution. Note scale ANO plot’s CWM either lower threshold value min value upper threshold value max value based whether CWM smaller higher reference value. Since scaled values sides range 0 1, generate separate lower upper condition indicators functional plant indicator. ANO plot can scaled value either lower upper indicator (one ‘NA’), except unlikely event CWM exactly matches reference value, case lower upper indicator receive scaled indicator value 1.scaling functionWe can prepare list data frames hold results perform scaling according principles described NINA report 1967 (Töpper Jakobsson 2021)\ndone separately ANO ASO. First ANO:ASO:","code":"\ncolnames(NiN.seminat)\n# 1st column is the species\n# 2nd-35th column is the abundances of sp in different ecosystem types\n# 36th-42nd column is the indicator values of the respective species\n# we choose 1000 iterations\n# species with abundance 1 (i.e. a max of 100%, must be included in each sample)\n# each sample re-samples 1/3 of the number of species\n# the abundance of the re-sampled species may vary (see bootstrap function for details)\nseminat.ref.cov <- indBoot.freq(sp=NiN.seminat.cov[,1],abun=NiN.seminat.cov[,2:35],ind=NiN.seminat.cov[,36:42],\n                                iter=1000,obl=1,rat=1/3,var.abun=T)\n\n# fixing NaNs\nfor (i in 1:length(seminat.ref.cov) ) {\n  for (j in 1:ncol(seminat.ref.cov[[i]]) ) {\n    v <- seminat.ref.cov[[i]][,j]\n    v[is.nan(v)] <- NA\n    seminat.ref.cov[[i]][,j] <- v\n  }\n}\nhead(seminat.ref.cov[[1]])\n#>     T34-C1  T34-C2a  T34-C2b  T34-C2c   T34-C3  T34-C4a\n#> 1 4.495751 4.668869 5.187970 4.913599 4.471859 5.044185\n#> 2 4.798450 4.789003 5.112410 4.897709 4.776579 5.063167\n#> 3 4.723618 4.693841 5.284698 4.929487 4.869919 4.661407\n#> 4 4.676056 5.077778 5.052503 5.073930 4.047897 5.147425\n#> 5 4.283480 4.925737 4.749687 4.936929 4.641347 5.115889\n#> 6 4.439506 4.992091 4.975490 5.040605 4.395466 4.782738\n#>    T34-C4b  T34-C4c  T34-C4d  T34-C5a  T34-C5b  T34-C5c\n#> 1 4.905660 4.831395 5.138790 4.976965 5.305769 5.358025\n#> 2 4.901687 4.903049 5.356568 4.928693 5.177665 5.633907\n#> 3 5.167203 5.053498 5.128882 5.028829 4.947210 5.298851\n#> 4 5.076003 4.687811 5.152466 4.780269 5.279133 5.332696\n#> 5 4.793367 4.763258 5.149013 5.052083 4.692387 4.997319\n#> 6 4.847183 4.508185 5.120944 4.988289 5.096742 5.337802\n#>    T34-C6a  T34-C6b  T34-C6c T32-C1C2 T32-C3C4 T32-C5C20a\n#> 1 4.829918 4.901768 5.295416 5.197669 5.095587   5.395248\n#> 2 4.785810 5.021924 5.420382 5.120633 5.106313   5.363305\n#> 3 4.899598 4.934539 5.544503 4.954911 5.141557   5.453696\n#> 4 5.322330 4.637644 4.875371 4.855372 5.030933   5.002085\n#> 5 4.905172 5.511243 4.914040 5.142040 5.012225   5.081940\n#> 6 4.968932 5.136364 5.213483 4.939894 5.276843   5.006351\n#>   T32-C7C8 T32-C5C20b  T32-C9a  T32-C9b  T32-C15 T32-C21C6a\n#> 1 5.456988   5.338915 4.603297 4.788480 5.517286   4.903005\n#> 2 5.157865   5.068729 4.742119 4.724733 5.577006   5.149119\n#> 3 5.287039   4.886700 4.827151 5.009886 5.712148   5.207692\n#> 4 5.135981   5.251815 4.609005 5.140180 5.420782   5.033461\n#> 5 5.188301   4.942563 4.733110 4.810544 5.852586   5.131613\n#> 6 5.343639   5.356093 4.980053 4.853164 5.552720   4.961377\n#>   T32-C21C6b T32-C10a T32-C10b  T32-C16     T41a     T41b\n#> 1   5.387918 4.743021 5.271682 5.526920 5.370405 5.383284\n#> 2   5.080102 4.943583 4.695790 5.733663 5.185846 5.629372\n#> 3   5.190100 4.798118 4.538592 5.487988 5.306589 5.119463\n#> 4   4.998872 5.099108 4.777846 5.799784 5.270177 5.350643\n#> 5   5.266511 4.837270 5.137168 5.491109 5.364764 5.246287\n#> 6   5.259280 4.984589 4.751285 5.369032 5.205766 5.392884\n#>   T45-C1C2   T45-C3 V10-C1C2   V10-C3\n#> 1 5.704686 5.992205 5.139970 4.643880\n#> 2 5.737460 6.085568 4.941102 4.448135\n#> 3 5.589718 5.661303 5.037154 4.625765\n#> 4 5.851431 5.732010 5.060109 5.026214\n#> 5 5.392019 5.832375 4.533404 4.802741\n#> 6 5.277558 5.885154 4.888081 4.548364#>     T34-C1  T34-C2a  T34-C2b  T34-C2c   T34-C3  T34-C4a\n#> 1 4.495751 4.668869 5.187970 4.913599 4.471859 5.044185\n#> 2 4.798450 4.789003 5.112410 4.897709 4.776579 5.063167\n#> 3 4.723618 4.693841 5.284698 4.929487 4.869919 4.661407\n#> 4 4.676056 5.077778 5.052503 5.073930 4.047897 5.147425\n#> 5 4.283480 4.925737 4.749687 4.936929 4.641347 5.115889\n#> 6 4.439506 4.992091 4.975490 5.040605 4.395466 4.782738\n#>    T34-C4b  T34-C4c  T34-C4d  T34-C5a  T34-C5b  T34-C5c\n#> 1 4.905660 4.831395 5.138790 4.976965 5.305769 5.358025\n#> 2 4.901687 4.903049 5.356568 4.928693 5.177665 5.633907\n#> 3 5.167203 5.053498 5.128882 5.028829 4.947210 5.298851\n#> 4 5.076003 4.687811 5.152466 4.780269 5.279133 5.332696\n#> 5 4.793367 4.763258 5.149013 5.052083 4.692387 4.997319\n#> 6 4.847183 4.508185 5.120944 4.988289 5.096742 5.337802\n#>    T34-C6a  T34-C6b  T34-C6c T32-C1C2 T32-C3C4 T32-C5C20a\n#> 1 4.829918 4.901768 5.295416 5.197669 5.095587   5.395248\n#> 2 4.785810 5.021924 5.420382 5.120633 5.106313   5.363305\n#> 3 4.899598 4.934539 5.544503 4.954911 5.141557   5.453696\n#> 4 5.322330 4.637644 4.875371 4.855372 5.030933   5.002085\n#> 5 4.905172 5.511243 4.914040 5.142040 5.012225   5.081940\n#> 6 4.968932 5.136364 5.213483 4.939894 5.276843   5.006351\n#>   T32-C7C8 T32-C5C20b  T32-C9a  T32-C9b  T32-C15 T32-C21C6a\n#> 1 5.456988   5.338915 4.603297 4.788480 5.517286   4.903005\n#> 2 5.157865   5.068729 4.742119 4.724733 5.577006   5.149119\n#> 3 5.287039   4.886700 4.827151 5.009886 5.712148   5.207692\n#> 4 5.135981   5.251815 4.609005 5.140180 5.420782   5.033461\n#> 5 5.188301   4.942563 4.733110 4.810544 5.852586   5.131613\n#> 6 5.343639   5.356093 4.980053 4.853164 5.552720   4.961377\n#>   T32-C21C6b T32-C10a T32-C10b  T32-C16     T41a     T41b\n#> 1   5.387918 4.743021 5.271682 5.526920 5.370405 5.383284\n#> 2   5.080102 4.943583 4.695790 5.733663 5.185846 5.629372\n#> 3   5.190100 4.798118 4.538592 5.487988 5.306589 5.119463\n#> 4   4.998872 5.099108 4.777846 5.799784 5.270177 5.350643\n#> 5   5.266511 4.837270 5.137168 5.491109 5.364764 5.246287\n#> 6   5.259280 4.984589 4.751285 5.369032 5.205766 5.392884\n#>   T45-C1C2   T45-C3 V10-C1C2   V10-C3\n#> 1 5.704686 5.992205 5.139970 4.643880\n#> 2 5.737460 6.085568 4.941102 4.448135\n#> 3 5.589718 5.661303 5.037154 4.625765\n#> 4 5.851431 5.732010 5.060109 5.026214\n#> 5 5.392019 5.832375 4.533404 4.802741\n#> 6 5.277558 5.885154 4.888081 4.548364\n#>  [1] T34-C1     T34-C2a    T34-C2b    T34-C2c    T34-C3    \n#>  [6] T34-C4a    T34-C4b    T34-C4c    T34-C4d    T34-C5a   \n#> [11] T34-C5b    T34-C5c    T34-C6a    T34-C6b    T34-C6c   \n#> [16] T32-C1C2   T32-C3C4   T32-C5C20a T32-C7C8   T32-C5C20b\n#> [21] T32-C9a    T32-C9b    T32-C15    T32-C21C6a T32-C21C6b\n#> [26] T32-C10a   T32-C10b   T32-C16    T41a       T41b      \n#> [31] T45-C1C2   T45-C3     V10-C1C2   V10-C3    \n#> <0 rows> (or 0-length row.names)\n#>  [1] \"T34-C1\"     \"T34-C2a\"    \"T34-C2b\"    \"T34-C2c\"   \n#>  [5] \"T34-C3\"     \"T34-C4a\"    \"T34-C4b\"    \"T34-C4c\"   \n#>  [9] \"T34-C4d\"    \"T34-C5a\"    \"T34-C5b\"    \"T34-C5c\"   \n#> [13] \"T34-C6a\"    \"T34-C6b\"    \"T34-C6c\"    \"T32-C1C2\"  \n#> [17] \"T32-C3C4\"   \"T32-C5C20a\" \"T32-C7C8\"   \"T32-C5C20b\"\n#> [21] \"T32-C9a\"    \"T32-C9b\"    \"T32-C15\"    \"T32-C21C6a\"\n#> [25] \"T32-C21C6b\" \"T32-C10a\"   \"T32-C10b\"   \"T32-C16\"   \n#> [29] \"T41a\"       \"T41b\"       \"T45-C1C2\"   \"T45-C3\"    \n#> [33] \"V10-C1C2\"   \"V10-C3\"\n#>  [1] \"T34-C1\"    \"T34-C2\"    \"T34-C2\"    \"T34-C2\"   \n#>  [5] \"T34-C3\"    \"T34-C4\"    \"T34-C4\"    \"T34-C4\"   \n#>  [9] \"T34-C4\"    \"T34-C5\"    \"T34-C5\"    \"T34-C5\"   \n#> [13] \"T34-C6\"    \"T34-C6\"    \"T34-C6\"    \"T32-C1C2\" \n#> [17] \"T32-C3C4\"  \"T32-C5C20\" \"T32-C7C8\"  \"T32-C5C20\"\n#> [21] \"T32-C9\"    \"T32-C9\"    \"T32-C15\"   \"T32-C21C6\"\n#> [25] \"T32-C21C6\" \"T32-C10\"   \"T32-C10\"   \"T32-C16\"  \n#> [29] \"T41\"       \"T41\"       \"T45-C1C2\"  \"T45-C3\"   \n#> [33] \"V10-C1C2\"  \"V10-C3\"\n#>          V1       V2       V3       V4       V5       V6\n#> 1  3.694963 4.455855 5.042233 4.064785 4.911158 5.726332\n#> 2  3.872656 4.544696 5.067305 4.291278 5.026818 5.733233\n#> 3  4.683814 5.014867 5.358364 4.317811 5.156158 5.852822\n#> 4  4.865484 5.102876 5.363346 4.034961 4.643624 5.166102\n#> 5  4.981342 5.243469 5.528039 3.830252 4.333141 4.867984\n#> 6  5.276490 5.549659 5.840840 3.058656 3.507617 3.966790\n#> 7  5.340400 5.590502 5.867682 3.325401 3.832367 4.293118\n#> 8  5.161360 5.575833 5.949398 4.443489 5.023939 5.731531\n#> 9  5.328272 5.817253 6.258642 4.308375 5.088821 6.247535\n#> 10 4.612772 4.928749 5.373696 7.076748 7.744906 8.397017\n#> 11 4.468003 4.837483 5.280768 6.589075 7.325905 7.962753\n#> 12       NA       NA       NA       NA       NA       NA\n#> 13       NA       NA       NA       NA       NA       NA\n#> 14       NA       NA       NA       NA       NA       NA\n#> 15       NA       NA       NA       NA       NA       NA\n#> 16       NA       NA       NA       NA       NA       NA\n#> 17       NA       NA       NA       NA       NA       NA\n#> 18       NA       NA       NA       NA       NA       NA\n#> 19       NA       NA       NA       NA       NA       NA\n#> 20       NA       NA       NA       NA       NA       NA\n#>          V7       V8       V9      V10      V11      V12\n#> 1  2.231924 2.763966 3.643059 2.374611 3.306753 4.676875\n#> 2  2.377691 2.996911 3.843860 2.551192 3.275629 4.387774\n#> 3  3.437854 4.051586 4.753529 3.013542 3.801197 4.718075\n#> 4  4.134956 4.550274 4.956232 3.745158 4.295415 4.840228\n#> 5  4.903506 5.402029 5.882318 3.467906 3.907100 4.454971\n#> 6  4.741062 5.137312 5.503883 3.550895 3.898565 4.286540\n#> 7  4.840029 5.198332 5.561334 3.989319 4.530815 5.040762\n#> 8  4.952658 5.452576 6.011182 5.282732 6.062480 6.633160\n#> 9  4.917752 5.561022 6.194208 4.834808 5.812497 6.883664\n#> 10 4.029667 4.616442 5.153380 4.332844 5.253199 6.029532\n#> 11 4.198709 4.750926 5.301648 4.675791 5.482393 6.198834\n#> 12       NA       NA       NA       NA       NA       NA\n#> 13       NA       NA       NA       NA       NA       NA\n#> 14       NA       NA       NA       NA       NA       NA\n#> 15       NA       NA       NA       NA       NA       NA\n#> 16       NA       NA       NA       NA       NA       NA\n#> 17       NA       NA       NA       NA       NA       NA\n#> 18       NA       NA       NA       NA       NA       NA\n#> 19       NA       NA       NA       NA       NA       NA\n#> 20       NA       NA       NA       NA       NA       NA\n#>         V13      V14      V15      V16      V17      V18\n#> 1  2.178991 2.702927 3.440871 2.984216 3.791938 4.358905\n#> 2  2.277478 2.733013 3.347336 3.293034 3.964737 4.543427\n#> 3  2.449075 2.912161 3.486105 4.335506 4.979633 5.536351\n#> 4  2.911345 3.241309 3.577153 4.555127 4.954427 5.370583\n#> 5  2.624162 2.993730 3.348833 4.617482 5.027109 5.427039\n#> 6  2.759828 3.079720 3.432867 4.331891 4.776583 5.189621\n#> 7  3.079555 3.410515 3.731820 4.060324 4.610136 5.147616\n#> 8  3.710334 4.146738 4.552950 3.676524 4.639444 5.412049\n#> 9  3.525970 4.168608 4.788924 3.627166 5.029662 5.757345\n#> 10 3.125459 3.676992 4.160553 3.397081 3.957329 4.541129\n#> 11 3.295643 3.736049 4.161127 3.275067 3.988681 4.596878\n#> 12       NA       NA       NA       NA       NA       NA\n#> 13       NA       NA       NA       NA       NA       NA\n#> 14       NA       NA       NA       NA       NA       NA\n#> 15       NA       NA       NA       NA       NA       NA\n#> 16       NA       NA       NA       NA       NA       NA\n#> 17       NA       NA       NA       NA       NA       NA\n#> 18       NA       NA       NA       NA       NA       NA\n#> 19       NA       NA       NA       NA       NA       NA\n#> 20       NA       NA       NA       NA       NA       NA\n#>         V19      V20      V21      NiN\n#> 1  1.700971 2.585099 3.974465   T34-C1\n#> 2  1.957253 2.712202 3.851444   T34-C3\n#> 3  2.566533 3.341770 4.715854 T32-C1C2\n#> 4  3.107489 3.708287 4.363006 T32-C3C4\n#> 5  3.256646 3.825798 4.440356 T32-C7C8\n#> 6  3.589531 4.102155 4.698638  T32-C15\n#> 7  3.684712 4.315234 5.079617  T32-C16\n#> 8  3.792943 4.772443 5.910748 T45-C1C2\n#> 9  3.887352 5.313561 7.055054   T45-C3\n#> 10 2.408673 3.176236 4.057877 V10-C1C2\n#> 11 2.522885 3.325373 4.404043   V10-C3\n#> 12       NA       NA       NA     <NA>\n#> 13       NA       NA       NA     <NA>\n#> 14       NA       NA       NA     <NA>\n#> 15       NA       NA       NA     <NA>\n#> 16       NA       NA       NA     <NA>\n#> 17       NA       NA       NA     <NA>\n#> 18       NA       NA       NA     <NA>\n#> 19       NA       NA       NA     <NA>\n#> 20       NA       NA       NA     <NA>\n#> [1] \"T34-C2\"    \"T34-C4\"    \"T34-C5\"    \"T34-C6\"   \n#> [5] \"T32-C5C20\" \"T32-C9\"    \"T32-C21C6\" \"T32-C10\"  \n#> [9] \"T41\"\n#> [1] 2 3 4\n#>          V1       V2       V3       V4       V5       V6\n#> 1  3.694963 4.455855 5.042233 4.064785 4.911158 5.726332\n#> 2  3.872656 4.544696 5.067305 4.291278 5.026818 5.733233\n#> 3  4.683814 5.014867 5.358364 4.317811 5.156158 5.852822\n#> 4  4.865484 5.102876 5.363346 4.034961 4.643624 5.166102\n#> 5  4.981342 5.243469 5.528039 3.830252 4.333141 4.867984\n#> 6  5.276490 5.549659 5.840840 3.058656 3.507617 3.966790\n#> 7  5.340400 5.590502 5.867682 3.325401 3.832367 4.293118\n#> 8  5.161360 5.575833 5.949398 4.443489 5.023939 5.731531\n#> 9  5.328272 5.817253 6.258642 4.308375 5.088821 6.247535\n#> 10 4.612772 4.928749 5.373696 7.076748 7.744906 8.397017\n#> 11 4.468003 4.837483 5.280768 6.589075 7.325905 7.962753\n#> 12 4.644287 4.951364 5.337365 3.931920 4.383662 5.483512\n#> 13 4.571538 4.973424 5.479821 3.042370 4.423535 5.515288\n#> 14 4.527074 4.994966 5.516279 3.062607 4.488716 6.141326\n#> 15 4.484462 5.037433 6.102683 3.293148 4.455076 6.097862\n#> 16 4.902428 5.155210 5.411498 3.925413 4.406973 4.921254\n#> 17 4.454662 4.775632 5.200423 5.055916 5.680832 6.385162\n#> 18 4.792464 5.125608 5.428366 4.137763 4.662601 5.116347\n#> 19 4.502474 4.891147 5.281771 4.978014 5.612696 6.322015\n#> 20 5.003183 5.251130 5.513521 4.807721 5.178649 5.590864\n#>          V7       V8       V9      V10      V11      V12\n#> 1  2.231924 2.763966 3.643059 2.374611 3.306753 4.676875\n#> 2  2.377691 2.996911 3.843860 2.551192 3.275629 4.387774\n#> 3  3.437854 4.051586 4.753529 3.013542 3.801197 4.718075\n#> 4  4.134956 4.550274 4.956232 3.745158 4.295415 4.840228\n#> 5  4.903506 5.402029 5.882318 3.467906 3.907100 4.454971\n#> 6  4.741062 5.137312 5.503883 3.550895 3.898565 4.286540\n#> 7  4.840029 5.198332 5.561334 3.989319 4.530815 5.040762\n#> 8  4.952658 5.452576 6.011182 5.282732 6.062480 6.633160\n#> 9  4.917752 5.561022 6.194208 4.834808 5.812497 6.883664\n#> 10 4.029667 4.616442 5.153380 4.332844 5.253199 6.029532\n#> 11 4.198709 4.750926 5.301648 4.675791 5.482393 6.198834\n#> 12 2.028829 2.444579 2.804951 2.080377 2.423099 2.798250\n#> 13 2.232830 2.975433 4.525925 1.994667 2.650282 3.675827\n#> 14 2.778285 4.026055 5.083037 2.118758 2.941948 3.836682\n#> 15 3.020470 4.379822 5.795966 2.108276 2.993038 3.803690\n#> 16 4.706848 5.094791 5.461205 3.629971 4.136638 4.676468\n#> 17 4.514010 4.966522 5.395454 4.479744 5.276425 6.041027\n#> 18 4.758323 5.100929 5.424962 4.255017 4.881833 5.394140\n#> 19 4.716802 5.085724 5.428951 5.015903 5.686866 6.325652\n#> 20 4.851695 5.133712 5.460406 5.327610 5.782120 6.243091\n#>         V13      V14      V15      V16      V17      V18\n#> 1  2.178991 2.702927 3.440871 2.984216 3.791938 4.358905\n#> 2  2.277478 2.733013 3.347336 3.293034 3.964737 4.543427\n#> 3  2.449075 2.912161 3.486105 4.335506 4.979633 5.536351\n#> 4  2.911345 3.241309 3.577153 4.555127 4.954427 5.370583\n#> 5  2.624162 2.993730 3.348833 4.617482 5.027109 5.427039\n#> 6  2.759828 3.079720 3.432867 4.331891 4.776583 5.189621\n#> 7  3.079555 3.410515 3.731820 4.060324 4.610136 5.147616\n#> 8  3.710334 4.146738 4.552950 3.676524 4.639444 5.412049\n#> 9  3.525970 4.168608 4.788924 3.627166 5.029662 5.757345\n#> 10 3.125459 3.676992 4.160553 3.397081 3.957329 4.541129\n#> 11 3.295643 3.736049 4.161127 3.275067 3.988681 4.596878\n#> 12 2.770666 3.324569 3.646475 3.822095 4.199011 4.679568\n#> 13 1.794028 3.055151 3.554441 3.964206 4.460697 5.441127\n#> 14 1.895038 2.755898 3.547876 3.918681 4.583622 5.318680\n#> 15 1.852948 2.719993 3.436248 3.996109 4.559088 5.281011\n#> 16 2.809679 3.139092 3.461385 4.637458 4.987574 5.359284\n#> 17 3.180545 3.668771 4.132592 4.092966 4.585217 5.160583\n#> 18 3.236024 3.581140 3.922420 4.420037 4.855540 5.358011\n#> 19 3.471647 3.924785 4.306964 4.083125 4.661327 5.268052\n#> 20 3.633083 3.899025 4.178710 4.160459 4.668937 5.149184\n#>         V19      V20      V21       NiN\n#> 1  1.700971 2.585099 3.974465    T34-C1\n#> 2  1.957253 2.712202 3.851444    T34-C3\n#> 3  2.566533 3.341770 4.715854  T32-C1C2\n#> 4  3.107489 3.708287 4.363006  T32-C3C4\n#> 5  3.256646 3.825798 4.440356  T32-C7C8\n#> 6  3.589531 4.102155 4.698638   T32-C15\n#> 7  3.684712 4.315234 5.079617   T32-C16\n#> 8  3.792943 4.772443 5.910748  T45-C1C2\n#> 9  3.887352 5.313561 7.055054    T45-C3\n#> 10 2.408673 3.176236 4.057877  V10-C1C2\n#> 11 2.522885 3.325373 4.404043    V10-C3\n#> 12 3.209041 4.138198 4.686286    T34-C2\n#> 13 2.769936 3.864515 4.593340    T34-C4\n#> 14 2.607216 3.647634 4.573322    T34-C5\n#> 15 2.672613 3.638081 4.486693    T34-C6\n#> 16 3.118888 3.635034 4.203783 T32-C5C20\n#> 17 2.529383 3.026330 3.779491    T32-C9\n#> 18 3.027811 3.730151 4.588422 T32-C21C6\n#> 19 2.657839 3.315751 4.100310   T32-C10\n#> 20 3.390231 3.953994 4.583870       T41\n#>           V1       V2       V3       V4       V5       V6\n#> 1   3.694963 4.455855 5.042233 4.064785 4.911158 5.726332\n#> 2   3.872656 4.544696 5.067305 4.291278 5.026818 5.733233\n#> 3   4.683814 5.014867 5.358364 4.317811 5.156158 5.852822\n#> 4   4.865484 5.102876 5.363346 4.034961 4.643624 5.166102\n#> 5   4.981342 5.243469 5.528039 3.830252 4.333141 4.867984\n#> 6   5.276490 5.549659 5.840840 3.058656 3.507617 3.966790\n#> 7   5.340400 5.590502 5.867682 3.325401 3.832367 4.293118\n#> 8   5.161360 5.575833 5.949398 4.443489 5.023939 5.731531\n#> 9   5.328272 5.817253 6.258642 4.308375 5.088821 6.247535\n#> 10  4.612772 4.928749 5.373696 7.076748 7.744906 8.397017\n#> 11  4.468003 4.837483 5.280768 6.589075 7.325905 7.962753\n#> 12  4.644287 4.951364 5.337365 3.931920 4.383662 5.483512\n#> 13  4.571538 4.973424 5.479821 3.042370 4.423535 5.515288\n#> 14  4.527074 4.994966 5.516279 3.062607 4.488716 6.141326\n#> 15  4.484462 5.037433 6.102683 3.293148 4.455076 6.097862\n#> 16  4.902428 5.155210 5.411498 3.925413 4.406973 4.921254\n#> 17  4.454662 4.775632 5.200423 5.055916 5.680832 6.385162\n#> 18  4.792464 5.125608 5.428366 4.137763 4.662601 5.116347\n#> 19  4.502474 4.891147 5.281771 4.978014 5.612696 6.322015\n#> 20  5.003183 5.251130 5.513521 4.807721 5.178649 5.590864\n#> 31  4.683814 5.014867 5.358364 4.317811 5.156158 5.852822\n#> 41  4.865484 5.102876 5.363346 4.034961 4.643624 5.166102\n#> 51  4.981342 5.243469 5.528039 3.830252 4.333141 4.867984\n#> 81  5.161360 5.575833 5.949398 4.443489 5.023939 5.731531\n#> 101 4.612772 4.928749 5.373696 7.076748 7.744906 8.397017\n#> 161 4.902428 5.155210 5.411498 3.925413 4.406973 4.921254\n#> 181 4.792464 5.125608 5.428366 4.137763 4.662601 5.116347\n#>           V7       V8       V9      V10      V11      V12\n#> 1   2.231924 2.763966 3.643059 2.374611 3.306753 4.676875\n#> 2   2.377691 2.996911 3.843860 2.551192 3.275629 4.387774\n#> 3   3.437854 4.051586 4.753529 3.013542 3.801197 4.718075\n#> 4   4.134956 4.550274 4.956232 3.745158 4.295415 4.840228\n#> 5   4.903506 5.402029 5.882318 3.467906 3.907100 4.454971\n#> 6   4.741062 5.137312 5.503883 3.550895 3.898565 4.286540\n#> 7   4.840029 5.198332 5.561334 3.989319 4.530815 5.040762\n#> 8   4.952658 5.452576 6.011182 5.282732 6.062480 6.633160\n#> 9   4.917752 5.561022 6.194208 4.834808 5.812497 6.883664\n#> 10  4.029667 4.616442 5.153380 4.332844 5.253199 6.029532\n#> 11  4.198709 4.750926 5.301648 4.675791 5.482393 6.198834\n#> 12  2.028829 2.444579 2.804951 2.080377 2.423099 2.798250\n#> 13  2.232830 2.975433 4.525925 1.994667 2.650282 3.675827\n#> 14  2.778285 4.026055 5.083037 2.118758 2.941948 3.836682\n#> 15  3.020470 4.379822 5.795966 2.108276 2.993038 3.803690\n#> 16  4.706848 5.094791 5.461205 3.629971 4.136638 4.676468\n#> 17  4.514010 4.966522 5.395454 4.479744 5.276425 6.041027\n#> 18  4.758323 5.100929 5.424962 4.255017 4.881833 5.394140\n#> 19  4.716802 5.085724 5.428951 5.015903 5.686866 6.325652\n#> 20  4.851695 5.133712 5.460406 5.327610 5.782120 6.243091\n#> 31  3.437854 4.051586 4.753529 3.013542 3.801197 4.718075\n#> 41  4.134956 4.550274 4.956232 3.745158 4.295415 4.840228\n#> 51  4.903506 5.402029 5.882318 3.467906 3.907100 4.454971\n#> 81  4.952658 5.452576 6.011182 5.282732 6.062480 6.633160\n#> 101 4.029667 4.616442 5.153380 4.332844 5.253199 6.029532\n#> 161 4.706848 5.094791 5.461205 3.629971 4.136638 4.676468\n#> 181 4.758323 5.100929 5.424962 4.255017 4.881833 5.394140\n#>          V13      V14      V15      V16      V17      V18\n#> 1   2.178991 2.702927 3.440871 2.984216 3.791938 4.358905\n#> 2   2.277478 2.733013 3.347336 3.293034 3.964737 4.543427\n#> 3   2.449075 2.912161 3.486105 4.335506 4.979633 5.536351\n#> 4   2.911345 3.241309 3.577153 4.555127 4.954427 5.370583\n#> 5   2.624162 2.993730 3.348833 4.617482 5.027109 5.427039\n#> 6   2.759828 3.079720 3.432867 4.331891 4.776583 5.189621\n#> 7   3.079555 3.410515 3.731820 4.060324 4.610136 5.147616\n#> 8   3.710334 4.146738 4.552950 3.676524 4.639444 5.412049\n#> 9   3.525970 4.168608 4.788924 3.627166 5.029662 5.757345\n#> 10  3.125459 3.676992 4.160553 3.397081 3.957329 4.541129\n#> 11  3.295643 3.736049 4.161127 3.275067 3.988681 4.596878\n#> 12  2.770666 3.324569 3.646475 3.822095 4.199011 4.679568\n#> 13  1.794028 3.055151 3.554441 3.964206 4.460697 5.441127\n#> 14  1.895038 2.755898 3.547876 3.918681 4.583622 5.318680\n#> 15  1.852948 2.719993 3.436248 3.996109 4.559088 5.281011\n#> 16  2.809679 3.139092 3.461385 4.637458 4.987574 5.359284\n#> 17  3.180545 3.668771 4.132592 4.092966 4.585217 5.160583\n#> 18  3.236024 3.581140 3.922420 4.420037 4.855540 5.358011\n#> 19  3.471647 3.924785 4.306964 4.083125 4.661327 5.268052\n#> 20  3.633083 3.899025 4.178710 4.160459 4.668937 5.149184\n#> 31  2.449075 2.912161 3.486105 4.335506 4.979633 5.536351\n#> 41  2.911345 3.241309 3.577153 4.555127 4.954427 5.370583\n#> 51  2.624162 2.993730 3.348833 4.617482 5.027109 5.427039\n#> 81  3.710334 4.146738 4.552950 3.676524 4.639444 5.412049\n#> 101 3.125459 3.676992 4.160553 3.397081 3.957329 4.541129\n#> 161 2.809679 3.139092 3.461385 4.637458 4.987574 5.359284\n#> 181 3.236024 3.581140 3.922420 4.420037 4.855540 5.358011\n#>          V19      V20      V21     NiN\n#> 1   1.700971 2.585099 3.974465  T34-C1\n#> 2   1.957253 2.712202 3.851444  T34-C3\n#> 3   2.566533 3.341770 4.715854  T32-C1\n#> 4   3.107489 3.708287 4.363006  T32-C3\n#> 5   3.256646 3.825798 4.440356  T32-C7\n#> 6   3.589531 4.102155 4.698638 T32-C15\n#> 7   3.684712 4.315234 5.079617 T32-C16\n#> 8   3.792943 4.772443 5.910748  T45-C1\n#> 9   3.887352 5.313561 7.055054  T45-C3\n#> 10  2.408673 3.176236 4.057877  V10-C1\n#> 11  2.522885 3.325373 4.404043  V10-C3\n#> 12  3.209041 4.138198 4.686286  T34-C2\n#> 13  2.769936 3.864515 4.593340  T34-C4\n#> 14  2.607216 3.647634 4.573322  T34-C5\n#> 15  2.672613 3.638081 4.486693  T34-C6\n#> 16  3.118888 3.635034 4.203783  T32-C5\n#> 17  2.529383 3.026330 3.779491  T32-C9\n#> 18  3.027811 3.730151 4.588422 T32-C21\n#> 19  2.657839 3.315751 4.100310 T32-C10\n#> 20  3.390231 3.953994 4.583870     T41\n#> 31  2.566533 3.341770 4.715854  T32-C2\n#> 41  3.107489 3.708287 4.363006  T32-C4\n#> 51  3.256646 3.825798 4.440356  T32-C8\n#> 81  3.792943 4.772443 5.910748  T45-C2\n#> 101 2.408673 3.176236 4.057877  V10-C2\n#> 161 3.118888 3.635034 4.203783 T32-C20\n#> 181 3.027811 3.730151 4.588422  T32-C6\n#> [1] 27 22\n#>       V1   V2   V3   V4   V5   V6   V7   V8   V9  V10  V11\n#> 1   3.69 4.46 5.04 4.06 4.91 5.73 2.23 2.76 3.64 2.37 3.31\n#> 2   3.87 4.54 5.07 4.29 5.03 5.73 2.38 3.00 3.84 2.55 3.28\n#> 3   4.68 5.01 5.36 4.32 5.16 5.85 3.44 4.05 4.75 3.01 3.80\n#> 4   4.87 5.10 5.36 4.03 4.64 5.17 4.13 4.55 4.96 3.75 4.30\n#> 5   4.98 5.24 5.53 3.83 4.33 4.87 4.90 5.40 5.88 3.47 3.91\n#> 6   5.28 5.55 5.84 3.06 3.51 3.97 4.74 5.14 5.50 3.55 3.90\n#> 7   5.34 5.59 5.87 3.33 3.83 4.29 4.84 5.20 5.56 3.99 4.53\n#> 8   5.16 5.58 5.95 4.44 5.02 5.73 4.95 5.45 6.01 5.28 6.06\n#> 9   5.33 5.82 6.26 4.31 5.09 6.25 4.92 5.56 6.19 4.83 5.81\n#> 10  4.61 4.93 5.37 7.08 7.74 8.40 4.03 4.62 5.15 4.33 5.25\n#> 11  4.47 4.84 5.28 6.59 7.33 7.96 4.20 4.75 5.30 4.68 5.48\n#> 12  4.64 4.95 5.34 3.93 4.38 5.48 2.03 2.44 2.80 2.08 2.42\n#> 13  4.57 4.97 5.48 3.04 4.42 5.52 2.23 2.98 4.53 1.99 2.65\n#> 14  4.53 4.99 5.52 3.06 4.49 6.14 2.78 4.03 5.08 2.12 2.94\n#> 15  4.48 5.04 6.10 3.29 4.46 6.10 3.02 4.38 5.80 2.11 2.99\n#> 16  4.90 5.16 5.41 3.93 4.41 4.92 4.71 5.09 5.46 3.63 4.14\n#> 17  4.45 4.78 5.20 5.06 5.68 6.39 4.51 4.97 5.40 4.48 5.28\n#> 18  4.79 5.13 5.43 4.14 4.66 5.12 4.76 5.10 5.42 4.26 4.88\n#> 19  4.50 4.89 5.28 4.98 5.61 6.32 4.72 5.09 5.43 5.02 5.69\n#> 20  5.00 5.25 5.51 4.81 5.18 5.59 4.85 5.13 5.46 5.33 5.78\n#> 31  4.68 5.01 5.36 4.32 5.16 5.85 3.44 4.05 4.75 3.01 3.80\n#> 41  4.87 5.10 5.36 4.03 4.64 5.17 4.13 4.55 4.96 3.75 4.30\n#> 51  4.98 5.24 5.53 3.83 4.33 4.87 4.90 5.40 5.88 3.47 3.91\n#> 81  5.16 5.58 5.95 4.44 5.02 5.73 4.95 5.45 6.01 5.28 6.06\n#> 101 4.61 4.93 5.37 7.08 7.74 8.40 4.03 4.62 5.15 4.33 5.25\n#> 161 4.90 5.16 5.41 3.93 4.41 4.92 4.71 5.09 5.46 3.63 4.14\n#> 181 4.79 5.13 5.43 4.14 4.66 5.12 4.76 5.10 5.42 4.26 4.88\n#>      V12  V13  V14  V15  V16  V17  V18  V19  V20  V21\n#> 1   4.68 2.18 2.70 3.44 2.98 3.79 4.36 1.70 2.59 3.97\n#> 2   4.39 2.28 2.73 3.35 3.29 3.96 4.54 1.96 2.71 3.85\n#> 3   4.72 2.45 2.91 3.49 4.34 4.98 5.54 2.57 3.34 4.72\n#> 4   4.84 2.91 3.24 3.58 4.56 4.95 5.37 3.11 3.71 4.36\n#> 5   4.45 2.62 2.99 3.35 4.62 5.03 5.43 3.26 3.83 4.44\n#> 6   4.29 2.76 3.08 3.43 4.33 4.78 5.19 3.59 4.10 4.70\n#> 7   5.04 3.08 3.41 3.73 4.06 4.61 5.15 3.68 4.32 5.08\n#> 8   6.63 3.71 4.15 4.55 3.68 4.64 5.41 3.79 4.77 5.91\n#> 9   6.88 3.53 4.17 4.79 3.63 5.03 5.76 3.89 5.31 7.06\n#> 10  6.03 3.13 3.68 4.16 3.40 3.96 4.54 2.41 3.18 4.06\n#> 11  6.20 3.30 3.74 4.16 3.28 3.99 4.60 2.52 3.33 4.40\n#> 12  2.80 2.77 3.32 3.65 3.82 4.20 4.68 3.21 4.14 4.69\n#> 13  3.68 1.79 3.06 3.55 3.96 4.46 5.44 2.77 3.86 4.59\n#> 14  3.84 1.90 2.76 3.55 3.92 4.58 5.32 2.61 3.65 4.57\n#> 15  3.80 1.85 2.72 3.44 4.00 4.56 5.28 2.67 3.64 4.49\n#> 16  4.68 2.81 3.14 3.46 4.64 4.99 5.36 3.12 3.64 4.20\n#> 17  6.04 3.18 3.67 4.13 4.09 4.59 5.16 2.53 3.03 3.78\n#> 18  5.39 3.24 3.58 3.92 4.42 4.86 5.36 3.03 3.73 4.59\n#> 19  6.33 3.47 3.92 4.31 4.08 4.66 5.27 2.66 3.32 4.10\n#> 20  6.24 3.63 3.90 4.18 4.16 4.67 5.15 3.39 3.95 4.58\n#> 31  4.72 2.45 2.91 3.49 4.34 4.98 5.54 2.57 3.34 4.72\n#> 41  4.84 2.91 3.24 3.58 4.56 4.95 5.37 3.11 3.71 4.36\n#> 51  4.45 2.62 2.99 3.35 4.62 5.03 5.43 3.26 3.83 4.44\n#> 81  6.63 3.71 4.15 4.55 3.68 4.64 5.41 3.79 4.77 5.91\n#> 101 6.03 3.13 3.68 4.16 3.40 3.96 4.54 2.41 3.18 4.06\n#> 161 4.68 2.81 3.14 3.46 4.64 4.99 5.36 3.12 3.64 4.20\n#> 181 5.39 3.24 3.58 3.92 4.42 4.86 5.36 3.03 3.73 4.59\n#>    Light_q2.5      Light_q50      Light_q97.5   \n#>  Min.   :3.695   Min.   :4.456   Min.   :5.042  \n#>  1st Qu.:4.549   1st Qu.:4.940   1st Qu.:5.358  \n#>  Median :4.792   Median :5.103   Median :5.411  \n#>  Mean   :4.747   Mean   :5.110   Mean   :5.504  \n#>  3rd Qu.:4.981   3rd Qu.:5.243   3rd Qu.:5.528  \n#>  Max.   :5.340   Max.   :5.817   Max.   :6.259  \n#>    Moist_q2.5      Moist_q50      Moist_q97.5   \n#>  Min.   :3.042   Min.   :3.508   Min.   :3.967  \n#>  1st Qu.:3.878   1st Qu.:4.415   1st Qu.:5.116  \n#>  Median :4.138   Median :4.663   Median :5.726  \n#>  Mean   :4.346   Mean   :5.032   Mean   :5.762  \n#>  3rd Qu.:4.443   3rd Qu.:5.156   3rd Qu.:6.120  \n#>  Max.   :7.077   Max.   :7.745   Max.   :8.397  \n#>     pH_q2.5          pH_q50         pH_q97.5    \n#>  Min.   :2.029   Min.   :2.445   Min.   :2.805  \n#>  1st Qu.:3.438   1st Qu.:4.216   1st Qu.:4.956  \n#>  Median :4.514   Median :4.967   Median :5.425  \n#>  Mean   :4.048   Mean   :4.591   Mean   :5.179  \n#>  3rd Qu.:4.799   3rd Qu.:5.136   3rd Qu.:5.533  \n#>  Max.   :4.953   Max.   :5.561   Max.   :6.194  \n#>  Nitrogen_q2.5    Nitrogen_q50   Nitrogen_q97.5 \n#>  Min.   :1.995   Min.   :2.423   Min.   :2.798  \n#>  1st Qu.:3.014   1st Qu.:3.801   1st Qu.:4.455  \n#>  Median :3.745   Median :4.295   Median :4.840  \n#>  Mean   :3.724   Mean   :4.398   Mean   :5.100  \n#>  3rd Qu.:4.406   3rd Qu.:5.265   3rd Qu.:6.035  \n#>  Max.   :5.328   Max.   :6.062   Max.   :6.884  \n#>  Phosphorus_q2.5 Phosphorus_q50  Phosphorus_q97.5\n#>  Min.   :1.794   Min.   :2.703   Min.   :3.347   \n#>  1st Qu.:2.537   1st Qu.:2.994   1st Qu.:3.461   \n#>  Median :2.911   Median :3.241   Median :3.577   \n#>  Mean   :2.868   Mean   :3.354   Mean   :3.805   \n#>  3rd Qu.:3.236   3rd Qu.:3.677   3rd Qu.:4.161   \n#>  Max.   :3.710   Max.   :4.169   Max.   :4.789   \n#>  Grazing_mowing_q2.5 Grazing_mowing_q50\n#>  Min.   :2.984       Min.   :3.792     \n#>  1st Qu.:3.677       1st Qu.:4.510     \n#>  Median :4.083       Median :4.661     \n#>  Mean   :4.033       Mean   :4.618     \n#>  3rd Qu.:4.420       3rd Qu.:4.967     \n#>  Max.   :4.637       Max.   :5.030     \n#>  Grazing_mowing_q97.5 Soil_disturbance_q2.5\n#>  Min.   :4.359        Min.   :1.701        \n#>  1st Qu.:5.148        1st Qu.:2.567        \n#>  Median :5.358        Median :3.028        \n#>  Mean   :5.182        Mean   :2.953        \n#>  3rd Qu.:5.412        3rd Qu.:3.257        \n#>  Max.   :5.757        Max.   :3.887        \n#>  Soil_disturbance_q50 Soil_disturbance_q97.5\n#>  Min.   :2.585        Min.   :3.779         \n#>  1st Qu.:3.334        1st Qu.:4.204         \n#>  Median :3.708        Median :4.487         \n#>  Mean   :3.715        Mean   :4.608         \n#>  3rd Qu.:3.909        3rd Qu.:4.692         \n#>  Max.   :5.314        Max.   :7.055         \n#>      NiN           \n#>  Length:27         \n#>  Class :character  \n#>  Mode  :character  \n#>                    \n#>                    \n#> \n#>     Light_q2.5 Light_q50 Light_q97.5 Moist_q2.5 Moist_q50\n#> 1     3.694963  4.455855    5.042233   4.064785  4.911158\n#> 2     3.872656  4.544696    5.067305   4.291278  5.026818\n#> 3     4.683814  5.014867    5.358364   4.317811  5.156158\n#> 4     4.865484  5.102876    5.363346   4.034961  4.643624\n#> 5     4.981342  5.243469    5.528039   3.830252  4.333141\n#> 6     5.276490  5.549659    5.840840   3.058656  3.507617\n#> 7     5.340400  5.590502    5.867682   3.325401  3.832367\n#> 8     5.161360  5.575833    5.949398   4.443489  5.023939\n#> 9     5.328272  5.817253    6.258642   4.308375  5.088821\n#> 10    4.612772  4.928749    5.373696   7.076748  7.744906\n#> 11    4.468003  4.837483    5.280768   6.589075  7.325905\n#> 12    4.644287  4.951364    5.337365   3.931920  4.383662\n#> 13    4.571538  4.973424    5.479821   3.042370  4.423535\n#> 14    4.527074  4.994966    5.516279   3.062607  4.488716\n#> 15    4.484462  5.037433    6.102683   3.293148  4.455076\n#> 16    4.902428  5.155210    5.411498   3.925413  4.406973\n#> 17    4.454662  4.775632    5.200423   5.055916  5.680832\n#> 18    4.792464  5.125608    5.428366   4.137763  4.662601\n#> 19    4.502474  4.891147    5.281771   4.978014  5.612696\n#> 20    5.003183  5.251130    5.513521   4.807721  5.178649\n#> 31    4.683814  5.014867    5.358364   4.317811  5.156158\n#> 41    4.865484  5.102876    5.363346   4.034961  4.643624\n#> 51    4.981342  5.243469    5.528039   3.830252  4.333141\n#> 81    5.161360  5.575833    5.949398   4.443489  5.023939\n#> 101   4.612772  4.928749    5.373696   7.076748  7.744906\n#> 161   4.902428  5.155210    5.411498   3.925413  4.406973\n#> 181   4.792464  5.125608    5.428366   4.137763  4.662601\n#>     Moist_q97.5  pH_q2.5   pH_q50 pH_q97.5 Nitrogen_q2.5\n#> 1      5.726332 2.231924 2.763966 3.643059      2.374611\n#> 2      5.733233 2.377691 2.996911 3.843860      2.551192\n#> 3      5.852822 3.437854 4.051586 4.753529      3.013542\n#> 4      5.166102 4.134956 4.550274 4.956232      3.745158\n#> 5      4.867984 4.903506 5.402029 5.882318      3.467906\n#> 6      3.966790 4.741062 5.137312 5.503883      3.550895\n#> 7      4.293118 4.840029 5.198332 5.561334      3.989319\n#> 8      5.731531 4.952658 5.452576 6.011182      5.282732\n#> 9      6.247535 4.917752 5.561022 6.194208      4.834808\n#> 10     8.397017 4.029667 4.616442 5.153380      4.332844\n#> 11     7.962753 4.198709 4.750926 5.301648      4.675791\n#> 12     5.483512 2.028829 2.444579 2.804951      2.080377\n#> 13     5.515288 2.232830 2.975433 4.525925      1.994667\n#> 14     6.141326 2.778285 4.026055 5.083037      2.118758\n#> 15     6.097862 3.020470 4.379822 5.795966      2.108276\n#> 16     4.921254 4.706848 5.094791 5.461205      3.629971\n#> 17     6.385162 4.514010 4.966522 5.395454      4.479744\n#> 18     5.116347 4.758323 5.100929 5.424962      4.255017\n#> 19     6.322015 4.716802 5.085724 5.428951      5.015903\n#> 20     5.590864 4.851695 5.133712 5.460406      5.327610\n#> 31     5.852822 3.437854 4.051586 4.753529      3.013542\n#> 41     5.166102 4.134956 4.550274 4.956232      3.745158\n#> 51     4.867984 4.903506 5.402029 5.882318      3.467906\n#> 81     5.731531 4.952658 5.452576 6.011182      5.282732\n#> 101    8.397017 4.029667 4.616442 5.153380      4.332844\n#> 161    4.921254 4.706848 5.094791 5.461205      3.629971\n#> 181    5.116347 4.758323 5.100929 5.424962      4.255017\n#>     Nitrogen_q50 Nitrogen_q97.5 Phosphorus_q2.5\n#> 1       3.306753       4.676875        2.178991\n#> 2       3.275629       4.387774        2.277478\n#> 3       3.801197       4.718075        2.449075\n#> 4       4.295415       4.840228        2.911345\n#> 5       3.907100       4.454971        2.624162\n#> 6       3.898565       4.286540        2.759828\n#> 7       4.530815       5.040762        3.079555\n#> 8       6.062480       6.633160        3.710334\n#> 9       5.812497       6.883664        3.525970\n#> 10      5.253199       6.029532        3.125459\n#> 11      5.482393       6.198834        3.295643\n#> 12      2.423099       2.798250        2.770666\n#> 13      2.650282       3.675827        1.794028\n#> 14      2.941948       3.836682        1.895038\n#> 15      2.993038       3.803690        1.852948\n#> 16      4.136638       4.676468        2.809679\n#> 17      5.276425       6.041027        3.180545\n#> 18      4.881833       5.394140        3.236024\n#> 19      5.686866       6.325652        3.471647\n#> 20      5.782120       6.243091        3.633083\n#> 31      3.801197       4.718075        2.449075\n#> 41      4.295415       4.840228        2.911345\n#> 51      3.907100       4.454971        2.624162\n#> 81      6.062480       6.633160        3.710334\n#> 101     5.253199       6.029532        3.125459\n#> 161     4.136638       4.676468        2.809679\n#> 181     4.881833       5.394140        3.236024\n#>     Phosphorus_q50 Phosphorus_q97.5 Grazing_mowing_q2.5\n#> 1         2.702927         3.440871            2.984216\n#> 2         2.733013         3.347336            3.293034\n#> 3         2.912161         3.486105            4.335506\n#> 4         3.241309         3.577153            4.555127\n#> 5         2.993730         3.348833            4.617482\n#> 6         3.079720         3.432867            4.331891\n#> 7         3.410515         3.731820            4.060324\n#> 8         4.146738         4.552950            3.676524\n#> 9         4.168608         4.788924            3.627166\n#> 10        3.676992         4.160553            3.397081\n#> 11        3.736049         4.161127            3.275067\n#> 12        3.324569         3.646475            3.822095\n#> 13        3.055151         3.554441            3.964206\n#> 14        2.755898         3.547876            3.918681\n#> 15        2.719993         3.436248            3.996109\n#> 16        3.139092         3.461385            4.637458\n#> 17        3.668771         4.132592            4.092966\n#> 18        3.581140         3.922420            4.420037\n#> 19        3.924785         4.306964            4.083125\n#> 20        3.899025         4.178710            4.160459\n#> 31        2.912161         3.486105            4.335506\n#> 41        3.241309         3.577153            4.555127\n#> 51        2.993730         3.348833            4.617482\n#> 81        4.146738         4.552950            3.676524\n#> 101       3.676992         4.160553            3.397081\n#> 161       3.139092         3.461385            4.637458\n#> 181       3.581140         3.922420            4.420037\n#>     Grazing_mowing_q50 Grazing_mowing_q97.5\n#> 1             3.791938             4.358905\n#> 2             3.964737             4.543427\n#> 3             4.979633             5.536351\n#> 4             4.954427             5.370583\n#> 5             5.027109             5.427039\n#> 6             4.776583             5.189621\n#> 7             4.610136             5.147616\n#> 8             4.639444             5.412049\n#> 9             5.029662             5.757345\n#> 10            3.957329             4.541129\n#> 11            3.988681             4.596878\n#> 12            4.199011             4.679568\n#> 13            4.460697             5.441127\n#> 14            4.583622             5.318680\n#> 15            4.559088             5.281011\n#> 16            4.987574             5.359284\n#> 17            4.585217             5.160583\n#> 18            4.855540             5.358011\n#> 19            4.661327             5.268052\n#> 20            4.668937             5.149184\n#> 31            4.979633             5.536351\n#> 41            4.954427             5.370583\n#> 51            5.027109             5.427039\n#> 81            4.639444             5.412049\n#> 101           3.957329             4.541129\n#> 161           4.987574             5.359284\n#> 181           4.855540             5.358011\n#>     Soil_disturbance_q2.5 Soil_disturbance_q50\n#> 1                1.700971             2.585099\n#> 2                1.957253             2.712202\n#> 3                2.566533             3.341770\n#> 4                3.107489             3.708287\n#> 5                3.256646             3.825798\n#> 6                3.589531             4.102155\n#> 7                3.684712             4.315234\n#> 8                3.792943             4.772443\n#> 9                3.887352             5.313561\n#> 10               2.408673             3.176236\n#> 11               2.522885             3.325373\n#> 12               3.209041             4.138198\n#> 13               2.769936             3.864515\n#> 14               2.607216             3.647634\n#> 15               2.672613             3.638081\n#> 16               3.118888             3.635034\n#> 17               2.529383             3.026330\n#> 18               3.027811             3.730151\n#> 19               2.657839             3.315751\n#> 20               3.390231             3.953994\n#> 31               2.566533             3.341770\n#> 41               3.107489             3.708287\n#> 51               3.256646             3.825798\n#> 81               3.792943             4.772443\n#> 101              2.408673             3.176236\n#> 161              3.118888             3.635034\n#> 181              3.027811             3.730151\n#>     Soil_disturbance_q97.5      NiN\n#> 1                 3.974465  T34-C-1\n#> 2                 3.851444  T34-C-3\n#> 3                 4.715854  T32-C-1\n#> 4                 4.363006  T32-C-3\n#> 5                 4.440356  T32-C-7\n#> 6                 4.698638 T32-C-15\n#> 7                 5.079617 T32-C-16\n#> 8                 5.910748  T45-C-1\n#> 9                 7.055054  T45-C-3\n#> 10                4.057877  V10-C-1\n#> 11                4.404043  V10-C-3\n#> 12                4.686286  T34-C-2\n#> 13                4.593340  T34-C-4\n#> 14                4.573322  T34-C-5\n#> 15                4.486693  T34-C-6\n#> 16                4.203783  T32-C-5\n#> 17                3.779491  T32-C-9\n#> 18                4.588422 T32-C-21\n#> 19                4.100310 T32-C-10\n#> 20                4.583870      T41\n#> 31                4.715854  T32-C-2\n#> 41                4.363006  T32-C-4\n#> 51                4.440356  T32-C-8\n#> 81                5.910748  T45-C-2\n#> 101               4.057877  V10-C-2\n#> 161               4.203783 T32-C-20\n#> 181               4.588422  T32-C-6\n#>          N1 hoved    grunn county region               Ind\n#> 1   seminat    NA  T34-C-1    all    all            Light1\n#> 2   seminat    NA  T34-C-1    all    all            Light2\n#> 3   seminat    NA  T34-C-3    all    all            Light1\n#> 4   seminat    NA  T34-C-3    all    all            Light2\n#> 5   seminat    NA  T32-C-1    all    all            Light1\n#> 6   seminat    NA  T32-C-1    all    all            Light2\n#> 7   seminat    NA  T32-C-3    all    all            Light1\n#> 8   seminat    NA  T32-C-3    all    all            Light2\n#> 9   seminat    NA  T32-C-7    all    all            Light1\n#> 10  seminat    NA  T32-C-7    all    all            Light2\n#> 11  seminat    NA T32-C-15    all    all            Light1\n#> 12  seminat    NA T32-C-15    all    all            Light2\n#> 13  seminat    NA T32-C-16    all    all            Light1\n#> 14  seminat    NA T32-C-16    all    all            Light2\n#> 15  seminat    NA  T45-C-1    all    all            Light1\n#> 16  seminat    NA  T45-C-1    all    all            Light2\n#> 17  seminat    NA  T45-C-3    all    all            Light1\n#> 18  seminat    NA  T45-C-3    all    all            Light2\n#> 19  seminat    NA  V10-C-1    all    all            Light1\n#> 20  seminat    NA  V10-C-1    all    all            Light2\n#> 21  seminat    NA  V10-C-3    all    all            Light1\n#> 22  seminat    NA  V10-C-3    all    all            Light2\n#> 23  seminat    NA  T34-C-2    all    all            Light1\n#> 24  seminat    NA  T34-C-2    all    all            Light2\n#> 25  seminat    NA  T34-C-4    all    all            Light1\n#> 26  seminat    NA  T34-C-4    all    all            Light2\n#> 27  seminat    NA  T34-C-5    all    all            Light1\n#> 28  seminat    NA  T34-C-5    all    all            Light2\n#> 29  seminat    NA  T34-C-6    all    all            Light1\n#> 30  seminat    NA  T34-C-6    all    all            Light2\n#> 31  seminat    NA  T32-C-5    all    all            Light1\n#> 32  seminat    NA  T32-C-5    all    all            Light2\n#> 33  seminat    NA  T32-C-9    all    all            Light1\n#> 34  seminat    NA  T32-C-9    all    all            Light2\n#> 35  seminat    NA T32-C-21    all    all            Light1\n#> 36  seminat    NA T32-C-21    all    all            Light2\n#> 37  seminat    NA T32-C-10    all    all            Light1\n#> 38  seminat    NA T32-C-10    all    all            Light2\n#> 39  seminat    NA      T41    all    all            Light1\n#> 40  seminat    NA      T41    all    all            Light2\n#> 41  seminat    NA  T32-C-2    all    all            Light1\n#> 42  seminat    NA  T32-C-2    all    all            Light2\n#> 43  seminat    NA  T32-C-4    all    all            Light1\n#> 44  seminat    NA  T32-C-4    all    all            Light2\n#> 45  seminat    NA  T32-C-8    all    all            Light1\n#> 46  seminat    NA  T32-C-8    all    all            Light2\n#> 47  seminat    NA  T45-C-2    all    all            Light1\n#> 48  seminat    NA  T45-C-2    all    all            Light2\n#> 49  seminat    NA  V10-C-2    all    all            Light1\n#> 50  seminat    NA  V10-C-2    all    all            Light2\n#> 51  seminat    NA T32-C-20    all    all            Light1\n#> 52  seminat    NA T32-C-20    all    all            Light2\n#> 53  seminat    NA  T32-C-6    all    all            Light1\n#> 54  seminat    NA  T32-C-6    all    all            Light2\n#> 55  seminat    NA  T34-C-1    all    all            Moist1\n#> 56  seminat    NA  T34-C-1    all    all            Moist2\n#> 57  seminat    NA  T34-C-3    all    all            Moist1\n#> 58  seminat    NA  T34-C-3    all    all            Moist2\n#> 59  seminat    NA  T32-C-1    all    all            Moist1\n#> 60  seminat    NA  T32-C-1    all    all            Moist2\n#> 61  seminat    NA  T32-C-3    all    all            Moist1\n#> 62  seminat    NA  T32-C-3    all    all            Moist2\n#> 63  seminat    NA  T32-C-7    all    all            Moist1\n#> 64  seminat    NA  T32-C-7    all    all            Moist2\n#> 65  seminat    NA T32-C-15    all    all            Moist1\n#> 66  seminat    NA T32-C-15    all    all            Moist2\n#> 67  seminat    NA T32-C-16    all    all            Moist1\n#> 68  seminat    NA T32-C-16    all    all            Moist2\n#> 69  seminat    NA  T45-C-1    all    all            Moist1\n#> 70  seminat    NA  T45-C-1    all    all            Moist2\n#> 71  seminat    NA  T45-C-3    all    all            Moist1\n#> 72  seminat    NA  T45-C-3    all    all            Moist2\n#> 73  seminat    NA  V10-C-1    all    all            Moist1\n#> 74  seminat    NA  V10-C-1    all    all            Moist2\n#> 75  seminat    NA  V10-C-3    all    all            Moist1\n#> 76  seminat    NA  V10-C-3    all    all            Moist2\n#> 77  seminat    NA  T34-C-2    all    all            Moist1\n#> 78  seminat    NA  T34-C-2    all    all            Moist2\n#> 79  seminat    NA  T34-C-4    all    all            Moist1\n#> 80  seminat    NA  T34-C-4    all    all            Moist2\n#> 81  seminat    NA  T34-C-5    all    all            Moist1\n#> 82  seminat    NA  T34-C-5    all    all            Moist2\n#> 83  seminat    NA  T34-C-6    all    all            Moist1\n#> 84  seminat    NA  T34-C-6    all    all            Moist2\n#> 85  seminat    NA  T32-C-5    all    all            Moist1\n#> 86  seminat    NA  T32-C-5    all    all            Moist2\n#> 87  seminat    NA  T32-C-9    all    all            Moist1\n#> 88  seminat    NA  T32-C-9    all    all            Moist2\n#> 89  seminat    NA T32-C-21    all    all            Moist1\n#> 90  seminat    NA T32-C-21    all    all            Moist2\n#> 91  seminat    NA T32-C-10    all    all            Moist1\n#> 92  seminat    NA T32-C-10    all    all            Moist2\n#> 93  seminat    NA      T41    all    all            Moist1\n#> 94  seminat    NA      T41    all    all            Moist2\n#> 95  seminat    NA  T32-C-2    all    all            Moist1\n#> 96  seminat    NA  T32-C-2    all    all            Moist2\n#> 97  seminat    NA  T32-C-4    all    all            Moist1\n#> 98  seminat    NA  T32-C-4    all    all            Moist2\n#> 99  seminat    NA  T32-C-8    all    all            Moist1\n#> 100 seminat    NA  T32-C-8    all    all            Moist2\n#> 101 seminat    NA  T45-C-2    all    all            Moist1\n#> 102 seminat    NA  T45-C-2    all    all            Moist2\n#> 103 seminat    NA  V10-C-2    all    all            Moist1\n#> 104 seminat    NA  V10-C-2    all    all            Moist2\n#> 105 seminat    NA T32-C-20    all    all            Moist1\n#> 106 seminat    NA T32-C-20    all    all            Moist2\n#> 107 seminat    NA  T32-C-6    all    all            Moist1\n#> 108 seminat    NA  T32-C-6    all    all            Moist2\n#> 109 seminat    NA  T34-C-1    all    all               pH1\n#> 110 seminat    NA  T34-C-1    all    all               pH2\n#> 111 seminat    NA  T34-C-3    all    all               pH1\n#> 112 seminat    NA  T34-C-3    all    all               pH2\n#> 113 seminat    NA  T32-C-1    all    all               pH1\n#> 114 seminat    NA  T32-C-1    all    all               pH2\n#> 115 seminat    NA  T32-C-3    all    all               pH1\n#> 116 seminat    NA  T32-C-3    all    all               pH2\n#> 117 seminat    NA  T32-C-7    all    all               pH1\n#> 118 seminat    NA  T32-C-7    all    all               pH2\n#> 119 seminat    NA T32-C-15    all    all               pH1\n#> 120 seminat    NA T32-C-15    all    all               pH2\n#> 121 seminat    NA T32-C-16    all    all               pH1\n#> 122 seminat    NA T32-C-16    all    all               pH2\n#> 123 seminat    NA  T45-C-1    all    all               pH1\n#> 124 seminat    NA  T45-C-1    all    all               pH2\n#> 125 seminat    NA  T45-C-3    all    all               pH1\n#> 126 seminat    NA  T45-C-3    all    all               pH2\n#> 127 seminat    NA  V10-C-1    all    all               pH1\n#> 128 seminat    NA  V10-C-1    all    all               pH2\n#> 129 seminat    NA  V10-C-3    all    all               pH1\n#> 130 seminat    NA  V10-C-3    all    all               pH2\n#> 131 seminat    NA  T34-C-2    all    all               pH1\n#> 132 seminat    NA  T34-C-2    all    all               pH2\n#> 133 seminat    NA  T34-C-4    all    all               pH1\n#> 134 seminat    NA  T34-C-4    all    all               pH2\n#> 135 seminat    NA  T34-C-5    all    all               pH1\n#> 136 seminat    NA  T34-C-5    all    all               pH2\n#> 137 seminat    NA  T34-C-6    all    all               pH1\n#> 138 seminat    NA  T34-C-6    all    all               pH2\n#> 139 seminat    NA  T32-C-5    all    all               pH1\n#> 140 seminat    NA  T32-C-5    all    all               pH2\n#> 141 seminat    NA  T32-C-9    all    all               pH1\n#> 142 seminat    NA  T32-C-9    all    all               pH2\n#> 143 seminat    NA T32-C-21    all    all               pH1\n#> 144 seminat    NA T32-C-21    all    all               pH2\n#> 145 seminat    NA T32-C-10    all    all               pH1\n#> 146 seminat    NA T32-C-10    all    all               pH2\n#> 147 seminat    NA      T41    all    all               pH1\n#> 148 seminat    NA      T41    all    all               pH2\n#> 149 seminat    NA  T32-C-2    all    all               pH1\n#> 150 seminat    NA  T32-C-2    all    all               pH2\n#> 151 seminat    NA  T32-C-4    all    all               pH1\n#> 152 seminat    NA  T32-C-4    all    all               pH2\n#> 153 seminat    NA  T32-C-8    all    all               pH1\n#> 154 seminat    NA  T32-C-8    all    all               pH2\n#> 155 seminat    NA  T45-C-2    all    all               pH1\n#> 156 seminat    NA  T45-C-2    all    all               pH2\n#> 157 seminat    NA  V10-C-2    all    all               pH1\n#> 158 seminat    NA  V10-C-2    all    all               pH2\n#> 159 seminat    NA T32-C-20    all    all               pH1\n#> 160 seminat    NA T32-C-20    all    all               pH2\n#> 161 seminat    NA  T32-C-6    all    all               pH1\n#> 162 seminat    NA  T32-C-6    all    all               pH2\n#> 163 seminat    NA  T34-C-1    all    all         Nitrogen1\n#> 164 seminat    NA  T34-C-1    all    all         Nitrogen2\n#> 165 seminat    NA  T34-C-3    all    all         Nitrogen1\n#> 166 seminat    NA  T34-C-3    all    all         Nitrogen2\n#> 167 seminat    NA  T32-C-1    all    all         Nitrogen1\n#> 168 seminat    NA  T32-C-1    all    all         Nitrogen2\n#> 169 seminat    NA  T32-C-3    all    all         Nitrogen1\n#> 170 seminat    NA  T32-C-3    all    all         Nitrogen2\n#> 171 seminat    NA  T32-C-7    all    all         Nitrogen1\n#> 172 seminat    NA  T32-C-7    all    all         Nitrogen2\n#> 173 seminat    NA T32-C-15    all    all         Nitrogen1\n#> 174 seminat    NA T32-C-15    all    all         Nitrogen2\n#> 175 seminat    NA T32-C-16    all    all         Nitrogen1\n#> 176 seminat    NA T32-C-16    all    all         Nitrogen2\n#> 177 seminat    NA  T45-C-1    all    all         Nitrogen1\n#> 178 seminat    NA  T45-C-1    all    all         Nitrogen2\n#> 179 seminat    NA  T45-C-3    all    all         Nitrogen1\n#> 180 seminat    NA  T45-C-3    all    all         Nitrogen2\n#> 181 seminat    NA  V10-C-1    all    all         Nitrogen1\n#> 182 seminat    NA  V10-C-1    all    all         Nitrogen2\n#> 183 seminat    NA  V10-C-3    all    all         Nitrogen1\n#> 184 seminat    NA  V10-C-3    all    all         Nitrogen2\n#> 185 seminat    NA  T34-C-2    all    all         Nitrogen1\n#> 186 seminat    NA  T34-C-2    all    all         Nitrogen2\n#> 187 seminat    NA  T34-C-4    all    all         Nitrogen1\n#> 188 seminat    NA  T34-C-4    all    all         Nitrogen2\n#> 189 seminat    NA  T34-C-5    all    all         Nitrogen1\n#> 190 seminat    NA  T34-C-5    all    all         Nitrogen2\n#> 191 seminat    NA  T34-C-6    all    all         Nitrogen1\n#> 192 seminat    NA  T34-C-6    all    all         Nitrogen2\n#> 193 seminat    NA  T32-C-5    all    all         Nitrogen1\n#> 194 seminat    NA  T32-C-5    all    all         Nitrogen2\n#> 195 seminat    NA  T32-C-9    all    all         Nitrogen1\n#> 196 seminat    NA  T32-C-9    all    all         Nitrogen2\n#> 197 seminat    NA T32-C-21    all    all         Nitrogen1\n#> 198 seminat    NA T32-C-21    all    all         Nitrogen2\n#> 199 seminat    NA T32-C-10    all    all         Nitrogen1\n#> 200 seminat    NA T32-C-10    all    all         Nitrogen2\n#> 201 seminat    NA      T41    all    all         Nitrogen1\n#> 202 seminat    NA      T41    all    all         Nitrogen2\n#> 203 seminat    NA  T32-C-2    all    all         Nitrogen1\n#> 204 seminat    NA  T32-C-2    all    all         Nitrogen2\n#> 205 seminat    NA  T32-C-4    all    all         Nitrogen1\n#> 206 seminat    NA  T32-C-4    all    all         Nitrogen2\n#> 207 seminat    NA  T32-C-8    all    all         Nitrogen1\n#> 208 seminat    NA  T32-C-8    all    all         Nitrogen2\n#> 209 seminat    NA  T45-C-2    all    all         Nitrogen1\n#> 210 seminat    NA  T45-C-2    all    all         Nitrogen2\n#> 211 seminat    NA  V10-C-2    all    all         Nitrogen1\n#> 212 seminat    NA  V10-C-2    all    all         Nitrogen2\n#> 213 seminat    NA T32-C-20    all    all         Nitrogen1\n#> 214 seminat    NA T32-C-20    all    all         Nitrogen2\n#> 215 seminat    NA  T32-C-6    all    all         Nitrogen1\n#> 216 seminat    NA  T32-C-6    all    all         Nitrogen2\n#> 217 seminat    NA  T34-C-1    all    all       Phosphorus1\n#> 218 seminat    NA  T34-C-1    all    all       Phosphorus2\n#> 219 seminat    NA  T34-C-3    all    all       Phosphorus1\n#> 220 seminat    NA  T34-C-3    all    all       Phosphorus2\n#> 221 seminat    NA  T32-C-1    all    all       Phosphorus1\n#> 222 seminat    NA  T32-C-1    all    all       Phosphorus2\n#> 223 seminat    NA  T32-C-3    all    all       Phosphorus1\n#> 224 seminat    NA  T32-C-3    all    all       Phosphorus2\n#> 225 seminat    NA  T32-C-7    all    all       Phosphorus1\n#> 226 seminat    NA  T32-C-7    all    all       Phosphorus2\n#> 227 seminat    NA T32-C-15    all    all       Phosphorus1\n#> 228 seminat    NA T32-C-15    all    all       Phosphorus2\n#> 229 seminat    NA T32-C-16    all    all       Phosphorus1\n#> 230 seminat    NA T32-C-16    all    all       Phosphorus2\n#> 231 seminat    NA  T45-C-1    all    all       Phosphorus1\n#> 232 seminat    NA  T45-C-1    all    all       Phosphorus2\n#> 233 seminat    NA  T45-C-3    all    all       Phosphorus1\n#> 234 seminat    NA  T45-C-3    all    all       Phosphorus2\n#> 235 seminat    NA  V10-C-1    all    all       Phosphorus1\n#> 236 seminat    NA  V10-C-1    all    all       Phosphorus2\n#> 237 seminat    NA  V10-C-3    all    all       Phosphorus1\n#> 238 seminat    NA  V10-C-3    all    all       Phosphorus2\n#> 239 seminat    NA  T34-C-2    all    all       Phosphorus1\n#> 240 seminat    NA  T34-C-2    all    all       Phosphorus2\n#> 241 seminat    NA  T34-C-4    all    all       Phosphorus1\n#> 242 seminat    NA  T34-C-4    all    all       Phosphorus2\n#> 243 seminat    NA  T34-C-5    all    all       Phosphorus1\n#> 244 seminat    NA  T34-C-5    all    all       Phosphorus2\n#> 245 seminat    NA  T34-C-6    all    all       Phosphorus1\n#> 246 seminat    NA  T34-C-6    all    all       Phosphorus2\n#> 247 seminat    NA  T32-C-5    all    all       Phosphorus1\n#> 248 seminat    NA  T32-C-5    all    all       Phosphorus2\n#> 249 seminat    NA  T32-C-9    all    all       Phosphorus1\n#> 250 seminat    NA  T32-C-9    all    all       Phosphorus2\n#> 251 seminat    NA T32-C-21    all    all       Phosphorus1\n#> 252 seminat    NA T32-C-21    all    all       Phosphorus2\n#> 253 seminat    NA T32-C-10    all    all       Phosphorus1\n#> 254 seminat    NA T32-C-10    all    all       Phosphorus2\n#> 255 seminat    NA      T41    all    all       Phosphorus1\n#> 256 seminat    NA      T41    all    all       Phosphorus2\n#> 257 seminat    NA  T32-C-2    all    all       Phosphorus1\n#> 258 seminat    NA  T32-C-2    all    all       Phosphorus2\n#> 259 seminat    NA  T32-C-4    all    all       Phosphorus1\n#> 260 seminat    NA  T32-C-4    all    all       Phosphorus2\n#> 261 seminat    NA  T32-C-8    all    all       Phosphorus1\n#> 262 seminat    NA  T32-C-8    all    all       Phosphorus2\n#> 263 seminat    NA  T45-C-2    all    all       Phosphorus1\n#> 264 seminat    NA  T45-C-2    all    all       Phosphorus2\n#> 265 seminat    NA  V10-C-2    all    all       Phosphorus1\n#> 266 seminat    NA  V10-C-2    all    all       Phosphorus2\n#> 267 seminat    NA T32-C-20    all    all       Phosphorus1\n#> 268 seminat    NA T32-C-20    all    all       Phosphorus2\n#> 269 seminat    NA  T32-C-6    all    all       Phosphorus1\n#> 270 seminat    NA  T32-C-6    all    all       Phosphorus2\n#> 271 seminat    NA  T34-C-1    all    all   Grazing_mowing1\n#> 272 seminat    NA  T34-C-1    all    all   Grazing_mowing2\n#> 273 seminat    NA  T34-C-3    all    all   Grazing_mowing1\n#> 274 seminat    NA  T34-C-3    all    all   Grazing_mowing2\n#> 275 seminat    NA  T32-C-1    all    all   Grazing_mowing1\n#> 276 seminat    NA  T32-C-1    all    all   Grazing_mowing2\n#> 277 seminat    NA  T32-C-3    all    all   Grazing_mowing1\n#> 278 seminat    NA  T32-C-3    all    all   Grazing_mowing2\n#> 279 seminat    NA  T32-C-7    all    all   Grazing_mowing1\n#> 280 seminat    NA  T32-C-7    all    all   Grazing_mowing2\n#> 281 seminat    NA T32-C-15    all    all   Grazing_mowing1\n#> 282 seminat    NA T32-C-15    all    all   Grazing_mowing2\n#> 283 seminat    NA T32-C-16    all    all   Grazing_mowing1\n#> 284 seminat    NA T32-C-16    all    all   Grazing_mowing2\n#> 285 seminat    NA  T45-C-1    all    all   Grazing_mowing1\n#> 286 seminat    NA  T45-C-1    all    all   Grazing_mowing2\n#> 287 seminat    NA  T45-C-3    all    all   Grazing_mowing1\n#> 288 seminat    NA  T45-C-3    all    all   Grazing_mowing2\n#> 289 seminat    NA  V10-C-1    all    all   Grazing_mowing1\n#> 290 seminat    NA  V10-C-1    all    all   Grazing_mowing2\n#> 291 seminat    NA  V10-C-3    all    all   Grazing_mowing1\n#> 292 seminat    NA  V10-C-3    all    all   Grazing_mowing2\n#> 293 seminat    NA  T34-C-2    all    all   Grazing_mowing1\n#> 294 seminat    NA  T34-C-2    all    all   Grazing_mowing2\n#> 295 seminat    NA  T34-C-4    all    all   Grazing_mowing1\n#> 296 seminat    NA  T34-C-4    all    all   Grazing_mowing2\n#> 297 seminat    NA  T34-C-5    all    all   Grazing_mowing1\n#> 298 seminat    NA  T34-C-5    all    all   Grazing_mowing2\n#> 299 seminat    NA  T34-C-6    all    all   Grazing_mowing1\n#> 300 seminat    NA  T34-C-6    all    all   Grazing_mowing2\n#> 301 seminat    NA  T32-C-5    all    all   Grazing_mowing1\n#> 302 seminat    NA  T32-C-5    all    all   Grazing_mowing2\n#> 303 seminat    NA  T32-C-9    all    all   Grazing_mowing1\n#> 304 seminat    NA  T32-C-9    all    all   Grazing_mowing2\n#> 305 seminat    NA T32-C-21    all    all   Grazing_mowing1\n#> 306 seminat    NA T32-C-21    all    all   Grazing_mowing2\n#> 307 seminat    NA T32-C-10    all    all   Grazing_mowing1\n#> 308 seminat    NA T32-C-10    all    all   Grazing_mowing2\n#> 309 seminat    NA      T41    all    all   Grazing_mowing1\n#> 310 seminat    NA      T41    all    all   Grazing_mowing2\n#> 311 seminat    NA  T32-C-2    all    all   Grazing_mowing1\n#> 312 seminat    NA  T32-C-2    all    all   Grazing_mowing2\n#> 313 seminat    NA  T32-C-4    all    all   Grazing_mowing1\n#> 314 seminat    NA  T32-C-4    all    all   Grazing_mowing2\n#> 315 seminat    NA  T32-C-8    all    all   Grazing_mowing1\n#> 316 seminat    NA  T32-C-8    all    all   Grazing_mowing2\n#> 317 seminat    NA  T45-C-2    all    all   Grazing_mowing1\n#> 318 seminat    NA  T45-C-2    all    all   Grazing_mowing2\n#> 319 seminat    NA  V10-C-2    all    all   Grazing_mowing1\n#> 320 seminat    NA  V10-C-2    all    all   Grazing_mowing2\n#> 321 seminat    NA T32-C-20    all    all   Grazing_mowing1\n#> 322 seminat    NA T32-C-20    all    all   Grazing_mowing2\n#> 323 seminat    NA  T32-C-6    all    all   Grazing_mowing1\n#> 324 seminat    NA  T32-C-6    all    all   Grazing_mowing2\n#> 325 seminat    NA  T34-C-1    all    all Soil_disturbance1\n#> 326 seminat    NA  T34-C-1    all    all Soil_disturbance2\n#> 327 seminat    NA  T34-C-3    all    all Soil_disturbance1\n#> 328 seminat    NA  T34-C-3    all    all Soil_disturbance2\n#> 329 seminat    NA  T32-C-1    all    all Soil_disturbance1\n#> 330 seminat    NA  T32-C-1    all    all Soil_disturbance2\n#> 331 seminat    NA  T32-C-3    all    all Soil_disturbance1\n#> 332 seminat    NA  T32-C-3    all    all Soil_disturbance2\n#> 333 seminat    NA  T32-C-7    all    all Soil_disturbance1\n#> 334 seminat    NA  T32-C-7    all    all Soil_disturbance2\n#> 335 seminat    NA T32-C-15    all    all Soil_disturbance1\n#> 336 seminat    NA T32-C-15    all    all Soil_disturbance2\n#> 337 seminat    NA T32-C-16    all    all Soil_disturbance1\n#> 338 seminat    NA T32-C-16    all    all Soil_disturbance2\n#> 339 seminat    NA  T45-C-1    all    all Soil_disturbance1\n#> 340 seminat    NA  T45-C-1    all    all Soil_disturbance2\n#> 341 seminat    NA  T45-C-3    all    all Soil_disturbance1\n#> 342 seminat    NA  T45-C-3    all    all Soil_disturbance2\n#> 343 seminat    NA  V10-C-1    all    all Soil_disturbance1\n#> 344 seminat    NA  V10-C-1    all    all Soil_disturbance2\n#> 345 seminat    NA  V10-C-3    all    all Soil_disturbance1\n#> 346 seminat    NA  V10-C-3    all    all Soil_disturbance2\n#> 347 seminat    NA  T34-C-2    all    all Soil_disturbance1\n#> 348 seminat    NA  T34-C-2    all    all Soil_disturbance2\n#> 349 seminat    NA  T34-C-4    all    all Soil_disturbance1\n#> 350 seminat    NA  T34-C-4    all    all Soil_disturbance2\n#> 351 seminat    NA  T34-C-5    all    all Soil_disturbance1\n#> 352 seminat    NA  T34-C-5    all    all Soil_disturbance2\n#> 353 seminat    NA  T34-C-6    all    all Soil_disturbance1\n#> 354 seminat    NA  T34-C-6    all    all Soil_disturbance2\n#> 355 seminat    NA  T32-C-5    all    all Soil_disturbance1\n#> 356 seminat    NA  T32-C-5    all    all Soil_disturbance2\n#> 357 seminat    NA  T32-C-9    all    all Soil_disturbance1\n#> 358 seminat    NA  T32-C-9    all    all Soil_disturbance2\n#> 359 seminat    NA T32-C-21    all    all Soil_disturbance1\n#> 360 seminat    NA T32-C-21    all    all Soil_disturbance2\n#> 361 seminat    NA T32-C-10    all    all Soil_disturbance1\n#> 362 seminat    NA T32-C-10    all    all Soil_disturbance2\n#> 363 seminat    NA      T41    all    all Soil_disturbance1\n#> 364 seminat    NA      T41    all    all Soil_disturbance2\n#> 365 seminat    NA  T32-C-2    all    all Soil_disturbance1\n#> 366 seminat    NA  T32-C-2    all    all Soil_disturbance2\n#> 367 seminat    NA  T32-C-4    all    all Soil_disturbance1\n#> 368 seminat    NA  T32-C-4    all    all Soil_disturbance2\n#> 369 seminat    NA  T32-C-8    all    all Soil_disturbance1\n#> 370 seminat    NA  T32-C-8    all    all Soil_disturbance2\n#> 371 seminat    NA  T45-C-2    all    all Soil_disturbance1\n#> 372 seminat    NA  T45-C-2    all    all Soil_disturbance2\n#> 373 seminat    NA  V10-C-2    all    all Soil_disturbance1\n#> 374 seminat    NA  V10-C-2    all    all Soil_disturbance2\n#> 375 seminat    NA T32-C-20    all    all Soil_disturbance1\n#> 376 seminat    NA T32-C-20    all    all Soil_disturbance2\n#> 377 seminat    NA  T32-C-6    all    all Soil_disturbance1\n#> 378 seminat    NA  T32-C-6    all    all Soil_disturbance2\n#>           Rv       Gv maxmin\n#> 1   4.455855 3.694963      1\n#> 2   4.455855 5.042233      7\n#> 3   4.544696 3.872656      1\n#> 4   4.544696 5.067305      7\n#> 5   5.014867 4.683814      1\n#> 6   5.014867 5.358364      7\n#> 7   5.102876 4.865484      1\n#> 8   5.102876 5.363346      7\n#> 9   5.243469 4.981342      1\n#> 10  5.243469 5.528039      7\n#> 11  5.549659 5.276490      1\n#> 12  5.549659 5.840840      7\n#> 13  5.590502 5.340400      1\n#> 14  5.590502 5.867682      7\n#> 15  5.575833 5.161360      1\n#> 16  5.575833 5.949398      7\n#> 17  5.817253 5.328272      1\n#> 18  5.817253 6.258642      7\n#> 19  4.928749 4.612772      1\n#> 20  4.928749 5.373696      7\n#> 21  4.837483 4.468003      1\n#> 22  4.837483 5.280768      7\n#> 23  4.951364 4.644287      1\n#> 24  4.951364 5.337365      7\n#> 25  4.973424 4.571538      1\n#> 26  4.973424 5.479821      7\n#> 27  4.994966 4.527074      1\n#> 28  4.994966 5.516279      7\n#> 29  5.037433 4.484462      1\n#> 30  5.037433 6.102683      7\n#> 31  5.155210 4.902428      1\n#> 32  5.155210 5.411498      7\n#> 33  4.775632 4.454662      1\n#> 34  4.775632 5.200423      7\n#> 35  5.125608 4.792464      1\n#> 36  5.125608 5.428366      7\n#> 37  4.891147 4.502474      1\n#> 38  4.891147 5.281771      7\n#> 39  5.251130 5.003183      1\n#> 40  5.251130 5.513521      7\n#> 41  5.014867 4.683814      1\n#> 42  5.014867 5.358364      7\n#> 43  5.102876 4.865484      1\n#> 44  5.102876 5.363346      7\n#> 45  5.243469 4.981342      1\n#> 46  5.243469 5.528039      7\n#> 47  5.575833 5.161360      1\n#> 48  5.575833 5.949398      7\n#> 49  4.928749 4.612772      1\n#> 50  4.928749 5.373696      7\n#> 51  5.155210 4.902428      1\n#> 52  5.155210 5.411498      7\n#> 53  5.125608 4.792464      1\n#> 54  5.125608 5.428366      7\n#> 55  4.911158 4.064785      1\n#> 56  4.911158 5.726332     12\n#> 57  5.026818 4.291278      1\n#> 58  5.026818 5.733233     12\n#> 59  5.156158 4.317811      1\n#> 60  5.156158 5.852822     12\n#> 61  4.643624 4.034961      1\n#> 62  4.643624 5.166102     12\n#> 63  4.333141 3.830252      1\n#> 64  4.333141 4.867984     12\n#> 65  3.507617 3.058656      1\n#> 66  3.507617 3.966790     12\n#> 67  3.832367 3.325401      1\n#> 68  3.832367 4.293118     12\n#> 69  5.023939 4.443489      1\n#> 70  5.023939 5.731531     12\n#> 71  5.088821 4.308375      1\n#> 72  5.088821 6.247535     12\n#> 73  7.744906 7.076748      1\n#> 74  7.744906 8.397017     12\n#> 75  7.325905 6.589075      1\n#> 76  7.325905 7.962753     12\n#> 77  4.383662 3.931920      1\n#> 78  4.383662 5.483512     12\n#> 79  4.423535 3.042370      1\n#> 80  4.423535 5.515288     12\n#> 81  4.488716 3.062607      1\n#> 82  4.488716 6.141326     12\n#> 83  4.455076 3.293148      1\n#> 84  4.455076 6.097862     12\n#> 85  4.406973 3.925413      1\n#> 86  4.406973 4.921254     12\n#> 87  5.680832 5.055916      1\n#> 88  5.680832 6.385162     12\n#> 89  4.662601 4.137763      1\n#> 90  4.662601 5.116347     12\n#> 91  5.612696 4.978014      1\n#> 92  5.612696 6.322015     12\n#> 93  5.178649 4.807721      1\n#> 94  5.178649 5.590864     12\n#> 95  5.156158 4.317811      1\n#> 96  5.156158 5.852822     12\n#> 97  4.643624 4.034961      1\n#> 98  4.643624 5.166102     12\n#> 99  4.333141 3.830252      1\n#> 100 4.333141 4.867984     12\n#> 101 5.023939 4.443489      1\n#> 102 5.023939 5.731531     12\n#> 103 7.744906 7.076748      1\n#> 104 7.744906 8.397017     12\n#> 105 4.406973 3.925413      1\n#> 106 4.406973 4.921254     12\n#> 107 4.662601 4.137763      1\n#> 108 4.662601 5.116347     12\n#> 109 2.763966 2.231924      1\n#> 110 2.763966 3.643059      8\n#> 111 2.996911 2.377691      1\n#> 112 2.996911 3.843860      8\n#> 113 4.051586 3.437854      1\n#> 114 4.051586 4.753529      8\n#> 115 4.550274 4.134956      1\n#> 116 4.550274 4.956232      8\n#> 117 5.402029 4.903506      1\n#> 118 5.402029 5.882318      8\n#> 119 5.137312 4.741062      1\n#> 120 5.137312 5.503883      8\n#> 121 5.198332 4.840029      1\n#> 122 5.198332 5.561334      8\n#> 123 5.452576 4.952658      1\n#> 124 5.452576 6.011182      8\n#> 125 5.561022 4.917752      1\n#> 126 5.561022 6.194208      8\n#> 127 4.616442 4.029667      1\n#> 128 4.616442 5.153380      8\n#> 129 4.750926 4.198709      1\n#> 130 4.750926 5.301648      8\n#> 131 2.444579 2.028829      1\n#> 132 2.444579 2.804951      8\n#> 133 2.975433 2.232830      1\n#> 134 2.975433 4.525925      8\n#> 135 4.026055 2.778285      1\n#> 136 4.026055 5.083037      8\n#> 137 4.379822 3.020470      1\n#> 138 4.379822 5.795966      8\n#> 139 5.094791 4.706848      1\n#> 140 5.094791 5.461205      8\n#> 141 4.966522 4.514010      1\n#> 142 4.966522 5.395454      8\n#> 143 5.100929 4.758323      1\n#> 144 5.100929 5.424962      8\n#> 145 5.085724 4.716802      1\n#> 146 5.085724 5.428951      8\n#> 147 5.133712 4.851695      1\n#> 148 5.133712 5.460406      8\n#> 149 4.051586 3.437854      1\n#> 150 4.051586 4.753529      8\n#> 151 4.550274 4.134956      1\n#> 152 4.550274 4.956232      8\n#> 153 5.402029 4.903506      1\n#> 154 5.402029 5.882318      8\n#> 155 5.452576 4.952658      1\n#> 156 5.452576 6.011182      8\n#> 157 4.616442 4.029667      1\n#> 158 4.616442 5.153380      8\n#> 159 5.094791 4.706848      1\n#> 160 5.094791 5.461205      8\n#> 161 5.100929 4.758323      1\n#> 162 5.100929 5.424962      8\n#> 163 3.306753 2.374611      1\n#> 164 3.306753 4.676875      9\n#> 165 3.275629 2.551192      1\n#> 166 3.275629 4.387774      9\n#> 167 3.801197 3.013542      1\n#> 168 3.801197 4.718075      9\n#> 169 4.295415 3.745158      1\n#> 170 4.295415 4.840228      9\n#> 171 3.907100 3.467906      1\n#> 172 3.907100 4.454971      9\n#> 173 3.898565 3.550895      1\n#> 174 3.898565 4.286540      9\n#> 175 4.530815 3.989319      1\n#> 176 4.530815 5.040762      9\n#> 177 6.062480 5.282732      1\n#> 178 6.062480 6.633160      9\n#> 179 5.812497 4.834808      1\n#> 180 5.812497 6.883664      9\n#> 181 5.253199 4.332844      1\n#> 182 5.253199 6.029532      9\n#> 183 5.482393 4.675791      1\n#> 184 5.482393 6.198834      9\n#> 185 2.423099 2.080377      1\n#> 186 2.423099 2.798250      9\n#> 187 2.650282 1.994667      1\n#> 188 2.650282 3.675827      9\n#> 189 2.941948 2.118758      1\n#> 190 2.941948 3.836682      9\n#> 191 2.993038 2.108276      1\n#> 192 2.993038 3.803690      9\n#> 193 4.136638 3.629971      1\n#> 194 4.136638 4.676468      9\n#> 195 5.276425 4.479744      1\n#> 196 5.276425 6.041027      9\n#> 197 4.881833 4.255017      1\n#> 198 4.881833 5.394140      9\n#> 199 5.686866 5.015903      1\n#> 200 5.686866 6.325652      9\n#> 201 5.782120 5.327610      1\n#> 202 5.782120 6.243091      9\n#> 203 3.801197 3.013542      1\n#> 204 3.801197 4.718075      9\n#> 205 4.295415 3.745158      1\n#> 206 4.295415 4.840228      9\n#> 207 3.907100 3.467906      1\n#> 208 3.907100 4.454971      9\n#> 209 6.062480 5.282732      1\n#> 210 6.062480 6.633160      9\n#> 211 5.253199 4.332844      1\n#> 212 5.253199 6.029532      9\n#> 213 4.136638 3.629971      1\n#> 214 4.136638 4.676468      9\n#> 215 4.881833 4.255017      1\n#> 216 4.881833 5.394140      9\n#> 217 2.702927 2.178991      1\n#> 218 2.702927 3.440871      9\n#> 219 2.733013 2.277478      1\n#> 220 2.733013 3.347336      9\n#> 221 2.912161 2.449075      1\n#> 222 2.912161 3.486105      9\n#> 223 3.241309 2.911345      1\n#> 224 3.241309 3.577153      9\n#> 225 2.993730 2.624162      1\n#> 226 2.993730 3.348833      9\n#> 227 3.079720 2.759828      1\n#> 228 3.079720 3.432867      9\n#> 229 3.410515 3.079555      1\n#> 230 3.410515 3.731820      9\n#> 231 4.146738 3.710334      1\n#> 232 4.146738 4.552950      9\n#> 233 4.168608 3.525970      1\n#> 234 4.168608 4.788924      9\n#> 235 3.676992 3.125459      1\n#> 236 3.676992 4.160553      9\n#> 237 3.736049 3.295643      1\n#> 238 3.736049 4.161127      9\n#> 239 3.324569 2.770666      1\n#> 240 3.324569 3.646475      9\n#> 241 3.055151 1.794028      1\n#> 242 3.055151 3.554441      9\n#> 243 2.755898 1.895038      1\n#> 244 2.755898 3.547876      9\n#> 245 2.719993 1.852948      1\n#> 246 2.719993 3.436248      9\n#> 247 3.139092 2.809679      1\n#> 248 3.139092 3.461385      9\n#> 249 3.668771 3.180545      1\n#> 250 3.668771 4.132592      9\n#> 251 3.581140 3.236024      1\n#> 252 3.581140 3.922420      9\n#> 253 3.924785 3.471647      1\n#> 254 3.924785 4.306964      9\n#> 255 3.899025 3.633083      1\n#> 256 3.899025 4.178710      9\n#> 257 2.912161 2.449075      1\n#> 258 2.912161 3.486105      9\n#> 259 3.241309 2.911345      1\n#> 260 3.241309 3.577153      9\n#> 261 2.993730 2.624162      1\n#> 262 2.993730 3.348833      9\n#> 263 4.146738 3.710334      1\n#> 264 4.146738 4.552950      9\n#> 265 3.676992 3.125459      1\n#> 266 3.676992 4.160553      9\n#> 267 3.139092 2.809679      1\n#> 268 3.139092 3.461385      9\n#> 269 3.581140 3.236024      1\n#> 270 3.581140 3.922420      9\n#> 271 3.791938 2.984216      1\n#> 272 3.791938 4.358905      9\n#> 273 3.964737 3.293034      1\n#> 274 3.964737 4.543427      9\n#> 275 4.979633 4.335506      1\n#> 276 4.979633 5.536351      9\n#> 277 4.954427 4.555127      1\n#> 278 4.954427 5.370583      9\n#> 279 5.027109 4.617482      1\n#> 280 5.027109 5.427039      9\n#> 281 4.776583 4.331891      1\n#> 282 4.776583 5.189621      9\n#> 283 4.610136 4.060324      1\n#> 284 4.610136 5.147616      9\n#> 285 4.639444 3.676524      1\n#> 286 4.639444 5.412049      9\n#> 287 5.029662 3.627166      1\n#> 288 5.029662 5.757345      9\n#> 289 3.957329 3.397081      1\n#> 290 3.957329 4.541129      9\n#> 291 3.988681 3.275067      1\n#> 292 3.988681 4.596878      9\n#> 293 4.199011 3.822095      1\n#> 294 4.199011 4.679568      9\n#> 295 4.460697 3.964206      1\n#> 296 4.460697 5.441127      9\n#> 297 4.583622 3.918681      1\n#> 298 4.583622 5.318680      9\n#> 299 4.559088 3.996109      1\n#> 300 4.559088 5.281011      9\n#> 301 4.987574 4.637458      1\n#> 302 4.987574 5.359284      9\n#> 303 4.585217 4.092966      1\n#> 304 4.585217 5.160583      9\n#> 305 4.855540 4.420037      1\n#> 306 4.855540 5.358011      9\n#> 307 4.661327 4.083125      1\n#> 308 4.661327 5.268052      9\n#> 309 4.668937 4.160459      1\n#> 310 4.668937 5.149184      9\n#> 311 4.979633 4.335506      1\n#> 312 4.979633 5.536351      9\n#> 313 4.954427 4.555127      1\n#> 314 4.954427 5.370583      9\n#> 315 5.027109 4.617482      1\n#> 316 5.027109 5.427039      9\n#> 317 4.639444 3.676524      1\n#> 318 4.639444 5.412049      9\n#> 319 3.957329 3.397081      1\n#> 320 3.957329 4.541129      9\n#> 321 4.987574 4.637458      1\n#> 322 4.987574 5.359284      9\n#> 323 4.855540 4.420037      1\n#> 324 4.855540 5.358011      9\n#> 325 2.585099 1.700971      1\n#> 326 2.585099 3.974465      9\n#> 327 2.712202 1.957253      1\n#> 328 2.712202 3.851444      9\n#> 329 3.341770 2.566533      1\n#> 330 3.341770 4.715854      9\n#> 331 3.708287 3.107489      1\n#> 332 3.708287 4.363006      9\n#> 333 3.825798 3.256646      1\n#> 334 3.825798 4.440356      9\n#> 335 4.102155 3.589531      1\n#> 336 4.102155 4.698638      9\n#> 337 4.315234 3.684712      1\n#> 338 4.315234 5.079617      9\n#> 339 4.772443 3.792943      1\n#> 340 4.772443 5.910748      9\n#> 341 5.313561 3.887352      1\n#> 342 5.313561 7.055054      9\n#> 343 3.176236 2.408673      1\n#> 344 3.176236 4.057877      9\n#> 345 3.325373 2.522885      1\n#> 346 3.325373 4.404043      9\n#> 347 4.138198 3.209041      1\n#> 348 4.138198 4.686286      9\n#> 349 3.864515 2.769936      1\n#> 350 3.864515 4.593340      9\n#> 351 3.647634 2.607216      1\n#> 352 3.647634 4.573322      9\n#> 353 3.638081 2.672613      1\n#> 354 3.638081 4.486693      9\n#> 355 3.635034 3.118888      1\n#> 356 3.635034 4.203783      9\n#> 357 3.026330 2.529383      1\n#> 358 3.026330 3.779491      9\n#> 359 3.730151 3.027811      1\n#> 360 3.730151 4.588422      9\n#> 361 3.315751 2.657839      1\n#> 362 3.315751 4.100310      9\n#> 363 3.953994 3.390231      1\n#> 364 3.953994 4.583870      9\n#> 365 3.341770 2.566533      1\n#> 366 3.341770 4.715854      9\n#> 367 3.708287 3.107489      1\n#> 368 3.708287 4.363006      9\n#> 369 3.825798 3.256646      1\n#> 370 3.825798 4.440356      9\n#> 371 4.772443 3.792943      1\n#> 372 4.772443 5.910748      9\n#> 373 3.176236 2.408673      1\n#> 374 3.176236 4.057877      9\n#> 375 3.635034 3.118888      1\n#> 376 3.635034 4.203783      9\n#> 377 3.730151 3.027811      1\n#> 378 3.730151 4.588422      9\n#>       N1               hoved                grunn    \n#>  Length:378         Length:378         T32-C-1 : 14  \n#>  Class :character   Class :character   T32-C-10: 14  \n#>  Mode  :character   Mode  :character   T32-C-15: 14  \n#>                                        T32-C-16: 14  \n#>                                        T32-C-2 : 14  \n#>                                        T32-C-20: 14  \n#>                                        (Other) :294  \n#>     county             region         \n#>  Length:378         Length:378        \n#>  Class :character   Class :character  \n#>  Mode  :character   Mode  :character  \n#>                                       \n#>                                       \n#>                                       \n#>                                       \n#>               Ind            Rv              Gv       \n#>  Grazing_mowing1: 27   Min.   :2.423   Min.   :1.701  \n#>  Grazing_mowing2: 27   1st Qu.:3.730   1st Qu.:3.631  \n#>  Light1         : 27   Median :4.550   Median :4.520  \n#>  Light2         : 27   Mean   :4.403   Mean   :4.419  \n#>  Moist1         : 27   3rd Qu.:5.030   3rd Qu.:5.280  \n#>  Moist2         : 27   Max.   :7.745   Max.   :8.397  \n#>  (Other)        :216                                  \n#>      maxmin  \n#>  Min.   : 1  \n#>  1st Qu.: 1  \n#>  Median : 4  \n#>  Mean   : 5  \n#>  3rd Qu.: 9  \n#>  Max.   :12  \n#> \nhead(seminat.ref.cov.val)\n#>        N1 hoved   grunn county region    Ind       Rv\n#> 1 seminat    NA T34-C-1    all    all Light1 4.455855\n#> 2 seminat    NA T34-C-1    all    all Light2 4.455855\n#> 3 seminat    NA T34-C-3    all    all Light1 4.544696\n#> 4 seminat    NA T34-C-3    all    all Light2 4.544696\n#> 5 seminat    NA T32-C-1    all    all Light1 5.014867\n#> 6 seminat    NA T32-C-1    all    all Light2 5.014867\n#>         Gv maxmin\n#> 1 3.694963      1\n#> 2 5.042233      7\n#> 3 3.872656      1\n#> 4 5.067305      7\n#> 5 4.683814      1\n#> 6 5.358364      7\n\n#### scaled values ####\nr.s <- 1    # reference value\nl.s <- 0.6  # limit value\na.s <- 0    # abscence of indicator, or indicator at maximum\n\n#### function for calculating scaled values for measured value ####\n\n## scaling function including truncation\nscal <- function() {\n  # place to hold the result\n   x <- numeric()\n  if (maxmin < ref) {\n    # values >= the reference value equal 1\n    if (val >= ref) {x <- 1}\n    # values < the reference value and >= the limit value can be deducted from the linear relationship between these two\n    if (val < ref & val >= lim) {x <- (l.s + (val-lim) * ( (r.s-l.s) / (ref-lim) ) )}\n    # values < the limit value and > maxmin can be deducted from the linear relationship between these two\n    if (val < lim & val > maxmin) {x <- (a.s + (val-maxmin) * ( (l.s-a.s) / (lim-maxmin) ) )}\n    # value equals or lower than maxmin\n    if (val <= maxmin) {x <-0}\n  } else {\n    # values <= the reference value equal 1\n    if (val <= ref) {x <- 1}\n    # values > the reference value and <= the limit value can be deducted from the linear relationship between these two\n    if (val > ref & val <= lim) {x <- ( r.s - ( (r.s - l.s) * (val - ref) / (lim - ref) ) )}\n    # values > the limit value and < maxmin can be deducted from the linear relationship between these two\n    if (val > lim) {x <- ( l.s - (l.s * (val - lim) / (maxmin - lim) ) )}\n    # value equals or larger than maxmin\n    if (val >= maxmin) {x <-0}\n  }\n  return(x)\n  \n}\n\n#### calculating scaled and non-truncated values for the indicators based on the dataset ####\nfor (i in 1:nrow(ANO.seminat) ) {  #\n  tryCatch({\n    print(i)\n    print(paste(ANO.seminat$ano_flate_id[i]))\n    print(paste(ANO.seminat$ano_punkt_id[i]))\n#    ANO.seminat$Hovedoekosystem_sirkel[i]\n#    ANO.seminat$Hovedoekosystem_rute[i]\n\n    # if the ANO.hovedtype exists in the reference\n    if (ANO.seminat$hovedtype_rute[i] %in% unique(substr(seminat.ref.cov.val$grunn,1,3)) ) {\n      \n      # if there is any species present in current ANO point  \n      if ( length(ANO.sp.ind[ANO.sp.ind$ParentGlobalID==as.character(ANO.seminat$GlobalID[i]),'Species']) > 0 ) {\n        \n\n          \n          # Light\n          dat <- ANO.sp.ind[ANO.sp.ind$ParentGlobalID==as.character(ANO.seminat$GlobalID[i]),c('art_dekning','Light')]\n          results.seminat.ANO[['original']][i,'richness'] <- nrow(dat)\n          dat <- dat[!is.na(dat$Light),]\n          \n          if ( nrow(dat)>0 ) {\n            \n            val <- sum(dat[,'art_dekning'] * dat[,'Light'],na.rm=T) / sum(dat[,'art_dekning'],na.rm=T)\n            # lower part of distribution\n            ref <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Light1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n            lim <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Light1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n            maxmin <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Light1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n            # coercing x into results.seminat.ANO dataframe\n            results.seminat.ANO[['scaled']][i,'Light1'] <- scal() \n            results.seminat.ANO[['non-truncated']][i,'Light1'] <- scal.2() \n            results.seminat.ANO[['original']][i,'Light1'] <- val \n            \n            # upper part of distribution\n            ref <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Light2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n            lim <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Light2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n            maxmin <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Light2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n            # coercing x into results.seminat.ANO dataframe\n            results.seminat.ANO[['scaled']][i,'Light2'] <- scal() \n            results.seminat.ANO[['non-truncated']][i,'Light2'] <- scal.2() \n            results.seminat.ANO[['original']][i,'Light2'] <- val\n          }\n          \n          \n          # Moisture\n          dat <- ANO.sp.ind[ANO.sp.ind$ParentGlobalID==as.character(ANO.seminat$GlobalID[i]),c('art_dekning','Moisture')]\n          results.seminat.ANO[['original']][i,'richness'] <- nrow(dat)\n          dat <- dat[!is.na(dat$Moisture),]\n          \n          if ( nrow(dat)>0 ) {\n            \n            val <- sum(dat[,'art_dekning'] * dat[,'Moisture'],na.rm=T) / sum(dat[,'art_dekning'],na.rm=T)\n            # lower part of distribution\n            ref <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Moist1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n            lim <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Moist1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n            maxmin <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Moist1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n            # coercing x into results.seminat.ANO dataframe\n            results.seminat.ANO[['scaled']][i,'Moist1'] <- scal() \n            results.seminat.ANO[['non-truncated']][i,'Moist1'] <- scal.2() \n            results.seminat.ANO[['original']][i,'Moist1'] <- val \n            \n            # upper part of distribution\n            ref <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Moist2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n            lim <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Moist2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n            maxmin <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Moist2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n            # coercing x into results.seminat.ANO dataframe\n            results.seminat.ANO[['scaled']][i,'Moist2'] <- scal() \n            results.seminat.ANO[['non-truncated']][i,'Moist2'] <- scal.2() \n            results.seminat.ANO[['original']][i,'Moist2'] <- val\n          }\n          \n          \n          # Soil_reaction_pH\n          dat <- ANO.sp.ind[ANO.sp.ind$ParentGlobalID==as.character(ANO.seminat$GlobalID[i]),c('art_dekning','Soil_reaction_pH')]\n          results.seminat.ANO[['original']][i,'richness'] <- nrow(dat)\n          dat <- dat[!is.na(dat$Soil_reaction_pH),]\n          \n          if ( nrow(dat)>0 ) {\n            \n            val <- sum(dat[,'art_dekning'] * dat[,'Soil_reaction_pH'],na.rm=T) / sum(dat[,'art_dekning'],na.rm=T)\n            # lower part of distribution\n            ref <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='pH1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n            lim <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='pH1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n            maxmin <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='pH1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n            # coercing x into results.seminat.ANO dataframe\n            results.seminat.ANO[['scaled']][i,'pH1'] <- scal() \n            results.seminat.ANO[['non-truncated']][i,'pH1'] <- scal.2() \n            results.seminat.ANO[['original']][i,'pH1'] <- val \n            \n            # upper part of distribution\n            ref <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='pH2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n            lim <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='pH2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n            maxmin <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='pH2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n            # coercing x into results.seminat.ANO dataframe\n            results.seminat.ANO[['scaled']][i,'pH2'] <- scal() \n            results.seminat.ANO[['non-truncated']][i,'pH2'] <- scal.2() \n            results.seminat.ANO[['original']][i,'pH2'] <- val\n          }\n          \n          \n          # Nitrogen\n          dat <- ANO.sp.ind[ANO.sp.ind$ParentGlobalID==as.character(ANO.seminat$GlobalID[i]),c('art_dekning','Nitrogen')]\n          results.seminat.ANO[['original']][i,'richness'] <- nrow(dat)\n          dat <- dat[!is.na(dat$Nitrogen),]\n          \n          if ( nrow(dat)>0 ) {\n            \n            val <- sum(dat[,'art_dekning'] * dat[,'Nitrogen'],na.rm=T) / sum(dat[,'art_dekning'],na.rm=T)\n            # lower part of distribution\n            ref <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Nitrogen1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n            lim <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Nitrogen1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n            maxmin <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Nitrogen1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n            # coercing x into results.seminat.ANO dataframe\n            results.seminat.ANO[['scaled']][i,'Nitrogen1'] <- scal() \n            results.seminat.ANO[['non-truncated']][i,'Nitrogen1'] <- scal.2() \n            results.seminat.ANO[['original']][i,'Nitrogen1'] <- val \n            \n            # upper part of distribution\n            ref <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Nitrogen2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n            lim <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Nitrogen2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n            maxmin <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Nitrogen2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n            # coercing x into results.seminat.ANO dataframe\n            results.seminat.ANO[['scaled']][i,'Nitrogen2'] <- scal() \n            results.seminat.ANO[['non-truncated']][i,'Nitrogen2'] <- scal.2() \n            results.seminat.ANO[['original']][i,'Nitrogen2'] <- val\n          }\n          \n          \n          # Phosphorus\n          dat <- ANO.sp.ind[ANO.sp.ind$ParentGlobalID==as.character(ANO.seminat$GlobalID[i]),c('art_dekning','Phosphorus')]\n          results.seminat.ANO[['original']][i,'richness'] <- nrow(dat)\n          dat <- dat[!is.na(dat$Phosphorus),]\n          \n          if ( nrow(dat)>0 ) {\n            \n            val <- sum(dat[,'art_dekning'] * dat[,'Phosphorus'],na.rm=T) / sum(dat[,'art_dekning'],na.rm=T)\n            # lower part of distribution\n            ref <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Phosphorus1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n            lim <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Phosphorus1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n            maxmin <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Phosphorus1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n            # coercing x into results.seminat.ANO dataframe\n            results.seminat.ANO[['scaled']][i,'Phosphorus1'] <- scal() \n            results.seminat.ANO[['non-truncated']][i,'Phosphorus1'] <- scal.2() \n            results.seminat.ANO[['original']][i,'Phosphorus1'] <- val \n            \n            # upper part of distribution\n            ref <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Phosphorus2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n            lim <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Phosphorus2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n            maxmin <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Phosphorus2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n            # coercing x into results.seminat.ANO dataframe\n            results.seminat.ANO[['scaled']][i,'Phosphorus2'] <- scal() \n            results.seminat.ANO[['non-truncated']][i,'Phosphorus2'] <- scal.2() \n            results.seminat.ANO[['original']][i,'Phosphorus2'] <- val\n          }\n          \n          \n          # Grazing_mowing\n          dat <- ANO.sp.ind[ANO.sp.ind$ParentGlobalID==as.character(ANO.seminat$GlobalID[i]),c('art_dekning','Grazing_mowing')]\n          results.seminat.ANO[['original']][i,'richness'] <- nrow(dat)\n          dat <- dat[!is.na(dat$Grazing_mowing),]\n          \n          if ( nrow(dat)>0 ) {\n            \n            val <- sum(dat[,'art_dekning'] * dat[,'Grazing_mowing'],na.rm=T) / sum(dat[,'art_dekning'],na.rm=T)\n            # lower part of distribution\n            ref <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Grazing_mowing1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n            lim <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Grazing_mowing1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n            maxmin <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Grazing_mowing1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n            # coercing x into results.seminat.ANO dataframe\n            results.seminat.ANO[['scaled']][i,'Grazing_mowing1'] <- scal() \n            results.seminat.ANO[['non-truncated']][i,'Grazing_mowing1'] <- scal.2() \n            results.seminat.ANO[['original']][i,'Grazing_mowing1'] <- val \n            \n            # upper part of distribution\n            ref <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Grazing_mowing2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n            lim <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Grazing_mowing2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n            maxmin <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Grazing_mowing2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n            # coercing x into results.seminat.ANO dataframe\n            results.seminat.ANO[['scaled']][i,'Grazing_mowing2'] <- scal() \n            results.seminat.ANO[['non-truncated']][i,'Grazing_mowing2'] <- scal.2() \n            results.seminat.ANO[['original']][i,'Grazing_mowing2'] <- val\n          }\n          \n          \n          # Soil_disturbance\n          dat <- ANO.sp.ind[ANO.sp.ind$ParentGlobalID==as.character(ANO.seminat$GlobalID[i]),c('art_dekning','Soil_disturbance')]\n          results.seminat.ANO[['original']][i,'richness'] <- nrow(dat)\n          dat <- dat[!is.na(dat$Soil_disturbance),]\n          \n          if ( nrow(dat)>0 ) {\n            \n            val <- sum(dat[,'art_dekning'] * dat[,'Soil_disturbance'],na.rm=T) / sum(dat[,'art_dekning'],na.rm=T)\n            # lower part of distribution\n            ref <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Soil_disturbance1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n            lim <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Soil_disturbance1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n            maxmin <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Soil_disturbance1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n            # coercing x into results.seminat.ANO dataframe\n            results.seminat.ANO[['scaled']][i,'Soil_disturbance1'] <- scal() \n            results.seminat.ANO[['non-truncated']][i,'Soil_disturbance1'] <- scal.2() \n            results.seminat.ANO[['original']][i,'Soil_disturbance1'] <- val \n            \n            # upper part of distribution\n            ref <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Soil_disturbance2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n            lim <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Soil_disturbance2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n            maxmin <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Soil_disturbance2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n            # coercing x into results.seminat.ANO dataframe\n            results.seminat.ANO[['scaled']][i,'Soil_disturbance2'] <- scal() \n            results.seminat.ANO[['non-truncated']][i,'Soil_disturbance2'] <- scal.2() \n            results.seminat.ANO[['original']][i,'Soil_disturbance2'] <- val\n          }\n          \n          \n          \n        }\n      }\n      \n\n    \n  }, error=function(e){cat(\"ERROR :\",conditionMessage(e), \"\\n\")})\n}\n\n\n# for using both sides of the plant indicators\nresults.seminat.ANO[['2-sided']] <- results.seminat.ANO[['non-truncated']]\n\n# remove values >1 for 2-sided indicators\nresults.seminat.ANO[['2-sided']]$Light1[results.seminat.ANO[['2-sided']]$Light1>1] <- NA\nresults.seminat.ANO[['2-sided']]$Light2[results.seminat.ANO[['2-sided']]$Light2>1] <- NA\n\nresults.seminat.ANO[['2-sided']]$Moist1[results.seminat.ANO[['2-sided']]$Moist1>1] <- NA\nresults.seminat.ANO[['2-sided']]$Moist2[results.seminat.ANO[['2-sided']]$Moist2>1] <- NA\n\nresults.seminat.ANO[['2-sided']]$pH1[results.seminat.ANO[['2-sided']]$pH1>1] <- NA\nresults.seminat.ANO[['2-sided']]$pH2[results.seminat.ANO[['2-sided']]$pH2>1] <- NA\n\nresults.seminat.ANO[['2-sided']]$Nitrogen1[results.seminat.ANO[['2-sided']]$Nitrogen1>1] <- NA\nresults.seminat.ANO[['2-sided']]$Nitrogen2[results.seminat.ANO[['2-sided']]$Nitrogen2>1] <- NA\n\nresults.seminat.ANO[['2-sided']]$Phosphorus1[results.seminat.ANO[['2-sided']]$Phosphorus1>1] <- NA\nresults.seminat.ANO[['2-sided']]$Phosphorus2[results.seminat.ANO[['2-sided']]$Phosphorus2>1] <- NA\n\nresults.seminat.ANO[['2-sided']]$Grazing_mowing1[results.seminat.ANO[['2-sided']]$Grazing_mowing1>1] <- NA\nresults.seminat.ANO[['2-sided']]$Grazing_mowing2[results.seminat.ANO[['2-sided']]$Grazing_mowing2>1] <- NA\n\nresults.seminat.ANO[['2-sided']]$Soil_disturbance1[results.seminat.ANO[['2-sided']]$Soil_disturbance1>1] <- NA\nresults.seminat.ANO[['2-sided']]$Soil_disturbance2[results.seminat.ANO[['2-sided']]$Soil_disturbance2>1] <- NA\n\n#### calculating scaled and non-truncated values for the indicators based on the dataset ####\nfor (i in 1:nrow(ASO.geo) ) {  #\n  tryCatch({\n    print(i)\n    print(paste(ASO.geo$ASO_ID[i]))\n\n    # if the ASO.grunntype exists in the reference\n    if (ASO.geo$NiN_grunntype[i] %in% unique(seminat.ref.cov.val$grunn) ) {\n      \n      # if there is any species present in current ASO point  \n      if ( length(ASO.sp.ind[ASO.sp.ind$ParentGlobalID==as.character(ASO.geo$GlobalID[i]),'Species']) > 0 ) {\n        \n\n          \n          # Light\n          dat <- ASO.sp.ind[ASO.sp.ind$ParentGlobalID==as.character(ASO.geo$GlobalID[i]),c('art_dekning','Light')]\n          results.seminat.ASO[['original']][i,'richness'] <- nrow(dat)\n          dat <- dat[!is.na(dat$Light),]\n          \n          if ( nrow(dat)>0 ) {\n            \n            val <- sum(dat[,'art_dekning'] * dat[,'Light'],na.rm=T) / sum(dat[,'art_dekning'],na.rm=T)\n            # lower part of distribution\n            ref <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Light1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'Rv']\n            lim <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Light1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'Gv']\n            maxmin <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Light1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'maxmin']\n            # coercing x into results.seminat.ASO dataframe\n            results.seminat.ASO[['scaled']][i,'Light1'] <- scal() \n            results.seminat.ASO[['non-truncated']][i,'Light1'] <- scal.2() \n            results.seminat.ASO[['original']][i,'Light1'] <- val \n            \n            # upper part of distribution\n            ref <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Light2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'Rv']\n            lim <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Light2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'Gv']\n            maxmin <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Light2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'maxmin']\n            # coercing x into results.seminat.ASO dataframe\n            results.seminat.ASO[['scaled']][i,'Light2'] <- scal() \n            results.seminat.ASO[['non-truncated']][i,'Light2'] <- scal.2() \n            results.seminat.ASO[['original']][i,'Light2'] <- val\n          }\n          \n          \n          # Moisture\n          dat <- ASO.sp.ind[ASO.sp.ind$ParentGlobalID==as.character(ASO.geo$GlobalID[i]),c('art_dekning','Moisture')]\n          results.seminat.ASO[['original']][i,'richness'] <- nrow(dat)\n          dat <- dat[!is.na(dat$Moisture),]\n          \n          if ( nrow(dat)>0 ) {\n            \n            val <- sum(dat[,'art_dekning'] * dat[,'Moisture'],na.rm=T) / sum(dat[,'art_dekning'],na.rm=T)\n            # lower part of distribution\n            ref <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Moist1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'Rv']\n            lim <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Moist1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'Gv']\n            maxmin <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Moist1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'maxmin']\n            # coercing x into results.seminat.ASO dataframe\n            results.seminat.ASO[['scaled']][i,'Moist1'] <- scal() \n            results.seminat.ASO[['non-truncated']][i,'Moist1'] <- scal.2() \n            results.seminat.ASO[['original']][i,'Moist1'] <- val \n            \n            # upper part of distribution\n            ref <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Moist2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'Rv']\n            lim <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Moist2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'Gv']\n            maxmin <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Moist2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'maxmin']\n            # coercing x into results.seminat.ASO dataframe\n            results.seminat.ASO[['scaled']][i,'Moist2'] <- scal() \n            results.seminat.ASO[['non-truncated']][i,'Moist2'] <- scal.2() \n            results.seminat.ASO[['original']][i,'Moist2'] <- val\n          }\n          \n          \n          # Soil_reaction_pH\n          dat <- ASO.sp.ind[ASO.sp.ind$ParentGlobalID==as.character(ASO.geo$GlobalID[i]),c('art_dekning','Soil_reaction_pH')]\n          results.seminat.ASO[['original']][i,'richness'] <- nrow(dat)\n          dat <- dat[!is.na(dat$Soil_reaction_pH),]\n          \n          if ( nrow(dat)>0 ) {\n            \n            val <- sum(dat[,'art_dekning'] * dat[,'Soil_reaction_pH'],na.rm=T) / sum(dat[,'art_dekning'],na.rm=T)\n            # lower part of distribution\n            ref <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='pH1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'Rv']\n            lim <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='pH1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'Gv']\n            maxmin <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='pH1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'maxmin']\n            # coercing x into results.seminat.ASO dataframe\n            results.seminat.ASO[['scaled']][i,'pH1'] <- scal() \n            results.seminat.ASO[['non-truncated']][i,'pH1'] <- scal.2() \n            results.seminat.ASO[['original']][i,'pH1'] <- val \n            \n            # upper part of distribution\n            ref <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='pH2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'Rv']\n            lim <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='pH2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'Gv']\n            maxmin <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='pH2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'maxmin']\n            # coercing x into results.seminat.ASO dataframe\n            results.seminat.ASO[['scaled']][i,'pH2'] <- scal() \n            results.seminat.ASO[['non-truncated']][i,'pH2'] <- scal.2() \n            results.seminat.ASO[['original']][i,'pH2'] <- val\n          }\n          \n          \n          # Nitrogen\n          dat <- ASO.sp.ind[ASO.sp.ind$ParentGlobalID==as.character(ASO.geo$GlobalID[i]),c('art_dekning','Nitrogen')]\n          results.seminat.ASO[['original']][i,'richness'] <- nrow(dat)\n          dat <- dat[!is.na(dat$Nitrogen),]\n          \n          if ( nrow(dat)>0 ) {\n            \n            val <- sum(dat[,'art_dekning'] * dat[,'Nitrogen'],na.rm=T) / sum(dat[,'art_dekning'],na.rm=T)\n            # lower part of distribution\n            ref <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Nitrogen1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'Rv']\n            lim <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Nitrogen1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'Gv']\n            maxmin <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Nitrogen1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'maxmin']\n            # coercing x into results.seminat.ASO dataframe\n            results.seminat.ASO[['scaled']][i,'Nitrogen1'] <- scal() \n            results.seminat.ASO[['non-truncated']][i,'Nitrogen1'] <- scal.2() \n            results.seminat.ASO[['original']][i,'Nitrogen1'] <- val \n            \n            # upper part of distribution\n            ref <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Nitrogen2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'Rv']\n            lim <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Nitrogen2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'Gv']\n            maxmin <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Nitrogen2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'maxmin']\n            # coercing x into results.seminat.ASO dataframe\n            results.seminat.ASO[['scaled']][i,'Nitrogen2'] <- scal() \n            results.seminat.ASO[['non-truncated']][i,'Nitrogen2'] <- scal.2() \n            results.seminat.ASO[['original']][i,'Nitrogen2'] <- val\n          }\n          \n          \n          # Phosphorus\n          dat <- ASO.sp.ind[ASO.sp.ind$ParentGlobalID==as.character(ASO.geo$GlobalID[i]),c('art_dekning','Phosphorus')]\n          results.seminat.ASO[['original']][i,'richness'] <- nrow(dat)\n          dat <- dat[!is.na(dat$Phosphorus),]\n          \n          if ( nrow(dat)>0 ) {\n            \n            val <- sum(dat[,'art_dekning'] * dat[,'Phosphorus'],na.rm=T) / sum(dat[,'art_dekning'],na.rm=T)\n            # lower part of distribution\n            ref <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Phosphorus1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'Rv']\n            lim <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Phosphorus1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'Gv']\n            maxmin <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Phosphorus1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'maxmin']\n            # coercing x into results.seminat.ASO dataframe\n            results.seminat.ASO[['scaled']][i,'Phosphorus1'] <- scal() \n            results.seminat.ASO[['non-truncated']][i,'Phosphorus1'] <- scal.2() \n            results.seminat.ASO[['original']][i,'Phosphorus1'] <- val \n            \n            # upper part of distribution\n            ref <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Phosphorus2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'Rv']\n            lim <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Phosphorus2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'Gv']\n            maxmin <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Phosphorus2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'maxmin']\n            # coercing x into results.seminat.ASO dataframe\n            results.seminat.ASO[['scaled']][i,'Phosphorus2'] <- scal() \n            results.seminat.ASO[['non-truncated']][i,'Phosphorus2'] <- scal.2() \n            results.seminat.ASO[['original']][i,'Phosphorus2'] <- val\n          }\n          \n          \n          # Grazing_mowing\n          dat <- ASO.sp.ind[ASO.sp.ind$ParentGlobalID==as.character(ASO.geo$GlobalID[i]),c('art_dekning','Grazing_mowing')]\n          results.seminat.ASO[['original']][i,'richness'] <- nrow(dat)\n          dat <- dat[!is.na(dat$Grazing_mowing),]\n          \n          if ( nrow(dat)>0 ) {\n            \n            val <- sum(dat[,'art_dekning'] * dat[,'Grazing_mowing'],na.rm=T) / sum(dat[,'art_dekning'],na.rm=T)\n            # lower part of distribution\n            ref <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Grazing_mowing1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'Rv']\n            lim <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Grazing_mowing1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'Gv']\n            maxmin <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Grazing_mowing1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'maxmin']\n            # coercing x into results.seminat.ASO dataframe\n            results.seminat.ASO[['scaled']][i,'Grazing_mowing1'] <- scal() \n            results.seminat.ASO[['non-truncated']][i,'Grazing_mowing1'] <- scal.2() \n            results.seminat.ASO[['original']][i,'Grazing_mowing1'] <- val \n            \n            # upper part of distribution\n            ref <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Grazing_mowing2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'Rv']\n            lim <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Grazing_mowing2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'Gv']\n            maxmin <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Grazing_mowing2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'maxmin']\n            # coercing x into results.seminat.ASO dataframe\n            results.seminat.ASO[['scaled']][i,'Grazing_mowing2'] <- scal() \n            results.seminat.ASO[['non-truncated']][i,'Grazing_mowing2'] <- scal.2() \n            results.seminat.ASO[['original']][i,'Grazing_mowing2'] <- val\n          }\n          \n          \n          # Soil_disturbance\n          dat <- ASO.sp.ind[ASO.sp.ind$ParentGlobalID==as.character(ASO.geo$GlobalID[i]),c('art_dekning','Soil_disturbance')]\n          results.seminat.ASO[['original']][i,'richness'] <- nrow(dat)\n          dat <- dat[!is.na(dat$Soil_disturbance),]\n          \n          if ( nrow(dat)>0 ) {\n            \n            val <- sum(dat[,'art_dekning'] * dat[,'Soil_disturbance'],na.rm=T) / sum(dat[,'art_dekning'],na.rm=T)\n            # lower part of distribution\n            ref <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Soil_disturbance1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'Rv']\n            lim <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Soil_disturbance1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'Gv']\n            maxmin <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Soil_disturbance1' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'maxmin']\n            # coercing x into results.seminat.ASO dataframe\n            results.seminat.ASO[['scaled']][i,'Soil_disturbance1'] <- scal() \n            results.seminat.ASO[['non-truncated']][i,'Soil_disturbance1'] <- scal.2() \n            results.seminat.ASO[['original']][i,'Soil_disturbance1'] <- val \n            \n            # upper part of distribution\n            ref <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Soil_disturbance2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'Rv']\n            lim <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Soil_disturbance2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'Gv']\n            maxmin <- seminat.ref.cov.val[seminat.ref.cov.val$Ind=='Soil_disturbance2' & seminat.ref.cov.val$grunn==as.character(results.seminat.ASO[['original']][i,\"NiN_grunntype\"]),'maxmin']\n            # coercing x into results.seminat.ASO dataframe\n            results.seminat.ASO[['scaled']][i,'Soil_disturbance2'] <- scal() \n            results.seminat.ASO[['non-truncated']][i,'Soil_disturbance2'] <- scal.2() \n            results.seminat.ASO[['original']][i,'Soil_disturbance2'] <- val\n          }\n          \n          \n          \n        }\n      }\n      \n\n    \n  }, error=function(e){cat(\"ERROR :\",conditionMessage(e), \"\\n\")})\n}\n\n# for using both sides of the plant indicators\nresults.seminat.ASO[['2-sided']] <- results.seminat.ASO[['non-truncated']]\n\n# remove values >1 for 2-sided indicators\nresults.seminat.ASO[['2-sided']]$Light1[results.seminat.ASO[['2-sided']]$Light1>1] <- NA\nresults.seminat.ASO[['2-sided']]$Light2[results.seminat.ASO[['2-sided']]$Light2>1] <- NA\n\nresults.seminat.ASO[['2-sided']]$Moist1[results.seminat.ASO[['2-sided']]$Moist1>1] <- NA\nresults.seminat.ASO[['2-sided']]$Moist2[results.seminat.ASO[['2-sided']]$Moist2>1] <- NA\n\nresults.seminat.ASO[['2-sided']]$pH1[results.seminat.ASO[['2-sided']]$pH1>1] <- NA\nresults.seminat.ASO[['2-sided']]$pH2[results.seminat.ASO[['2-sided']]$pH2>1] <- NA\n\nresults.seminat.ASO[['2-sided']]$Nitrogen1[results.seminat.ASO[['2-sided']]$Nitrogen1>1] <- NA\nresults.seminat.ASO[['2-sided']]$Nitrogen2[results.seminat.ASO[['2-sided']]$Nitrogen2>1] <- NA\n\nresults.seminat.ASO[['2-sided']]$Phosphorus1[results.seminat.ASO[['2-sided']]$Phosphorus1>1] <- NA\nresults.seminat.ASO[['2-sided']]$Phosphorus2[results.seminat.ASO[['2-sided']]$Phosphorus2>1] <- NA\n\nresults.seminat.ASO[['2-sided']]$Grazing_mowing1[results.seminat.ASO[['2-sided']]$Grazing_mowing1>1] <- NA\nresults.seminat.ASO[['2-sided']]$Grazing_mowing2[results.seminat.ASO[['2-sided']]$Grazing_mowing2>1] <- NA\n\nresults.seminat.ASO[['2-sided']]$Soil_disturbance1[results.seminat.ASO[['2-sided']]$Soil_disturbance1>1] <- NA\nresults.seminat.ASO[['2-sided']]$Soil_disturbance2[results.seminat.ASO[['2-sided']]$Soil_disturbance2>1] <- NA\nhead(results.seminat.ANO[['2-sided']])\n#>                                 GlobalID\n#> 1 {6A82CBAF-BD0F-40EE-9ECD-679D064DA5D2}\n#> 2 {F895016D-46E3-4DC4-81AC-22060D841C05}\n#> 3 {B3A03D40-EA4E-4E4F-8FA0-A5FD96D44F37}\n#> 4 {00C75C7D-70A0-40B7-A43D-1FB83A4108EE}\n#> 5 {8213D53A-A0EB-47BE-BCE2-0A6D267F1F59}\n#> 6 {85586A80-718C-464D-BD41-0C6681E36468}\n#>      registeringsdato klokkeslett_start ano_flate_id\n#> 1 2019-08-12 11:59:59             14:25      ANO0007\n#> 2 2019-09-11 11:59:59             11:00      ANO0016\n#> 3 2019-09-09 11:59:59             13:47      ANO0016\n#> 4 2019-09-09 11:59:59             11:32      ANO0016\n#> 5 2019-09-09 11:59:59             12:46      ANO0016\n#> 6 2019-09-18 11:59:59             10:01      ANO0019\n#>   ano_punkt_id         ssb_id program\n#> 1   ANO0007_42 21145006491000     ANO\n#> 2   ANO0016_35 20485006950500     ANO\n#> 3   ANO0016_11 20485006950500     ANO\n#> 4   ANO0016_15 20485006950500     ANO\n#> 5   ANO0016_24 20485006950500     ANO\n#> 6   ANO0019_13 23275006736000     ANO\n#>                                                                   instruks\n#> 1 https://nedlasting.miljodirektoratet.no/naturovervaking/ano_instruks.pdf\n#> 2 https://nedlasting.miljodirektoratet.no/naturovervaking/ano_instruks.pdf\n#> 3 https://nedlasting.miljodirektoratet.no/naturovervaking/ano_instruks.pdf\n#> 4 https://nedlasting.miljodirektoratet.no/naturovervaking/ano_instruks.pdf\n#> 5 https://nedlasting.miljodirektoratet.no/naturovervaking/ano_instruks.pdf\n#> 6 https://nedlasting.miljodirektoratet.no/naturovervaking/ano_instruks.pdf\n#>    aar      dataansvarlig_mdir                   dataeier\n#> 1 2019 Ole Einar Butli Hårstad Miljødirektoratet, VAL/VMK\n#> 2 2019 Ole Einar Butli Hårstad Miljødirektoratet, VAL/VMK\n#> 3 2019 Ole Einar Butli Hårstad Miljødirektoratet, VAL/VMK\n#> 4 2019 Ole Einar Butli Hårstad Miljødirektoratet, VAL/VMK\n#> 5 2019 Ole Einar Butli Hårstad Miljødirektoratet, VAL/VMK\n#> 6 2019 Ole Einar Butli Hårstad Miljødirektoratet, VAL/VMK\n#>                           vaer hovedoekosystem_punkt\n#> 1                overskyet,sol              vaatmark\n#> 2 overskyet,vindstille,opphold    semi_naturlig_mark\n#> 3       sol,vindstille,opphold    semi_naturlig_mark\n#> 4       sol,opphold,vindstille    semi_naturlig_mark\n#> 5       sol,opphold,vindstille    semi_naturlig_mark\n#> 6                     sol,vind    semi_naturlig_mark\n#>   andel_hovedoekosystem_punkt utilgjengelig_punkt\n#> 1                          NA                <NA>\n#> 2                          NA                <NA>\n#> 3                          NA                <NA>\n#> 4                          NA                <NA>\n#> 5                          NA                <NA>\n#> 6                          NA                <NA>\n#>   utilgjengelig_begrunnelse  gps noeyaktighet\n#> 1                      <NA> <NA>         <NA>\n#> 2                      <NA> <NA>         <NA>\n#> 3                      <NA> <NA>         <NA>\n#> 4                      <NA> <NA>         <NA>\n#> 5                      <NA> <NA>         <NA>\n#> 6                      <NA> <NA>         <NA>\n#>   kommentar_posisjon klokkeslett_karplanter_start\n#> 1               <NA>                         <NA>\n#> 2               <NA>                         <NA>\n#> 3               <NA>                         <NA>\n#> 4               <NA>                         <NA>\n#> 5               <NA>                         <NA>\n#> 6               <NA>                         <NA>\n#>   art_alle_registrert karplanter_dekning\n#> 1                <NA>              100.0\n#> 2                <NA>               78.5\n#> 3                <NA>               70.2\n#> 4                <NA>               94.1\n#> 5                <NA>               89.7\n#> 6                <NA>               46.5\n#>   klokkeslett_karplanter_slutt karplanter_feltsjikt\n#> 1                         <NA>                   NA\n#> 2                         <NA>                   NA\n#> 3                         <NA>                   NA\n#> 4                         <NA>                   NA\n#> 5                         <NA>                   NA\n#> 6                         <NA>                   NA\n#>   moser_dekning torvmoser_dekning lav_dekning stroe_dekning\n#> 1           0.0                 0           0           0.0\n#> 2          20.0                 6           1           0.1\n#> 3          18.0                 0           0           1.0\n#> 4           5.0                 0           0           0.1\n#> 5           0.1                 0           0          10.0\n#> 6          34.0                 0           0           0.0\n#>   jord_grus_stein_berg_dekning stubber_kvister_dekning\n#> 1                           NA                      NA\n#> 2                            0                      NA\n#> 3                           10                      NA\n#> 4                            0                      NA\n#> 5                            0                      NA\n#> 6                           17                      NA\n#>   alger_fjell_dekning        kommentar_ruteanalyse\n#> 1                  NA                Høy vannstand\n#> 2                  NA            Lav kun på einer.\n#> 3                  NA                         <NA>\n#> 4                  NA Antar tidligere kystlynghei.\n#> 5                  NA     Underlig gran, tatt med.\n#> 6                  NA                         <NA>\n#>   fastmerker kommentar_fastmerker kartleggingsenhet_1m2\n#> 1       <NA>                 <NA>               V10-C-1\n#> 2       <NA>                 <NA>               T34-C-2\n#> 3       <NA>                 <NA>               T34-C-2\n#> 4       <NA>                 <NA>               T34-C-2\n#> 5       <NA>                 <NA>               T34-C-2\n#> 6       <NA>                 <NA>               T32-C-4\n#>          hovedtype_1m2                 ke_beskrivelse_1m2\n#> 1 Semi-naturlig våteng                 intermediær våteng\n#> 2          Kystlynghei          kalkfattige kystlyngheier\n#> 3          Kystlynghei          kalkfattige kystlyngheier\n#> 4          Kystlynghei          kalkfattige kystlyngheier\n#> 5          Kystlynghei          kalkfattige kystlyngheier\n#> 6    Semi-naturlig eng intermediær eng med klart hevdpreg\n#>   kartleggingsenhet_250m2 hovedtype_250m2\n#> 1                    <NA>            <NA>\n#> 2                    <NA>            <NA>\n#> 3                    <NA>            <NA>\n#> 4                    <NA>            <NA>\n#> 5                    <NA>            <NA>\n#> 6                    <NA>            <NA>\n#>   ke_beskrivelse_250m2 andel_kartleggingsenhet_250m2\n#> 1                 <NA>                            NA\n#> 2                 <NA>                            NA\n#> 3                 <NA>                            NA\n#> 4                 <NA>                            NA\n#> 5                 <NA>                            NA\n#> 6                 <NA>                            NA\n#>   groeftingsintensitet bruksintensitet beitetrykk\n#> 1                   NA               1         NA\n#> 2                   NA               1          1\n#> 3                   NA               1          1\n#> 4                   NA               1          1\n#> 5                   NA               1          1\n#> 6                   NA               5          3\n#>   slatteintensitet tungekjoretoy slitasje forekomst_ntyp\n#> 1                1             0        0             ja\n#> 2                1            NA       NA             ja\n#> 3                1            NA       NA             ja\n#> 4                1            NA       NA             ja\n#> 5                1            NA       NA             ja\n#> 6                1            NA       NA             ja\n#>       ntyp\n#> 1 ntyp_E16\n#> 2 ntyp_D04\n#> 3 ntyp_D04\n#> 4 ntyp_D04\n#> 5 ntyp_D04\n#> 6 ntyp_D02\n#>                                                                                                 kommentar_naturtyperegistering\n#> 1                                                                                    I kant til tjern, 25-30% av sirkel er L1.\n#> 2 Tidligere kystlynghei som er i ferd med å gro igjen med furu. Sjekk flyfoto, grøft i området. Har trolig minimal påvirkning.\n#> 3                                                                                                                         <NA>\n#> 4                                                                                                                         <NA>\n#> 5                                                                                                                         <NA>\n#> 6                                                                                                                         <NA>\n#>   side_5_note krypende_vier_dekning\n#> 1        <NA>                     0\n#> 2        <NA>                    NA\n#> 3        <NA>                    NA\n#> 4        <NA>                    NA\n#> 5        <NA>                    NA\n#> 6        <NA>                    NA\n#>   ikke_krypende_vier_dekning vedplanter_total_dekning\n#> 1                          0                     40.0\n#> 2                         NA                      0.1\n#> 3                         NA                      0.0\n#> 4                         NA                      0.0\n#> 5                         NA                      0.0\n#> 6                         NA                      0.0\n#>   busker_dekning tresjikt_dekning treslag_registrert\n#> 1            2.0              6.0               <NA>\n#> 2            2.0              2.0               <NA>\n#> 3           50.0             15.0               <NA>\n#> 4            3.0             25.0               <NA>\n#> 5           25.0             15.0               <NA>\n#> 6            0.1              0.1               <NA>\n#>   roesslyng_dekning roesslyngblad pa_dekning pa_note\n#> 1                NA          <NA>         NA    <NA>\n#> 2               2.0          <NA>          0    <NA>\n#> 3               0.1          <NA>          0    <NA>\n#> 4              25.0          <NA>          0    <NA>\n#> 5               0.1          <NA>          0    <NA>\n#> 6                NA          <NA>          0    <NA>\n#>   pa_registrert fa_total_dekning fa_registrert\n#> 1          <NA>                0          <NA>\n#> 2          <NA>                0          <NA>\n#> 3          <NA>                0          <NA>\n#> 4          <NA>                0          <NA>\n#> 5          <NA>                0          <NA>\n#> 6          <NA>                0          <NA>\n#>                                                kommentar_250m2_flate\n#> 1                                                               <NA>\n#> 2                                                               <NA>\n#> 3                                                               <NA>\n#> 4 Vanskelig å vurdere busksjikt pga store tuer og høgvokst røsslyng.\n#> 5                                                               <NA>\n#> 6                                                               <NA>\n#>   klokkeslett_slutt\n#> 1             14:51\n#> 2             11:18\n#> 3             14:04\n#> 4             12:32\n#> 5             13:02\n#> 6             10:30\n#>                                                                                             vedlegg_url\n#> 1 https://nin-felles-test.miljodirektoratet.no/api/Overvaking/list/6a82cbaf-bd0f-40ee-9ecd-679d064da5d2\n#> 2 https://nin-felles-test.miljodirektoratet.no/api/Overvaking/list/f895016d-46e3-4dc4-81ac-22060d841c05\n#> 3 https://nin-felles-test.miljodirektoratet.no/api/Overvaking/list/b3a03d40-ea4e-4e4f-8fa0-a5fd96d44f37\n#> 4 https://nin-felles-test.miljodirektoratet.no/api/Overvaking/list/00c75c7d-70a0-40b7-a43d-1fb83a4108ee\n#> 5 https://nin-felles-test.miljodirektoratet.no/api/Overvaking/list/8213d53a-a0eb-47be-bce2-0a6d267f1f59\n#> 6 https://nin-felles-test.miljodirektoratet.no/api/Overvaking/list/85586a80-718c-464d-bd41-0c6681e36468\n#>                    creator        creationdate\n#> 1 liting_miljodirektoratet 2019-08-16 10:25:40\n#> 2 heisol_miljodirektoratet 2019-09-11 17:17:00\n#> 3 heisol_miljodirektoratet 2019-09-11 17:21:20\n#> 4 heisol_miljodirektoratet 2019-09-11 17:21:34\n#> 5 heisol_miljodirektoratet 2019-09-11 17:21:44\n#> 6 liting_miljodirektoratet 2019-09-20 10:42:59\n#>                     editor            editdate\n#> 1 liting_miljodirektoratet 2019-08-16 10:25:40\n#> 2 heisol_miljodirektoratet 2019-10-01 22:58:54\n#> 3 heisol_miljodirektoratet 2019-09-11 17:21:20\n#> 4 heisol_miljodirektoratet 2019-09-11 17:21:34\n#> 5 heisol_miljodirektoratet 2019-09-11 17:21:44\n#> 6 liting_miljodirektoratet 2019-09-20 10:42:59\n#>   hovedtype_rute    Light1    Light2    Moist1    Moist2\n#> 1            V10 0.5646634        NA        NA 0.9662055\n#> 2            T34        NA 0.9681051 0.7416001        NA\n#> 3            T34 0.8147081        NA 0.8747101        NA\n#> 4            T34 0.9664539        NA 0.7637899        NA\n#> 5            T34        NA 0.9519108 0.6681794        NA\n#> 6            T32        NA 0.9730420        NA 0.8621709\n#>         pH1      pH2 Nitrogen1 Nitrogen2 Phosphorus1\n#> 1 0.4752998       NA 0.2160317        NA   0.5081256\n#> 2        NA 0.917248 0.5298606        NA   0.7914040\n#> 3 0.6449013       NA 0.4651749        NA   0.7152068\n#> 4 0.7665267       NA 0.7902201        NA          NA\n#> 5 0.7342246       NA 0.7065666        NA          NA\n#> 6 0.5885764       NA 0.9478357        NA   0.5819242\n#>   Phosphorus2 Grazing_mowing1 Grazing_mowing2\n#> 1          NA              NA       0.8337301\n#> 2          NA              NA       0.9872861\n#> 3          NA       0.7389128              NA\n#> 4   0.5987296       0.7662447              NA\n#> 5   0.5803697       0.7840680              NA\n#> 6          NA       0.9163949              NA\n#>   Soil_disturbance1 Soil_disturbance2\n#> 1         0.4259328                NA\n#> 2         0.9026180                NA\n#> 3         0.6915287                NA\n#> 4                NA         0.8697387\n#> 5                NA         0.7501916\n#> 6         0.5614387                NA\nhead(results.seminat.ASO[['2-sided']])\n#>   ObjectID                             GlobalID\n#> 1        1 0b82a794-86fd-43ad-89e0-7739cffae471\n#> 2        2 6ba6acb6-b292-482f-bd0e-32b7f36fb3e4\n#> 3        3 3ad93d67-62ea-44d9-a058-41eac4cccc91\n#> 4        4 b584c506-46ab-46e5-b597-8bdc804b4b5c\n#> 5        5 c24c2a38-46bf-4efa-b4f4-ee1157d39793\n#> 6        6 fc0d85f6-f95c-404c-8ceb-d58707947a6e\n#>      Registeringsdato Klokkeslett start: Værforhold\n#> 1 2022-06-08 10:00:00              10:38     nedbør\n#> 2 2022-06-08 10:00:00              11:59    opphold\n#> 3 2022-06-08 10:00:00              15:27     nedbør\n#> 4 2022-06-08 10:00:00              15:31     nedbør\n#> 5 2022-06-09 10:00:00              11:00  overskyet\n#> 6 2022-06-09 10:00:00              09:33  overskyet\n#>   Omradenummer_flatenummer Eng_ID    ASO_ID Er enga T32?\n#> 1                  019_063      1 019_063_1          nei\n#> 2                  019_061      1 019_061_1           ja\n#> 3                  019_061      2 019_061_2          nei\n#> 4                  019_061      3 019_061_3          nei\n#> 5                  019_143      6 019_143_6           ja\n#> 6                  019_143      2 019_143_2           ja\n#>   NiN_grunntype Annen dominerende kartleggingsenhet\n#> 1          <NA>                                 T45\n#> 2       T32-C-4                                <NA>\n#> 3          <NA>                                 T45\n#> 4          <NA>                                  T4\n#> 5       T32-C-4                                <NA>\n#> 6       T32-C-4                                <NA>\n#>                                         Kommentarfelt...12\n#> 1 I gjengroing, mye fremmedarter. Canadagullris, hagelupin\n#> 2                                                     <NA>\n#> 3                        Deler rundt bygning er trolig T40\n#> 4                                                     <NA>\n#> 5                                                     <NA>\n#> 6                                                     <NA>\n#>   NiN-baserte variabler skal fylles ut for alle semi-naturlige enger per flate (500 x 500 meter)\n#> 1                                                                                             NA\n#> 2                                                                                             NA\n#> 3                                                                                             NA\n#> 4                                                                                             NA\n#> 5                                                                                             NA\n#> 6                                                                                             NA\n#>   Aktuell bruksintensitet (7JB-BA) Beitedyr (7JB-BD)\n#> 1                             <NA>              <NA>\n#> 2                         7JB-BA_1          7JB-BD_X\n#> 3                             <NA>              <NA>\n#> 4                             <NA>              <NA>\n#> 5                         7JB-BA_4         7JB-BD_ST\n#> 6                         7JB-BA_4         7JB-BD_ST\n#>   Beitetrykk\n#> 1       <NA>\n#> 2   7JB-BT_1\n#> 3       <NA>\n#> 4       <NA>\n#> 5   7JB-BT_4\n#> 6   7JB-BT_4\n#>   Eventuell utfyllende informasjon om beiteregime\n#> 1                                            <NA>\n#> 2                                            <NA>\n#> 3                                            <NA>\n#> 4                                            <NA>\n#> 5                                            <NA>\n#> 6                                            <NA>\n#>   Slatteintensitet\n#> 1             <NA>\n#> 2         7JB-SI_1\n#> 3             <NA>\n#> 4             <NA>\n#> 5         7JB-SI_1\n#> 6         7JB-SI_1\n#>   Eventuell utfyllende informasjon om slåtteregime (antall slåtter, slåttetidspunkt, utstyr, håndtering av avling, etterbeiting)\n#> 1                                                                                                                           <NA>\n#> 2                                                                                                                           <NA>\n#> 3                                                                                                                           <NA>\n#> 4                                                                                                                           <NA>\n#> 5                                                                                                                           <NA>\n#> 6                                                                                                                           <NA>\n#>   Høsting av tresjiktet - Stubbelauving (7JB-HT-SL)\n#> 1                                              <NA>\n#> 2                                       7JB-HT-SL_0\n#> 3                                              <NA>\n#> 4                                              <NA>\n#> 5                                       7JB-HT-SL_0\n#> 6                                       7JB-HT-SL_0\n#>   Høsting av tresjiktet - Lauving av styvingstrær (7JB-HT-ST)\n#> 1                                                        <NA>\n#> 2                                                 7JB-HT-ST_0\n#> 3                                                        <NA>\n#> 4                                                        <NA>\n#> 5                                                 7JB-HT-ST_0\n#> 6                                                 7JB-HT-ST_0\n#>   Totalantall gamle trær (4TG) tungekjoretoy   slitasje\n#> 1                         <NA>          <NA>       <NA>\n#> 2                      4TG-0_0    MDirPRTK_0 MDirPRSE_0\n#> 3                         <NA>          <NA>       <NA>\n#> 4                         <NA>          <NA>       <NA>\n#> 5                      4TG-0_0    MDirPRTK_0 MDirPRSE_2\n#> 6                      4TG-0_1    MDirPRTK_1 MDirPRSE_3\n#>   Tresjiktsdekning Busksjiktsdekning Dekning moser (%)\n#> 1             <NA>              <NA>                NA\n#> 2             A9_3              A7_2                60\n#> 3             <NA>              <NA>                NA\n#> 4             <NA>              <NA>                NA\n#> 5             A9_6              A7_0                50\n#> 6             A9_4              A7_0                70\n#>   Dominerende mose\n#> 1             <NA>\n#> 2     Engkransmose\n#> 3             <NA>\n#> 4             <NA>\n#> 5     Engkransmose\n#> 6     Engkransmose\n#>   Dekning av vedplanter under 0,8 m (i feltsjikt)\n#> 1                                            <NA>\n#> 2                                            A7_0\n#> 3                                            <NA>\n#> 4                                            <NA>\n#> 5                                            A7_0\n#> 6                                            A7_1\n#>   Dekninga av karplanter i feltsjikt\n#> 1                               <NA>\n#> 2                               A7_6\n#> 3                               <NA>\n#> 4                               <NA>\n#> 5                               A7_5\n#> 6                               A7_5\n#>   Kommentar til dekning av vedplanter i feltsjikt\n#> 1                                            <NA>\n#> 2                                            <NA>\n#> 3                                            <NA>\n#> 4                                            <NA>\n#> 5                                            <NA>\n#> 6                                            <NA>\n#>   Dekning strø Dekning lav\n#> 1         <NA>        <NA>\n#> 2         A7_5        A7_0\n#> 3         <NA>        <NA>\n#> 4         <NA>        <NA>\n#> 5         A7_2        A7_0\n#> 6         A7_3        A7_0\n#>   Dekning bar jord, sand, stein, grus\n#> 1                                <NA>\n#> 2                                A7_0\n#> 3                                <NA>\n#> 4                                <NA>\n#> 5                                A7_1\n#> 6                                A7_2\n#>   Kommenter her om det er informasjon du ikke har fått lagt inn andre steder\n#> 1                                                                       <NA>\n#> 2                                                                       <NA>\n#> 3                                                                       <NA>\n#> 4                                                                       <NA>\n#> 5                                                                       <NA>\n#> 6                                                                       <NA>\n#>   Registrer det du selv ser på som problemart\n#> 1                                          NA\n#> 2                                          NA\n#> 3                                          NA\n#> 4                                          NA\n#> 5                                          NA\n#> 6                                          NA\n#>   Total dekning (%) problemarter i enga Kommentarfelt...38\n#> 1                                    NA               <NA>\n#> 2                                    60               <NA>\n#> 3                                    NA               <NA>\n#> 4                                    NA               <NA>\n#> 5                                    NA               <NA>\n#> 6                                    NA               <NA>\n#>   Denne siden fylles ut for inntil tre enger per flate\n#> 1                                                   NA\n#> 2                                                   NA\n#> 3                                                   NA\n#> 4                                                   NA\n#> 5                                                   NA\n#> 6                                                   NA\n#>   Koordinat start øst Koordinat start nord\n#> 1                  NA                   NA\n#> 2              310262              6598017\n#> 3                  NA                   NA\n#> 4                  NA                   NA\n#> 5              311303              6596630\n#> 6              311271              6596538\n#>   Koordinat slutt øst Koordinat slutt nord\n#> 1                  NA                   NA\n#> 2              310230              6597971\n#> 3                  NA                   NA\n#> 4                  NA                   NA\n#> 5              311282              6596635\n#> 6              311243              6596538\n#>                      Kommentarfelt...44\n#> 1                                  <NA>\n#> 2                                  <NA>\n#> 3                                  <NA>\n#> 4                                  <NA>\n#> 5 Knekkpunkt. Øst: 311289,nord: 6596641\n#> 6                                  <NA>\n#>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          veg_html_rows\n#> 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 <NA>\n#> 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  <tr><td>Bringebær (Rubus idaeus)<\/td><td>50 - 75 % dekning<\/td><td>3/8 - 4/5<\/td><\/tr><tr><td>Skogburkne (Athyrium filix-femina)<\/td><td>1 - 6,25 % dekning<\/td><td>1/32 - 1/8<\/td><\/tr><tr><td>Skogsnelle (Equisetum sylvaticum)<\/td><td>25-50 % dekning<\/td><td>> 4/5<\/td><\/tr><tr><td>Engrapp (Poa pratensis pratensis)<\/td><td>12,5 - 25 % dekning<\/td><td>> 4/5<\/td><\/tr><tr><td>Hvitveis (Anemone nemorosa)<\/td><td>12,5 - 25 % dekning<\/td><td>3/8 - 4/5<\/td><\/tr><tr><td>Krypsoleie (Ranunculus repens)<\/td><td>6,25 - 12,5 % dekning<\/td><td>1/8 - 3/8<\/td><\/tr><tr><td>Englodnegras (Holcus lanatus)<\/td><td><\/td><td><\/td><\/tr><tr><td>Åkertistel (Cirsium arvense)<\/td><td>12,5 - 25 % dekning<\/td><td>3/8 - 4/5<\/td><\/tr><tr><td>Stormaure (Galium album)<\/td><td>25-50 % dekning<\/td><td>> 4/5<\/td><\/tr><tr><td>Sløke (Angelica sylvestris)<\/td><td>12,5 - 25 % dekning<\/td><td>1/8 - 3/8<\/td><\/tr><tr><td>Sølvbunke (Deschampsia cespitosa cespitosa)<\/td><td>6,25 - 12,5 % dekning<\/td><td>1/8 - 3/8<\/td><\/tr><tr><td>Tepperot (Potentilla erecta)<\/td><td>1 - 6,25 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Prestekrage (Leucanthemum vulgare)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Nyseryllik (Achillea ptarmica)<\/td><td>6,25 - 12,5 % dekning<\/td><td>1/8 - 3/8<\/td><\/tr><tr><td>Stornesle (Urtica dioica)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Tveskjeggveronika (Veronica chamaedrys)<\/td><td>6,25 - 12,5 % dekning<\/td><td>3/8 - 4/5<\/td><\/tr><tr><td>Gjerdevikke (Vicia sepium)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Krattmjølke (Epilobium montanum)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Enghumleblom (Geum rivale)<\/td><td>6,25 - 12,5 % dekning<\/td><td>1/32 - 1/8<\/td><\/tr><tr><td>Engsyre (Rumex acetosa)<\/td><td>1 - 6,25 % dekning<\/td><td>1/8 - 3/8<\/td><\/tr><tr><td>Marikåper (Alchemilla sp.)<\/td><td>< 1 % dekning<\/td><td>1/32 - 1/8<\/td><\/tr><tr><td>Grasstjerneblom (Stellaria graminea)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Gulflatbelg (Lathyrus pratensis)<\/td><td>1 - 6,25 % dekning<\/td><td>1/32 - 1/8<\/td><\/tr><tr><td>Gulaks (Anthoxanthum odoratum)<\/td><td>1 - 6,25 % dekning<\/td><td>1/32 - 1/8<\/td><\/tr><tr><td>Ryllik (Achillea millefolium)<\/td><td>6,25 - 12,5 % dekning<\/td><td>1/8 - 3/8<\/td><\/tr><tr><td>Lintorskemunn (Linaria vulgaris)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Markjordbær (Fragaria vesca)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Hundegras (Dactylis glomerata)<\/td><td>1 - 6,25 % dekning<\/td><td>1/32 - 1/8<\/td><\/tr><tr><td>Engkvein (Agrostis capillaris)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Rødsvingel (Festuca rubra)<\/td><td>1 - 6,25 % dekning<\/td><td>1/32 - 1/8<\/td><\/tr><tr><td>Fuglevikke (Vicia cracca)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Hundekjeks (Anthriscus sylvestris)<\/td><td>1 - 6,25 % dekning<\/td><td>1/32 - 1/8<\/td><\/tr><tr><td>Firkantperikum (Hypericum maculatum)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Mjødurt (Filipendula ulmaria)<\/td><td>12,5 - 25 % dekning<\/td><td>1/8 - 3/8<\/td><\/tr><tr><td>Gullris (Solidago virgaurea)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Nyresoleier (Ranunculus auricomus agg.)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Aurikkelsveve (Pilosella lactucella)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Veitistel (Cirsium vulgare)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Gråor (Alnus incana)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Engsoleie (Ranunculus acris acris)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Bleikstarr (Carex pallescens)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr>\n#> 3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 <NA>\n#> 4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 <NA>\n#> 5 <tr><td>Engrapp (Poa pratensis pratensis)<\/td><td>12,5 - 25 % dekning<\/td><td>3/8 - 4/5<\/td><\/tr><tr><td>Hvitveis (Anemone nemorosa)<\/td><td>12,5 - 25 % dekning<\/td><td>> 4/5<\/td><\/tr><tr><td>Engsyre (Rumex acetosa)<\/td><td>1 - 6,25 % dekning<\/td><td>1/8 - 3/8<\/td><\/tr><tr><td>Løvetannslekta (Taraxacum sp.)<\/td><td>12,5 - 25 % dekning<\/td><td>> 4/5<\/td><\/tr><tr><td>Småsyre (Rumex acetosella)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Engkvein (Agrostis capillaris)<\/td><td>6,25 - 12,5 % dekning<\/td><td>3/8 - 4/5<\/td><\/tr><tr><td>Ryllik (Achillea millefolium)<\/td><td>6,25 - 12,5 % dekning<\/td><td>1/8 - 3/8<\/td><\/tr><tr><td>Hvitkløver (Trifolium repens)<\/td><td>6,25 - 12,5 % dekning<\/td><td>1/8 - 3/8<\/td><\/tr><tr><td>Snauveronika (Veronica serpyllifolia serpyllifolia)<\/td><td>6,25 - 12,5 % dekning<\/td><td>1/8 - 3/8<\/td><\/tr><tr><td>Arve (Cerastium fontanum)<\/td><td>6,25 - 12,5 % dekning<\/td><td>3/8 - 4/5<\/td><\/tr><tr><td>Tiriltunge (Lotus corniculatus)<\/td><td>1 - 6,25 % dekning<\/td><td>1/8 - 3/8<\/td><\/tr><tr><td>Rogn (Sorbus aucuparia)<\/td><td>< 1 % dekning<\/td><td>1/32 - 1/8<\/td><\/tr><tr><td>Osp (Populus tremula)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Groblad (Plantago major)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Nyresoleier (Ranunculus auricomus agg.)<\/td><td>6,25 - 12,5 % dekning<\/td><td>3/8 - 4/5<\/td><\/tr><tr><td>Vårerteknapp (Lathyrus vernus)<\/td><td>6,25 - 12,5 % dekning<\/td><td>1/8 - 3/8<\/td><\/tr><tr><td>Nyseryllik (Achillea ptarmica)<\/td><td>1 - 6,25 % dekning<\/td><td>1/32 - 1/8<\/td><\/tr><tr><td>Vårrublom (Draba verna)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Engfrytle (Luzula multiflora multiflora)<\/td><td>6,25 - 12,5 % dekning<\/td><td>1/8 - 3/8<\/td><\/tr><tr><td>Blåklokke (Campanula rotundifolia)<\/td><td>1 - 6,25 % dekning<\/td><td>1/32 - 1/8<\/td><\/tr><tr><td>Tepperot (Potentilla erecta)<\/td><td>1 - 6,25 % dekning<\/td><td>1/32 - 1/8<\/td><\/tr><tr><td>Beitesveve-gruppa (Vulgata)<\/td><td>1 - 6,25 % dekning<\/td><td>1/32 - 1/8<\/td><\/tr><tr><td>Bleikstarr (Carex pallescens)<\/td><td>< 1 % dekning<\/td><td>1/32 - 1/8<\/td><\/tr><tr><td>Timotei (Phleum pratense)<\/td><td>1 - 6,25 % dekning<\/td><td>1/32 - 1/8<\/td><\/tr><tr><td>Tveskjeggveronika (Veronica chamaedrys)<\/td><td>1 - 6,25 % dekning<\/td><td>1/8 - 3/8<\/td><\/tr><tr><td>Sølvbunke (Deschampsia cespitosa cespitosa)<\/td><td>1 - 6,25 % dekning<\/td><td>1/32 - 1/8<\/td><\/tr><tr><td>Sauesvingel (Festuca ovina)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Harestarr (Carex leporina)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Gullris (Solidago virgaurea)<\/td><td>1 - 6,25 % dekning<\/td><td>1/8 - 3/8<\/td><\/tr><tr><td>Grasstjerneblom (Stellaria graminea)<\/td><td>6,25 - 12,5 % dekning<\/td><td>3/8 - 4/5<\/td><\/tr><tr><td>Firkantperikum (Hypericum maculatum)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Prestekrage (Leucanthemum vulgare)<\/td><td>< 1 % dekning<\/td><td>1/32 - 1/8<\/td><\/tr><tr><td>Skjermsveve (Hieracium umbellatum)<\/td><td>1 - 6,25 % dekning<\/td><td>1/32 - 1/8<\/td><\/tr><tr><td>Gulaks (Anthoxanthum odoratum)<\/td><td>1 - 6,25 % dekning<\/td><td>1/8 - 3/8<\/td><\/tr><tr><td>Tiriltunge (Lotus corniculatus)<\/td><td>1 - 6,25 % dekning<\/td><td>1/32 - 1/8<\/td><\/tr><tr><td>Hengebjørk (Betula pendula)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Smyle (Avenella flexuosa)<\/td><td>< 1 % dekning<\/td><td>1/32 - 1/8<\/td><\/tr><tr><td>Maiblom (Maianthemum bifolium)<\/td><td>1 - 6,25 % dekning<\/td><td>1/32 - 1/8<\/td><\/tr><tr><td>Legeveronika (Veronica officinalis)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Marikåper (Alchemilla sp.)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Blåbær (Vaccinium myrtillus)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Firblad (Paris quadrifolia)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Storarve (Cerastium arvense)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Hundekjeks (Anthriscus sylvestris)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Engsoleie (Ranunculus acris acris)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Jonsokkoll (Ajuga pyramidalis)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr>\n#> 6                                                                                                                                                                                                                                                                                                                                                                                                                                <tr><td>Nyresildre (Saxifraga granulata)<\/td><td>12,5 - 25 % dekning<\/td><td>3/8 - 4/5<\/td><\/tr><tr><td>Løvetannslekta (Taraxacum sp.)<\/td><td>1 - 6,25 % dekning<\/td><td>1/8 - 3/8<\/td><\/tr><tr><td>Hvitveis (Anemone nemorosa)<\/td><td>12,5 - 25 % dekning<\/td><td>3/8 - 4/5<\/td><\/tr><tr><td>Marikåper (Alchemilla sp.)<\/td><td>6,25 - 12,5 % dekning<\/td><td>1/8 - 3/8<\/td><\/tr><tr><td>Gulaks (Anthoxanthum odoratum)<\/td><td>25-50 % dekning<\/td><td>> 4/5<\/td><\/tr><tr><td>Sølvbunke (Deschampsia cespitosa cespitosa)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Hundegras (Dactylis glomerata)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Arve (Cerastium fontanum)<\/td><td>1 - 6,25 % dekning<\/td><td>3/8 - 4/5<\/td><\/tr><tr><td>Ryllik (Achillea millefolium)<\/td><td>6,25 - 12,5 % dekning<\/td><td>3/8 - 4/5<\/td><\/tr><tr><td>Bleikstarr (Carex pallescens)<\/td><td>6,25 - 12,5 % dekning<\/td><td>1/8 - 3/8<\/td><\/tr><tr><td>Nyresoleier (Ranunculus auricomus agg.)<\/td><td>1 - 6,25 % dekning<\/td><td>1/8 - 3/8<\/td><\/tr><tr><td>Nyseryllik (Achillea ptarmica)<\/td><td>1 - 6,25 % dekning<\/td><td>1/8 - 3/8<\/td><\/tr><tr><td>Grasstjerneblom (Stellaria graminea)<\/td><td>1 - 6,25 % dekning<\/td><td>3/8 - 4/5<\/td><\/tr><tr><td>Engrapp (Poa pratensis pratensis)<\/td><td>1 - 6,25 % dekning<\/td><td>1/8 - 3/8<\/td><\/tr><tr><td>Tveskjeggveronika (Veronica chamaedrys)<\/td><td>1 - 6,25 % dekning<\/td><td>1/32 - 1/8<\/td><\/tr><tr><td>Hvitkløver (Trifolium repens)<\/td><td>12,5 - 25 % dekning<\/td><td>3/8 - 4/5<\/td><\/tr><tr><td>Engfrytle (Luzula multiflora multiflora)<\/td><td>6,25 - 12,5 % dekning<\/td><td>> 4/5<\/td><\/tr><tr><td>Osp (Populus tremula)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Engkvein (Agrostis capillaris)<\/td><td>1 - 6,25 % dekning<\/td><td>1/32 - 1/8<\/td><\/tr><tr><td>Engsyre (Rumex acetosa)<\/td><td>12,5 - 25 % dekning<\/td><td>> 4/5<\/td><\/tr><tr><td>Sauesvingel (Festuca ovina)<\/td><td>1 - 6,25 % dekning<\/td><td>1/32 - 1/8<\/td><\/tr><tr><td>Blåklokke (Campanula rotundifolia)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Snauveronika (Veronica serpyllifolia serpyllifolia)<\/td><td>1 - 6,25 % dekning<\/td><td>1/32 - 1/8<\/td><\/tr><tr><td>Tepperot (Potentilla erecta)<\/td><td>6,25 - 12,5 % dekning<\/td><td>1/8 - 3/8<\/td><\/tr><tr><td>Harestarr (Carex leporina)<\/td><td>1 - 6,25 % dekning<\/td><td>1/8 - 3/8<\/td><\/tr><tr><td>Engsoleie (Ranunculus acris acris)<\/td><td>6,25 - 12,5 % dekning<\/td><td>1/8 - 3/8<\/td><\/tr><tr><td>Vårerteknapp (Lathyrus vernus)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Skogsnelle (Equisetum sylvaticum)<\/td><td>6,25 - 12,5 % dekning<\/td><td>1/8 - 3/8<\/td><\/tr><tr><td>Åkerforglemmegei (Myosotis arvensis)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Rødkløver (Trifolium pratense)<\/td><td>1 - 6,25 % dekning<\/td><td>1/32 - 1/8<\/td><\/tr><tr><td>Aurikkelsveve (Pilosella lactucella)<\/td><td>6,25 - 12,5 % dekning<\/td><td>3/8 - 4/5<\/td><\/tr><tr><td>Slåttestarr (Carex nigra nigra)<\/td><td>< 1 % dekning<\/td><td>1/32 - 1/8<\/td><\/tr><tr><td>Jonsokkoll (Ajuga pyramidalis)<\/td><td>< 1 % dekning<\/td><td>1/32 - 1/8<\/td><\/tr><tr><td>Skjermsveve (Hieracium umbellatum)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Trådsiv (Juncus filiformis)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Åkersnelle (Equisetum arvense)<\/td><td>1 - 6,25 % dekning<\/td><td>1/32 - 1/8<\/td><\/tr><tr><td>Fuglevikke (Vicia cracca)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Timotei (Phleum pratense)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Mjødurt (Filipendula ulmaria)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Bjørk (Betula pubescens)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr><tr><td>Myrtistel (Cirsium palustre)<\/td><td>< 1 % dekning<\/td><td>1/32<\/td><\/tr>\n#>   Arter registert\n#> 1              NA\n#> 2              NA\n#> 3              NA\n#> 4              NA\n#> 5              NA\n#> 6              NA\n#>                                                                                                                                                                 Kommentarfelt...47\n#> 1                                                                                                                                                                             <NA>\n#> 2                                                                                                                                                                             <NA>\n#> 3                                                                                                                                                                             <NA>\n#> 4                                                                                                                                                                             <NA>\n#> 5 I tillegg fant vi en sveve et sted som vi ikke klarte å bestemme. Den var kun i knopp.\\r\\nEt sted sto det også en kløver som kan være skogkløver. Den var uten blomster.\\r\\n\\r\\n\n#> 6                                                                                                                                                                             <NA>\n#>   Bilder som beskriver enga i landskapskontekst, engas struktur, spesielle arter (både sjeldne, typiske og problematiske) samt engas struktur og særpreg.\n#> 1                                                                                                                                                      NA\n#> 2                                                                                                                                                      NA\n#> 3                                                                                                                                                      NA\n#> 4                                                                                                                                                      NA\n#> 5                                                                                                                                                      NA\n#> 6                                                                                                                                                      NA\n#>          CreationDate                  Creator\n#> 1 2022-06-08 12:58:38 dagoye_miljodirektoratet\n#> 2 2022-06-08 12:58:43 dagoye_miljodirektoratet\n#> 3 2022-06-10 20:22:27 dagoye_miljodirektoratet\n#> 4 2022-06-10 20:22:32 dagoye_miljodirektoratet\n#> 5 2022-06-10 20:22:38 dagoye_miljodirektoratet\n#> 6 2022-06-10 20:22:43 dagoye_miljodirektoratet\n#>              EditDate                   Editor    Light1\n#> 1 2022-06-08 12:58:38 dagoye_miljodirektoratet        NA\n#> 2 2022-06-20 11:17:48 dagoye_miljodirektoratet 0.5938649\n#> 3 2022-06-10 20:22:27 dagoye_miljodirektoratet        NA\n#> 4 2022-06-10 20:22:32 dagoye_miljodirektoratet        NA\n#> 5 2022-06-20 11:14:30 dagoye_miljodirektoratet 0.6160343\n#> 6 2022-06-20 09:58:37 dagoye_miljodirektoratet 0.9584039\n#>   Light2    Moist1    Moist2      pH1       pH2 Nitrogen1\n#> 1     NA        NA        NA       NA        NA        NA\n#> 2     NA        NA 0.6842561 0.614915        NA        NA\n#> 3     NA        NA        NA       NA        NA        NA\n#> 4     NA        NA        NA       NA        NA        NA\n#> 5     NA 0.8542713        NA       NA 0.7210950        NA\n#> 6     NA 0.9313055        NA       NA 0.8447671        NA\n#>   Nitrogen2 Phosphorus1 Phosphorus2 Grazing_mowing1\n#> 1        NA          NA          NA              NA\n#> 2 0.4982404          NA   0.5799781       0.3793599\n#> 3        NA          NA          NA              NA\n#> 4        NA          NA          NA              NA\n#> 5 0.6853648          NA   0.8407701              NA\n#> 6 0.7395137    0.772325          NA              NA\n#>   Grazing_mowing2 Soil_disturbance1 Soil_disturbance2\n#> 1              NA                NA                NA\n#> 2              NA         0.5500822                NA\n#> 3              NA                NA                NA\n#> 4              NA                NA                NA\n#> 5       0.9411774         0.6740756                NA\n#> 6       0.6199815         0.8681759                NA"},{"path":"Functional-plant-indicators-seminat.html","id":"scaled-value-analyses-1","chapter":"7 Functional Plant Indicators - Semi-Natural Ecosystems","heading":"7.7.1.2 Scaled value analyses","text":"order visualize results need rearrange results-objects wide long format (note lower upper condition indicator functional plant indicators).","code":"\n#### plotting scaled values by main ecosystem type ####\n## continuing with 2-sided\nres.seminat.ANO <- results.seminat.ANO[['2-sided']]\n\n# make long version of the scaled value part\nres.seminat.ANO <-\n  res.seminat.ANO %>% \n  pivot_longer(\n    cols = c(\"Light1\",\"Light2\",\n             \"Moist1\",\"Moist2\",\n             \"pH1\",\"pH2\",\n             \"Nitrogen1\",\"Nitrogen2\",\n             \"Phosphorus1\",\"Phosphorus2\",\n             \"Grazing_mowing1\",\"Grazing_mowing2\",\n             \"Soil_disturbance1\",\"Soil_disturbance2\"),\n    names_to = \"fp_ind\",\n    values_to = \"scaled_value\",\n    values_drop_na = FALSE\n  )\n\n# add original values as well\nres.seminat.ANO <- \n  res.seminat.ANO %>% add_column(original = results.seminat.ANO[['original']] %>% \n                               pivot_longer(\n                                 cols = c(\"Light1\",\"Light2\",\n                                          \"Moist1\",\"Moist2\",\n                                          \"pH1\",\"pH2\",\n                                          \"Nitrogen1\",\"Nitrogen2\",\n                                          \"Phosphorus1\",\"Phosphorus2\",\n                                          \"Grazing_mowing1\",\"Grazing_mowing2\",\n                                          \"Soil_disturbance1\",\"Soil_disturbance2\"),\n                                 names_to = NULL,\n                                 values_to = \"original\",\n                                 values_drop_na = FALSE\n                               ) %>%\n                               pull(original)\n  )\n\n# similarly for ASO\nres.seminat.ASO <- results.seminat.ASO[['2-sided']]\n#colnames(res.seminat.ASO)\n\n# make long version of the scaled value part\nres.seminat.ASO <-\n  res.seminat.ASO %>% \n  pivot_longer(\n    cols = c(\"Light1\",\"Light2\",\n             \"Moist1\",\"Moist2\",\n             \"pH1\",\"pH2\",\n             \"Nitrogen1\",\"Nitrogen2\",\n             \"Phosphorus1\",\"Phosphorus2\",\n             \"Grazing_mowing1\",\"Grazing_mowing2\",\n             \"Soil_disturbance1\",\"Soil_disturbance2\"),\n    names_to = \"fp_ind\",\n    values_to = \"scaled_value\",\n    values_drop_na = FALSE\n  )\n\n# add original values as well\nres.seminat.ASO <- \n  res.seminat.ASO %>% add_column(original = results.seminat.ASO[['original']] %>% \n                                   pivot_longer(\n                                     cols = c(\"Light1\",\"Light2\",\n                                              \"Moist1\",\"Moist2\",\n                                              \"pH1\",\"pH2\",\n                                              \"Nitrogen1\",\"Nitrogen2\",\n                                              \"Phosphorus1\",\"Phosphorus2\",\n                                              \"Grazing_mowing1\",\"Grazing_mowing2\",\n                                              \"Soil_disturbance1\",\"Soil_disturbance2\"),\n                                     names_to = NULL,\n                                     values_to = \"original\",\n                                     values_drop_na = FALSE\n                                   ) %>%\n                                   pull(original)\n  )"},{"path":"Functional-plant-indicators-seminat.html","id":"ecosystem-sub-types-1","chapter":"7 Functional Plant Indicators - Semi-Natural Ecosystems","heading":"7.7.2 Ecosystem sub-types","text":"can show resulting scaled values Violin plots indicator main ecosystem type\n\nANO results show especially T32s (semi-natural meadows) reduced light, grazing_mowing, soil_disturbance values, indicates abandonment. addition, results indicate acidic conditions plant communities. ASO results show similar outcomes respect abandonment acidity, addition also deviations towards high nitrogen values.","code":""},{"path":"Functional-plant-indicators-seminat.html","id":"indicator-index-maps-1","chapter":"7 Functional Plant Indicators - Semi-Natural Ecosystems","heading":"7.7.3 Indicator index maps","text":"can also show results map, instance Grazing_mowing1 (lower Grazing_mowing indicator), either directly plotting data onto map…\n…colors values data points map hard make .","code":"#> Reading layer `outlineOfNorway_EPSG25833' from data source \n#>   `/data/Egenutvikling/41001581_egenutvikling_anders_kolstad/github/ecosystemCondition/data/outlineOfNorway_EPSG25833.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 1 feature and 2 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -113472.7 ymin: 6448359 xmax: 1114618 ymax: 7939917\n#> Projected CRS: ETRS89 / UTM zone 33N\n#> Reading layer `regions' from data source \n#>   `/data/Egenutvikling/41001581_egenutvikling_anders_kolstad/github/ecosystemCondition/data/regions.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 5 features and 2 fields\n#> Geometry type: POLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -99551.21 ymin: 6426048 xmax: 1121941 ymax: 7962744\n#> Projected CRS: ETRS89 / UTM zone 33N"},{"path":"Functional-plant-indicators-seminat.html","id":"regions---maps-and-statistics-1","chapter":"7 Functional Plant Indicators - Semi-Natural Ecosystems","heading":"7.7.4 Regions - maps and statistics","text":"Alternatively can calculate show region-wise means related standard errors. note calculating simple mean inappropriate data. :\n() scaled data bound 0 1, thus follow beta-distribution rather Gaussian one\n(ii) ANO ASO datasets nested structureTherefore, need () use beta-model, (ii) can account nested structure data.\n, apply following function using either glmmTMB null-model beta-distribution, logit link, nesting random intercept, simple betareg null-model logit link nesting extensive enough mixed model.corresponding maps upper Nitrogen indicator ASO data:","code":"\nlibrary(betareg)\nlibrary(glmmTMB)\n\nexpit <- function(L) exp(L) / (1+exp(L)) # since the beta-models use a logit link, we need to calculate the estimates back to the identity scale\n\n# the function performs a glmmTMB if there's >= 5 random levels in the nesting structure\n# if that is not the case, then the function performs a betareg if theres >= 2 observations\n# if that is not the case either, then the function returns the value of the single observation with NA standard error\n\nindmean.beta <- function(df) {\n\n  st_geometry(df) <- NULL\n  colnames(df) <- c(\"y\",\"ran\")\n  \n  if ( nrow(df[!is.na(df[,1]),]) >= 2 ) {\n    \n    if ( length(unique(df[!is.na(df[,1]),2])) >=5 ) {\n      \n      mod1 <- glmmTMB(y ~ 1 +(1|ran), family=beta_family(), data=df)\n      \n      return(c(\n        expit(summary( mod1 )$coefficients$cond[1]),\n        \n        expit( summary( mod1 )$coefficients$cond[1] + \n                 summary( mod1 )$coefficients$cond[2] )-\n          expit( summary( mod1 )$coefficients$cond[1] ),\n        \n        nrow(df[!is.na(df$y),]),\n        summary( mod1 )$coefficients$cond[1],\n        summary( mod1 )$coefficients$cond[2]\n      ))\n      \n    } else {\n      \n      mod2 <- betareg(y ~ 1, data=df)\n      \n      return(c(\n        expit(summary( mod2 )$coefficients$mean[1]),\n        expit( summary( mod2 )$coefficients$mean[1] + \n                 summary( mod2 )$coefficients$mean[2] )-\n          expit( summary( mod2 )$coefficients$mean[1] ),\n        nrow(df[!is.na(df$y),]),\n        summary( mod2 )$coefficients$mean[1],\n        summary( mod2 )$coefficients$mean[2]\n      ))\n      \n    }\n    \n  } else {\n    \n    return(c(df$y,NA,1,NA,NA))\n    \n  }\n\n}\n\nres.seminat.ANO2 = st_join(res.seminat.ANO2, regnor, left = TRUE)\nres.seminat.ASO2 = st_join(res.seminat.ASO2, regnor, left = TRUE)\n\nregnor <- regnor %>%\n  mutate(\n    Grazing_mowing1.ANO.reg.mean = c(indmean.beta(df=res.seminat.ANO2[res.seminat.ANO2$region==\"Northern Norway\",c(\"Grazing_mowing1\",\"ano_flate_id\")])[1],\n                                 indmean.beta(df=res.seminat.ANO2[res.seminat.ANO2$region==\"Central Norway\",c(\"Grazing_mowing1\",\"ano_flate_id\")])[1],\n                                 indmean.beta(df=res.seminat.ANO2[res.seminat.ANO2$region==\"Eastern Norway\",c(\"Grazing_mowing1\",\"ano_flate_id\")])[1],\n                                 indmean.beta(df=res.seminat.ANO2[res.seminat.ANO2$region==\"Western Norway\",c(\"Grazing_mowing1\",\"ano_flate_id\")])[1],\n                                 indmean.beta(df=res.seminat.ANO2[res.seminat.ANO2$region==\"Southern Norway\",c(\"Grazing_mowing1\",\"ano_flate_id\")])[1]\n                                 ),\n    Grazing_mowing1.ANO.reg.se = c(indmean.beta(df=res.seminat.ANO2[res.seminat.ANO2$region==\"Northern Norway\",c(\"Grazing_mowing1\",\"ano_flate_id\")])[2],\n                               indmean.beta(df=res.seminat.ANO2[res.seminat.ANO2$region==\"Central Norway\",c(\"Grazing_mowing1\",\"ano_flate_id\")])[2],\n                               indmean.beta(df=res.seminat.ANO2[res.seminat.ANO2$region==\"Eastern Norway\",c(\"Grazing_mowing1\",\"ano_flate_id\")])[2],\n                               indmean.beta(df=res.seminat.ANO2[res.seminat.ANO2$region==\"Western Norway\",c(\"Grazing_mowing1\",\"ano_flate_id\")])[2],\n                               indmean.beta(df=res.seminat.ANO2[res.seminat.ANO2$region==\"Southern Norway\",c(\"Grazing_mowing1\",\"ano_flate_id\")])[2]\n                               ),\n    Grazing_mowing1.ANO.reg.n = c(nrow(res.seminat.ANO2[res.seminat.ANO2$region==\"Northern Norway\" & !is.na(res.seminat.ANO2$Grazing_mowing1),]),\n                              nrow(res.seminat.ANO2[res.seminat.ANO2$region==\"Central Norway\" & !is.na(res.seminat.ANO2$Grazing_mowing1),]),\n                              nrow(res.seminat.ANO2[res.seminat.ANO2$region==\"Eastern Norway\" & !is.na(res.seminat.ANO2$Grazing_mowing1),]),\n                              nrow(res.seminat.ANO2[res.seminat.ANO2$region==\"Western Norway\" & !is.na(res.seminat.ANO2$Grazing_mowing1),]),\n                              nrow(res.seminat.ANO2[res.seminat.ANO2$region==\"Southern Norway\" & !is.na(res.seminat.ANO2$Grazing_mowing1),])\n                              )\n  )\n\n# and adding the values for ASO\nregnor <- regnor %>%\n  mutate(\n    Nitrogen2.ASO.reg.mean = c(indmean.beta(df=res.seminat.ASO2[res.seminat.ASO2$region==\"Northern Norway\",c(\"Nitrogen2\",\"Omradenummer_flatenummer\")])[1],\n                               indmean.beta(df=res.seminat.ASO2[res.seminat.ASO2$region==\"Central Norway\",c(\"Nitrogen2\",\"Omradenummer_flatenummer\")])[1],\n                               indmean.beta(df=res.seminat.ASO2[res.seminat.ASO2$region==\"Eastern Norway\",c(\"Nitrogen2\",\"Omradenummer_flatenummer\")])[1],\n                               indmean.beta(df=res.seminat.ASO2[res.seminat.ASO2$region==\"Western Norway\",c(\"Nitrogen2\",\"Omradenummer_flatenummer\")])[1],\n                               indmean.beta(df=res.seminat.ASO2[res.seminat.ASO2$region==\"Southern Norway\",c(\"Nitrogen2\",\"Omradenummer_flatenummer\")])[1]\n                               ),\n    Nitrogen2.ASO.reg.se = c(indmean.beta(df=res.seminat.ASO2[res.seminat.ASO2$region==\"Northern Norway\",c(\"Nitrogen2\",\"Omradenummer_flatenummer\")])[2],\n                             indmean.beta(df=res.seminat.ASO2[res.seminat.ASO2$region==\"Central Norway\",c(\"Nitrogen2\",\"Omradenummer_flatenummer\")])[2],\n                             indmean.beta(df=res.seminat.ASO2[res.seminat.ASO2$region==\"Eastern Norway\",c(\"Nitrogen2\",\"Omradenummer_flatenummer\")])[2],\n                             indmean.beta(df=res.seminat.ASO2[res.seminat.ASO2$region==\"Western Norway\",c(\"Nitrogen2\",\"Omradenummer_flatenummer\")])[2],\n                             indmean.beta(df=res.seminat.ASO2[res.seminat.ASO2$region==\"Southern Norway\",c(\"Nitrogen2\",\"Omradenummer_flatenummer\")])[2]\n                             ),\n    Nitrogen2.ASO.reg.n = c(nrow(res.seminat.ASO2[res.seminat.ASO2$region==\"Northern Norway\" & !is.na(res.seminat.ASO2$Nitrogen2),]),\n                            nrow(res.seminat.ASO2[res.seminat.ASO2$region==\"Central Norway\" & !is.na(res.seminat.ASO2$Nitrogen2),]),\n                            nrow(res.seminat.ASO2[res.seminat.ASO2$region==\"Eastern Norway\" & !is.na(res.seminat.ASO2$Nitrogen2),]),\n                            nrow(res.seminat.ASO2[res.seminat.ASO2$region==\"Western Norway\" & !is.na(res.seminat.ASO2$Nitrogen2),]),\n                            nrow(res.seminat.ASO2[res.seminat.ASO2$region==\"Southern Norway\" & !is.na(res.seminat.ASO2$Nitrogen2),]))\n  )\n\n\n\n## scaled value maps for Grazing_mowing1 (lower indicator), ANO\n# mean\ntm_shape(regnor) +\n  tm_polygons(col=\"Grazing_mowing1.ANO.reg.mean\", title=\"Grazing_mowing (lower), mean\", style=\"quantile\", palette=rev(get_brewer_pal(palette=\"OrRd\", n=5, plot=FALSE))) +\n  tm_text(\"Grazing_mowing1.ANO.reg.n\",col=\"black\",bg.color=\"grey\")\n# se\ntm_shape(regnor) +\n  tm_polygons(col=\"Grazing_mowing1.ANO.reg.se\", title=\"Grazing_mowing (lower), SE\", style=\"quantile\", palette=get_brewer_pal(palette=\"OrRd\", n=5, plot=FALSE)) +\n  tm_text(\"Grazing_mowing1.ANO.reg.n\",col=\"black\",bg.color=\"grey\")\n## scaled value maps for Nitrogen2 (upper indicator), ASO\n# mean\ntm_shape(regnor) +\n  tm_polygons(col=\"Nitrogen2.ASO.reg.mean\", title=\"Nitrogen (upper), mean\", style=\"quantile\", palette=rev(get_brewer_pal(palette=\"OrRd\", n=5, plot=FALSE))) +\n  tm_text(\"Nitrogen2.ASO.reg.n\",col=\"black\",bg.color=\"grey\")\n# se\ntm_shape(regnor) +\n  tm_polygons(col=\"Nitrogen2.ASO.reg.se\", title=\"Nitrogen (upper), SE\", style=\"quantile\", palette=get_brewer_pal(palette=\"OrRd\", n=5, plot=FALSE)) +\n  tm_text(\"Nitrogen2.ASO.reg.n\",col=\"black\",bg.color=\"grey\")"},{"path":"Functional-plant-indicators-seminat.html","id":"unscaled-values-vs.-reference-1","chapter":"7 Functional Plant Indicators - Semi-Natural Ecosystems","heading":"7.7.4.1 Unscaled values vs. reference","text":"can also compare unscaled values reference distribution order identify ecosystem types functional plant indicators showing deviation expectation. Since Grazing_mowing ANO nitrogen ASO show deviations exemplify indicators unscaled values.Grazing_mowing, ANO:Nitrogen, ASO","code":"\n#summary(res.seminat$kartleggingsenhet_1m2)\n#length(unique(res.seminat$kartleggingsenhet_1m2))\n# 19 NiN-types, of which T41-C-1 has 0 observations, and T32 & T34 as main types don't have a reference -> so, 16 NiN-Types to plot\n#colnames(seminat.ref.cov[['Light']])\n\n### Grazing_mowing\npar(mfrow=c(2,4))\n## T32s\n# T32-C-1\nplot(density( as.matrix(seminat.ref.cov[['Grazing_mowing']][,\"T32-C1C2\"]) ,na.rm=T),\n     xlim=c(1,8), type=\"l\", main='T32-C1',xlab='Grazing_mowing value')\npoints(density(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T32-C-1\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T32-C-1\",]$original,\n       rep(0,length(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T32-C-1\",]$original)),\n       col=\"red\")\n\n# T32-C-2\nplot(density( as.matrix(seminat.ref.cov[['Grazing_mowing']][,\"T32-C1C2\"]) ,na.rm=T),\n     xlim=c(1,8), type=\"l\", main='T32-C2',xlab='Grazing_mowing value')\npoints(density(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T32-C-2\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T32-C-2\",]$original,\n       rep(0,length(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T32-C-2\",]$original)),\n       col=\"red\")\n\n# T32-C-3\nplot(density( as.matrix(seminat.ref.cov[['Grazing_mowing']][,\"T32-C3C4\"]) ,na.rm=T),\n     xlim=c(1,8), type=\"l\", main='T32-C3',xlab='Grazing_mowing value')\npoints(density(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T32-C-3\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T32-C-3\",]$original,\n       rep(0,length(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T32-C-3\",]$original)),\n       col=\"red\")\n\n# T32-C-4\nplot(density( as.matrix(seminat.ref.cov[['Grazing_mowing']][,\"T32-C3C4\"]) ,na.rm=T),\n     xlim=c(1,8), type=\"l\", main='T32-C4',xlab='Grazing_mowing value')\npoints(density(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T32-C-4\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T32-C-4\",]$original,\n       rep(0,length(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T32-C-4\",]$original)),\n       col=\"red\")\n\n# T32-C-5\nplot(density( as.matrix(seminat.ref.cov[['Grazing_mowing']][,c(\"T32-C5C20a\",\"T32-C5C20b\")]) ,na.rm=T),\n     xlim=c(1,8), type=\"l\", main='T32-C5',xlab='Grazing_mowing value')\npoints(density(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T32-C-5\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T32-C-5\",]$original,\n       rep(0,length(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T32-C-5\",]$original)),\n       col=\"red\")\n\n# T32-C-6\nplot(density( as.matrix(seminat.ref.cov[['Grazing_mowing']][,c(\"T32-C21C6a\",\"T32-C21C6b\")]) ,na.rm=T),\n     xlim=c(1,8), type=\"l\", main='T32-C6',xlab='Grazing_mowing value')\npoints(density(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T32-C-6\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T32-C-6\",]$original,\n       rep(0,length(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T32-C-6\",]$original)),\n       col=\"red\")\n\n# T32-C-9\nplot(density( as.matrix(seminat.ref.cov[['Grazing_mowing']][,c(\"T32-C9a\",\"T32-C9b\")]) ,na.rm=T),\n     xlim=c(1,8), type=\"l\", main='T32-C9',xlab='Grazing_mowing value')\npoints(density(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T32-C-9\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T32-C-9\",]$original,\n       rep(0,length(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T32-C-9\",]$original)),\n       col=\"red\")\n\n# T32-C-10\nplot(density( as.matrix(seminat.ref.cov[['Grazing_mowing']][,c(\"T32-C10a\",\"T32-C10b\")]) ,na.rm=T),\n     xlim=c(1,8), type=\"l\", main='T32-C10',xlab='Grazing_mowing value')\npoints(density(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T32-C-10\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T32-C-10\",]$original,\n       rep(0,length(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T32-C-10\",]$original)),\n       col=\"red\")\n\n\npar(mfrow=c(2,4))\n# T32-C-15\nplot(density( as.matrix(seminat.ref.cov[['Grazing_mowing']][,c(\"T32-C15\")]) ,na.rm=T),\n     xlim=c(1,8), type=\"l\", main='T32-C15',xlab='Grazing_mowing value')\n#points(density(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T32-C-15\",]$original,na.rm=T),\n#       type=\"l\", col=\"red\")\npoints(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T32-C-15\",]$original,\n       rep(0,length(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T32-C-15\",]$original)),\n       col=\"red\")\n\n# T32-C-20\nplot(density( as.matrix(seminat.ref.cov[['Grazing_mowing']][,c(\"T32-C5C20a\",\"T32-C5C20b\")]) ,na.rm=T),\n     xlim=c(1,8), type=\"l\", main='T32-C20',xlab='Grazing_mowing value')\npoints(density(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T32-C-20\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T32-C-20\",]$original,\n       rep(0,length(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T32-C-20\",]$original)),\n       col=\"red\")\n\n\n## V10s\n# V10-C-1\nplot(density( as.matrix(seminat.ref.cov[['Grazing_mowing']][,\"V10-C1C2\"]) ,na.rm=T),\n     xlim=c(1,8), type=\"l\", main='V10-C1',xlab='Grazing_mowing value')\npoints(density(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"V10-C-1\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"V10-C-1\",]$original,\n       rep(0,length(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"V10-C-1\",]$original)),\n       col=\"red\")\n\n# V10-C-3\nplot(density( as.matrix(seminat.ref.cov[['Grazing_mowing']][,\"V10-C3\"]) ,na.rm=T),\n     xlim=c(1,8), type=\"l\", main='V10-C3',xlab='Grazing_mowing value')\n#points(density(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"V10-C-3\",]$original,na.rm=T),\n#       type=\"l\", col=\"red\")\npoints(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"V10-C-3\",]$original,\n       rep(0,length(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"V10-C-3\",]$original)),\n       col=\"red\")\n\n\n## T34s\n# T34-C-1\nplot(density( as.matrix(seminat.ref.cov[['Grazing_mowing']][,\"T34-C1\"]) ,na.rm=T),\n     xlim=c(1,8), type=\"l\", main='T34-C1',xlab='Grazing_mowing value')\npoints(density(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T34-C-1\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T34-C-1\",]$original,\n       rep(0,length(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T34-C-1\",]$original)),\n       col=\"red\")\n\n# T34-C-2\nplot(density( as.matrix(seminat.ref.cov[['Grazing_mowing']][,c(\"T34-C2a\",\"T34-C2b\",\"T34-C2c\")]) ,na.rm=T),\n     xlim=c(1,8), type=\"l\", main='T34-C2',xlab='Grazing_mowing value')\npoints(density(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T34-C-2\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T34-C-2\",]$original,\n       rep(0,length(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T34-C-2\",]$original)),\n       col=\"red\")\n\n# T34-C-4\nplot(density( as.matrix(seminat.ref.cov[['Grazing_mowing']][,c(\"T34-C4a\",\"T34-C4b\",\"T34-C4c\",\"T34-C4d\")]) ,na.rm=T),\n     xlim=c(1,8), type=\"l\", main='T34-C4',xlab='Grazing_mowing value')\n#points(density(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T34-C-4\",]$original,na.rm=T),\n#       type=\"l\", col=\"red\")\npoints(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T34-C-4\",]$original,\n       rep(0,length(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T34-C-4\",]$original)),\n       col=\"red\")\n\n\n## T41\nplot(density( as.matrix(seminat.ref.cov[['Grazing_mowing']][,c(\"T41a\",\"T41b\")]) ,na.rm=T),\n     xlim=c(1,8), type=\"l\", main='T41',xlab='Grazing_mowing value')\npoints(density(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T41\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T41\",]$original,\n       rep(0,length(res.seminat.ANO[res.seminat.ANO$fp_ind==\"Grazing_mowing1\" & res.seminat.ANO$kartleggingsenhet_1m2==\"T41\",]$original)),\n       col=\"red\")\nlegend(\"topleft\", legend=c(\"reference\",\"field data\"), pch=c(NA,1), lty=1, col=c(\"black\",\"red\"))\n\n#summary(res.seminat.ASO$NiN_grunntype)\n#length(levels(res.seminat.ASO$NiN_grunntype))\n# 12 NiN-types, of which C-13 and C-2 have 0 observations -> so, 10 NiN-Types to plot\n#colnames(seminat.ref.cov[['Nitrogen']])\n\n\n\n\n### Nitrogen\npar(mfrow=c(3,4))\n# T32-C-1\nplot(density( as.matrix(seminat.ref.cov[['Nitrogen']][,\"T32-C1C2\"]) ,na.rm=T),\n     xlim=c(1,8), type=\"l\", main='T32-C1',xlab='Nitrogen value')\npoints(density(res.seminat.ASO[res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$NiN_grunntype==\"T32-C-1\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.seminat.ASO[res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$NiN_grunntype==\"T32-C-1\",]$original,\n       rep(0,length(res.seminat.ASO[res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$NiN_grunntype==\"T32-C-1\",]$original)),\n       col=\"red\")\n\n# T32-C-3\nplot(density( as.matrix(seminat.ref.cov[['Nitrogen']][,\"T32-C3C4\"]) ,na.rm=T),\n     xlim=c(1,8), type=\"l\", main='T32-C3',xlab='Nitrogen value')\npoints(density(res.seminat.ASO[res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$NiN_grunntype==\"T32-C-3\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.seminat.ASO[res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$NiN_grunntype==\"T32-C-3\",]$original,\n       rep(0,length(res.seminat.ASO[res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$NiN_grunntype==\"T32-C-3\",]$original)),\n       col=\"red\")\n\n# T32-C-4\nplot(density( as.matrix(seminat.ref.cov[['Nitrogen']][,\"T32-C3C4\"]) ,na.rm=T),\n     xlim=c(1,8), type=\"l\", main='T32-C4',xlab='Nitrogen value')\npoints(density(res.seminat.ASO[res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$NiN_grunntype==\"T32-C-4\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.seminat.ASO[res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$NiN_grunntype==\"T32-C-4\",]$original,\n       rep(0,length(res.seminat.ASO[res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$NiN_grunntype==\"T32-C-4\",]$original)),\n       col=\"red\")\n\n# T32-C-5\nplot(density( as.matrix(seminat.ref.cov[['Nitrogen']][,c(\"T32-C5C20a\",\"T32-C5C20b\")]) ,na.rm=T),\n     xlim=c(1,8), type=\"l\", main='T32-C5',xlab='Nitrogen value')\npoints(density(res.seminat.ASO[res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$NiN_grunntype==\"T32-C-5\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.seminat.ASO[res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$NiN_grunntype==\"T32-C-5\",]$original,\n       rep(0,length(res.seminat.ASO[res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$NiN_grunntype==\"T32-C-5\",]$original)),\n       col=\"red\")\n\n# T32-C-6\nplot(density( as.matrix(seminat.ref.cov[['Nitrogen']][,c(\"T32-C21C6a\",\"T32-C21C6b\")]) ,na.rm=T),\n     xlim=c(1,8), type=\"l\", main='T32-C6',xlab='Nitrogen value')\npoints(density(res.seminat.ASO[res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$NiN_grunntype==\"T32-C-6\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.seminat.ASO[res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$NiN_grunntype==\"T32-C-6\",]$original,\n       rep(0,length(res.seminat.ASO[res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$NiN_grunntype==\"T32-C-6\",]$original)),\n       col=\"red\")\n\n# T32-C-7\nplot(density( as.matrix(seminat.ref.cov[['Nitrogen']][,c(\"T32-C7C8\")]) ,na.rm=T),\n     xlim=c(1,8), type=\"l\", main='T32-C7',xlab='Nitrogen value')\n#points(density(res.seminat.ASO[res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$NiN_grunntype==\"T32-C-7\",]$original,na.rm=T),\n#       type=\"l\", col=\"red\")\npoints(res.seminat.ASO[res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$NiN_grunntype==\"T32-C-7\",]$original,\n       rep(0,length(res.seminat.ASO[res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$NiN_grunntype==\"T32-C-7\",]$original)),\n       col=\"red\")\n\n# T32-C-8\nplot(density( as.matrix(seminat.ref.cov[['Nitrogen']][,c(\"T32-C7C8\")]) ,na.rm=T),\n     xlim=c(1,8), type=\"l\", main='T32-C8',xlab='Nitrogen value')\npoints(density(res.seminat.ASO[res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$NiN_grunntype==\"T32-C-8\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.seminat.ASO[res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$NiN_grunntype==\"T32-C-8\",]$original,\n       rep(0,length(res.seminat.ASO[res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$NiN_grunntype==\"T32-C-8\",]$original)),\n       col=\"red\")\n\n# T32-C-9\nplot(density( as.matrix(seminat.ref.cov[['Nitrogen']][,c(\"T32-C9a\",\"T32-C9b\")]) ,na.rm=T),\n     xlim=c(1,8), type=\"l\", main='T32-C9',xlab='Nitrogen value')\n#points(density(res.seminat.ASO[res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$NiN_grunntype==\"T32-C-9\",]$original,na.rm=T),\n#       type=\"l\", col=\"red\")\npoints(res.seminat.ASO[res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$NiN_grunntype==\"T32-C-9\",]$original,\n       rep(0,length(res.seminat.ASO[res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$NiN_grunntype==\"T32-C-9\",]$original)),\n       col=\"red\")\n\n# T32-C-10\nplot(density( as.matrix(seminat.ref.cov[['Nitrogen']][,c(\"T32-C10a\",\"T32-C10b\")]) ,na.rm=T),\n     xlim=c(1,8), type=\"l\", main='T32-C10',xlab='Nitrogen value')\n#points(density(res.seminat.ASO[res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$NiN_grunntype==\"T32-C-10\",]$original,na.rm=T),\n#       type=\"l\", col=\"red\")\npoints(res.seminat.ASO[res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$NiN_grunntype==\"T32-C-10\",]$original,\n       rep(0,length(res.seminat.ASO[res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$NiN_grunntype==\"T32-C-10\",]$original)),\n       col=\"red\")\n\n\n# T32-C-20\nplot(density( as.matrix(seminat.ref.cov[['Nitrogen']][,c(\"T32-C5C20a\",\"T32-C5C20b\")]) ,na.rm=T),\n     xlim=c(1,8), type=\"l\", main='T32-C20',xlab='Nitrogen value')\npoints(density(res.seminat.ASO[res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$NiN_grunntype==\"T32-C-20\",]$original,na.rm=T),\n       type=\"l\", col=\"red\")\npoints(res.seminat.ASO[res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$NiN_grunntype==\"T32-C-20\",]$original,\n       rep(0,length(res.seminat.ASO[res.seminat.ASO$fp_ind==\"Nitrogen2\" & res.seminat.ASO$NiN_grunntype==\"T32-C-20\",]$original)),\n       col=\"red\")\n\nplot.new()\n\nlegend(\"topleft\", legend=c(\"reference\",\"field data\"), pch=c(NA,1), lty=1, col=c(\"black\",\"red\"))"},{"path":"Functional-plant-indicators-seminat.html","id":"exp-fpin","chapter":"7 Functional Plant Indicators - Semi-Natural Ecosystems","heading":"7.7.5 Eksport file (final product)","text":"","code":""},{"path":"Functional-plant-indicators-open.html","id":"Functional-plant-indicators-open","chapter":"8 Functional Plant Indicators - Naturally Open Ecosystems","heading":"8 Functional Plant Indicators - Naturally Open Ecosystems","text":"Norwegian name: Planteindikatorer\nAuthor date:Joachim TöpperAugust 2023Indicators described chapter:Grime’s CSR valuesLightNitrogenSoil disturbance","code":""},{"path":"Functional-plant-indicators-open.html","id":"intro-fpin","chapter":"8 Functional Plant Indicators - Naturally Open Ecosystems","heading":"8.1 Introduction","text":"Functional plant indicators can used describe functional signature plant communities calculating community-weighted means plant indicator values plant communities (Diekmann 2003). functional signature plant communities may indicative ecosystem identity, depending functional plant indicator look (cf. Töpper et al. 2018). instance, using indicator moisture one find functional signature higher moisture values plant communities mires compared e.g. grasslands forests. Deviations functional signature indicator beyond certain range indicator values (course natural variation functional signatures within ecosystem type) may related reduction ecological condition. , combine functional plant indicator data field sampled plant community data Norwegian nature monitoring programs ANO (Tingstad et al. 2019) GRUK (Evju et al. 2020) naturally open ecosystems tree line (abbreviated ‘nat-open’ henceforth). calculate functional signature plant communities monitored sites respect Grime’s CSR values, light, nitrogen, soil disturbance. functional signatures compared reference distributions functional signature, separately nat-open ecosystem type, calculated ‘generalized species lists’ developed ecosystem types Norwegian categorization system eco-diversity (Halvorsen et al. 2020). plant functional condition indicators developed following principles technical protocol IBECA framework (Jakobsson et al. 2021, Töpper & Jakobsson 2021). Note deviations reference may occur directions, e.g. nitrogen signature testing data may higher lower reference. Deviations two directions indicate different environmental phenomena thus treated separately. Therefore, develop two condition indicators functional plant indicator, lower one upper one (see details).","code":""},{"path":"Functional-plant-indicators-open.html","id":"about-the-underlying-data-5","chapter":"8 Functional Plant Indicators - Naturally Open Ecosystems","heading":"8.2 About the underlying data","text":"‘functional plant indicator’ project nat-open ecosystems, use five sets data building indicators ecological condition:test data use plant community data (1) ANO monitoring scheme (cf. Tingstad et al. 2019) (2) GRUK monitoring scheme (cf. Evju et al. 2020)reference data use (3) generalized species lists developed Evju et al. (2023) nat-open ecosystem typesSwedish plant indicator data light, nitrogen, soil disturbance Tyler et al. (2021), (5) Grime’s CSR values plant species’ strategies (towards competition, stress, ruderal conditions)\nSwedish plant indicator data light, nitrogen, soil disturbance Tyler et al. (2021), (5) Grime’s CSR values plant species’ strategies (towards competition, stress, ruderal conditions)ANO monitoring data:\nANO stands ‘areal-representativ naturovervåking’, .e. ‘area representative nature monitoring’. 1000 sites randomly distributed across mainland Norway visited within 5-year cycle. ANO site spans 500 x 500 m grid cell, data collection ANO site includes 18 evenly distributed vegetation analyses 1 x 1 m plots (18, evenly distributed points may water otherwise inaccessible). vegetation analyses, cover vascular plant species plot recorded. Every vegetation analysis accompanied assessment ecosystem plot lies , including ecosystem type additional variables related ecosystem-specific drivers state. analysis document, use plots classified one nat-open ecosystem types Norwegian categorization system eco-diversity (NiN) registered lying mountain areas tree line.\nanalysis document, use data available Miljødirektoratets kartkatalog (https://kartkatalog.miljodirektoratet./Dataset/Details/2054), comprises data first three ANO-years, 2019-2021, total 8887 plots 498 sites.ANO monitoring data:\nANO stands ‘areal-representativ naturovervåking’, .e. ‘area representative nature monitoring’. 1000 sites randomly distributed across mainland Norway visited within 5-year cycle. ANO site spans 500 x 500 m grid cell, data collection ANO site includes 18 evenly distributed vegetation analyses 1 x 1 m plots (18, evenly distributed points may water otherwise inaccessible). vegetation analyses, cover vascular plant species plot recorded. Every vegetation analysis accompanied assessment ecosystem plot lies , including ecosystem type additional variables related ecosystem-specific drivers state. analysis document, use plots classified one nat-open ecosystem types Norwegian categorization system eco-diversity (NiN) registered lying mountain areas tree line.\nanalysis document, use data available Miljødirektoratets kartkatalog (https://kartkatalog.miljodirektoratet./Dataset/Details/2054), comprises data first three ANO-years, 2019-2021, total 8887 plots 498 sites.GRUK monitoring data\nGRUK stands ‘Grunnlendt åpen kalkmark’, represents monitoring open, limestone rich ecosystems soils shallow forest establishment. limestone rich focus scheme motivated high biodiversity value places monitoring sites area around Oslofjord. spring 2023, GRUK data comprise 596 vegetation plots 146 sites, mapped ecosystem type “åpen grunnlendt mark” (T2) therein limestone-rich subtypes T2-C-7 T2-C-8 Norwegian classification system ecosystem types.\nvegetation analysis GRUK records percent cover every species vascular plants 1 m^2 plots. addition, range site variables related ecosystem-specific drivers state recorded.\nanalysis document, use GRUK monitoring data, span years 2020-22. 2022 data also include assessment site condition, included analysis results document. future, data data may become available Miljødirektoratets kartkatalog.GRUK monitoring data\nGRUK stands ‘Grunnlendt åpen kalkmark’, represents monitoring open, limestone rich ecosystems soils shallow forest establishment. limestone rich focus scheme motivated high biodiversity value places monitoring sites area around Oslofjord. spring 2023, GRUK data comprise 596 vegetation plots 146 sites, mapped ecosystem type “åpen grunnlendt mark” (T2) therein limestone-rich subtypes T2-C-7 T2-C-8 Norwegian classification system ecosystem types.\nvegetation analysis GRUK records percent cover every species vascular plants 1 m^2 plots. addition, range site variables related ecosystem-specific drivers state recorded.\nanalysis document, use GRUK monitoring data, span years 2020-22. 2022 data also include assessment site condition, included analysis results document. future, data data may become available Miljødirektoratets kartkatalog.NiN reference data:\ngeneralized species lists underlying ecosystem categorization NiN represent expert-compiled species lists based empirical evidence literature expert knowledge systems species. lists, every species assigned abundance value 6-step scale, step representing range ‘expected combination frequency cover’ occurrence (1: < 1/32, 2: 1/32 - 1/8 , 3: 1/8 - 3/8, 4: 3/8 - 4/5, 5: 3/8 - 4/5 + dominance, 6: > 4/5). purpose project, steps simplified maximum ‘expected combination frequency cover’, whereby steps 4 & 5 assigned 0.6 0.8, respectively, order distinguish .NiN reference data:\ngeneralized species lists underlying ecosystem categorization NiN represent expert-compiled species lists based empirical evidence literature expert knowledge systems species. lists, every species assigned abundance value 6-step scale, step representing range ‘expected combination frequency cover’ occurrence (1: < 1/32, 2: 1/32 - 1/8 , 3: 1/8 - 3/8, 4: 3/8 - 4/5, 5: 3/8 - 4/5 + dominance, 6: > 4/5). purpose project, steps simplified maximum ‘expected combination frequency cover’, whereby steps 4 & 5 assigned 0.6 0.8, respectively, order distinguish .Swedish plant indicator set published Tyler et al. (2021) contains large collection plant indicators based Swedish flora, well representative Norwegian flora well. set, decided include indicator data light, moisture, pH, nitrogen, phosphorus, grazing_mowing, soil disturbance semi-natural ecosystems, thought subject potential change due abandonment, drainage/flooding, pollution, erosion.Swedish plant indicator set published Tyler et al. (2021) contains large collection plant indicators based Swedish flora, well representative Norwegian flora well. set, decided include indicator data light, moisture, pH, nitrogen, phosphorus, grazing_mowing, soil disturbance semi-natural ecosystems, thought subject potential change due abandonment, drainage/flooding, pollution, erosion.Grime’s system plant strategy scores (Grime 1974) comprises relative (one another) scores competition-, stress-, disturbance(“ruderality”)-related life strategy plant species. analysis document, use three variables, C, S R, different pressures acting ecosystem might change every one strategies (e.g. alien species competition, climate change stress, land use change ruderality).Grime’s system plant strategy scores (Grime 1974) comprises relative (one another) scores competition-, stress-, disturbance(“ruderality”)-related life strategy plant species. analysis document, use three variables, C, S R, different pressures acting ecosystem might change every one strategies (e.g. alien species competition, climate change stress, land use change ruderality).","code":""},{"path":"Functional-plant-indicators-open.html","id":"representativity-in-time-and-space-6","chapter":"8 Functional Plant Indicators - Naturally Open Ecosystems","heading":"8.2.1 Representativity in time and space","text":"nat-open ecosystems, ANO data analysis contain 143 plots 52 sites, principle distributed randomly across country. nat-open ecosystems occur often certain regions Norway others, amount plots sites equal among Norway’s five regions. 143 plots distributed across regions following way:Northern Norway: 29Central Norway: 39Eastern Norway: 34Western Norway: 24Southern Norway: 17For GRUK, analysis covers 1103 plots 146 sites.1103 plots distributed across regions following way:Northern Norway: 0Central Norway: 0Eastern Norway: 1042Western Norway: 0Southern Norway: 61","code":""},{"path":"Functional-plant-indicators-open.html","id":"temporal-coverage-5","chapter":"8 Functional Plant Indicators - Naturally Open Ecosystems","heading":"8.2.2 Temporal coverage","text":"ANO evaluation data cover first three years, 2019-2021, first 5-year-cycle ANO monitoring scheme. GRUK covers 2020-2022. Thus, actual time series data, indicator evaluation therefore include temporal analyses.","code":""},{"path":"Functional-plant-indicators-open.html","id":"collinearities-with-other-indicators-7","chapter":"8 Functional Plant Indicators - Naturally Open Ecosystems","heading":"8.3 Collinearities with other indicators","text":"","code":""},{"path":"Functional-plant-indicators-open.html","id":"reference-state-and-values-3","chapter":"8 Functional Plant Indicators - Naturally Open Ecosystems","heading":"8.4 Reference state and values","text":"","code":""},{"path":"Functional-plant-indicators-open.html","id":"reference-state-2","chapter":"8 Functional Plant Indicators - Naturally Open Ecosystems","heading":"8.4.1 Reference state","text":"reference state defined via functional signature generalized species lists NiN ecosystem types (see also Töpper et al. 2018). nat-open ecosystem types lists newly prepared Evju et al. (2023). bootstrapping species lists (see details ) calculating community-weighted means functional plant indicators every re-sampled community, describe reference state distribution indicator values respective plant functional indicator. distributions calculated minor ecosystem types (“grunntyper” “kartleggingsenheter” 1:5000 mapping scale) within major ecosystem types (hovedtyper) NiN. extensive discussion use reference communities can found Jakobsson et al. (2020).","code":""},{"path":"Functional-plant-indicators-open.html","id":"ref-vals-fpin","chapter":"8 Functional Plant Indicators - Naturally Open Ecosystems","heading":"8.4.2 Reference values, thresholds for defining good ecological condition, minimum and/or maximum values","text":"analysis, derive scaling values statistical (, non-parametric) distributions (see Jakobsson et al. 2010). ecosystem sub-type plant functional indicator, reference value defined median value indicator value distribution. cases distributions naturally two-sided (see Heat-requirement indicator mountain assessment example one-sided functional plant indicator, Framstad et al. 2022), deviation optimal state thus may occur direction (e.g. indicating low high pH), need define two threshold values good ecological condition well minimum maximum value. line previous assessments ecological condition Norwegian forests mountains, define lower upper threshold value via 95% confidence interval reference distribution, .e. 0.025 0.975 quantiles. minimum maximum values given minimum maximum possible indicator values respective plant functional indicator. details scaling principles IBECA, please see Töpper & Jakobsson (2021).","code":""},{"path":"Functional-plant-indicators-open.html","id":"uncertainties-6","chapter":"8 Functional Plant Indicators - Naturally Open Ecosystems","heading":"8.5 Uncertainties","text":"can calculate mean indicator value (scaling) every region (delimited area interest) well corresponding standard error measure spatial uncertainty geographical area.","code":""},{"path":"Functional-plant-indicators-open.html","id":"references-7","chapter":"8 Functional Plant Indicators - Naturally Open Ecosystems","heading":"8.6 References","text":"Diekmann, M. 2003. Species indicator values important tool applied plant ecology - review. Basic Applied Ecology 4: 493-506, doi:10.1078/1439-1791-00185Evju, M., Stabbetorp, O.E., Olsen, S.L., Bratli, H., Often, . & Bakkestuen, V. 2020. Dry calcareous grasslands Oslofjord region. test monitoring protocols results 2020. NINA Report 1910. Norwegian Institute Nature Research.Evju, M., Stabbetorp, O.E., Olsen, S.L., Bratli, … . 2023. Generalized species lists naturally open ecosystem types tree line Norway. prep.Framstad, E., Kolstad, . L., Nybø, S., Töpper, J. & Vandvik, V. 2022. condition forest mountain ecosystems Norway. Assessment IBECA method. NINA Report 2100. Norwegian Institute Nature Research.Grime J.P. 1974. Vegetation classification reference strategies. Nature 250(5461):26-31.Halvorsen, R., Skarpaas, O., Bryn, ., Bratli, H., Erikstad, L., Simensen, T., & Lieungh, E. (2020). Towards systematics ecodiversity: EcoSyst framework. Global Ecology Biogeography, 29(11), 1887-1906. doi:10.1111/geb.13164Jakobsson, S., Töpper, J.P., Evju, M., Framstad, E., Lyngstad, ., Pedersen, B., Sickel, H., Sverdrup-Thygeson, ., Vandvik. V., Velle, L.G., Aarrestad, P.. & Nybø, S. 2020. Setting reference levels limits good ecological condition terrestrial ecosystems. Insights case study based IBECA approach. Ecological Indicators 116: 106492.Jakobsson, S., Evju, M., Framstad, E., Imbert, ., Lyngstad, ., Sickel, H., Sverdrup-Thygeson, ., Töpper, J., Vandvik, V., Velle, L.G., Aarrestad, P.. & Nybø, S. 2021. index-based assessment ecological condition links international frameworks. Ecological Indicators 124: 107252.Tingstad, L., Evju, M., Sickel, H., & Töpper, J. 2019. Utvikling av nasjonal arealrepresentativ naturovervåking (ANO). Forslag til gjennomføring, protokoller og kostnadsvurderinger med utgangspunkt erfaringer fra uttesting Trøndelag. NINA Rapport 1642.Töpper, J. & Jakobsson, S. 2021. Index-Based Ecological Condition Assessment (IBECA) - Technical protocol, version 1.0. NINA Report 1967. Norwegian Institute Nature Research.Töpper, J., Velle, L.G. & Vandvik, V. 2018. Developing method assessment ecological state based indicator values Ellenberg Grime (revised edition). NINA Report 1529b. Norwegian Institute Nature Research.Tyler, T., Herbertsson, L., Olofsson, J., & Olsson, P. . 2021. Ecological indicator traits values Swedish vascular plants. Ecological -dicators, 120. doi:10.1016/j.ecolind.2020.106923","code":""},{"path":"Functional-plant-indicators-open.html","id":"analyses-fpin","chapter":"8 Functional Plant Indicators - Naturally Open Ecosystems","heading":"8.7 Analyses","text":"","code":""},{"path":"Functional-plant-indicators-open.html","id":"data-sets-5","chapter":"8 Functional Plant Indicators - Naturally Open Ecosystems","heading":"8.7.1 Data sets","text":"ANO data: ANO.sp contains species data, ANO.geo contains site data.GRUK data: GRUK.species contains species data, GRUK.variable contains site data, GRUK2021.condition contains field-based condition assessment 2021 season.Plant indicators Tyler et al. (2021) Grime (1974) saved ind.Tyler ind.Grime.Generalized species lists (reference communities): natopen_NiN_ref contains reference species lists, natopen_NiN_ref_spInfo contains additional taxonomic information species.","code":""},{"path":"Functional-plant-indicators-open.html","id":"data-handling-2","chapter":"8 Functional Plant Indicators - Naturally Open Ecosystems","heading":"8.7.1.1 Data handling","text":"Checking errorsChecking species nomenclature different species lists make species indicator data possible mergeMerging indicator data monitoring data indicator data reference data\n(shown , documented code)leaving us monitoring data including plant indicators (ANO.sp.ind, GRUK.species.ind) reference data including plant indicators (NiN.natopen.cov)ecosystem type NiN species list, can calculate community weighted mean (CWM) relevant functional plant indicators.\nsemi-natural ecosystems, testing “Light”, “Moisture”, “Soil_reaction_pH”, “Nitrogen”, “Phosphorus”, “Grazing_mowing”, “Soil_disturbance”. order get distributions CWMs rather one single value (comparison empirical testing data), NiN lists can bootstrapped.","code":"\nhead(ANO.sp.ind)\n#>      Species art_dekning\n#> 1 Abies alba           0\n#> 2 Abies alba           0\n#> 3 Abies alba           0\n#> 4 Abies alba           0\n#> 5 Abies alba           0\n#> 6 Abies alba           0\n#>                           ParentGlobalID CC SS RR Light\n#> 1 {CB1796B9-01F5-4109-B44E-4582CA855F93} NA NA NA     2\n#> 2 {AB9ED5C2-E906-4C73-B543-EC6CB28B39D5} NA NA NA     2\n#> 3 {A660C3D8-C8DD-414D-8B70-80F9A284E34E} NA NA NA     2\n#> 4 {142D1B0E-32EE-4FD8-AA12-DBF3A0B2DC54} NA NA NA     2\n#> 5 {B7DD61EE-A113-4486-A4B8-D50ACAAC648B} NA NA NA     2\n#> 6 {32A9B462-5483-4D47-ADAF-78F11AF201AA} NA NA NA     2\n#>   Nitrogen Soil_disturbance\n#> 1        5                1\n#> 2        5                1\n#> 3        5                1\n#> 4        5                1\n#> 5        5                1\n#> 6        5                1\nhead(GRUK.species.ind)\n#>                         ParentGlobalID              Species\n#> 1 002ee3d0-f9f5-4760-9580-b71d56748595        Poa compressa\n#> 2 002ee3d0-f9f5-4760-9580-b71d56748595 Equisetum sylvaticum\n#> 3 002ee3d0-f9f5-4760-9580-b71d56748595 Polygonatum odoratum\n#> 4 002ee3d0-f9f5-4760-9580-b71d56748595  Geranium sanguineum\n#> 5 002ee3d0-f9f5-4760-9580-b71d56748595     Origanum vulgare\n#> 6 002ee3d0-f9f5-4760-9580-b71d56748595        Sonchus asper\n#>   art_dekning        CC        SS        RR Light Nitrogen\n#> 1         0.1 0.1666667 0.4166667 0.4166667     7        4\n#> 2         0.1 0.4166667 0.1666667 0.4166667     4        3\n#> 3         1.0 0.5000000 0.5000000 0.0000000     5        3\n#> 4         0.1 0.1666667 0.6666667 0.1666667     5        3\n#> 5         3.0 0.4166667 0.4166667 0.1666667     6        4\n#> 6         1.0 0.2500000 0.0000000 0.7500000     6        7\n#>   Soil_disturbance year Flate_ID Punkt_ID\n#> 1                5 2020     44-1       NA\n#> 2                2 2020     44-1       NA\n#> 3                5 2020     44-1       NA\n#> 4                2 2020     44-1       NA\n#> 5                4 2020     44-1       NA\n#> 6                9 2020     44-1       NA\n#>   Total dekning % av karplanter registert\n#> 1                                     5.3\n#> 2                                     5.3\n#> 3                                     5.3\n#> 4                                     5.3\n#> 5                                     5.3\n#> 6                                     5.3\n#>   Dekning % av karplanter i feltsjikt Dekning % av moser\n#> 1                                   4                  0\n#> 2                                   4                  0\n#> 3                                   4                  0\n#> 4                                   4                  0\n#> 5                                   4                  0\n#> 6                                   4                  0\n#>   Dekning % av lav Dekning % av strø\n#> 1                0                 8\n#> 2                0                 8\n#> 3                0                 8\n#> 4                0                 8\n#> 5                0                 8\n#> 6                0                 8\n#>   Dekning % av bar jord/grus/stein/berg Kartleggingsenhet\n#> 1                                    99            T2-C-7\n#> 2                                    99            T2-C-7\n#> 3                                    99            T2-C-7\n#> 4                                    99            T2-C-7\n#> 5                                    99            T2-C-7\n#> 6                                    99            T2-C-7\n#>   Spor etter ferdsel med tunge kjøretøy (%)\n#> 1                                         0\n#> 2                                         0\n#> 3                                         0\n#> 4                                         0\n#> 5                                         0\n#> 6                                         0\n#>   Spor etter slitasje og slitasjebetinget erosjon (%)\n#> 1                                                   0\n#> 2                                                   0\n#> 3                                                   0\n#> 4                                                   0\n#> 5                                                   0\n#> 6                                                   0\n#>   Dekning % av nakent berg\n#> 1                        7\n#> 2                        7\n#> 3                        7\n#> 4                        7\n#> 5                        7\n#> 6                        7\n#>   Menneskeskapte objekter i sirkelen?\n#> 1                                 nei\n#> 2                                 nei\n#> 3                                 nei\n#> 4                                 nei\n#> 5                                 nei\n#> 6                                 nei\n#>   Total dekning % av vedplanter i feltsjikt\n#> 1                                         5\n#> 2                                         5\n#> 3                                         5\n#> 4                                         5\n#> 5                                         5\n#> 6                                         5\n#>   Dekning % av busker i busksjikt Dekning % av tresjikt\n#> 1                               3                     8\n#> 2                               3                     8\n#> 3                               3                     8\n#> 4                               3                     8\n#> 5                               3                     8\n#> 6                               3                     8\n#>   Dekning % av problemarter\n#> 1                        NA\n#> 2                        NA\n#> 3                        NA\n#> 4                        NA\n#> 5                        NA\n#> 6                        NA\n#>   Total dekning % av fremmede arter        x        y\n#> 1                                 0 10.73183 59.94773\n#> 2                                 0 10.73183 59.94773\n#> 3                                 0 10.73183 59.94773\n#> 4                                 0 10.73183 59.94773\n#> 5                                 0 10.73183 59.94773\n#> 6                                 0 10.73183 59.94773\n#>                   geometry\n#> 1 POINT (261665.7 6653279)\n#> 2 POINT (261665.7 6653279)\n#> 3 POINT (261665.7 6653279)\n#> 4 POINT (261665.7 6653279)\n#> 5 POINT (261665.7 6653279)\n#> 6 POINT (261665.7 6653279)\nhead(NiN.natopen.cov)\n#>                        sp T1_toerkeutsatte_berg T1-C-11\n#> 1    Achillea millefolium                    NA      NA\n#> 2       Achillea ptarmica                    NA      NA\n#> 3         Acinos arvensis                    NA      NA\n#> 4 Aconitum septentrionale                    NA      NA\n#> 5          Actaea spicata                    NA      NA\n#> 6     Agrimonia eupatoria                    NA      NA\n#>   T1-C-12 T1_fosseberg T2-C-1 T2-C-2 T2-C-3 T2-C-4 T2-C-5\n#> 1      NA           NA     NA     NA     NA     NA     NA\n#> 2      NA           NA     NA     NA     NA     NA     NA\n#> 3      NA           NA     NA     NA     NA     NA     NA\n#> 4      NA           NA     NA     NA     NA     NA     NA\n#> 5      NA           NA     NA     NA     NA     NA     NA\n#> 6      NA           NA     NA     NA     NA     NA  0.375\n#>   T2-C-6 T2-C-7 T2-C-8 T2-C-7_BN T2-C-8_BN T8-C-1 T8-C-2\n#> 1     NA     NA     NA        NA        NA     NA     NA\n#> 2     NA     NA     NA        NA        NA     NA     NA\n#> 3     NA  0.375  0.375   0.37500   0.37500     NA     NA\n#> 4     NA     NA     NA        NA        NA     NA     NA\n#> 5     NA     NA     NA        NA        NA     NA     NA\n#> 6     NA  0.375     NA   0.03125   0.03125     NA     NA\n#>   T8-C-3 T11-C-1 T11-C-2 T12-C-1 T12-C-2 T13-C-1 T13-C-2\n#> 1  0.375      NA      NA      NA 0.12500      NA      NA\n#> 2     NA      NA      NA      NA 0.03125      NA      NA\n#> 3     NA      NA      NA      NA      NA      NA      NA\n#> 4     NA      NA      NA      NA      NA      NA      NA\n#> 5     NA      NA      NA      NA      NA      NA      NA\n#> 6     NA      NA      NA      NA      NA      NA      NA\n#>   T13-C-3 T13-C-4 T13-C-5 T13-C-6 T13-C-7 T13-C-8 T13-C-9\n#> 1      NA      NA      NA      NA      NA      NA      NA\n#> 2      NA      NA      NA      NA      NA      NA      NA\n#> 3      NA 0.03125 0.03125 0.03125 0.03125 0.03125 0.03125\n#> 4      NA      NA      NA      NA      NA      NA      NA\n#> 5      NA      NA      NA      NA      NA      NA      NA\n#> 6      NA      NA      NA      NA      NA      NA      NA\n#>   T13-C-10 T13-C-11 T13-C-12 T13-C-13 T13-C-14 T13-C-15 T15\n#> 1       NA       NA       NA       NA       NA       NA  NA\n#> 2       NA       NA       NA       NA       NA       NA  NA\n#> 3       NA       NA       NA       NA       NA       NA  NA\n#> 4       NA       NA       NA       NA       NA       NA  NA\n#> 5       NA       NA       NA       NA       NA       NA  NA\n#> 6       NA       NA       NA       NA       NA       NA  NA\n#>   T15-Bratli21 T16-C-1 T16-C-2 T16-C-3 T16-C-4 T16-C-5\n#> 1      0.03125   0.375   0.375      NA      NA      NA\n#> 2           NA      NA      NA      NA      NA      NA\n#> 3           NA      NA      NA      NA   0.125      NA\n#> 4      0.03125      NA      NA      NA      NA      NA\n#> 5           NA      NA      NA   0.125   0.125      NA\n#> 6           NA      NA      NA      NA      NA      NA\n#>   T16-C-6 T16-C-7 T18-C-1 T18-C-2 T18-C-3 T18-C-4 T21-C-1\n#> 1      NA      NA      NA      NA      NA      NA   0.125\n#> 2      NA      NA   0.125      NA      NA      NA      NA\n#> 3      NA      NA      NA      NA      NA      NA      NA\n#> 4      NA      NA      NA      NA      NA      NA      NA\n#> 5      NA      NA      NA      NA      NA      NA      NA\n#> 6      NA      NA      NA      NA      NA      NA      NA\n#>   T21-C-2 T21-C-3 T21-C-4 T21-7 T24-C-1_samlet\n#> 1   0.375     0.6   0.375 0.375             NA\n#> 2      NA      NA      NA    NA             NA\n#> 3      NA      NA      NA    NA             NA\n#> 4      NA      NA      NA    NA             NA\n#> 5      NA      NA      NA    NA             NA\n#> 6      NA      NA      NA    NA             NA\n#>   T24-C-2_samlet T24-C-1_Moere T24-C-1_Troendelag\n#> 1             NA            NA                 NA\n#> 2             NA            NA                 NA\n#> 3             NA            NA                 NA\n#> 4             NA            NA                 NA\n#> 5             NA            NA                 NA\n#> 6             NA            NA                 NA\n#>   T24-C-1_Troms T24-C-1_Finnmark T24-C-2_Moere\n#> 1            NA            0.125            NA\n#> 2            NA               NA            NA\n#> 3            NA               NA            NA\n#> 4            NA               NA            NA\n#> 5            NA               NA            NA\n#> 6            NA               NA            NA\n#>   T24-C-2_Troendelag T24-C-2_Troms T24-C-2_Finnmark T29-C-1\n#> 1                 NA            NA            0.375      NA\n#> 2                 NA            NA               NA      NA\n#> 3                 NA            NA               NA      NA\n#> 4                 NA            NA               NA      NA\n#> 5                 NA            NA               NA      NA\n#> 6                 NA            NA               NA      NA\n#>   T29-C-2 T29-C-3 T29-C-4 T29-C-5 T29-C-6        Phylum\n#> 1 0.80000      NA   0.375 0.03125      NA Magnoliophyta\n#> 2 0.03125      NA      NA      NA      NA Magnoliophyta\n#> 3      NA     0.6   0.375      NA      NA Magnoliophyta\n#> 4      NA      NA      NA      NA      NA Magnoliophyta\n#> 5      NA      NA      NA      NA      NA Magnoliophyta\n#> 6 0.12500      NA      NA      NA      NA Magnoliophyta\n#>                   sp.orig        CC        SS        RR\n#> 1    Achillea millefolium 0.3333333 0.3333333 0.3333333\n#> 2       Achillea ptarmica 0.4166667 0.4166667 0.1666667\n#> 3         Acinos arvensis 0.1666667 0.4166667 0.4166667\n#> 4 Aconitum septentrionale        NA        NA        NA\n#> 5          Actaea spicata        NA        NA        NA\n#> 6     Agrimonia eupatoria 0.3333333 0.3333333 0.3333333\n#>   Light Nitrogen Soil_disturbance\n#> 1     6        5                2\n#> 2     5        4                2\n#> 3     7        3                7\n#> 4     4        7                2\n#> 5     2        6                3\n#> 6     5        6                5"},{"path":"Functional-plant-indicators-open.html","id":"bootstrap-function-for-frequency-abundance-2","chapter":"8 Functional Plant Indicators - Naturally Open Ecosystems","heading":"8.7.1.1.1 bootstrap function for frequency abundance","text":"function calculate community weighted means selected indicator values (ind)species lists (sp) given abundances percent (scale 0 1) one ‘sites’ (abun)given number iterations (iter),species given certain minimum abundance occurring bootstraps (obl), andwith given re-sampling ratio original species list (rat)every bootstrap iteration abundance sampled species can randomly changed limited amount wished introducing re-sampling abundance values adjacent abundance steps certain probability (var.abun)Running bootstrapsThis results R-list slot every selected indicator, every slot ’s data frame many columns NiN species lists many rows iterations bootstrap.\nNext, need derive scaling values bootstrap-lists (columns) every mapping unit NiN. , define things following way:Median = reference values0.025 0.975 quantiles = lower upper limit valuesmin max respective indicator’s scale = min/max valuesOnce test data (ANO, GRUK) scaling values reference data place, can calculate community-weighted means (CWM) selected indicators ANO GRUK community data scale scaling values reference distribution. Note scale ANO/GRUK plot’s CWM either lower threshold value min value upper threshold value max value based whether CWM smaller higher reference value. Since scaled values sides range 0 1, generate separate lower upper condition indicators functional plant indicator. ANO/GRUK plot can scaled value either lower upper indicator (one ‘NA’), except unlikely event CWM exactly matches reference value, case lower upper indicator receive scaled indicator value 1.scaling functionWe can prepare list data frames hold results perform scaling according principles described NINA report 1967 (Töpper Jakobsson 2021)\ndone separately ANO ASO. First ANO:GRUK:","code":"\ncolnames(NiN.natopen)\n# 1st column is the species\n# 6th-71st column is the abundances of sp in different ecosystem types\n# 74th-79th column is the indicator values of the respective species\n# we choose 1000 iterations\n# species with abundance 1 (i.e. a max of 100%, must be included in each sample)\n# each sample re-samples 1/3 of the number of species\n# the abundance of the re-sampled species may vary (see bootstrap function for details)\nnatopen.ref.cov <- indBoot.freq(sp=NiN.natopen.cov[,1],abun=NiN.natopen.cov[,6:71],ind=NiN.natopen.cov[,74:79],iter=1000,obl=1,rat=1/3,var.abun=T)\n\n### fixing NaN's\nfor (i in 1:length(natopen.ref.cov) ) {\n  for (j in 1:ncol(natopen.ref.cov[[i]]) ) {\n    v <- natopen.ref.cov[[i]][,j]\n    v[is.nan(v)] <- NA\n    natopen.ref.cov[[i]][,j] <- v\n  }\n}\nhead(natopen.ref.cov[[1]])\n#>      T2-C-1     T2-C-2     T2-C-3     T2-C-4    T2-C-5\n#> 1 0.2845850 0.25000000 0.14655172 0.10347682 0.2346319\n#> 2 0.3818565 0.16025641 0.12820513 0.13008130 0.2382169\n#> 3 0.1697966 0.21428571 0.24583333 0.15540016 0.2293046\n#> 4 0.2393868 0.15476190 0.14665866 0.19340378 0.2066667\n#> 5 0.2500000 0.25000000 0.05496922 0.08085612 0.1104183\n#> 6 0.2619048 0.06862745 0.01739736 0.05701754 0.2588652\n#>        T2-C-6    T2-C-7    T2-C-8 T2-C-7_BN T2-C-8_BN\n#> 1 0.089953944 0.2057258 0.2837079 0.1569223 0.3247954\n#> 2 0.103709127 0.2114830 0.2331540 0.1974646 0.2087871\n#> 3 0.047180939 0.2519630 0.3000000 0.2314341 0.1643737\n#> 4 0.301147228 0.3008681 0.3027884 0.1949171 0.2540587\n#> 5 0.001539646 0.1829332 0.2220369 0.1870552 0.1070675\n#> 6 0.083333333 0.1803109 0.2382713 0.1813302 0.2170433\n#>      T8-C-1 T8-C-2    T8-C-3 T11-C-1 T11-C-2 T12-C-1\n#> 1 0.0923913     NA 0.1410256      NA      NA      NA\n#> 2 0.2026144     NA 0.1923077      NA      NA      NA\n#> 3 0.2500000     NA 0.0600000      NA      NA      NA\n#> 4 0.1666667     NA 0.1178862      NA      NA      NA\n#> 5 0.1616162     NA 0.1933333      NA      NA      NA\n#> 6 0.2516340     NA 0.2891156      NA      NA      NA\n#>     T12-C-2 T13-C-1 T13-C-2 T13-C-3 T13-C-4    T13-C-5\n#> 1 0.5449800      NA      NA      NA      NA 0.13888889\n#> 2 0.3095506      NA      NA      NA      NA 0.13888889\n#> 3 0.3425983      NA      NA      NA      NA 0.16666667\n#> 4 0.3918308      NA      NA      NA      NA 0.21747967\n#> 5 0.4647327      NA      NA      NA      NA 0.09482759\n#> 6 0.5083175      NA      NA      NA      NA 0.18965517\n#>      T13-C-6    T13-C-7    T13-C-8   T13-C-9 T13-C-10\n#> 1 0.08849281 0.51706827 0.16666667 0.2987805       NA\n#> 2 0.18140868 0.01683381 0.20114943 0.2385057       NA\n#> 3 0.16211790 0.03132648 0.16666667 0.1944444       NA\n#> 4 0.23989899 0.54421769 0.08130081 0.1760037       NA\n#> 5 0.21226415 0.02777778 0.06504065 0.2919800       NA\n#> 6 0.11049107 0.39393939 0.08130081 0.2146465       NA\n#>   T13-C-11 T13-C-12 T13-C-13 T13-C-14 T13-C-15       T15\n#> 1       NA       NA       NA       NA       NA 0.3645833\n#> 2       NA       NA       NA       NA       NA 0.3339489\n#> 3       NA       NA       NA       NA       NA 0.3210682\n#> 4       NA       NA       NA       NA       NA 0.3649425\n#> 5       NA       NA       NA       NA       NA 0.4716981\n#> 6       NA       NA       NA       NA       NA 0.3946790\n#>   T15-Bratli21   T16-C-1   T16-C-2   T16-C-3   T16-C-4\n#> 1    0.2551183 0.2226776 0.2198670 0.2577736 0.3085355\n#> 2    0.2872909 0.3341544 0.3596491 0.2608512 0.1820631\n#> 3    0.2770032 0.2708333 0.2613169 0.3069184 0.2842679\n#> 4    0.3413580 0.2552083 0.1635802 0.2956989 0.2115575\n#> 5    0.3022203 0.2407407 0.2693429 0.2246497 0.1650106\n#> 6    0.2649355 0.3182898 0.3535714 0.2408487 0.2112299\n#>     T16-C-5   T16-C-6   T16-C-7   T18-C-1    T18-C-2\n#> 1 0.6531548 0.5458443 0.3305085 0.6448475 0.40948276\n#> 2 0.4814815 0.4051164 0.2500000 0.3070175 0.26190476\n#> 3 0.3727735 0.3267196 0.2916667 0.4373479 0.23289183\n#> 4 0.5041667 0.3931981 0.2083333 0.3030303 0.34612310\n#> 5 0.4586247 0.3076377 0.3218391 0.5825617 0.51851852\n#> 6 0.4064327 0.4531083 0.2166667 0.3549383 0.07929472\n#>   T18-C-3 T18-C-4   T21-C-1   T21-C-2   T21-C-3   T21-C-4\n#> 1      NA      NA 0.3663522 0.3309456 0.2259268 0.2647892\n#> 2      NA      NA 0.5610200 0.4441581 0.2566483 0.3367434\n#> 3      NA      NA 0.2731569 0.3973696 0.1865861 0.2837838\n#> 4      NA      NA 0.3060429 0.3239783 0.2458751 0.3696404\n#> 5      NA      NA 0.4566886 0.4012757 0.1777217 0.4740468\n#> 6      NA      NA 0.2535817 0.3604806 0.3903275 0.2679592\n#>       T21-7 T24-C-1_samlet T24-C-2_samlet T24-C-1_Moere\n#> 1 0.1665567      0.5044695      0.1912136     0.5350369\n#> 2 0.3191248      0.5767588      0.3276727     0.4834191\n#> 3 0.1247113      0.6266280      0.3867521     0.5691266\n#> 4 0.2437276      0.4711472      0.3026242     0.3687776\n#> 5 0.2944641      0.5371597      0.2251286     0.4222182\n#> 6 0.1722222      0.4268812      0.4085174     0.7216956\n#>   T24-C-1_Troendelag T24-C-1_Troms T24-C-1_Finnmark\n#> 1          0.5065958     0.3224095        0.3252841\n#> 2          0.2782205     0.4330668        0.3094435\n#> 3          0.6114393     0.4215686        0.3496066\n#> 4          0.7293266     0.4587379        0.3119735\n#> 5          0.6171679     0.2330508        0.2825630\n#> 6          0.6029216     0.4210111        0.3598690\n#>   T24-C-2_Moere T24-C-2_Troendelag T24-C-2_Troms\n#> 1    0.54901961          0.4368867     0.1675386\n#> 2    0.44444444          0.4541667     0.3560888\n#> 3    0.21217105          0.3388889     0.3933333\n#> 4    0.52314815          0.3593750     0.3803165\n#> 5    0.22222222          0.2401961     0.1985816\n#> 6    0.08496732          0.6305257     0.2599206\n#>   T24-C-2_Finnmark   T29-C-1   T29-C-2   T29-C-3   T29-C-4\n#> 1        0.2533113 0.4000000 0.2106061 0.1629790 0.3508230\n#> 2        0.5125369 0.3782051 0.4335956 0.1383435 0.2924837\n#> 3        0.3229491 0.5128205 0.1657688 0.1739201 0.2762557\n#> 4        0.3774663 0.3484848 0.2364865 0.1962779 0.2156863\n#> 5        0.4353499 0.5894309 0.2523840 0.1219386 0.3700565\n#> 6        0.2934783 0.4429825 0.2853027 0.1561419 0.3246124\n#>     T29-C-5   T29-C-6\n#> 1 0.5268670 0.3347458\n#> 2 0.4388802 0.3237705\n#> 3 0.6453824 0.2886335\n#> 4 0.4484266 0.5535714\n#> 5 0.4876657 0.4451220\n#> 6 0.4409456 0.5347222#>  [1] \"T2-C-1\"             \"T2-C-2\"            \n#>  [3] \"T2-C-3\"             \"T2-C-4\"            \n#>  [5] \"T2-C-5\"             \"T2-C-6\"            \n#>  [7] \"T2-C-7\"             \"T2-C-8\"            \n#>  [9] \"T2-C-7_BN\"          \"T2-C-8_BN\"         \n#> [11] \"T8-C-1\"             \"T8-C-2\"            \n#> [13] \"T8-C-3\"             \"T11-C-1\"           \n#> [15] \"T11-C-2\"            \"T12-C-1\"           \n#> [17] \"T12-C-2\"            \"T13-C-1\"           \n#> [19] \"T13-C-2\"            \"T13-C-3\"           \n#> [21] \"T13-C-4\"            \"T13-C-5\"           \n#> [23] \"T13-C-6\"            \"T13-C-7\"           \n#> [25] \"T13-C-8\"            \"T13-C-9\"           \n#> [27] \"T13-C-10\"           \"T13-C-11\"          \n#> [29] \"T13-C-12\"           \"T13-C-13\"          \n#> [31] \"T13-C-14\"           \"T13-C-15\"          \n#> [33] \"T15\"                \"T15-Bratli21\"      \n#> [35] \"T16-C-1\"            \"T16-C-2\"           \n#> [37] \"T16-C-3\"            \"T16-C-4\"           \n#> [39] \"T16-C-5\"            \"T16-C-6\"           \n#> [41] \"T16-C-7\"            \"T18-C-1\"           \n#> [43] \"T18-C-2\"            \"T18-C-3\"           \n#> [45] \"T18-C-4\"            \"T21-C-1\"           \n#> [47] \"T21-C-2\"            \"T21-C-3\"           \n#> [49] \"T21-C-4\"            \"T21-7\"             \n#> [51] \"T24-C-1_samlet\"     \"T24-C-2_samlet\"    \n#> [53] \"T24-C-1_Moere\"      \"T24-C-1_Troendelag\"\n#> [55] \"T24-C-1_Troms\"      \"T24-C-1_Finnmark\"  \n#> [57] \"T24-C-2_Moere\"      \"T24-C-2_Troendelag\"\n#> [59] \"T24-C-2_Troms\"      \"T24-C-2_Finnmark\"  \n#> [61] \"T29-C-1\"            \"T29-C-2\"           \n#> [63] \"T29-C-3\"            \"T29-C-4\"           \n#> [65] \"T29-C-5\"            \"T29-C-6\"\n#>  [1] \"T2-C-1\"             \"T2-C-2\"            \n#>  [3] \"T2-C-3\"             \"T2-C-4\"            \n#>  [5] \"T2-C-5\"             \"T2-C-6\"            \n#>  [7] \"T2-C-7\"             \"T2-C-8\"            \n#>  [9] \"T2-C-7_BN\"          \"T2-C-8_BN\"         \n#> [11] \"T8-C-1\"             \"T8-C-2\"            \n#> [13] \"T8-C-3\"             \"T11-C-1\"           \n#> [15] \"T11-C-2\"            \"T12-C-1\"           \n#> [17] \"T12-C-2\"            \"T13-C-1\"           \n#> [19] \"T13-C-2\"            \"T13-C-3\"           \n#> [21] \"T13-C-4\"            \"T13-C-5\"           \n#> [23] \"T13-C-6\"            \"T13-C-7\"           \n#> [25] \"T13-C-8\"            \"T13-C-9\"           \n#> [27] \"T13-C-10\"           \"T13-C-11\"          \n#> [29] \"T13-C-12\"           \"T13-C-13\"          \n#> [31] \"T13-C-14\"           \"T13-C-15\"          \n#> [33] \"T15\"                \"T15-Bratli21\"      \n#> [35] \"T16-C-1\"            \"T16-C-2\"           \n#> [37] \"T16-C-3\"            \"T16-C-4\"           \n#> [39] \"T16-C-5\"            \"T16-C-6\"           \n#> [41] \"T16-C-7\"            \"T18-C-1\"           \n#> [43] \"T18-C-2\"            \"T18-C-3\"           \n#> [45] \"T18-C-4\"            \"T21-C-1\"           \n#> [47] \"T21-C-2\"            \"T21-C-3\"           \n#> [49] \"T21-C-4\"            \"T21-7\"             \n#> [51] \"T24-C-1_samlet\"     \"T24-C-2_samlet\"    \n#> [53] \"T24-C-1_Moere\"      \"T24-C-1_Troendelag\"\n#> [55] \"T24-C-1_Troms\"      \"T24-C-1_Finnmark\"  \n#> [57] \"T24-C-2_Moere\"      \"T24-C-2_Troendelag\"\n#> [59] \"T24-C-2_Troms\"      \"T24-C-2_Finnmark\"  \n#> [61] \"T29-C-1\"            \"T29-C-2\"           \n#> [63] \"T29-C-3\"            \"T29-C-4\"           \n#> [65] \"T29-C-5\"            \"T29-C-6\"\n#>            V1         V2        V3          V4         V5\n#> 1  0.08766832 0.21872555 0.3888889 0.496031746 0.67063492\n#> 2  0.05382353 0.19671091 0.2843487 0.428523810 0.65859351\n#> 3  0.03753882 0.17141992 0.3920588 0.329815301 0.56470638\n#> 4  0.02523850 0.12230736 0.1929744 0.327729100 0.56582778\n#> 5  0.10919903 0.20897488 0.3380892 0.360701100 0.52346972\n#> 6  0.01706577 0.09912008 0.2559378 0.435242751 0.58410216\n#> 7  0.15620537 0.25719120 0.3652055 0.441457929 0.55090793\n#> 8  0.18061362 0.25018911 0.3382194 0.470574683 0.57752100\n#> 9  0.10224655 0.20957553 0.3680637 0.462116259 0.57902923\n#> 10 0.07427100 0.17847283 0.3162418 0.463891580 0.60815835\n#> 11 0.09300746 0.21488110 0.3695652 0.155108025 0.33333333\n#> 12         NA         NA        NA          NA         NA\n#> 13 0.02525253 0.15415885 0.2878788 0.346414806 0.56818182\n#> 14         NA         NA        NA          NA         NA\n#> 15         NA         NA        NA          NA         NA\n#> 16         NA         NA        NA          NA         NA\n#> 17 0.29060240 0.40597466 0.5529830 0.155818787 0.25215467\n#> 18         NA         NA        NA          NA         NA\n#> 19         NA         NA        NA          NA         NA\n#> 20         NA         NA        NA          NA         NA\n#> 21         NA         NA        NA          NA         NA\n#> 22 0.08130081 0.16666667 0.2682927 0.405053266 0.58333333\n#> 23 0.04382799 0.18405797 0.3087121 0.346037866 0.50505301\n#> 24 0.01230389 0.25000000 0.5833333 0.207409555 0.57507473\n#> 25 0.08130081 0.18292683 0.3191057 0.416666667 0.61111111\n#> 26 0.12457912 0.20114943 0.3516536 0.326849857 0.55962644\n#> 27         NA         NA        NA          NA         NA\n#> 28         NA         NA        NA          NA         NA\n#> 29         NA         NA        NA          NA         NA\n#> 30         NA         NA        NA          NA         NA\n#> 31         NA         NA        NA          NA         NA\n#> 32         NA         NA        NA          NA         NA\n#> 33 0.24499059 0.36111111 0.5139583 0.233295494 0.40638940\n#> 34 0.25060905 0.29379425 0.3820887 0.435684880 0.53193205\n#> 35 0.16234299 0.25693620 0.3766281 0.279155891 0.47113943\n#> 36 0.16357485 0.28641287 0.4200559 0.310350085 0.48381744\n#> 37 0.14811000 0.23896199 0.3637605 0.378845415 0.49905906\n#> 38 0.14713231 0.25527663 0.3812905 0.376717790 0.52809611\n#> 39 0.27060801 0.41732082 0.6757135 0.164448153 0.34122203\n#> 40 0.28533155 0.45307881 0.6803745 0.195725145 0.35596430\n#> 41 0.09935897 0.30450974 0.5769421 0.222222223 0.43693694\n#> 42 0.24251435 0.44391944 0.6280931 0.164932380 0.35012504\n#> 43 0.16710152 0.34454332 0.5191094 0.034689455 0.14347518\n#> 44         NA         NA        NA          NA         NA\n#> 45         NA         NA        NA          NA         NA\n#> 46 0.18793380 0.37662986 0.5758055 0.030067155 0.27795685\n#> 47 0.30130530 0.39989343 0.4976052 0.345761792 0.44474045\n#> 48 0.17262831 0.27771966 0.3958725 0.343577594 0.46802992\n#> 49 0.19120164 0.34709012 0.5028986 0.125478216 0.36723930\n#> 50 0.08967567 0.25972603 0.4213119 0.201083409 0.42210487\n#> 51 0.30003882 0.48453591 0.6419169 0.024354072 0.11784811\n#> 52 0.15736725 0.34885701 0.5663918 0.002446965 0.07598784\n#> 53 0.27298739 0.48333123 0.6615657 0.024361766 0.12427942\n#> 54 0.31163533 0.56287224 0.7379600 0.011030933 0.12438130\n#> 55 0.21169666 0.39119214 0.5782941 0.016121596 0.16962269\n#> 56 0.17771697 0.36777152 0.5187301 0.008425297 0.16703751\n#> 57 0.12745098 0.43629763 0.6548144 0.000000000 0.07921569\n#> 58 0.18848759 0.44182390 0.6936776 0.004898777 0.09975386\n#> 59 0.18384737 0.32321389 0.4251799 0.001579779 0.08695652\n#> 60 0.25007982 0.41887963 0.5943766 0.032845002 0.16601732\n#> 61 0.18415773 0.37098021 0.5758081 0.092580409 0.23484848\n#> 62 0.20707442 0.33291604 0.4557148 0.389448156 0.52754059\n#> 63 0.09585174 0.16486025 0.2532998 0.407042639 0.55685255\n#> 64 0.08778217 0.21052632 0.3721359 0.261498756 0.46883828\n#> 65 0.31088700 0.46304153 0.6264738 0.029733603 0.13930852\n#> 66 0.23213639 0.41569491 0.6266744 0.038280536 0.21708726\n#>           V6          V7        V8        V9      V10\n#> 1  0.7447321 0.005735723 0.1120774 0.2870716 2.834613\n#> 2  0.7797668 0.000000000 0.1597796 0.4084967 3.330579\n#> 3  0.7936851 0.025321138 0.2359968 0.5696107 3.156486\n#> 4  0.7665337 0.120574240 0.3157958 0.5338759 4.606769\n#> 5  0.6916941 0.110983810 0.2541142 0.4559565 4.453310\n#> 6  0.7786876 0.105434160 0.2957560 0.5040567 4.712980\n#> 7  0.6738322 0.091546770 0.1914806 0.2923935 4.862638\n#> 8  0.6974140 0.063927305 0.1672794 0.2924579 4.984373\n#> 9  0.7524761 0.079745942 0.1926481 0.3330141 4.701733\n#> 10 0.7909958 0.086004879 0.1957826 0.3493089 4.956422\n#> 11 0.5245331 0.270036376 0.4404762 0.6581973 4.415000\n#> 12        NA          NA        NA        NA       NA\n#> 13 0.8055556 0.134583333 0.2727273 0.4356260 4.816806\n#> 14        NA          NA        NA        NA       NA\n#> 15        NA          NA        NA        NA       NA\n#> 16        NA          NA        NA        NA       NA\n#> 17 0.3795203 0.219522914 0.3350895 0.4297591 5.162242\n#> 18        NA          NA        NA        NA       NA\n#> 19        NA          NA        NA        NA       NA\n#> 20        NA          NA        NA        NA       NA\n#> 21        NA          NA        NA        NA       NA\n#> 22 0.8211382 0.055555556 0.2357724 0.3821839 2.804878\n#> 23 0.6409212 0.185886752 0.3148770 0.4666543 4.294758\n#> 24 0.9799197 0.005020080 0.1224490 0.3413906 3.036145\n#> 25 0.8373984 0.032520325 0.1944444 0.3678862 3.333333\n#> 26 0.7223420 0.126375456 0.2347561 0.3679465 4.242424\n#> 27        NA          NA        NA        NA       NA\n#> 28        NA          NA        NA        NA       NA\n#> 29        NA          NA        NA        NA       NA\n#> 30        NA          NA        NA        NA       NA\n#> 31        NA          NA        NA        NA       NA\n#> 32        NA          NA        NA        NA       NA\n#> 33 0.5608236 0.126061321 0.2291667 0.3338492 3.420904\n#> 34 0.5983096 0.132100093 0.1703649 0.2101719 3.762917\n#> 35 0.6395535 0.109208892 0.2639093 0.4881055 4.279944\n#> 36 0.6822968 0.088539009 0.2158678 0.3912413 4.477555\n#> 37 0.6267098 0.135197412 0.2567565 0.3992098 4.193298\n#> 38 0.6744551 0.105401613 0.2161034 0.3386715 4.286509\n#> 39 0.5311081 0.077056285 0.2169817 0.3704522 4.227666\n#> 40 0.5174475 0.066329446 0.1792464 0.3124922 4.050876\n#> 41 0.6388889 0.070914473 0.2432432 0.4722917 4.564932\n#> 42 0.5758203 0.065786151 0.2005232 0.3851419 4.617633\n#> 43 0.2708425 0.333205756 0.5148968 0.6731078 4.511375\n#> 44        NA          NA        NA        NA       NA\n#> 45        NA          NA        NA        NA       NA\n#> 46 0.5039078 0.041433288 0.3179337 0.7070889 4.781331\n#> 47 0.5660524 0.070192195 0.1516556 0.2346538 5.788984\n#> 48 0.6043919 0.141816620 0.2483754 0.3762084 4.872919\n#> 49 0.5924905 0.099946196 0.2991857 0.4475722 5.043468\n#> 50 0.7521036 0.124964235 0.3083632 0.4529543 5.105344\n#> 51 0.2372093 0.229556384 0.3944126 0.6167403 4.945497\n#> 52 0.2706975 0.313574049 0.5493960 0.8096174 4.529733\n#> 53 0.2937690 0.154204634 0.3714276 0.6352384 4.763961\n#> 54 0.2939938 0.134245220 0.2958759 0.5954819 4.706109\n#> 55 0.3192162 0.281787839 0.4100370 0.7030475 4.519067\n#> 56 0.3858288 0.166140141 0.4659604 0.7632445 4.719671\n#> 57 0.3000000 0.250000000 0.4632166 0.8236928 4.250000\n#> 58 0.2720318 0.225054113 0.4420727 0.7138526 4.521594\n#> 59 0.2343690 0.396525204 0.5961376 0.7989570 5.478092\n#> 60 0.3089442 0.216024611 0.4026184 0.6433525 4.601372\n#> 61 0.4650319 0.176704546 0.3775510 0.5943713 3.939242\n#> 62 0.6801921 0.045448503 0.1371601 0.2354948 4.082042\n#> 63 0.7022056 0.164400765 0.2714242 0.3981789 5.478967\n#> 64 0.6618873 0.192436558 0.3117091 0.4538495 5.557103\n#> 65 0.2829305 0.251389541 0.3843212 0.5527090 4.919260\n#> 66 0.4524256 0.203657407 0.3519559 0.5327743 5.309729\n#>         V11      V12      V13      V14      V15      V16\n#> 1  4.476190 5.389009 1.666667 2.600000 3.717514 2.054054\n#> 2  4.880952 6.285714 1.235294 2.333333 3.470588 2.000000\n#> 3  4.814227 6.011573 1.916576 3.275345 4.450445 2.110920\n#> 4  5.737986 6.666667 1.818617 3.000000 4.319588 3.385196\n#> 5  5.247586 6.009061 2.647226 3.556649 4.822016 2.976882\n#> 6  5.721032 6.641097 2.463591 3.173645 4.187576 3.409615\n#> 7  5.539673 6.282584 2.838162 3.369092 4.049901 2.972562\n#> 8  5.680120 6.113998 2.727575 3.094241 3.496544 3.947285\n#> 9  5.551775 6.342671 2.963358 3.348366 3.825764 2.758179\n#> 10 5.741075 6.514043 2.998198 3.372142 3.815734 3.155511\n#> 11 5.407785 6.333673 3.632551 4.842105 6.076923 2.682520\n#> 12       NA       NA       NA       NA       NA       NA\n#> 13 5.971691 6.769318 2.333333 4.000000 5.480121 2.499745\n#> 14       NA       NA       NA       NA       NA       NA\n#> 15       NA       NA       NA       NA       NA       NA\n#> 16       NA       NA       NA       NA       NA       NA\n#> 17 5.429241 5.705945 3.722993 4.576458 5.442697 2.486205\n#> 18       NA       NA       NA       NA       NA       NA\n#> 19       NA       NA       NA       NA       NA       NA\n#> 20       NA       NA       NA       NA       NA       NA\n#> 21       NA       NA       NA       NA       NA       NA\n#> 22 4.844828 6.451293 3.000000 3.804878 5.634146 1.780488\n#> 23 5.210157 6.570921 2.999832 3.925928 4.612375 2.744836\n#> 24 4.258065 6.015283 1.845266 3.489796 6.000000 2.333163\n#> 25 5.000000 6.568966 3.000000 3.706897 4.804878 2.568966\n#> 26 5.197828 6.128086 2.422414 3.656566 4.677020 2.585859\n#> 27       NA       NA       NA       NA       NA       NA\n#> 28       NA       NA       NA       NA       NA       NA\n#> 29       NA       NA       NA       NA       NA       NA\n#> 30       NA       NA       NA       NA       NA       NA\n#> 31       NA       NA       NA       NA       NA       NA\n#> 32       NA       NA       NA       NA       NA       NA\n#> 33 4.434783 5.000000 4.681067 5.597872 6.511206 1.671995\n#> 34 4.104077 4.410747 4.693984 5.173043 5.651100 1.896863\n#> 35 5.000000 5.654848 2.510243 3.773156 4.928668 2.380929\n#> 36 5.101882 5.756967 2.522576 3.740369 4.880149 2.302267\n#> 37 4.921653 5.716938 2.822584 3.761088 4.495396 2.808479\n#> 38 4.960372 5.627944 2.657396 3.635066 4.433828 2.974881\n#> 39 4.847752 5.361825 4.159384 5.327030 6.326673 2.184895\n#> 40 4.726896 5.272624 4.027343 5.281717 6.555162 2.195281\n#> 41 5.428571 6.428968 2.917080 4.125000 5.700357 2.222101\n#> 42 5.160636 5.685656 3.354103 4.747317 5.881711 1.831488\n#> 43 5.208685 6.091255 4.317818 5.290616 6.354692 3.237734\n#> 44       NA       NA       NA       NA       NA       NA\n#> 45       NA       NA       NA       NA       NA       NA\n#> 46 6.316456 6.960317 3.580813 5.775142 8.484127 2.160844\n#> 47 6.246117 6.731249 4.259699 4.912874 5.755123 2.975682\n#> 48 5.464732 6.041276 3.111765 3.898314 4.765610 2.652346\n#> 49 5.513848 5.978263 1.981775 3.889614 5.489779 2.203449\n#> 50 5.727173 6.695663 2.530103 3.672057 4.754403 2.168740\n#> 51 5.632478 6.356044 5.136618 6.428801 7.627357 2.701516\n#> 52 5.579246 6.759379 4.574493 6.587573 8.351996 2.832766\n#> 53 5.591324 6.445831 4.955440 6.442319 7.663058 2.390914\n#> 54 5.573011 6.542760 4.623751 6.212592 7.290282 2.036044\n#> 55 5.335195 6.419427 4.653704 6.111111 7.662631 2.273312\n#> 56 5.787640 6.837309 4.465035 6.256079 8.057582 2.504946\n#> 57 5.330579 6.851852 4.500000 6.076923 7.825870 2.148016\n#> 58 5.389459 6.435125 4.493949 5.812383 7.548410 2.434490\n#> 59 6.299593 6.953990 6.277632 7.632523 8.743697 5.038970\n#> 60 5.439271 6.415611 4.695587 6.115232 7.736712 2.262829\n#> 61 5.133333 6.067273 3.749671 5.060606 6.500000 2.710071\n#> 62 4.997702 5.616845 3.677237 4.428342 5.141886 2.197448\n#> 63 5.974999 6.456638 2.594755 3.178488 3.779111 3.306645\n#> 64 6.140688 6.679142 2.866538 3.606447 4.550026 3.049985\n#> 65 5.695322 6.442589 4.824208 6.132208 7.365500 2.874646\n#> 66 6.073837 6.787213 3.594940 5.460067 7.587204 2.462940\n#>         V17      V18                NiN\n#> 1  3.475383 4.809472             T2-C-1\n#> 2  3.846154 6.500000             T2-C-2\n#> 3  3.677023 5.589687             T2-C-3\n#> 4  5.333333 7.119332             T2-C-4\n#> 5  4.272900 5.555851             T2-C-5\n#> 6  5.145120 6.823120             T2-C-6\n#> 7  4.031481 4.994144             T2-C-7\n#> 8  5.060515 5.910220             T2-C-8\n#> 9  4.107361 5.479319          T2-C-7_BN\n#> 10 4.321785 5.578610          T2-C-8_BN\n#> 11 4.428571 6.470861             T8-C-1\n#> 12       NA       NA             T8-C-2\n#> 13 3.900000 5.483190             T8-C-3\n#> 14       NA       NA            T11-C-1\n#> 15       NA       NA            T11-C-2\n#> 16       NA       NA            T12-C-1\n#> 17 3.259703 4.238748            T12-C-2\n#> 18       NA       NA            T13-C-1\n#> 19       NA       NA            T13-C-2\n#> 20       NA       NA            T13-C-3\n#> 21       NA       NA            T13-C-4\n#> 22 3.195122 5.439024            T13-C-5\n#> 23 4.501678 6.289810            T13-C-6\n#> 24 4.000000 5.757576            T13-C-7\n#> 25 3.431034 5.439024            T13-C-8\n#> 26 4.068966 5.711590            T13-C-9\n#> 27       NA       NA           T13-C-10\n#> 28       NA       NA           T13-C-11\n#> 29       NA       NA           T13-C-12\n#> 30       NA       NA           T13-C-13\n#> 31       NA       NA           T13-C-14\n#> 32       NA       NA           T13-C-15\n#> 33 2.340711 3.281270                T15\n#> 34 2.177064 2.625147       T15-Bratli21\n#> 35 3.402128 4.625284            T16-C-1\n#> 36 3.253731 4.430699            T16-C-2\n#> 37 3.773531 4.921042            T16-C-3\n#> 38 3.978725 5.140815            T16-C-4\n#> 39 3.079133 4.308136            T16-C-5\n#> 40 2.894178 4.023432            T16-C-6\n#> 41 3.900226 6.250000            T16-C-7\n#> 42 2.498695 4.353716            T18-C-1\n#> 43 5.170566 6.784790            T18-C-2\n#> 44       NA       NA            T18-C-3\n#> 45       NA       NA            T18-C-4\n#> 46 4.508028 8.460971            T21-C-1\n#> 47 3.722446 4.647642            T21-C-2\n#> 48 3.340359 4.316478            T21-C-3\n#> 49 3.351073 5.322171            T21-C-4\n#> 50 3.117752 5.087087              T21-7\n#> 51 4.729340 7.042814     T24-C-1_samlet\n#> 52 6.345262 8.671942     T24-C-2_samlet\n#> 53 4.506373 7.018260      T24-C-1_Moere\n#> 54 3.605463 6.500132 T24-C-1_Troendelag\n#> 55 4.543918 7.594822      T24-C-1_Troms\n#> 56 5.626185 8.421311   T24-C-1_Finnmark\n#> 57 5.857143 8.412131      T24-C-2_Moere\n#> 58 5.298468 7.661147 T24-C-2_Troendelag\n#> 59 7.116970 8.825881      T24-C-2_Troms\n#> 60 4.447006 7.028946   T24-C-2_Finnmark\n#> 61 4.635255 6.266731            T29-C-1\n#> 62 2.940788 3.848218            T29-C-2\n#> 63 4.396006 5.545852            T29-C-3\n#> 64 4.403716 5.870871            T29-C-4\n#> 65 4.542380 6.352717            T29-C-5\n#> 66 4.569048 7.142719            T29-C-6\n#> [1] 66 19\n#>      V1   V2   V3   V4   V5   V6   V7   V8   V9  V10  V11\n#> 1  0.09 0.22 0.39 0.50 0.67 0.74 0.01 0.11 0.29 2.83 4.48\n#> 2  0.05 0.20 0.28 0.43 0.66 0.78 0.00 0.16 0.41 3.33 4.88\n#> 3  0.04 0.17 0.39 0.33 0.56 0.79 0.03 0.24 0.57 3.16 4.81\n#> 4  0.03 0.12 0.19 0.33 0.57 0.77 0.12 0.32 0.53 4.61 5.74\n#> 5  0.11 0.21 0.34 0.36 0.52 0.69 0.11 0.25 0.46 4.45 5.25\n#> 6  0.02 0.10 0.26 0.44 0.58 0.78 0.11 0.30 0.50 4.71 5.72\n#> 7  0.16 0.26 0.37 0.44 0.55 0.67 0.09 0.19 0.29 4.86 5.54\n#> 8  0.18 0.25 0.34 0.47 0.58 0.70 0.06 0.17 0.29 4.98 5.68\n#> 9  0.10 0.21 0.37 0.46 0.58 0.75 0.08 0.19 0.33 4.70 5.55\n#> 10 0.07 0.18 0.32 0.46 0.61 0.79 0.09 0.20 0.35 4.96 5.74\n#> 11 0.09 0.21 0.37 0.16 0.33 0.52 0.27 0.44 0.66 4.42 5.41\n#> 12   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA\n#> 13 0.03 0.15 0.29 0.35 0.57 0.81 0.13 0.27 0.44 4.82 5.97\n#> 14   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA\n#> 15   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA\n#> 16   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA\n#> 17 0.29 0.41 0.55 0.16 0.25 0.38 0.22 0.34 0.43 5.16 5.43\n#> 18   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA\n#> 19   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA\n#> 20   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA\n#> 21   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA\n#> 22 0.08 0.17 0.27 0.41 0.58 0.82 0.06 0.24 0.38 2.80 4.84\n#> 23 0.04 0.18 0.31 0.35 0.51 0.64 0.19 0.31 0.47 4.29 5.21\n#> 24 0.01 0.25 0.58 0.21 0.58 0.98 0.01 0.12 0.34 3.04 4.26\n#> 25 0.08 0.18 0.32 0.42 0.61 0.84 0.03 0.19 0.37 3.33 5.00\n#> 26 0.12 0.20 0.35 0.33 0.56 0.72 0.13 0.23 0.37 4.24 5.20\n#> 27   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA\n#> 28   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA\n#> 29   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA\n#> 30   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA\n#> 31   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA\n#> 32   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA\n#> 33 0.24 0.36 0.51 0.23 0.41 0.56 0.13 0.23 0.33 3.42 4.43\n#> 34 0.25 0.29 0.38 0.44 0.53 0.60 0.13 0.17 0.21 3.76 4.10\n#> 35 0.16 0.26 0.38 0.28 0.47 0.64 0.11 0.26 0.49 4.28 5.00\n#> 36 0.16 0.29 0.42 0.31 0.48 0.68 0.09 0.22 0.39 4.48 5.10\n#> 37 0.15 0.24 0.36 0.38 0.50 0.63 0.14 0.26 0.40 4.19 4.92\n#> 38 0.15 0.26 0.38 0.38 0.53 0.67 0.11 0.22 0.34 4.29 4.96\n#> 39 0.27 0.42 0.68 0.16 0.34 0.53 0.08 0.22 0.37 4.23 4.85\n#> 40 0.29 0.45 0.68 0.20 0.36 0.52 0.07 0.18 0.31 4.05 4.73\n#> 41 0.10 0.30 0.58 0.22 0.44 0.64 0.07 0.24 0.47 4.56 5.43\n#> 42 0.24 0.44 0.63 0.16 0.35 0.58 0.07 0.20 0.39 4.62 5.16\n#> 43 0.17 0.34 0.52 0.03 0.14 0.27 0.33 0.51 0.67 4.51 5.21\n#> 44   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA\n#> 45   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA\n#> 46 0.19 0.38 0.58 0.03 0.28 0.50 0.04 0.32 0.71 4.78 6.32\n#> 47 0.30 0.40 0.50 0.35 0.44 0.57 0.07 0.15 0.23 5.79 6.25\n#> 48 0.17 0.28 0.40 0.34 0.47 0.60 0.14 0.25 0.38 4.87 5.46\n#> 49 0.19 0.35 0.50 0.13 0.37 0.59 0.10 0.30 0.45 5.04 5.51\n#> 50 0.09 0.26 0.42 0.20 0.42 0.75 0.12 0.31 0.45 5.11 5.73\n#> 51 0.30 0.48 0.64 0.02 0.12 0.24 0.23 0.39 0.62 4.95 5.63\n#> 52 0.16 0.35 0.57 0.00 0.08 0.27 0.31 0.55 0.81 4.53 5.58\n#> 53 0.27 0.48 0.66 0.02 0.12 0.29 0.15 0.37 0.64 4.76 5.59\n#> 54 0.31 0.56 0.74 0.01 0.12 0.29 0.13 0.30 0.60 4.71 5.57\n#> 55 0.21 0.39 0.58 0.02 0.17 0.32 0.28 0.41 0.70 4.52 5.34\n#> 56 0.18 0.37 0.52 0.01 0.17 0.39 0.17 0.47 0.76 4.72 5.79\n#> 57 0.13 0.44 0.65 0.00 0.08 0.30 0.25 0.46 0.82 4.25 5.33\n#> 58 0.19 0.44 0.69 0.00 0.10 0.27 0.23 0.44 0.71 4.52 5.39\n#> 59 0.18 0.32 0.43 0.00 0.09 0.23 0.40 0.60 0.80 5.48 6.30\n#> 60 0.25 0.42 0.59 0.03 0.17 0.31 0.22 0.40 0.64 4.60 5.44\n#> 61 0.18 0.37 0.58 0.09 0.23 0.47 0.18 0.38 0.59 3.94 5.13\n#> 62 0.21 0.33 0.46 0.39 0.53 0.68 0.05 0.14 0.24 4.08 5.00\n#> 63 0.10 0.16 0.25 0.41 0.56 0.70 0.16 0.27 0.40 5.48 5.97\n#> 64 0.09 0.21 0.37 0.26 0.47 0.66 0.19 0.31 0.45 5.56 6.14\n#> 65 0.31 0.46 0.63 0.03 0.14 0.28 0.25 0.38 0.55 4.92 5.70\n#> 66 0.23 0.42 0.63 0.04 0.22 0.45 0.20 0.35 0.53 5.31 6.07\n#>     V12  V13  V14  V15  V16  V17  V18\n#> 1  5.39 1.67 2.60 3.72 2.05 3.48 4.81\n#> 2  6.29 1.24 2.33 3.47 2.00 3.85 6.50\n#> 3  6.01 1.92 3.28 4.45 2.11 3.68 5.59\n#> 4  6.67 1.82 3.00 4.32 3.39 5.33 7.12\n#> 5  6.01 2.65 3.56 4.82 2.98 4.27 5.56\n#> 6  6.64 2.46 3.17 4.19 3.41 5.15 6.82\n#> 7  6.28 2.84 3.37 4.05 2.97 4.03 4.99\n#> 8  6.11 2.73 3.09 3.50 3.95 5.06 5.91\n#> 9  6.34 2.96 3.35 3.83 2.76 4.11 5.48\n#> 10 6.51 3.00 3.37 3.82 3.16 4.32 5.58\n#> 11 6.33 3.63 4.84 6.08 2.68 4.43 6.47\n#> 12   NA   NA   NA   NA   NA   NA   NA\n#> 13 6.77 2.33 4.00 5.48 2.50 3.90 5.48\n#> 14   NA   NA   NA   NA   NA   NA   NA\n#> 15   NA   NA   NA   NA   NA   NA   NA\n#> 16   NA   NA   NA   NA   NA   NA   NA\n#> 17 5.71 3.72 4.58 5.44 2.49 3.26 4.24\n#> 18   NA   NA   NA   NA   NA   NA   NA\n#> 19   NA   NA   NA   NA   NA   NA   NA\n#> 20   NA   NA   NA   NA   NA   NA   NA\n#> 21   NA   NA   NA   NA   NA   NA   NA\n#> 22 6.45 3.00 3.80 5.63 1.78 3.20 5.44\n#> 23 6.57 3.00 3.93 4.61 2.74 4.50 6.29\n#> 24 6.02 1.85 3.49 6.00 2.33 4.00 5.76\n#> 25 6.57 3.00 3.71 4.80 2.57 3.43 5.44\n#> 26 6.13 2.42 3.66 4.68 2.59 4.07 5.71\n#> 27   NA   NA   NA   NA   NA   NA   NA\n#> 28   NA   NA   NA   NA   NA   NA   NA\n#> 29   NA   NA   NA   NA   NA   NA   NA\n#> 30   NA   NA   NA   NA   NA   NA   NA\n#> 31   NA   NA   NA   NA   NA   NA   NA\n#> 32   NA   NA   NA   NA   NA   NA   NA\n#> 33 5.00 4.68 5.60 6.51 1.67 2.34 3.28\n#> 34 4.41 4.69 5.17 5.65 1.90 2.18 2.63\n#> 35 5.65 2.51 3.77 4.93 2.38 3.40 4.63\n#> 36 5.76 2.52 3.74 4.88 2.30 3.25 4.43\n#> 37 5.72 2.82 3.76 4.50 2.81 3.77 4.92\n#> 38 5.63 2.66 3.64 4.43 2.97 3.98 5.14\n#> 39 5.36 4.16 5.33 6.33 2.18 3.08 4.31\n#> 40 5.27 4.03 5.28 6.56 2.20 2.89 4.02\n#> 41 6.43 2.92 4.12 5.70 2.22 3.90 6.25\n#> 42 5.69 3.35 4.75 5.88 1.83 2.50 4.35\n#> 43 6.09 4.32 5.29 6.35 3.24 5.17 6.78\n#> 44   NA   NA   NA   NA   NA   NA   NA\n#> 45   NA   NA   NA   NA   NA   NA   NA\n#> 46 6.96 3.58 5.78 8.48 2.16 4.51 8.46\n#> 47 6.73 4.26 4.91 5.76 2.98 3.72 4.65\n#> 48 6.04 3.11 3.90 4.77 2.65 3.34 4.32\n#> 49 5.98 1.98 3.89 5.49 2.20 3.35 5.32\n#> 50 6.70 2.53 3.67 4.75 2.17 3.12 5.09\n#> 51 6.36 5.14 6.43 7.63 2.70 4.73 7.04\n#> 52 6.76 4.57 6.59 8.35 2.83 6.35 8.67\n#> 53 6.45 4.96 6.44 7.66 2.39 4.51 7.02\n#> 54 6.54 4.62 6.21 7.29 2.04 3.61 6.50\n#> 55 6.42 4.65 6.11 7.66 2.27 4.54 7.59\n#> 56 6.84 4.47 6.26 8.06 2.50 5.63 8.42\n#> 57 6.85 4.50 6.08 7.83 2.15 5.86 8.41\n#> 58 6.44 4.49 5.81 7.55 2.43 5.30 7.66\n#> 59 6.95 6.28 7.63 8.74 5.04 7.12 8.83\n#> 60 6.42 4.70 6.12 7.74 2.26 4.45 7.03\n#> 61 6.07 3.75 5.06 6.50 2.71 4.64 6.27\n#> 62 5.62 3.68 4.43 5.14 2.20 2.94 3.85\n#> 63 6.46 2.59 3.18 3.78 3.31 4.40 5.55\n#> 64 6.68 2.87 3.61 4.55 3.05 4.40 5.87\n#> 65 6.44 4.82 6.13 7.37 2.87 4.54 6.35\n#> 66 6.79 3.59 5.46 7.59 2.46 4.57 7.14\n#>     CC_q2.5            CC_q50           CC_q97.5     \n#>  Min.   :0.01230   Min.   :0.09912   Min.   :0.1930  \n#>  1st Qu.:0.09051   1st Qu.:0.20981   1st Qu.:0.3641  \n#>  Median :0.16296   Median :0.29010   Median :0.4232  \n#>  Mean   :0.16039   Mean   :0.30412   Mean   :0.4635  \n#>  3rd Qu.:0.22703   3rd Qu.:0.39772   3rd Qu.:0.5780  \n#>  Max.   :0.31163   Max.   :0.56287   Max.   :0.7380  \n#>  NA's   :16        NA's   :16        NA's   :16      \n#>     SS_q2.5            SS_q50           SS_q97.5     \n#>  Min.   :0.00000   Min.   :0.07599   Min.   :0.2344  \n#>  1st Qu.:0.03559   1st Qu.:0.22153   1st Qu.:0.4025  \n#>  Median :0.24740   Median :0.45638   Median :0.6156  \n#>  Mean   :0.23524   Mean   :0.39509   Mean   :0.5735  \n#>  3rd Qu.:0.37831   3rd Qu.:0.55893   3rd Qu.:0.7173  \n#>  Max.   :0.49603   Max.   :0.67063   Max.   :0.9799  \n#>  NA's   :16        NA's   :16        NA's   :16      \n#>     RR_q2.5            RR_q50          RR_q97.5     \n#>  Min.   :0.00000   Min.   :0.1121   Min.   :0.2102  \n#>  1st Qu.:0.07245   1st Qu.:0.2044   1st Qu.:0.3679  \n#>  Median :0.12551   Median :0.2677   Median :0.4503  \n#>  Mean   :0.13816   Mean   :0.2906   Mean   :0.4788  \n#>  3rd Qu.:0.19080   3rd Qu.:0.3666   3rd Qu.:0.5952  \n#>  Max.   :0.39653   Max.   :0.5961   Max.   :0.8237  \n#>  NA's   :16        NA's   :16       NA's   :16      \n#>    Light_q2.5      Light_q50      Light_q97.5   \n#>  Min.   :2.805   Min.   :4.104   Min.   :4.411  \n#>  1st Qu.:4.231   1st Qu.:5.000   1st Qu.:5.986  \n#>  Median :4.547   Median :5.418   Median :6.349  \n#>  Mean   :4.460   Mean   :5.357   Mean   :6.206  \n#>  3rd Qu.:4.870   3rd Qu.:5.692   3rd Qu.:6.570  \n#>  Max.   :5.789   Max.   :6.316   Max.   :6.960  \n#>  NA's   :16      NA's   :16      NA's   :16     \n#>  Nitrogen_q2.5    Nitrogen_q50   Nitrogen_q97.5 \n#>  Min.   :1.235   Min.   :2.333   Min.   :3.471  \n#>  1st Qu.:2.608   1st Qu.:3.614   1st Qu.:4.566  \n#>  Median :3.056   Median :4.062   Median :5.562  \n#>  Mean   :3.401   Mean   :4.545   Mean   :5.746  \n#>  3rd Qu.:4.428   3rd Qu.:5.563   3rd Qu.:7.107  \n#>  Max.   :6.278   Max.   :7.633   Max.   :8.744  \n#>  NA's   :16      NA's   :16      NA's   :16     \n#>  Soil_disturbance_q2.5 Soil_disturbance_q50\n#>  Min.   :1.672         Min.   :2.177       \n#>  1st Qu.:2.196         1st Qu.:3.409       \n#>  Median :2.493         Median :4.050       \n#>  Mean   :2.591         Mean   :4.123       \n#>  3rd Qu.:2.864         3rd Qu.:4.544       \n#>  Max.   :5.039         Max.   :7.117       \n#>  NA's   :16            NA's   :16          \n#>  Soil_disturbance_q97.5     NiN           \n#>  Min.   :2.625          Length:66         \n#>  1st Qu.:4.939          Class :character  \n#>  Median :5.651          Mode  :character  \n#>  Mean   :5.879                            \n#>  3rd Qu.:6.814                            \n#>  Max.   :8.826                            \n#>  NA's   :16\n#>  [1] \"T2-C-1\"             \"T2-C-2\"            \n#>  [3] \"T2-C-3\"             \"T2-C-4\"            \n#>  [5] \"T2-C-5\"             \"T2-C-6\"            \n#>  [7] \"T2-C-7\"             \"T2-C-8\"            \n#>  [9] \"T2-C-7_BN\"          \"T2-C-8_BN\"         \n#> [11] \"T8-C-1\"             \"T8-C-2\"            \n#> [13] \"T8-C-3\"             \"T11-C-1\"           \n#> [15] \"T11-C-2\"            \"T12-C-1\"           \n#> [17] \"T12-C-2\"            \"T13-C-1\"           \n#> [19] \"T13-C-2\"            \"T13-C-3\"           \n#> [21] \"T13-C-4\"            \"T13-C-5\"           \n#> [23] \"T13-C-6\"            \"T13-C-7\"           \n#> [25] \"T13-C-8\"            \"T13-C-9\"           \n#> [27] \"T13-C-10\"           \"T13-C-11\"          \n#> [29] \"T13-C-12\"           \"T13-C-13\"          \n#> [31] \"T13-C-14\"           \"T13-C-15\"          \n#> [33] \"T15\"                \"T15-Bratli21\"      \n#> [35] \"T16-C-1\"            \"T16-C-2\"           \n#> [37] \"T16-C-3\"            \"T16-C-4\"           \n#> [39] \"T16-C-5\"            \"T16-C-6\"           \n#> [41] \"T16-C-7\"            \"T18-C-1\"           \n#> [43] \"T18-C-2\"            \"T18-C-3\"           \n#> [45] \"T18-C-4\"            \"T21-C-1\"           \n#> [47] \"T21-C-2\"            \"T21-C-3\"           \n#> [49] \"T21-C-4\"            \"T21-7\"             \n#> [51] \"T24-C-1_samlet\"     \"T24-C-2_samlet\"    \n#> [53] \"T24-C-1_Moere\"      \"T24-C-1_Troendelag\"\n#> [55] \"T24-C-1_Troms\"      \"T24-C-1_Finnmark\"  \n#> [57] \"T24-C-2_Moere\"      \"T24-C-2_Troendelag\"\n#> [59] \"T24-C-2_Troms\"      \"T24-C-2_Finnmark\"  \n#> [61] \"T29-C-1\"            \"T29-C-2\"           \n#> [63] \"T29-C-3\"            \"T29-C-4\"           \n#> [65] \"T29-C-5\"            \"T29-C-6\"\n#>       CC_q2.5     CC_q50  CC_q97.5     SS_q2.5     SS_q50\n#> 1  0.08766832 0.21872555 0.3888889 0.496031746 0.67063492\n#> 2  0.05382353 0.19671091 0.2843487 0.428523810 0.65859351\n#> 3  0.03753882 0.17141992 0.3920588 0.329815301 0.56470638\n#> 4  0.02523850 0.12230736 0.1929744 0.327729100 0.56582778\n#> 5  0.10919903 0.20897488 0.3380892 0.360701100 0.52346972\n#> 6  0.01706577 0.09912008 0.2559378 0.435242751 0.58410216\n#> 7  0.15620537 0.25719120 0.3652055 0.441457929 0.55090793\n#> 8  0.18061362 0.25018911 0.3382194 0.470574683 0.57752100\n#> 9  0.10224655 0.20957553 0.3680637 0.462116259 0.57902923\n#> 10 0.07427100 0.17847283 0.3162418 0.463891580 0.60815835\n#> 11 0.09300746 0.21488110 0.3695652 0.155108025 0.33333333\n#> 12         NA         NA        NA          NA         NA\n#> 13 0.02525253 0.15415885 0.2878788 0.346414806 0.56818182\n#> 14         NA         NA        NA          NA         NA\n#> 15         NA         NA        NA          NA         NA\n#> 16         NA         NA        NA          NA         NA\n#> 17 0.29060240 0.40597466 0.5529830 0.155818787 0.25215467\n#> 18         NA         NA        NA          NA         NA\n#> 19         NA         NA        NA          NA         NA\n#> 20         NA         NA        NA          NA         NA\n#> 21         NA         NA        NA          NA         NA\n#> 22 0.08130081 0.16666667 0.2682927 0.405053266 0.58333333\n#> 23 0.04382799 0.18405797 0.3087121 0.346037866 0.50505301\n#> 24 0.01230389 0.25000000 0.5833333 0.207409555 0.57507473\n#> 25 0.08130081 0.18292683 0.3191057 0.416666667 0.61111111\n#> 26 0.12457912 0.20114943 0.3516536 0.326849857 0.55962644\n#> 27         NA         NA        NA          NA         NA\n#> 28         NA         NA        NA          NA         NA\n#> 29         NA         NA        NA          NA         NA\n#> 30         NA         NA        NA          NA         NA\n#> 31         NA         NA        NA          NA         NA\n#> 32         NA         NA        NA          NA         NA\n#> 33 0.24499059 0.36111111 0.5139583 0.233295494 0.40638940\n#> 34 0.25060905 0.29379425 0.3820887 0.435684880 0.53193205\n#> 35 0.16234299 0.25693620 0.3766281 0.279155891 0.47113943\n#> 36 0.16357485 0.28641287 0.4200559 0.310350085 0.48381744\n#> 37 0.14811000 0.23896199 0.3637605 0.378845415 0.49905906\n#> 38 0.14713231 0.25527663 0.3812905 0.376717790 0.52809611\n#> 39 0.27060801 0.41732082 0.6757135 0.164448153 0.34122203\n#> 40 0.28533155 0.45307881 0.6803745 0.195725145 0.35596430\n#> 41 0.09935897 0.30450974 0.5769421 0.222222223 0.43693694\n#> 42 0.24251435 0.44391944 0.6280931 0.164932380 0.35012504\n#> 43 0.16710152 0.34454332 0.5191094 0.034689455 0.14347518\n#> 44         NA         NA        NA          NA         NA\n#> 45         NA         NA        NA          NA         NA\n#> 46 0.18793380 0.37662986 0.5758055 0.030067155 0.27795685\n#> 47 0.30130530 0.39989343 0.4976052 0.345761792 0.44474045\n#> 48 0.17262831 0.27771966 0.3958725 0.343577594 0.46802992\n#> 49 0.19120164 0.34709012 0.5028986 0.125478216 0.36723930\n#> 50 0.08967567 0.25972603 0.4213119 0.201083409 0.42210487\n#> 51 0.30003882 0.48453591 0.6419169 0.024354072 0.11784811\n#> 52 0.15736725 0.34885701 0.5663918 0.002446965 0.07598784\n#> 53 0.27298739 0.48333123 0.6615657 0.024361766 0.12427942\n#> 54 0.31163533 0.56287224 0.7379600 0.011030933 0.12438130\n#> 55 0.21169666 0.39119214 0.5782941 0.016121596 0.16962269\n#> 56 0.17771697 0.36777152 0.5187301 0.008425297 0.16703751\n#> 57 0.12745098 0.43629763 0.6548144 0.000000000 0.07921569\n#> 58 0.18848759 0.44182390 0.6936776 0.004898777 0.09975386\n#> 59 0.18384737 0.32321389 0.4251799 0.001579779 0.08695652\n#> 60 0.25007982 0.41887963 0.5943766 0.032845002 0.16601732\n#> 61 0.18415773 0.37098021 0.5758081 0.092580409 0.23484848\n#> 62 0.20707442 0.33291604 0.4557148 0.389448156 0.52754059\n#> 63 0.09585174 0.16486025 0.2532998 0.407042639 0.55685255\n#> 64 0.08778217 0.21052632 0.3721359 0.261498756 0.46883828\n#> 65 0.31088700 0.46304153 0.6264738 0.029733603 0.13930852\n#> 66 0.23213639 0.41569491 0.6266744 0.038280536 0.21708726\n#>     SS_q97.5     RR_q2.5    RR_q50  RR_q97.5 Light_q2.5\n#> 1  0.7447321 0.005735723 0.1120774 0.2870716   2.834613\n#> 2  0.7797668 0.000000000 0.1597796 0.4084967   3.330579\n#> 3  0.7936851 0.025321138 0.2359968 0.5696107   3.156486\n#> 4  0.7665337 0.120574240 0.3157958 0.5338759   4.606769\n#> 5  0.6916941 0.110983810 0.2541142 0.4559565   4.453310\n#> 6  0.7786876 0.105434160 0.2957560 0.5040567   4.712980\n#> 7  0.6738322 0.091546770 0.1914806 0.2923935   4.862638\n#> 8  0.6974140 0.063927305 0.1672794 0.2924579   4.984373\n#> 9  0.7524761 0.079745942 0.1926481 0.3330141   4.701733\n#> 10 0.7909958 0.086004879 0.1957826 0.3493089   4.956422\n#> 11 0.5245331 0.270036376 0.4404762 0.6581973   4.415000\n#> 12        NA          NA        NA        NA         NA\n#> 13 0.8055556 0.134583333 0.2727273 0.4356260   4.816806\n#> 14        NA          NA        NA        NA         NA\n#> 15        NA          NA        NA        NA         NA\n#> 16        NA          NA        NA        NA         NA\n#> 17 0.3795203 0.219522914 0.3350895 0.4297591   5.162242\n#> 18        NA          NA        NA        NA         NA\n#> 19        NA          NA        NA        NA         NA\n#> 20        NA          NA        NA        NA         NA\n#> 21        NA          NA        NA        NA         NA\n#> 22 0.8211382 0.055555556 0.2357724 0.3821839   2.804878\n#> 23 0.6409212 0.185886752 0.3148770 0.4666543   4.294758\n#> 24 0.9799197 0.005020080 0.1224490 0.3413906   3.036145\n#> 25 0.8373984 0.032520325 0.1944444 0.3678862   3.333333\n#> 26 0.7223420 0.126375456 0.2347561 0.3679465   4.242424\n#> 27        NA          NA        NA        NA         NA\n#> 28        NA          NA        NA        NA         NA\n#> 29        NA          NA        NA        NA         NA\n#> 30        NA          NA        NA        NA         NA\n#> 31        NA          NA        NA        NA         NA\n#> 32        NA          NA        NA        NA         NA\n#> 33 0.5608236 0.126061321 0.2291667 0.3338492   3.420904\n#> 34 0.5983096 0.132100093 0.1703649 0.2101719   3.762917\n#> 35 0.6395535 0.109208892 0.2639093 0.4881055   4.279944\n#> 36 0.6822968 0.088539009 0.2158678 0.3912413   4.477555\n#> 37 0.6267098 0.135197412 0.2567565 0.3992098   4.193298\n#> 38 0.6744551 0.105401613 0.2161034 0.3386715   4.286509\n#> 39 0.5311081 0.077056285 0.2169817 0.3704522   4.227666\n#> 40 0.5174475 0.066329446 0.1792464 0.3124922   4.050876\n#> 41 0.6388889 0.070914473 0.2432432 0.4722917   4.564932\n#> 42 0.5758203 0.065786151 0.2005232 0.3851419   4.617633\n#> 43 0.2708425 0.333205756 0.5148968 0.6731078   4.511375\n#> 44        NA          NA        NA        NA         NA\n#> 45        NA          NA        NA        NA         NA\n#> 46 0.5039078 0.041433288 0.3179337 0.7070889   4.781331\n#> 47 0.5660524 0.070192195 0.1516556 0.2346538   5.788984\n#> 48 0.6043919 0.141816620 0.2483754 0.3762084   4.872919\n#> 49 0.5924905 0.099946196 0.2991857 0.4475722   5.043468\n#> 50 0.7521036 0.124964235 0.3083632 0.4529543   5.105344\n#> 51 0.2372093 0.229556384 0.3944126 0.6167403   4.945497\n#> 52 0.2706975 0.313574049 0.5493960 0.8096174   4.529733\n#> 53 0.2937690 0.154204634 0.3714276 0.6352384   4.763961\n#> 54 0.2939938 0.134245220 0.2958759 0.5954819   4.706109\n#> 55 0.3192162 0.281787839 0.4100370 0.7030475   4.519067\n#> 56 0.3858288 0.166140141 0.4659604 0.7632445   4.719671\n#> 57 0.3000000 0.250000000 0.4632166 0.8236928   4.250000\n#> 58 0.2720318 0.225054113 0.4420727 0.7138526   4.521594\n#> 59 0.2343690 0.396525204 0.5961376 0.7989570   5.478092\n#> 60 0.3089442 0.216024611 0.4026184 0.6433525   4.601372\n#> 61 0.4650319 0.176704546 0.3775510 0.5943713   3.939242\n#> 62 0.6801921 0.045448503 0.1371601 0.2354948   4.082042\n#> 63 0.7022056 0.164400765 0.2714242 0.3981789   5.478967\n#> 64 0.6618873 0.192436558 0.3117091 0.4538495   5.557103\n#> 65 0.2829305 0.251389541 0.3843212 0.5527090   4.919260\n#> 66 0.4524256 0.203657407 0.3519559 0.5327743   5.309729\n#>    Light_q50 Light_q97.5 Nitrogen_q2.5 Nitrogen_q50\n#> 1   4.476190    5.389009      1.666667     2.600000\n#> 2   4.880952    6.285714      1.235294     2.333333\n#> 3   4.814227    6.011573      1.916576     3.275345\n#> 4   5.737986    6.666667      1.818617     3.000000\n#> 5   5.247586    6.009061      2.647226     3.556649\n#> 6   5.721032    6.641097      2.463591     3.173645\n#> 7   5.539673    6.282584      2.838162     3.369092\n#> 8   5.680120    6.113998      2.727575     3.094241\n#> 9   5.551775    6.342671      2.963358     3.348366\n#> 10  5.741075    6.514043      2.998198     3.372142\n#> 11  5.407785    6.333673      3.632551     4.842105\n#> 12        NA          NA            NA           NA\n#> 13  5.971691    6.769318      2.333333     4.000000\n#> 14        NA          NA            NA           NA\n#> 15        NA          NA            NA           NA\n#> 16        NA          NA            NA           NA\n#> 17  5.429241    5.705945      3.722993     4.576458\n#> 18        NA          NA            NA           NA\n#> 19        NA          NA            NA           NA\n#> 20        NA          NA            NA           NA\n#> 21        NA          NA            NA           NA\n#> 22  4.844828    6.451293      3.000000     3.804878\n#> 23  5.210157    6.570921      2.999832     3.925928\n#> 24  4.258065    6.015283      1.845266     3.489796\n#> 25  5.000000    6.568966      3.000000     3.706897\n#> 26  5.197828    6.128086      2.422414     3.656566\n#> 27        NA          NA            NA           NA\n#> 28        NA          NA            NA           NA\n#> 29        NA          NA            NA           NA\n#> 30        NA          NA            NA           NA\n#> 31        NA          NA            NA           NA\n#> 32        NA          NA            NA           NA\n#> 33  4.434783    5.000000      4.681067     5.597872\n#> 34  4.104077    4.410747      4.693984     5.173043\n#> 35  5.000000    5.654848      2.510243     3.773156\n#> 36  5.101882    5.756967      2.522576     3.740369\n#> 37  4.921653    5.716938      2.822584     3.761088\n#> 38  4.960372    5.627944      2.657396     3.635066\n#> 39  4.847752    5.361825      4.159384     5.327030\n#> 40  4.726896    5.272624      4.027343     5.281717\n#> 41  5.428571    6.428968      2.917080     4.125000\n#> 42  5.160636    5.685656      3.354103     4.747317\n#> 43  5.208685    6.091255      4.317818     5.290616\n#> 44        NA          NA            NA           NA\n#> 45        NA          NA            NA           NA\n#> 46  6.316456    6.960317      3.580813     5.775142\n#> 47  6.246117    6.731249      4.259699     4.912874\n#> 48  5.464732    6.041276      3.111765     3.898314\n#> 49  5.513848    5.978263      1.981775     3.889614\n#> 50  5.727173    6.695663      2.530103     3.672057\n#> 51  5.632478    6.356044      5.136618     6.428801\n#> 52  5.579246    6.759379      4.574493     6.587573\n#> 53  5.591324    6.445831      4.955440     6.442319\n#> 54  5.573011    6.542760      4.623751     6.212592\n#> 55  5.335195    6.419427      4.653704     6.111111\n#> 56  5.787640    6.837309      4.465035     6.256079\n#> 57  5.330579    6.851852      4.500000     6.076923\n#> 58  5.389459    6.435125      4.493949     5.812383\n#> 59  6.299593    6.953990      6.277632     7.632523\n#> 60  5.439271    6.415611      4.695587     6.115232\n#> 61  5.133333    6.067273      3.749671     5.060606\n#> 62  4.997702    5.616845      3.677237     4.428342\n#> 63  5.974999    6.456638      2.594755     3.178488\n#> 64  6.140688    6.679142      2.866538     3.606447\n#> 65  5.695322    6.442589      4.824208     6.132208\n#> 66  6.073837    6.787213      3.594940     5.460067\n#>    Nitrogen_q97.5 Soil_disturbance_q2.5\n#> 1        3.717514              2.054054\n#> 2        3.470588              2.000000\n#> 3        4.450445              2.110920\n#> 4        4.319588              3.385196\n#> 5        4.822016              2.976882\n#> 6        4.187576              3.409615\n#> 7        4.049901              2.972562\n#> 8        3.496544              3.947285\n#> 9        3.825764              2.758179\n#> 10       3.815734              3.155511\n#> 11       6.076923              2.682520\n#> 12             NA                    NA\n#> 13       5.480121              2.499745\n#> 14             NA                    NA\n#> 15             NA                    NA\n#> 16             NA                    NA\n#> 17       5.442697              2.486205\n#> 18             NA                    NA\n#> 19             NA                    NA\n#> 20             NA                    NA\n#> 21             NA                    NA\n#> 22       5.634146              1.780488\n#> 23       4.612375              2.744836\n#> 24       6.000000              2.333163\n#> 25       4.804878              2.568966\n#> 26       4.677020              2.585859\n#> 27             NA                    NA\n#> 28             NA                    NA\n#> 29             NA                    NA\n#> 30             NA                    NA\n#> 31             NA                    NA\n#> 32             NA                    NA\n#> 33       6.511206              1.671995\n#> 34       5.651100              1.896863\n#> 35       4.928668              2.380929\n#> 36       4.880149              2.302267\n#> 37       4.495396              2.808479\n#> 38       4.433828              2.974881\n#> 39       6.326673              2.184895\n#> 40       6.555162              2.195281\n#> 41       5.700357              2.222101\n#> 42       5.881711              1.831488\n#> 43       6.354692              3.237734\n#> 44             NA                    NA\n#> 45             NA                    NA\n#> 46       8.484127              2.160844\n#> 47       5.755123              2.975682\n#> 48       4.765610              2.652346\n#> 49       5.489779              2.203449\n#> 50       4.754403              2.168740\n#> 51       7.627357              2.701516\n#> 52       8.351996              2.832766\n#> 53       7.663058              2.390914\n#> 54       7.290282              2.036044\n#> 55       7.662631              2.273312\n#> 56       8.057582              2.504946\n#> 57       7.825870              2.148016\n#> 58       7.548410              2.434490\n#> 59       8.743697              5.038970\n#> 60       7.736712              2.262829\n#> 61       6.500000              2.710071\n#> 62       5.141886              2.197448\n#> 63       3.779111              3.306645\n#> 64       4.550026              3.049985\n#> 65       7.365500              2.874646\n#> 66       7.587204              2.462940\n#>    Soil_disturbance_q50 Soil_disturbance_q97.5\n#> 1              3.475383               4.809472\n#> 2              3.846154               6.500000\n#> 3              3.677023               5.589687\n#> 4              5.333333               7.119332\n#> 5              4.272900               5.555851\n#> 6              5.145120               6.823120\n#> 7              4.031481               4.994144\n#> 8              5.060515               5.910220\n#> 9              4.107361               5.479319\n#> 10             4.321785               5.578610\n#> 11             4.428571               6.470861\n#> 12                   NA                     NA\n#> 13             3.900000               5.483190\n#> 14                   NA                     NA\n#> 15                   NA                     NA\n#> 16                   NA                     NA\n#> 17             3.259703               4.238748\n#> 18                   NA                     NA\n#> 19                   NA                     NA\n#> 20                   NA                     NA\n#> 21                   NA                     NA\n#> 22             3.195122               5.439024\n#> 23             4.501678               6.289810\n#> 24             4.000000               5.757576\n#> 25             3.431034               5.439024\n#> 26             4.068966               5.711590\n#> 27                   NA                     NA\n#> 28                   NA                     NA\n#> 29                   NA                     NA\n#> 30                   NA                     NA\n#> 31                   NA                     NA\n#> 32                   NA                     NA\n#> 33             2.340711               3.281270\n#> 34             2.177064               2.625147\n#> 35             3.402128               4.625284\n#> 36             3.253731               4.430699\n#> 37             3.773531               4.921042\n#> 38             3.978725               5.140815\n#> 39             3.079133               4.308136\n#> 40             2.894178               4.023432\n#> 41             3.900226               6.250000\n#> 42             2.498695               4.353716\n#> 43             5.170566               6.784790\n#> 44                   NA                     NA\n#> 45                   NA                     NA\n#> 46             4.508028               8.460971\n#> 47             3.722446               4.647642\n#> 48             3.340359               4.316478\n#> 49             3.351073               5.322171\n#> 50             3.117752               5.087087\n#> 51             4.729340               7.042814\n#> 52             6.345262               8.671942\n#> 53             4.506373               7.018260\n#> 54             3.605463               6.500132\n#> 55             4.543918               7.594822\n#> 56             5.626185               8.421311\n#> 57             5.857143               8.412131\n#> 58             5.298468               7.661147\n#> 59             7.116970               8.825881\n#> 60             4.447006               7.028946\n#> 61             4.635255               6.266731\n#> 62             2.940788               3.848218\n#> 63             4.396006               5.545852\n#> 64             4.403716               5.870871\n#> 65             4.542380               6.352717\n#> 66             4.569048               7.142719\n#>                   NiN\n#> 1              T2-C-1\n#> 2              T2-C-2\n#> 3              T2-C-3\n#> 4              T2-C-4\n#> 5              T2-C-5\n#> 6              T2-C-6\n#> 7              T2-C-7\n#> 8              T2-C-8\n#> 9           T2-C-7_BN\n#> 10          T2-C-8_BN\n#> 11             T8-C-1\n#> 12             T8-C-2\n#> 13             T8-C-3\n#> 14            T11-C-1\n#> 15            T11-C-2\n#> 16            T12-C-1\n#> 17            T12-C-2\n#> 18            T13-C-1\n#> 19            T13-C-2\n#> 20            T13-C-3\n#> 21            T13-C-4\n#> 22            T13-C-5\n#> 23            T13-C-6\n#> 24            T13-C-7\n#> 25            T13-C-8\n#> 26            T13-C-9\n#> 27           T13-C-10\n#> 28           T13-C-11\n#> 29           T13-C-12\n#> 30           T13-C-13\n#> 31           T13-C-14\n#> 32           T13-C-15\n#> 33                T15\n#> 34       T15-Bratli21\n#> 35            T16-C-1\n#> 36            T16-C-2\n#> 37            T16-C-3\n#> 38            T16-C-4\n#> 39            T16-C-5\n#> 40            T16-C-6\n#> 41            T16-C-7\n#> 42            T18-C-1\n#> 43            T18-C-2\n#> 44            T18-C-3\n#> 45            T18-C-4\n#> 46            T21-C-1\n#> 47            T21-C-2\n#> 48            T21-C-3\n#> 49            T21-C-4\n#> 50              T21-7\n#> 51     T24-C-1_samlet\n#> 52     T24-C-2_samlet\n#> 53      T24-C-1_Moere\n#> 54 T24-C-1_Troendelag\n#> 55      T24-C-1_Troms\n#> 56   T24-C-1_Finnmark\n#> 57      T24-C-2_Moere\n#> 58 T24-C-2_Troendelag\n#> 59      T24-C-2_Troms\n#> 60   T24-C-2_Finnmark\n#> 61            T29-C-1\n#> 62            T29-C-2\n#> 63            T29-C-3\n#> 64            T29-C-4\n#> 65            T29-C-5\n#> 66            T29-C-6\n#>          N1 hoved              grunn county region\n#> 1   natopen    NA             T2-C-1    all    all\n#> 2   natopen    NA             T2-C-1    all    all\n#> 3   natopen    NA             T2-C-2    all    all\n#> 4   natopen    NA             T2-C-2    all    all\n#> 5   natopen    NA             T2-C-3    all    all\n#> 6   natopen    NA             T2-C-3    all    all\n#> 7   natopen    NA             T2-C-4    all    all\n#> 8   natopen    NA             T2-C-4    all    all\n#> 9   natopen    NA             T2-C-5    all    all\n#> 10  natopen    NA             T2-C-5    all    all\n#> 11  natopen    NA             T2-C-6    all    all\n#> 12  natopen    NA             T2-C-6    all    all\n#> 13  natopen    NA             T2-C-7    all    all\n#> 14  natopen    NA             T2-C-7    all    all\n#> 15  natopen    NA             T2-C-8    all    all\n#> 16  natopen    NA             T2-C-8    all    all\n#> 17  natopen    NA          T2-C-7_BN    all    all\n#> 18  natopen    NA          T2-C-7_BN    all    all\n#> 19  natopen    NA          T2-C-8_BN    all    all\n#> 20  natopen    NA          T2-C-8_BN    all    all\n#> 21  natopen    NA             T8-C-1    all    all\n#> 22  natopen    NA             T8-C-1    all    all\n#> 23  natopen    NA             T8-C-2    all    all\n#> 24  natopen    NA             T8-C-2    all    all\n#> 25  natopen    NA             T8-C-3    all    all\n#> 26  natopen    NA             T8-C-3    all    all\n#> 27  natopen    NA            T11-C-1    all    all\n#> 28  natopen    NA            T11-C-1    all    all\n#> 29  natopen    NA            T11-C-2    all    all\n#> 30  natopen    NA            T11-C-2    all    all\n#> 31  natopen    NA            T12-C-1    all    all\n#> 32  natopen    NA            T12-C-1    all    all\n#> 33  natopen    NA            T12-C-2    all    all\n#> 34  natopen    NA            T12-C-2    all    all\n#> 35  natopen    NA            T13-C-1    all    all\n#> 36  natopen    NA            T13-C-1    all    all\n#> 37  natopen    NA            T13-C-2    all    all\n#> 38  natopen    NA            T13-C-2    all    all\n#> 39  natopen    NA            T13-C-3    all    all\n#> 40  natopen    NA            T13-C-3    all    all\n#> 41  natopen    NA            T13-C-4    all    all\n#> 42  natopen    NA            T13-C-4    all    all\n#> 43  natopen    NA            T13-C-5    all    all\n#> 44  natopen    NA            T13-C-5    all    all\n#> 45  natopen    NA            T13-C-6    all    all\n#> 46  natopen    NA            T13-C-6    all    all\n#> 47  natopen    NA            T13-C-7    all    all\n#> 48  natopen    NA            T13-C-7    all    all\n#> 49  natopen    NA            T13-C-8    all    all\n#> 50  natopen    NA            T13-C-8    all    all\n#> 51  natopen    NA            T13-C-9    all    all\n#> 52  natopen    NA            T13-C-9    all    all\n#> 53  natopen    NA           T13-C-10    all    all\n#> 54  natopen    NA           T13-C-10    all    all\n#> 55  natopen    NA           T13-C-11    all    all\n#> 56  natopen    NA           T13-C-11    all    all\n#> 57  natopen    NA           T13-C-12    all    all\n#> 58  natopen    NA           T13-C-12    all    all\n#> 59  natopen    NA           T13-C-13    all    all\n#> 60  natopen    NA           T13-C-13    all    all\n#> 61  natopen    NA           T13-C-14    all    all\n#> 62  natopen    NA           T13-C-14    all    all\n#> 63  natopen    NA           T13-C-15    all    all\n#> 64  natopen    NA           T13-C-15    all    all\n#> 65  natopen    NA                T15    all    all\n#> 66  natopen    NA                T15    all    all\n#> 67  natopen    NA       T15-Bratli21    all    all\n#> 68  natopen    NA       T15-Bratli21    all    all\n#> 69  natopen    NA            T16-C-1    all    all\n#> 70  natopen    NA            T16-C-1    all    all\n#> 71  natopen    NA            T16-C-2    all    all\n#> 72  natopen    NA            T16-C-2    all    all\n#> 73  natopen    NA            T16-C-3    all    all\n#> 74  natopen    NA            T16-C-3    all    all\n#> 75  natopen    NA            T16-C-4    all    all\n#> 76  natopen    NA            T16-C-4    all    all\n#> 77  natopen    NA            T16-C-5    all    all\n#> 78  natopen    NA            T16-C-5    all    all\n#> 79  natopen    NA            T16-C-6    all    all\n#> 80  natopen    NA            T16-C-6    all    all\n#> 81  natopen    NA            T16-C-7    all    all\n#> 82  natopen    NA            T16-C-7    all    all\n#> 83  natopen    NA            T18-C-1    all    all\n#> 84  natopen    NA            T18-C-1    all    all\n#> 85  natopen    NA            T18-C-2    all    all\n#> 86  natopen    NA            T18-C-2    all    all\n#> 87  natopen    NA            T18-C-3    all    all\n#> 88  natopen    NA            T18-C-3    all    all\n#> 89  natopen    NA            T18-C-4    all    all\n#> 90  natopen    NA            T18-C-4    all    all\n#> 91  natopen    NA            T21-C-1    all    all\n#> 92  natopen    NA            T21-C-1    all    all\n#> 93  natopen    NA            T21-C-2    all    all\n#> 94  natopen    NA            T21-C-2    all    all\n#> 95  natopen    NA            T21-C-3    all    all\n#> 96  natopen    NA            T21-C-3    all    all\n#> 97  natopen    NA            T21-C-4    all    all\n#> 98  natopen    NA            T21-C-4    all    all\n#> 99  natopen    NA              T21-7    all    all\n#> 100 natopen    NA              T21-7    all    all\n#> 101 natopen    NA     T24-C-1_samlet    all    all\n#> 102 natopen    NA     T24-C-1_samlet    all    all\n#> 103 natopen    NA     T24-C-2_samlet    all    all\n#> 104 natopen    NA     T24-C-2_samlet    all    all\n#> 105 natopen    NA      T24-C-1_Moere    all    all\n#> 106 natopen    NA      T24-C-1_Moere    all    all\n#> 107 natopen    NA T24-C-1_Troendelag    all    all\n#> 108 natopen    NA T24-C-1_Troendelag    all    all\n#> 109 natopen    NA      T24-C-1_Troms    all    all\n#> 110 natopen    NA      T24-C-1_Troms    all    all\n#> 111 natopen    NA   T24-C-1_Finnmark    all    all\n#> 112 natopen    NA   T24-C-1_Finnmark    all    all\n#> 113 natopen    NA      T24-C-2_Moere    all    all\n#> 114 natopen    NA      T24-C-2_Moere    all    all\n#> 115 natopen    NA T24-C-2_Troendelag    all    all\n#> 116 natopen    NA T24-C-2_Troendelag    all    all\n#> 117 natopen    NA      T24-C-2_Troms    all    all\n#> 118 natopen    NA      T24-C-2_Troms    all    all\n#> 119 natopen    NA   T24-C-2_Finnmark    all    all\n#> 120 natopen    NA   T24-C-2_Finnmark    all    all\n#> 121 natopen    NA            T29-C-1    all    all\n#> 122 natopen    NA            T29-C-1    all    all\n#> 123 natopen    NA            T29-C-2    all    all\n#> 124 natopen    NA            T29-C-2    all    all\n#> 125 natopen    NA            T29-C-3    all    all\n#> 126 natopen    NA            T29-C-3    all    all\n#> 127 natopen    NA            T29-C-4    all    all\n#> 128 natopen    NA            T29-C-4    all    all\n#> 129 natopen    NA            T29-C-5    all    all\n#> 130 natopen    NA            T29-C-5    all    all\n#> 131 natopen    NA            T29-C-6    all    all\n#> 132 natopen    NA            T29-C-6    all    all\n#> 133 natopen    NA             T2-C-1    all    all\n#> 134 natopen    NA             T2-C-1    all    all\n#> 135 natopen    NA             T2-C-2    all    all\n#> 136 natopen    NA             T2-C-2    all    all\n#> 137 natopen    NA             T2-C-3    all    all\n#> 138 natopen    NA             T2-C-3    all    all\n#> 139 natopen    NA             T2-C-4    all    all\n#> 140 natopen    NA             T2-C-4    all    all\n#> 141 natopen    NA             T2-C-5    all    all\n#> 142 natopen    NA             T2-C-5    all    all\n#> 143 natopen    NA             T2-C-6    all    all\n#> 144 natopen    NA             T2-C-6    all    all\n#> 145 natopen    NA             T2-C-7    all    all\n#> 146 natopen    NA             T2-C-7    all    all\n#> 147 natopen    NA             T2-C-8    all    all\n#> 148 natopen    NA             T2-C-8    all    all\n#> 149 natopen    NA          T2-C-7_BN    all    all\n#> 150 natopen    NA          T2-C-7_BN    all    all\n#> 151 natopen    NA          T2-C-8_BN    all    all\n#> 152 natopen    NA          T2-C-8_BN    all    all\n#> 153 natopen    NA             T8-C-1    all    all\n#> 154 natopen    NA             T8-C-1    all    all\n#> 155 natopen    NA             T8-C-2    all    all\n#> 156 natopen    NA             T8-C-2    all    all\n#> 157 natopen    NA             T8-C-3    all    all\n#> 158 natopen    NA             T8-C-3    all    all\n#> 159 natopen    NA            T11-C-1    all    all\n#> 160 natopen    NA            T11-C-1    all    all\n#> 161 natopen    NA            T11-C-2    all    all\n#> 162 natopen    NA            T11-C-2    all    all\n#> 163 natopen    NA            T12-C-1    all    all\n#> 164 natopen    NA            T12-C-1    all    all\n#> 165 natopen    NA            T12-C-2    all    all\n#> 166 natopen    NA            T12-C-2    all    all\n#> 167 natopen    NA            T13-C-1    all    all\n#> 168 natopen    NA            T13-C-1    all    all\n#> 169 natopen    NA            T13-C-2    all    all\n#> 170 natopen    NA            T13-C-2    all    all\n#> 171 natopen    NA            T13-C-3    all    all\n#> 172 natopen    NA            T13-C-3    all    all\n#> 173 natopen    NA            T13-C-4    all    all\n#> 174 natopen    NA            T13-C-4    all    all\n#> 175 natopen    NA            T13-C-5    all    all\n#> 176 natopen    NA            T13-C-5    all    all\n#> 177 natopen    NA            T13-C-6    all    all\n#> 178 natopen    NA            T13-C-6    all    all\n#> 179 natopen    NA            T13-C-7    all    all\n#> 180 natopen    NA            T13-C-7    all    all\n#> 181 natopen    NA            T13-C-8    all    all\n#> 182 natopen    NA            T13-C-8    all    all\n#> 183 natopen    NA            T13-C-9    all    all\n#> 184 natopen    NA            T13-C-9    all    all\n#> 185 natopen    NA           T13-C-10    all    all\n#> 186 natopen    NA           T13-C-10    all    all\n#> 187 natopen    NA           T13-C-11    all    all\n#> 188 natopen    NA           T13-C-11    all    all\n#> 189 natopen    NA           T13-C-12    all    all\n#> 190 natopen    NA           T13-C-12    all    all\n#> 191 natopen    NA           T13-C-13    all    all\n#> 192 natopen    NA           T13-C-13    all    all\n#> 193 natopen    NA           T13-C-14    all    all\n#> 194 natopen    NA           T13-C-14    all    all\n#> 195 natopen    NA           T13-C-15    all    all\n#> 196 natopen    NA           T13-C-15    all    all\n#> 197 natopen    NA                T15    all    all\n#> 198 natopen    NA                T15    all    all\n#> 199 natopen    NA       T15-Bratli21    all    all\n#> 200 natopen    NA       T15-Bratli21    all    all\n#> 201 natopen    NA            T16-C-1    all    all\n#> 202 natopen    NA            T16-C-1    all    all\n#> 203 natopen    NA            T16-C-2    all    all\n#> 204 natopen    NA            T16-C-2    all    all\n#> 205 natopen    NA            T16-C-3    all    all\n#> 206 natopen    NA            T16-C-3    all    all\n#> 207 natopen    NA            T16-C-4    all    all\n#> 208 natopen    NA            T16-C-4    all    all\n#> 209 natopen    NA            T16-C-5    all    all\n#> 210 natopen    NA            T16-C-5    all    all\n#> 211 natopen    NA            T16-C-6    all    all\n#> 212 natopen    NA            T16-C-6    all    all\n#> 213 natopen    NA            T16-C-7    all    all\n#> 214 natopen    NA            T16-C-7    all    all\n#> 215 natopen    NA            T18-C-1    all    all\n#> 216 natopen    NA            T18-C-1    all    all\n#> 217 natopen    NA            T18-C-2    all    all\n#> 218 natopen    NA            T18-C-2    all    all\n#> 219 natopen    NA            T18-C-3    all    all\n#> 220 natopen    NA            T18-C-3    all    all\n#> 221 natopen    NA            T18-C-4    all    all\n#> 222 natopen    NA            T18-C-4    all    all\n#> 223 natopen    NA            T21-C-1    all    all\n#> 224 natopen    NA            T21-C-1    all    all\n#> 225 natopen    NA            T21-C-2    all    all\n#> 226 natopen    NA            T21-C-2    all    all\n#> 227 natopen    NA            T21-C-3    all    all\n#> 228 natopen    NA            T21-C-3    all    all\n#> 229 natopen    NA            T21-C-4    all    all\n#> 230 natopen    NA            T21-C-4    all    all\n#> 231 natopen    NA              T21-7    all    all\n#> 232 natopen    NA              T21-7    all    all\n#> 233 natopen    NA     T24-C-1_samlet    all    all\n#> 234 natopen    NA     T24-C-1_samlet    all    all\n#> 235 natopen    NA     T24-C-2_samlet    all    all\n#> 236 natopen    NA     T24-C-2_samlet    all    all\n#> 237 natopen    NA      T24-C-1_Moere    all    all\n#> 238 natopen    NA      T24-C-1_Moere    all    all\n#> 239 natopen    NA T24-C-1_Troendelag    all    all\n#> 240 natopen    NA T24-C-1_Troendelag    all    all\n#> 241 natopen    NA      T24-C-1_Troms    all    all\n#> 242 natopen    NA      T24-C-1_Troms    all    all\n#> 243 natopen    NA   T24-C-1_Finnmark    all    all\n#> 244 natopen    NA   T24-C-1_Finnmark    all    all\n#> 245 natopen    NA      T24-C-2_Moere    all    all\n#> 246 natopen    NA      T24-C-2_Moere    all    all\n#> 247 natopen    NA T24-C-2_Troendelag    all    all\n#> 248 natopen    NA T24-C-2_Troendelag    all    all\n#> 249 natopen    NA      T24-C-2_Troms    all    all\n#> 250 natopen    NA      T24-C-2_Troms    all    all\n#> 251 natopen    NA   T24-C-2_Finnmark    all    all\n#> 252 natopen    NA   T24-C-2_Finnmark    all    all\n#> 253 natopen    NA            T29-C-1    all    all\n#> 254 natopen    NA            T29-C-1    all    all\n#> 255 natopen    NA            T29-C-2    all    all\n#> 256 natopen    NA            T29-C-2    all    all\n#> 257 natopen    NA            T29-C-3    all    all\n#> 258 natopen    NA            T29-C-3    all    all\n#> 259 natopen    NA            T29-C-4    all    all\n#> 260 natopen    NA            T29-C-4    all    all\n#> 261 natopen    NA            T29-C-5    all    all\n#> 262 natopen    NA            T29-C-5    all    all\n#> 263 natopen    NA            T29-C-6    all    all\n#> 264 natopen    NA            T29-C-6    all    all\n#> 265 natopen    NA             T2-C-1    all    all\n#> 266 natopen    NA             T2-C-1    all    all\n#> 267 natopen    NA             T2-C-2    all    all\n#> 268 natopen    NA             T2-C-2    all    all\n#> 269 natopen    NA             T2-C-3    all    all\n#> 270 natopen    NA             T2-C-3    all    all\n#> 271 natopen    NA             T2-C-4    all    all\n#> 272 natopen    NA             T2-C-4    all    all\n#> 273 natopen    NA             T2-C-5    all    all\n#> 274 natopen    NA             T2-C-5    all    all\n#> 275 natopen    NA             T2-C-6    all    all\n#> 276 natopen    NA             T2-C-6    all    all\n#> 277 natopen    NA             T2-C-7    all    all\n#> 278 natopen    NA             T2-C-7    all    all\n#> 279 natopen    NA             T2-C-8    all    all\n#> 280 natopen    NA             T2-C-8    all    all\n#> 281 natopen    NA          T2-C-7_BN    all    all\n#> 282 natopen    NA          T2-C-7_BN    all    all\n#> 283 natopen    NA          T2-C-8_BN    all    all\n#> 284 natopen    NA          T2-C-8_BN    all    all\n#> 285 natopen    NA             T8-C-1    all    all\n#> 286 natopen    NA             T8-C-1    all    all\n#> 287 natopen    NA             T8-C-2    all    all\n#> 288 natopen    NA             T8-C-2    all    all\n#> 289 natopen    NA             T8-C-3    all    all\n#> 290 natopen    NA             T8-C-3    all    all\n#> 291 natopen    NA            T11-C-1    all    all\n#> 292 natopen    NA            T11-C-1    all    all\n#> 293 natopen    NA            T11-C-2    all    all\n#> 294 natopen    NA            T11-C-2    all    all\n#> 295 natopen    NA            T12-C-1    all    all\n#> 296 natopen    NA            T12-C-1    all    all\n#> 297 natopen    NA            T12-C-2    all    all\n#> 298 natopen    NA            T12-C-2    all    all\n#> 299 natopen    NA            T13-C-1    all    all\n#> 300 natopen    NA            T13-C-1    all    all\n#> 301 natopen    NA            T13-C-2    all    all\n#> 302 natopen    NA            T13-C-2    all    all\n#> 303 natopen    NA            T13-C-3    all    all\n#> 304 natopen    NA            T13-C-3    all    all\n#> 305 natopen    NA            T13-C-4    all    all\n#> 306 natopen    NA            T13-C-4    all    all\n#> 307 natopen    NA            T13-C-5    all    all\n#> 308 natopen    NA            T13-C-5    all    all\n#> 309 natopen    NA            T13-C-6    all    all\n#> 310 natopen    NA            T13-C-6    all    all\n#> 311 natopen    NA            T13-C-7    all    all\n#> 312 natopen    NA            T13-C-7    all    all\n#> 313 natopen    NA            T13-C-8    all    all\n#> 314 natopen    NA            T13-C-8    all    all\n#> 315 natopen    NA            T13-C-9    all    all\n#> 316 natopen    NA            T13-C-9    all    all\n#> 317 natopen    NA           T13-C-10    all    all\n#> 318 natopen    NA           T13-C-10    all    all\n#> 319 natopen    NA           T13-C-11    all    all\n#> 320 natopen    NA           T13-C-11    all    all\n#> 321 natopen    NA           T13-C-12    all    all\n#> 322 natopen    NA           T13-C-12    all    all\n#> 323 natopen    NA           T13-C-13    all    all\n#> 324 natopen    NA           T13-C-13    all    all\n#> 325 natopen    NA           T13-C-14    all    all\n#> 326 natopen    NA           T13-C-14    all    all\n#> 327 natopen    NA           T13-C-15    all    all\n#> 328 natopen    NA           T13-C-15    all    all\n#> 329 natopen    NA                T15    all    all\n#> 330 natopen    NA                T15    all    all\n#> 331 natopen    NA       T15-Bratli21    all    all\n#> 332 natopen    NA       T15-Bratli21    all    all\n#> 333 natopen    NA            T16-C-1    all    all\n#> 334 natopen    NA            T16-C-1    all    all\n#> 335 natopen    NA            T16-C-2    all    all\n#> 336 natopen    NA            T16-C-2    all    all\n#> 337 natopen    NA            T16-C-3    all    all\n#> 338 natopen    NA            T16-C-3    all    all\n#> 339 natopen    NA            T16-C-4    all    all\n#> 340 natopen    NA            T16-C-4    all    all\n#> 341 natopen    NA            T16-C-5    all    all\n#> 342 natopen    NA            T16-C-5    all    all\n#> 343 natopen    NA            T16-C-6    all    all\n#> 344 natopen    NA            T16-C-6    all    all\n#> 345 natopen    NA            T16-C-7    all    all\n#> 346 natopen    NA            T16-C-7    all    all\n#> 347 natopen    NA            T18-C-1    all    all\n#> 348 natopen    NA            T18-C-1    all    all\n#> 349 natopen    NA            T18-C-2    all    all\n#> 350 natopen    NA            T18-C-2    all    all\n#> 351 natopen    NA            T18-C-3    all    all\n#> 352 natopen    NA            T18-C-3    all    all\n#> 353 natopen    NA            T18-C-4    all    all\n#> 354 natopen    NA            T18-C-4    all    all\n#> 355 natopen    NA            T21-C-1    all    all\n#> 356 natopen    NA            T21-C-1    all    all\n#> 357 natopen    NA            T21-C-2    all    all\n#> 358 natopen    NA            T21-C-2    all    all\n#> 359 natopen    NA            T21-C-3    all    all\n#> 360 natopen    NA            T21-C-3    all    all\n#> 361 natopen    NA            T21-C-4    all    all\n#> 362 natopen    NA            T21-C-4    all    all\n#> 363 natopen    NA              T21-7    all    all\n#> 364 natopen    NA              T21-7    all    all\n#> 365 natopen    NA     T24-C-1_samlet    all    all\n#> 366 natopen    NA     T24-C-1_samlet    all    all\n#> 367 natopen    NA     T24-C-2_samlet    all    all\n#> 368 natopen    NA     T24-C-2_samlet    all    all\n#> 369 natopen    NA      T24-C-1_Moere    all    all\n#> 370 natopen    NA      T24-C-1_Moere    all    all\n#> 371 natopen    NA T24-C-1_Troendelag    all    all\n#> 372 natopen    NA T24-C-1_Troendelag    all    all\n#> 373 natopen    NA      T24-C-1_Troms    all    all\n#> 374 natopen    NA      T24-C-1_Troms    all    all\n#> 375 natopen    NA   T24-C-1_Finnmark    all    all\n#> 376 natopen    NA   T24-C-1_Finnmark    all    all\n#> 377 natopen    NA      T24-C-2_Moere    all    all\n#> 378 natopen    NA      T24-C-2_Moere    all    all\n#> 379 natopen    NA T24-C-2_Troendelag    all    all\n#> 380 natopen    NA T24-C-2_Troendelag    all    all\n#> 381 natopen    NA      T24-C-2_Troms    all    all\n#> 382 natopen    NA      T24-C-2_Troms    all    all\n#> 383 natopen    NA   T24-C-2_Finnmark    all    all\n#> 384 natopen    NA   T24-C-2_Finnmark    all    all\n#> 385 natopen    NA            T29-C-1    all    all\n#> 386 natopen    NA            T29-C-1    all    all\n#> 387 natopen    NA            T29-C-2    all    all\n#> 388 natopen    NA            T29-C-2    all    all\n#> 389 natopen    NA            T29-C-3    all    all\n#> 390 natopen    NA            T29-C-3    all    all\n#> 391 natopen    NA            T29-C-4    all    all\n#> 392 natopen    NA            T29-C-4    all    all\n#> 393 natopen    NA            T29-C-5    all    all\n#> 394 natopen    NA            T29-C-5    all    all\n#> 395 natopen    NA            T29-C-6    all    all\n#> 396 natopen    NA            T29-C-6    all    all\n#> 397 natopen    NA             T2-C-1    all    all\n#> 398 natopen    NA             T2-C-1    all    all\n#> 399 natopen    NA             T2-C-2    all    all\n#> 400 natopen    NA             T2-C-2    all    all\n#> 401 natopen    NA             T2-C-3    all    all\n#> 402 natopen    NA             T2-C-3    all    all\n#> 403 natopen    NA             T2-C-4    all    all\n#> 404 natopen    NA             T2-C-4    all    all\n#> 405 natopen    NA             T2-C-5    all    all\n#> 406 natopen    NA             T2-C-5    all    all\n#> 407 natopen    NA             T2-C-6    all    all\n#> 408 natopen    NA             T2-C-6    all    all\n#> 409 natopen    NA             T2-C-7    all    all\n#> 410 natopen    NA             T2-C-7    all    all\n#> 411 natopen    NA             T2-C-8    all    all\n#> 412 natopen    NA             T2-C-8    all    all\n#> 413 natopen    NA          T2-C-7_BN    all    all\n#> 414 natopen    NA          T2-C-7_BN    all    all\n#> 415 natopen    NA          T2-C-8_BN    all    all\n#> 416 natopen    NA          T2-C-8_BN    all    all\n#> 417 natopen    NA             T8-C-1    all    all\n#> 418 natopen    NA             T8-C-1    all    all\n#> 419 natopen    NA             T8-C-2    all    all\n#> 420 natopen    NA             T8-C-2    all    all\n#> 421 natopen    NA             T8-C-3    all    all\n#> 422 natopen    NA             T8-C-3    all    all\n#> 423 natopen    NA            T11-C-1    all    all\n#> 424 natopen    NA            T11-C-1    all    all\n#> 425 natopen    NA            T11-C-2    all    all\n#> 426 natopen    NA            T11-C-2    all    all\n#> 427 natopen    NA            T12-C-1    all    all\n#> 428 natopen    NA            T12-C-1    all    all\n#> 429 natopen    NA            T12-C-2    all    all\n#> 430 natopen    NA            T12-C-2    all    all\n#> 431 natopen    NA            T13-C-1    all    all\n#> 432 natopen    NA            T13-C-1    all    all\n#> 433 natopen    NA            T13-C-2    all    all\n#> 434 natopen    NA            T13-C-2    all    all\n#> 435 natopen    NA            T13-C-3    all    all\n#> 436 natopen    NA            T13-C-3    all    all\n#> 437 natopen    NA            T13-C-4    all    all\n#> 438 natopen    NA            T13-C-4    all    all\n#> 439 natopen    NA            T13-C-5    all    all\n#> 440 natopen    NA            T13-C-5    all    all\n#> 441 natopen    NA            T13-C-6    all    all\n#> 442 natopen    NA            T13-C-6    all    all\n#> 443 natopen    NA            T13-C-7    all    all\n#> 444 natopen    NA            T13-C-7    all    all\n#> 445 natopen    NA            T13-C-8    all    all\n#> 446 natopen    NA            T13-C-8    all    all\n#> 447 natopen    NA            T13-C-9    all    all\n#> 448 natopen    NA            T13-C-9    all    all\n#> 449 natopen    NA           T13-C-10    all    all\n#> 450 natopen    NA           T13-C-10    all    all\n#> 451 natopen    NA           T13-C-11    all    all\n#> 452 natopen    NA           T13-C-11    all    all\n#> 453 natopen    NA           T13-C-12    all    all\n#> 454 natopen    NA           T13-C-12    all    all\n#> 455 natopen    NA           T13-C-13    all    all\n#> 456 natopen    NA           T13-C-13    all    all\n#> 457 natopen    NA           T13-C-14    all    all\n#> 458 natopen    NA           T13-C-14    all    all\n#> 459 natopen    NA           T13-C-15    all    all\n#> 460 natopen    NA           T13-C-15    all    all\n#> 461 natopen    NA                T15    all    all\n#> 462 natopen    NA                T15    all    all\n#> 463 natopen    NA       T15-Bratli21    all    all\n#> 464 natopen    NA       T15-Bratli21    all    all\n#> 465 natopen    NA            T16-C-1    all    all\n#> 466 natopen    NA            T16-C-1    all    all\n#> 467 natopen    NA            T16-C-2    all    all\n#> 468 natopen    NA            T16-C-2    all    all\n#> 469 natopen    NA            T16-C-3    all    all\n#> 470 natopen    NA            T16-C-3    all    all\n#> 471 natopen    NA            T16-C-4    all    all\n#> 472 natopen    NA            T16-C-4    all    all\n#> 473 natopen    NA            T16-C-5    all    all\n#> 474 natopen    NA            T16-C-5    all    all\n#> 475 natopen    NA            T16-C-6    all    all\n#> 476 natopen    NA            T16-C-6    all    all\n#> 477 natopen    NA            T16-C-7    all    all\n#> 478 natopen    NA            T16-C-7    all    all\n#> 479 natopen    NA            T18-C-1    all    all\n#> 480 natopen    NA            T18-C-1    all    all\n#> 481 natopen    NA            T18-C-2    all    all\n#> 482 natopen    NA            T18-C-2    all    all\n#> 483 natopen    NA            T18-C-3    all    all\n#> 484 natopen    NA            T18-C-3    all    all\n#> 485 natopen    NA            T18-C-4    all    all\n#> 486 natopen    NA            T18-C-4    all    all\n#> 487 natopen    NA            T21-C-1    all    all\n#> 488 natopen    NA            T21-C-1    all    all\n#> 489 natopen    NA            T21-C-2    all    all\n#> 490 natopen    NA            T21-C-2    all    all\n#> 491 natopen    NA            T21-C-3    all    all\n#> 492 natopen    NA            T21-C-3    all    all\n#> 493 natopen    NA            T21-C-4    all    all\n#> 494 natopen    NA            T21-C-4    all    all\n#> 495 natopen    NA              T21-7    all    all\n#> 496 natopen    NA              T21-7    all    all\n#> 497 natopen    NA     T24-C-1_samlet    all    all\n#> 498 natopen    NA     T24-C-1_samlet    all    all\n#> 499 natopen    NA     T24-C-2_samlet    all    all\n#> 500 natopen    NA     T24-C-2_samlet    all    all\n#> 501 natopen    NA      T24-C-1_Moere    all    all\n#> 502 natopen    NA      T24-C-1_Moere    all    all\n#> 503 natopen    NA T24-C-1_Troendelag    all    all\n#> 504 natopen    NA T24-C-1_Troendelag    all    all\n#> 505 natopen    NA      T24-C-1_Troms    all    all\n#> 506 natopen    NA      T24-C-1_Troms    all    all\n#> 507 natopen    NA   T24-C-1_Finnmark    all    all\n#> 508 natopen    NA   T24-C-1_Finnmark    all    all\n#> 509 natopen    NA      T24-C-2_Moere    all    all\n#> 510 natopen    NA      T24-C-2_Moere    all    all\n#> 511 natopen    NA T24-C-2_Troendelag    all    all\n#> 512 natopen    NA T24-C-2_Troendelag    all    all\n#> 513 natopen    NA      T24-C-2_Troms    all    all\n#> 514 natopen    NA      T24-C-2_Troms    all    all\n#> 515 natopen    NA   T24-C-2_Finnmark    all    all\n#> 516 natopen    NA   T24-C-2_Finnmark    all    all\n#> 517 natopen    NA            T29-C-1    all    all\n#> 518 natopen    NA            T29-C-1    all    all\n#> 519 natopen    NA            T29-C-2    all    all\n#> 520 natopen    NA            T29-C-2    all    all\n#> 521 natopen    NA            T29-C-3    all    all\n#> 522 natopen    NA            T29-C-3    all    all\n#> 523 natopen    NA            T29-C-4    all    all\n#> 524 natopen    NA            T29-C-4    all    all\n#> 525 natopen    NA            T29-C-5    all    all\n#> 526 natopen    NA            T29-C-5    all    all\n#> 527 natopen    NA            T29-C-6    all    all\n#> 528 natopen    NA            T29-C-6    all    all\n#> 529 natopen    NA             T2-C-1    all    all\n#> 530 natopen    NA             T2-C-1    all    all\n#> 531 natopen    NA             T2-C-2    all    all\n#> 532 natopen    NA             T2-C-2    all    all\n#> 533 natopen    NA             T2-C-3    all    all\n#> 534 natopen    NA             T2-C-3    all    all\n#> 535 natopen    NA             T2-C-4    all    all\n#> 536 natopen    NA             T2-C-4    all    all\n#> 537 natopen    NA             T2-C-5    all    all\n#> 538 natopen    NA             T2-C-5    all    all\n#> 539 natopen    NA             T2-C-6    all    all\n#> 540 natopen    NA             T2-C-6    all    all\n#> 541 natopen    NA             T2-C-7    all    all\n#> 542 natopen    NA             T2-C-7    all    all\n#> 543 natopen    NA             T2-C-8    all    all\n#> 544 natopen    NA             T2-C-8    all    all\n#> 545 natopen    NA          T2-C-7_BN    all    all\n#> 546 natopen    NA          T2-C-7_BN    all    all\n#> 547 natopen    NA          T2-C-8_BN    all    all\n#> 548 natopen    NA          T2-C-8_BN    all    all\n#> 549 natopen    NA             T8-C-1    all    all\n#> 550 natopen    NA             T8-C-1    all    all\n#> 551 natopen    NA             T8-C-2    all    all\n#> 552 natopen    NA             T8-C-2    all    all\n#> 553 natopen    NA             T8-C-3    all    all\n#> 554 natopen    NA             T8-C-3    all    all\n#> 555 natopen    NA            T11-C-1    all    all\n#> 556 natopen    NA            T11-C-1    all    all\n#> 557 natopen    NA            T11-C-2    all    all\n#> 558 natopen    NA            T11-C-2    all    all\n#> 559 natopen    NA            T12-C-1    all    all\n#> 560 natopen    NA            T12-C-1    all    all\n#> 561 natopen    NA            T12-C-2    all    all\n#> 562 natopen    NA            T12-C-2    all    all\n#> 563 natopen    NA            T13-C-1    all    all\n#> 564 natopen    NA            T13-C-1    all    all\n#> 565 natopen    NA            T13-C-2    all    all\n#> 566 natopen    NA            T13-C-2    all    all\n#> 567 natopen    NA            T13-C-3    all    all\n#> 568 natopen    NA            T13-C-3    all    all\n#> 569 natopen    NA            T13-C-4    all    all\n#> 570 natopen    NA            T13-C-4    all    all\n#> 571 natopen    NA            T13-C-5    all    all\n#> 572 natopen    NA            T13-C-5    all    all\n#> 573 natopen    NA            T13-C-6    all    all\n#> 574 natopen    NA            T13-C-6    all    all\n#> 575 natopen    NA            T13-C-7    all    all\n#> 576 natopen    NA            T13-C-7    all    all\n#> 577 natopen    NA            T13-C-8    all    all\n#> 578 natopen    NA            T13-C-8    all    all\n#> 579 natopen    NA            T13-C-9    all    all\n#> 580 natopen    NA            T13-C-9    all    all\n#> 581 natopen    NA           T13-C-10    all    all\n#> 582 natopen    NA           T13-C-10    all    all\n#> 583 natopen    NA           T13-C-11    all    all\n#> 584 natopen    NA           T13-C-11    all    all\n#> 585 natopen    NA           T13-C-12    all    all\n#> 586 natopen    NA           T13-C-12    all    all\n#> 587 natopen    NA           T13-C-13    all    all\n#> 588 natopen    NA           T13-C-13    all    all\n#> 589 natopen    NA           T13-C-14    all    all\n#> 590 natopen    NA           T13-C-14    all    all\n#> 591 natopen    NA           T13-C-15    all    all\n#> 592 natopen    NA           T13-C-15    all    all\n#> 593 natopen    NA                T15    all    all\n#> 594 natopen    NA                T15    all    all\n#> 595 natopen    NA       T15-Bratli21    all    all\n#> 596 natopen    NA       T15-Bratli21    all    all\n#> 597 natopen    NA            T16-C-1    all    all\n#> 598 natopen    NA            T16-C-1    all    all\n#> 599 natopen    NA            T16-C-2    all    all\n#> 600 natopen    NA            T16-C-2    all    all\n#> 601 natopen    NA            T16-C-3    all    all\n#> 602 natopen    NA            T16-C-3    all    all\n#> 603 natopen    NA            T16-C-4    all    all\n#> 604 natopen    NA            T16-C-4    all    all\n#> 605 natopen    NA            T16-C-5    all    all\n#> 606 natopen    NA            T16-C-5    all    all\n#> 607 natopen    NA            T16-C-6    all    all\n#> 608 natopen    NA            T16-C-6    all    all\n#> 609 natopen    NA            T16-C-7    all    all\n#> 610 natopen    NA            T16-C-7    all    all\n#> 611 natopen    NA            T18-C-1    all    all\n#> 612 natopen    NA            T18-C-1    all    all\n#> 613 natopen    NA            T18-C-2    all    all\n#> 614 natopen    NA            T18-C-2    all    all\n#> 615 natopen    NA            T18-C-3    all    all\n#> 616 natopen    NA            T18-C-3    all    all\n#> 617 natopen    NA            T18-C-4    all    all\n#> 618 natopen    NA            T18-C-4    all    all\n#> 619 natopen    NA            T21-C-1    all    all\n#> 620 natopen    NA            T21-C-1    all    all\n#> 621 natopen    NA            T21-C-2    all    all\n#> 622 natopen    NA            T21-C-2    all    all\n#> 623 natopen    NA            T21-C-3    all    all\n#> 624 natopen    NA            T21-C-3    all    all\n#> 625 natopen    NA            T21-C-4    all    all\n#> 626 natopen    NA            T21-C-4    all    all\n#> 627 natopen    NA              T21-7    all    all\n#> 628 natopen    NA              T21-7    all    all\n#> 629 natopen    NA     T24-C-1_samlet    all    all\n#> 630 natopen    NA     T24-C-1_samlet    all    all\n#> 631 natopen    NA     T24-C-2_samlet    all    all\n#> 632 natopen    NA     T24-C-2_samlet    all    all\n#> 633 natopen    NA      T24-C-1_Moere    all    all\n#> 634 natopen    NA      T24-C-1_Moere    all    all\n#> 635 natopen    NA T24-C-1_Troendelag    all    all\n#> 636 natopen    NA T24-C-1_Troendelag    all    all\n#> 637 natopen    NA      T24-C-1_Troms    all    all\n#> 638 natopen    NA      T24-C-1_Troms    all    all\n#> 639 natopen    NA   T24-C-1_Finnmark    all    all\n#> 640 natopen    NA   T24-C-1_Finnmark    all    all\n#> 641 natopen    NA      T24-C-2_Moere    all    all\n#> 642 natopen    NA      T24-C-2_Moere    all    all\n#> 643 natopen    NA T24-C-2_Troendelag    all    all\n#> 644 natopen    NA T24-C-2_Troendelag    all    all\n#> 645 natopen    NA      T24-C-2_Troms    all    all\n#> 646 natopen    NA      T24-C-2_Troms    all    all\n#> 647 natopen    NA   T24-C-2_Finnmark    all    all\n#> 648 natopen    NA   T24-C-2_Finnmark    all    all\n#> 649 natopen    NA            T29-C-1    all    all\n#> 650 natopen    NA            T29-C-1    all    all\n#> 651 natopen    NA            T29-C-2    all    all\n#> 652 natopen    NA            T29-C-2    all    all\n#> 653 natopen    NA            T29-C-3    all    all\n#> 654 natopen    NA            T29-C-3    all    all\n#> 655 natopen    NA            T29-C-4    all    all\n#> 656 natopen    NA            T29-C-4    all    all\n#> 657 natopen    NA            T29-C-5    all    all\n#> 658 natopen    NA            T29-C-5    all    all\n#> 659 natopen    NA            T29-C-6    all    all\n#> 660 natopen    NA            T29-C-6    all    all\n#> 661 natopen    NA             T2-C-1    all    all\n#> 662 natopen    NA             T2-C-1    all    all\n#> 663 natopen    NA             T2-C-2    all    all\n#> 664 natopen    NA             T2-C-2    all    all\n#> 665 natopen    NA             T2-C-3    all    all\n#> 666 natopen    NA             T2-C-3    all    all\n#> 667 natopen    NA             T2-C-4    all    all\n#> 668 natopen    NA             T2-C-4    all    all\n#> 669 natopen    NA             T2-C-5    all    all\n#> 670 natopen    NA             T2-C-5    all    all\n#> 671 natopen    NA             T2-C-6    all    all\n#> 672 natopen    NA             T2-C-6    all    all\n#> 673 natopen    NA             T2-C-7    all    all\n#> 674 natopen    NA             T2-C-7    all    all\n#> 675 natopen    NA             T2-C-8    all    all\n#> 676 natopen    NA             T2-C-8    all    all\n#> 677 natopen    NA          T2-C-7_BN    all    all\n#> 678 natopen    NA          T2-C-7_BN    all    all\n#> 679 natopen    NA          T2-C-8_BN    all    all\n#> 680 natopen    NA          T2-C-8_BN    all    all\n#> 681 natopen    NA             T8-C-1    all    all\n#> 682 natopen    NA             T8-C-1    all    all\n#> 683 natopen    NA             T8-C-2    all    all\n#> 684 natopen    NA             T8-C-2    all    all\n#> 685 natopen    NA             T8-C-3    all    all\n#> 686 natopen    NA             T8-C-3    all    all\n#> 687 natopen    NA            T11-C-1    all    all\n#> 688 natopen    NA            T11-C-1    all    all\n#> 689 natopen    NA            T11-C-2    all    all\n#> 690 natopen    NA            T11-C-2    all    all\n#> 691 natopen    NA            T12-C-1    all    all\n#> 692 natopen    NA            T12-C-1    all    all\n#> 693 natopen    NA            T12-C-2    all    all\n#> 694 natopen    NA            T12-C-2    all    all\n#> 695 natopen    NA            T13-C-1    all    all\n#> 696 natopen    NA            T13-C-1    all    all\n#> 697 natopen    NA            T13-C-2    all    all\n#> 698 natopen    NA            T13-C-2    all    all\n#> 699 natopen    NA            T13-C-3    all    all\n#> 700 natopen    NA            T13-C-3    all    all\n#> 701 natopen    NA            T13-C-4    all    all\n#> 702 natopen    NA            T13-C-4    all    all\n#> 703 natopen    NA            T13-C-5    all    all\n#> 704 natopen    NA            T13-C-5    all    all\n#> 705 natopen    NA            T13-C-6    all    all\n#> 706 natopen    NA            T13-C-6    all    all\n#> 707 natopen    NA            T13-C-7    all    all\n#> 708 natopen    NA            T13-C-7    all    all\n#> 709 natopen    NA            T13-C-8    all    all\n#> 710 natopen    NA            T13-C-8    all    all\n#> 711 natopen    NA            T13-C-9    all    all\n#> 712 natopen    NA            T13-C-9    all    all\n#> 713 natopen    NA           T13-C-10    all    all\n#> 714 natopen    NA           T13-C-10    all    all\n#> 715 natopen    NA           T13-C-11    all    all\n#> 716 natopen    NA           T13-C-11    all    all\n#> 717 natopen    NA           T13-C-12    all    all\n#> 718 natopen    NA           T13-C-12    all    all\n#> 719 natopen    NA           T13-C-13    all    all\n#> 720 natopen    NA           T13-C-13    all    all\n#> 721 natopen    NA           T13-C-14    all    all\n#> 722 natopen    NA           T13-C-14    all    all\n#> 723 natopen    NA           T13-C-15    all    all\n#> 724 natopen    NA           T13-C-15    all    all\n#> 725 natopen    NA                T15    all    all\n#> 726 natopen    NA                T15    all    all\n#> 727 natopen    NA       T15-Bratli21    all    all\n#> 728 natopen    NA       T15-Bratli21    all    all\n#> 729 natopen    NA            T16-C-1    all    all\n#> 730 natopen    NA            T16-C-1    all    all\n#> 731 natopen    NA            T16-C-2    all    all\n#> 732 natopen    NA            T16-C-2    all    all\n#> 733 natopen    NA            T16-C-3    all    all\n#> 734 natopen    NA            T16-C-3    all    all\n#> 735 natopen    NA            T16-C-4    all    all\n#> 736 natopen    NA            T16-C-4    all    all\n#> 737 natopen    NA            T16-C-5    all    all\n#> 738 natopen    NA            T16-C-5    all    all\n#> 739 natopen    NA            T16-C-6    all    all\n#> 740 natopen    NA            T16-C-6    all    all\n#> 741 natopen    NA            T16-C-7    all    all\n#> 742 natopen    NA            T16-C-7    all    all\n#> 743 natopen    NA            T18-C-1    all    all\n#> 744 natopen    NA            T18-C-1    all    all\n#> 745 natopen    NA            T18-C-2    all    all\n#> 746 natopen    NA            T18-C-2    all    all\n#> 747 natopen    NA            T18-C-3    all    all\n#> 748 natopen    NA            T18-C-3    all    all\n#> 749 natopen    NA            T18-C-4    all    all\n#> 750 natopen    NA            T18-C-4    all    all\n#> 751 natopen    NA            T21-C-1    all    all\n#> 752 natopen    NA            T21-C-1    all    all\n#> 753 natopen    NA            T21-C-2    all    all\n#> 754 natopen    NA            T21-C-2    all    all\n#> 755 natopen    NA            T21-C-3    all    all\n#> 756 natopen    NA            T21-C-3    all    all\n#> 757 natopen    NA            T21-C-4    all    all\n#> 758 natopen    NA            T21-C-4    all    all\n#> 759 natopen    NA              T21-7    all    all\n#> 760 natopen    NA              T21-7    all    all\n#> 761 natopen    NA     T24-C-1_samlet    all    all\n#> 762 natopen    NA     T24-C-1_samlet    all    all\n#> 763 natopen    NA     T24-C-2_samlet    all    all\n#> 764 natopen    NA     T24-C-2_samlet    all    all\n#> 765 natopen    NA      T24-C-1_Moere    all    all\n#> 766 natopen    NA      T24-C-1_Moere    all    all\n#> 767 natopen    NA T24-C-1_Troendelag    all    all\n#> 768 natopen    NA T24-C-1_Troendelag    all    all\n#> 769 natopen    NA      T24-C-1_Troms    all    all\n#> 770 natopen    NA      T24-C-1_Troms    all    all\n#> 771 natopen    NA   T24-C-1_Finnmark    all    all\n#> 772 natopen    NA   T24-C-1_Finnmark    all    all\n#> 773 natopen    NA      T24-C-2_Moere    all    all\n#> 774 natopen    NA      T24-C-2_Moere    all    all\n#> 775 natopen    NA T24-C-2_Troendelag    all    all\n#> 776 natopen    NA T24-C-2_Troendelag    all    all\n#> 777 natopen    NA      T24-C-2_Troms    all    all\n#> 778 natopen    NA      T24-C-2_Troms    all    all\n#> 779 natopen    NA   T24-C-2_Finnmark    all    all\n#> 780 natopen    NA   T24-C-2_Finnmark    all    all\n#> 781 natopen    NA            T29-C-1    all    all\n#> 782 natopen    NA            T29-C-1    all    all\n#> 783 natopen    NA            T29-C-2    all    all\n#> 784 natopen    NA            T29-C-2    all    all\n#> 785 natopen    NA            T29-C-3    all    all\n#> 786 natopen    NA            T29-C-3    all    all\n#> 787 natopen    NA            T29-C-4    all    all\n#> 788 natopen    NA            T29-C-4    all    all\n#> 789 natopen    NA            T29-C-5    all    all\n#> 790 natopen    NA            T29-C-5    all    all\n#> 791 natopen    NA            T29-C-6    all    all\n#> 792 natopen    NA            T29-C-6    all    all\n#>                   Ind         Rv          Gv maxmin\n#> 1                 CC1 0.21872555 0.087668322      0\n#> 2                 CC2 0.21872555 0.388888889      1\n#> 3                 CC1 0.19671091 0.053823529      0\n#> 4                 CC2 0.19671091 0.284348739      1\n#> 5                 CC1 0.17141992 0.037538818      0\n#> 6                 CC2 0.17141992 0.392058791      1\n#> 7                 CC1 0.12230736 0.025238496      0\n#> 8                 CC2 0.12230736 0.192974372      1\n#> 9                 CC1 0.20897488 0.109199030      0\n#> 10                CC2 0.20897488 0.338089226      1\n#> 11                CC1 0.09912008 0.017065773      0\n#> 12                CC2 0.09912008 0.255937770      1\n#> 13                CC1 0.25719120 0.156205369      0\n#> 14                CC2 0.25719120 0.365205532      1\n#> 15                CC1 0.25018911 0.180613619      0\n#> 16                CC2 0.25018911 0.338219364      1\n#> 17                CC1 0.20957553 0.102246546      0\n#> 18                CC2 0.20957553 0.368063711      1\n#> 19                CC1 0.17847283 0.074271005      0\n#> 20                CC2 0.17847283 0.316241762      1\n#> 21                CC1 0.21488110 0.093007457      0\n#> 22                CC2 0.21488110 0.369565217      1\n#> 23                CC1         NA          NA      0\n#> 24                CC2         NA          NA      1\n#> 25                CC1 0.15415885 0.025252525      0\n#> 26                CC2 0.15415885 0.287878788      1\n#> 27                CC1         NA          NA      0\n#> 28                CC2         NA          NA      1\n#> 29                CC1         NA          NA      0\n#> 30                CC2         NA          NA      1\n#> 31                CC1         NA          NA      0\n#> 32                CC2         NA          NA      1\n#> 33                CC1 0.40597466 0.290602398      0\n#> 34                CC2 0.40597466 0.552983004      1\n#> 35                CC1         NA          NA      0\n#> 36                CC2         NA          NA      1\n#> 37                CC1         NA          NA      0\n#> 38                CC2         NA          NA      1\n#> 39                CC1         NA          NA      0\n#> 40                CC2         NA          NA      1\n#> 41                CC1         NA          NA      0\n#> 42                CC2         NA          NA      1\n#> 43                CC1 0.16666667 0.081300813      0\n#> 44                CC2 0.16666667 0.268292683      1\n#> 45                CC1 0.18405797 0.043827986      0\n#> 46                CC2 0.18405797 0.308712121      1\n#> 47                CC1 0.25000000 0.012303889      0\n#> 48                CC2 0.25000000 0.583333333      1\n#> 49                CC1 0.18292683 0.081300813      0\n#> 50                CC2 0.18292683 0.319105691      1\n#> 51                CC1 0.20114943 0.124579125      0\n#> 52                CC2 0.20114943 0.351653613      1\n#> 53                CC1         NA          NA      0\n#> 54                CC2         NA          NA      1\n#> 55                CC1         NA          NA      0\n#> 56                CC2         NA          NA      1\n#> 57                CC1         NA          NA      0\n#> 58                CC2         NA          NA      1\n#> 59                CC1         NA          NA      0\n#> 60                CC2         NA          NA      1\n#> 61                CC1         NA          NA      0\n#> 62                CC2         NA          NA      1\n#> 63                CC1         NA          NA      0\n#> 64                CC2         NA          NA      1\n#> 65                CC1 0.36111111 0.244990591      0\n#> 66                CC2 0.36111111 0.513958333      1\n#> 67                CC1 0.29379425 0.250609052      0\n#> 68                CC2 0.29379425 0.382088652      1\n#> 69                CC1 0.25693620 0.162342987      0\n#> 70                CC2 0.25693620 0.376628082      1\n#> 71                CC1 0.28641287 0.163574851      0\n#> 72                CC2 0.28641287 0.420055922      1\n#> 73                CC1 0.23896199 0.148109995      0\n#> 74                CC2 0.23896199 0.363760505      1\n#> 75                CC1 0.25527663 0.147132313      0\n#> 76                CC2 0.25527663 0.381290472      1\n#> 77                CC1 0.41732082 0.270608011      0\n#> 78                CC2 0.41732082 0.675713465      1\n#> 79                CC1 0.45307881 0.285331552      0\n#> 80                CC2 0.45307881 0.680374460      1\n#> 81                CC1 0.30450974 0.099358975      0\n#> 82                CC2 0.30450974 0.576942091      1\n#> 83                CC1 0.44391944 0.242514345      0\n#> 84                CC2 0.44391944 0.628093140      1\n#> 85                CC1 0.34454332 0.167101520      0\n#> 86                CC2 0.34454332 0.519109405      1\n#> 87                CC1         NA          NA      0\n#> 88                CC2         NA          NA      1\n#> 89                CC1         NA          NA      0\n#> 90                CC2         NA          NA      1\n#> 91                CC1 0.37662986 0.187933803      0\n#> 92                CC2 0.37662986 0.575805454      1\n#> 93                CC1 0.39989343 0.301305299      0\n#> 94                CC2 0.39989343 0.497605180      1\n#> 95                CC1 0.27771966 0.172628307      0\n#> 96                CC2 0.27771966 0.395872477      1\n#> 97                CC1 0.34709012 0.191201637      0\n#> 98                CC2 0.34709012 0.502898603      1\n#> 99                CC1 0.25972603 0.089675665      0\n#> 100               CC2 0.25972603 0.421311900      1\n#> 101               CC1 0.48453591 0.300038824      0\n#> 102               CC2 0.48453591 0.641916891      1\n#> 103               CC1 0.34885701 0.157367254      0\n#> 104               CC2 0.34885701 0.566391850      1\n#> 105               CC1 0.48333123 0.272987388      0\n#> 106               CC2 0.48333123 0.661565655      1\n#> 107               CC1 0.56287224 0.311635333      0\n#> 108               CC2 0.56287224 0.737959957      1\n#> 109               CC1 0.39119214 0.211696658      0\n#> 110               CC2 0.39119214 0.578294095      1\n#> 111               CC1 0.36777152 0.177716968      0\n#> 112               CC2 0.36777152 0.518730127      1\n#> 113               CC1 0.43629763 0.127450980      0\n#> 114               CC2 0.43629763 0.654814426      1\n#> 115               CC1 0.44182390 0.188487595      0\n#> 116               CC2 0.44182390 0.693677626      1\n#> 117               CC1 0.32321389 0.183847371      0\n#> 118               CC2 0.32321389 0.425179887      1\n#> 119               CC1 0.41887963 0.250079822      0\n#> 120               CC2 0.41887963 0.594376585      1\n#> 121               CC1 0.37098021 0.184157732      0\n#> 122               CC2 0.37098021 0.575808081      1\n#> 123               CC1 0.33291604 0.207074422      0\n#> 124               CC2 0.33291604 0.455714782      1\n#> 125               CC1 0.16486025 0.095851739      0\n#> 126               CC2 0.16486025 0.253299785      1\n#> 127               CC1 0.21052632 0.087782166      0\n#> 128               CC2 0.21052632 0.372135936      1\n#> 129               CC1 0.46304153 0.310887004      0\n#> 130               CC2 0.46304153 0.626473781      1\n#> 131               CC1 0.41569491 0.232136387      0\n#> 132               CC2 0.41569491 0.626674411      1\n#> 133               SS1 0.67063492 0.496031746      0\n#> 134               SS2 0.67063492 0.744732093      1\n#> 135               SS1 0.65859351 0.428523810      0\n#> 136               SS2 0.65859351 0.779766768      1\n#> 137               SS1 0.56470638 0.329815301      0\n#> 138               SS2 0.56470638 0.793685100      1\n#> 139               SS1 0.56582778 0.327729100      0\n#> 140               SS2 0.56582778 0.766533689      1\n#> 141               SS1 0.52346972 0.360701100      0\n#> 142               SS2 0.52346972 0.691694099      1\n#> 143               SS1 0.58410216 0.435242751      0\n#> 144               SS2 0.58410216 0.778687555      1\n#> 145               SS1 0.55090793 0.441457929      0\n#> 146               SS2 0.55090793 0.673832169      1\n#> 147               SS1 0.57752100 0.470574683      0\n#> 148               SS2 0.57752100 0.697413954      1\n#> 149               SS1 0.57902923 0.462116259      0\n#> 150               SS2 0.57902923 0.752476088      1\n#> 151               SS1 0.60815835 0.463891580      0\n#> 152               SS2 0.60815835 0.790995798      1\n#> 153               SS1 0.33333333 0.155108025      0\n#> 154               SS2 0.33333333 0.524533092      1\n#> 155               SS1         NA          NA      0\n#> 156               SS2         NA          NA      1\n#> 157               SS1 0.56818182 0.346414806      0\n#> 158               SS2 0.56818182 0.805555556      1\n#> 159               SS1         NA          NA      0\n#> 160               SS2         NA          NA      1\n#> 161               SS1         NA          NA      0\n#> 162               SS2         NA          NA      1\n#> 163               SS1         NA          NA      0\n#> 164               SS2         NA          NA      1\n#> 165               SS1 0.25215467 0.155818787      0\n#> 166               SS2 0.25215467 0.379520267      1\n#> 167               SS1         NA          NA      0\n#> 168               SS2         NA          NA      1\n#> 169               SS1         NA          NA      0\n#> 170               SS2         NA          NA      1\n#> 171               SS1         NA          NA      0\n#> 172               SS2         NA          NA      1\n#> 173               SS1         NA          NA      0\n#> 174               SS2         NA          NA      1\n#> 175               SS1 0.58333333 0.405053266      0\n#> 176               SS2 0.58333333 0.821138212      1\n#> 177               SS1 0.50505301 0.346037866      0\n#> 178               SS2 0.50505301 0.640921168      1\n#> 179               SS1 0.57507473 0.207409555      0\n#> 180               SS2 0.57507473 0.979919679      1\n#> 181               SS1 0.61111111 0.416666667      0\n#> 182               SS2 0.61111111 0.837398374      1\n#> 183               SS1 0.55962644 0.326849857      0\n#> 184               SS2 0.55962644 0.722341954      1\n#> 185               SS1         NA          NA      0\n#> 186               SS2         NA          NA      1\n#> 187               SS1         NA          NA      0\n#> 188               SS2         NA          NA      1\n#> 189               SS1         NA          NA      0\n#> 190               SS2         NA          NA      1\n#> 191               SS1         NA          NA      0\n#> 192               SS2         NA          NA      1\n#> 193               SS1         NA          NA      0\n#> 194               SS2         NA          NA      1\n#> 195               SS1         NA          NA      0\n#> 196               SS2         NA          NA      1\n#> 197               SS1 0.40638940 0.233295494      0\n#> 198               SS2 0.40638940 0.560823560      1\n#> 199               SS1 0.53193205 0.435684880      0\n#> 200               SS2 0.53193205 0.598309619      1\n#> 201               SS1 0.47113943 0.279155891      0\n#> 202               SS2 0.47113943 0.639553454      1\n#> 203               SS1 0.48381744 0.310350085      0\n#> 204               SS2 0.48381744 0.682296836      1\n#> 205               SS1 0.49905906 0.378845415      0\n#> 206               SS2 0.49905906 0.626709829      1\n#> 207               SS1 0.52809611 0.376717790      0\n#> 208               SS2 0.52809611 0.674455094      1\n#> 209               SS1 0.34122203 0.164448153      0\n#> 210               SS2 0.34122203 0.531108136      1\n#> 211               SS1 0.35596430 0.195725145      0\n#> 212               SS2 0.35596430 0.517447459      1\n#> 213               SS1 0.43693694 0.222222223      0\n#> 214               SS2 0.43693694 0.638888889      1\n#> 215               SS1 0.35012504 0.164932380      0\n#> 216               SS2 0.35012504 0.575820324      1\n#> 217               SS1 0.14347518 0.034689455      0\n#> 218               SS2 0.14347518 0.270842474      1\n#> 219               SS1         NA          NA      0\n#> 220               SS2         NA          NA      1\n#> 221               SS1         NA          NA      0\n#> 222               SS2         NA          NA      1\n#> 223               SS1 0.27795685 0.030067155      0\n#> 224               SS2 0.27795685 0.503907800      1\n#> 225               SS1 0.44474045 0.345761792      0\n#> 226               SS2 0.44474045 0.566052357      1\n#> 227               SS1 0.46802992 0.343577594      0\n#> 228               SS2 0.46802992 0.604391895      1\n#> 229               SS1 0.36723930 0.125478216      0\n#> 230               SS2 0.36723930 0.592490518      1\n#> 231               SS1 0.42210487 0.201083409      0\n#> 232               SS2 0.42210487 0.752103568      1\n#> 233               SS1 0.11784811 0.024354072      0\n#> 234               SS2 0.11784811 0.237209290      1\n#> 235               SS1 0.07598784 0.002446965      0\n#> 236               SS2 0.07598784 0.270697544      1\n#> 237               SS1 0.12427942 0.024361766      0\n#> 238               SS2 0.12427942 0.293769010      1\n#> 239               SS1 0.12438130 0.011030933      0\n#> 240               SS2 0.12438130 0.293993797      1\n#> 241               SS1 0.16962269 0.016121596      0\n#> 242               SS2 0.16962269 0.319216178      1\n#> 243               SS1 0.16703751 0.008425297      0\n#> 244               SS2 0.16703751 0.385828828      1\n#> 245               SS1 0.07921569 0.000000000      0\n#> 246               SS2 0.07921569 0.300000000      1\n#> 247               SS1 0.09975386 0.004898777      0\n#> 248               SS2 0.09975386 0.272031820      1\n#> 249               SS1 0.08695652 0.001579779      0\n#> 250               SS2 0.08695652 0.234369028      1\n#> 251               SS1 0.16601732 0.032845002      0\n#> 252               SS2 0.16601732 0.308944231      1\n#> 253               SS1 0.23484848 0.092580409      0\n#> 254               SS2 0.23484848 0.465031898      1\n#> 255               SS1 0.52754059 0.389448156      0\n#> 256               SS2 0.52754059 0.680192098      1\n#> 257               SS1 0.55685255 0.407042639      0\n#> 258               SS2 0.55685255 0.702205553      1\n#> 259               SS1 0.46883828 0.261498756      0\n#> 260               SS2 0.46883828 0.661887255      1\n#> 261               SS1 0.13930852 0.029733603      0\n#> 262               SS2 0.13930852 0.282930537      1\n#> 263               SS1 0.21708726 0.038280536      0\n#> 264               SS2 0.21708726 0.452425595      1\n#> 265               RR1 0.11207735 0.005735723      0\n#> 266               RR2 0.11207735 0.287071609      1\n#> 267               RR1 0.15977961 0.000000000      0\n#> 268               RR2 0.15977961 0.408496732      1\n#> 269               RR1 0.23599683 0.025321138      0\n#> 270               RR2 0.23599683 0.569610675      1\n#> 271               RR1 0.31579579 0.120574240      0\n#> 272               RR2 0.31579579 0.533875868      1\n#> 273               RR1 0.25411421 0.110983810      0\n#> 274               RR2 0.25411421 0.455956460      1\n#> 275               RR1 0.29575597 0.105434160      0\n#> 276               RR2 0.29575597 0.504056689      1\n#> 277               RR1 0.19148056 0.091546770      0\n#> 278               RR2 0.19148056 0.292393476      1\n#> 279               RR1 0.16727937 0.063927305      0\n#> 280               RR2 0.16727937 0.292457903      1\n#> 281               RR1 0.19264814 0.079745942      0\n#> 282               RR2 0.19264814 0.333014092      1\n#> 283               RR1 0.19578262 0.086004879      0\n#> 284               RR2 0.19578262 0.349308888      1\n#> 285               RR1 0.44047619 0.270036376      0\n#> 286               RR2 0.44047619 0.658197279      1\n#> 287               RR1         NA          NA      0\n#> 288               RR2         NA          NA      1\n#> 289               RR1 0.27272727 0.134583333      0\n#> 290               RR2 0.27272727 0.435625997      1\n#> 291               RR1         NA          NA      0\n#> 292               RR2         NA          NA      1\n#> 293               RR1         NA          NA      0\n#> 294               RR2         NA          NA      1\n#> 295               RR1         NA          NA      0\n#> 296               RR2         NA          NA      1\n#> 297               RR1 0.33508951 0.219522914      0\n#> 298               RR2 0.33508951 0.429759135      1\n#> 299               RR1         NA          NA      0\n#> 300               RR2         NA          NA      1\n#> 301               RR1         NA          NA      0\n#> 302               RR2         NA          NA      1\n#> 303               RR1         NA          NA      0\n#> 304               RR2         NA          NA      1\n#> 305               RR1         NA          NA      0\n#> 306               RR2         NA          NA      1\n#> 307               RR1 0.23577236 0.055555556      0\n#> 308               RR2 0.23577236 0.382183908      1\n#> 309               RR1 0.31487696 0.185886752      0\n#> 310               RR2 0.31487696 0.466654256      1\n#> 311               RR1 0.12244898 0.005020080      0\n#> 312               RR2 0.12244898 0.341390563      1\n#> 313               RR1 0.19444444 0.032520325      0\n#> 314               RR2 0.19444444 0.367886179      1\n#> 315               RR1 0.23475610 0.126375456      0\n#> 316               RR2 0.23475610 0.367946544      1\n#> 317               RR1         NA          NA      0\n#> 318               RR2         NA          NA      1\n#> 319               RR1         NA          NA      0\n#> 320               RR2         NA          NA      1\n#> 321               RR1         NA          NA      0\n#> 322               RR2         NA          NA      1\n#> 323               RR1         NA          NA      0\n#> 324               RR2         NA          NA      1\n#> 325               RR1         NA          NA      0\n#> 326               RR2         NA          NA      1\n#> 327               RR1         NA          NA      0\n#> 328               RR2         NA          NA      1\n#> 329               RR1 0.22916667 0.126061321      0\n#> 330               RR2 0.22916667 0.333849150      1\n#> 331               RR1 0.17036491 0.132100093      0\n#> 332               RR2 0.17036491 0.210171941      1\n#> 333               RR1 0.26390925 0.109208892      0\n#> 334               RR2 0.26390925 0.488105501      1\n#> 335               RR1 0.21586783 0.088539009      0\n#> 336               RR2 0.21586783 0.391241336      1\n#> 337               RR1 0.25675646 0.135197412      0\n#> 338               RR2 0.25675646 0.399209818      1\n#> 339               RR1 0.21610340 0.105401613      0\n#> 340               RR2 0.21610340 0.338671451      1\n#> 341               RR1 0.21698168 0.077056285      0\n#> 342               RR2 0.21698168 0.370452222      1\n#> 343               RR1 0.17924641 0.066329446      0\n#> 344               RR2 0.17924641 0.312492206      1\n#> 345               RR1 0.24324324 0.070914473      0\n#> 346               RR2 0.24324324 0.472291667      1\n#> 347               RR1 0.20052320 0.065786151      0\n#> 348               RR2 0.20052320 0.385141944      1\n#> 349               RR1 0.51489678 0.333205756      0\n#> 350               RR2 0.51489678 0.673107822      1\n#> 351               RR1         NA          NA      0\n#> 352               RR2         NA          NA      1\n#> 353               RR1         NA          NA      0\n#> 354               RR2         NA          NA      1\n#> 355               RR1 0.31793370 0.041433288      0\n#> 356               RR2 0.31793370 0.707088924      1\n#> 357               RR1 0.15165560 0.070192195      0\n#> 358               RR2 0.15165560 0.234653773      1\n#> 359               RR1 0.24837542 0.141816620      0\n#> 360               RR2 0.24837542 0.376208380      1\n#> 361               RR1 0.29918569 0.099946196      0\n#> 362               RR2 0.29918569 0.447572196      1\n#> 363               RR1 0.30836320 0.124964235      0\n#> 364               RR2 0.30836320 0.452954292      1\n#> 365               RR1 0.39441255 0.229556384      0\n#> 366               RR2 0.39441255 0.616740280      1\n#> 367               RR1 0.54939602 0.313574049      0\n#> 368               RR2 0.54939602 0.809617443      1\n#> 369               RR1 0.37142755 0.154204634      0\n#> 370               RR2 0.37142755 0.635238398      1\n#> 371               RR1 0.29587590 0.134245220      0\n#> 372               RR2 0.29587590 0.595481886      1\n#> 373               RR1 0.41003699 0.281787839      0\n#> 374               RR2 0.41003699 0.703047453      1\n#> 375               RR1 0.46596035 0.166140141      0\n#> 376               RR2 0.46596035 0.763244456      1\n#> 377               RR1 0.46321663 0.250000000      0\n#> 378               RR2 0.46321663 0.823692810      1\n#> 379               RR1 0.44207273 0.225054113      0\n#> 380               RR2 0.44207273 0.713852599      1\n#> 381               RR1 0.59613758 0.396525204      0\n#> 382               RR2 0.59613758 0.798956977      1\n#> 383               RR1 0.40261842 0.216024611      0\n#> 384               RR2 0.40261842 0.643352546      1\n#> 385               RR1 0.37755102 0.176704546      0\n#> 386               RR2 0.37755102 0.594371345      1\n#> 387               RR1 0.13716008 0.045448503      0\n#> 388               RR2 0.13716008 0.235494847      1\n#> 389               RR1 0.27142423 0.164400765      0\n#> 390               RR2 0.27142423 0.398178911      1\n#> 391               RR1 0.31170915 0.192436558      0\n#> 392               RR2 0.31170915 0.453849503      1\n#> 393               RR1 0.38432123 0.251389541      0\n#> 394               RR2 0.38432123 0.552708975      1\n#> 395               RR1 0.35195589 0.203657407      0\n#> 396               RR2 0.35195589 0.532774344      1\n#> 397            Light1 4.47619048 2.834612861      1\n#> 398            Light2 4.47619048 5.389009186      7\n#> 399            Light1 4.88095238 3.330578512      1\n#> 400            Light2 4.88095238 6.285714286      7\n#> 401            Light1 4.81422719 3.156486052      1\n#> 402            Light2 4.81422719 6.011572505      7\n#> 403            Light1 5.73798627 4.606769195      1\n#> 404            Light2 5.73798627 6.666666667      7\n#> 405            Light1 5.24758561 4.453309805      1\n#> 406            Light2 5.24758561 6.009060565      7\n#> 407            Light1 5.72103152 4.712980419      1\n#> 408            Light2 5.72103152 6.641096866      7\n#> 409            Light1 5.53967329 4.862638019      1\n#> 410            Light2 5.53967329 6.282584122      7\n#> 411            Light1 5.68012021 4.984373197      1\n#> 412            Light2 5.68012021 6.113997923      7\n#> 413            Light1 5.55177496 4.701732750      1\n#> 414            Light2 5.55177496 6.342670793      7\n#> 415            Light1 5.74107476 4.956422206      1\n#> 416            Light2 5.74107476 6.514042973      7\n#> 417            Light1 5.40778534 4.415000000      1\n#> 418            Light2 5.40778534 6.333673469      7\n#> 419            Light1         NA          NA      1\n#> 420            Light2         NA          NA      7\n#> 421            Light1 5.97169059 4.816806220      1\n#> 422            Light2 5.97169059 6.769318182      7\n#> 423            Light1         NA          NA      1\n#> 424            Light2         NA          NA      7\n#> 425            Light1         NA          NA      1\n#> 426            Light2         NA          NA      7\n#> 427            Light1         NA          NA      1\n#> 428            Light2         NA          NA      7\n#> 429            Light1 5.42924136 5.162242188      1\n#> 430            Light2 5.42924136 5.705945005      7\n#> 431            Light1         NA          NA      1\n#> 432            Light2         NA          NA      7\n#> 433            Light1         NA          NA      1\n#> 434            Light2         NA          NA      7\n#> 435            Light1         NA          NA      1\n#> 436            Light2         NA          NA      7\n#> 437            Light1         NA          NA      1\n#> 438            Light2         NA          NA      7\n#> 439            Light1 4.84482759 2.804878049      1\n#> 440            Light2 4.84482759 6.451293103      7\n#> 441            Light1 5.21015695 4.294757727      1\n#> 442            Light2 5.21015695 6.570920738      7\n#> 443            Light1 4.25806452 3.036144578      1\n#> 444            Light2 4.25806452 6.015282931      7\n#> 445            Light1 5.00000000 3.333333333      1\n#> 446            Light2 5.00000000 6.568965517      7\n#> 447            Light1 5.19782836 4.242424242      1\n#> 448            Light2 5.19782836 6.128085599      7\n#> 449            Light1         NA          NA      1\n#> 450            Light2         NA          NA      7\n#> 451            Light1         NA          NA      1\n#> 452            Light2         NA          NA      7\n#> 453            Light1         NA          NA      1\n#> 454            Light2         NA          NA      7\n#> 455            Light1         NA          NA      1\n#> 456            Light2         NA          NA      7\n#> 457            Light1         NA          NA      1\n#> 458            Light2         NA          NA      7\n#> 459            Light1         NA          NA      1\n#> 460            Light2         NA          NA      7\n#> 461            Light1 4.43478261 3.420903674      1\n#> 462            Light2 4.43478261 5.000000000      7\n#> 463            Light1 4.10407738 3.762917253      1\n#> 464            Light2 4.10407738 4.410746502      7\n#> 465            Light1 5.00000000 4.279944444      1\n#> 466            Light2 5.00000000 5.654848485      7\n#> 467            Light1 5.10188239 4.477555167      1\n#> 468            Light2 5.10188239 5.756967367      7\n#> 469            Light1 4.92165308 4.193298199      1\n#> 470            Light2 4.92165308 5.716938330      7\n#> 471            Light1 4.96037224 4.286508899      1\n#> 472            Light2 4.96037224 5.627944292      7\n#> 473            Light1 4.84775158 4.227666344      1\n#> 474            Light2 4.84775158 5.361825146      7\n#> 475            Light1 4.72689642 4.050875991      1\n#> 476            Light2 4.72689642 5.272623786      7\n#> 477            Light1 5.42857143 4.564932127      1\n#> 478            Light2 5.42857143 6.428968254      7\n#> 479            Light1 5.16063561 4.617632572      1\n#> 480            Light2 5.16063561 5.685655515      7\n#> 481            Light1 5.20868452 4.511374738      1\n#> 482            Light2 5.20868452 6.091254693      7\n#> 483            Light1         NA          NA      1\n#> 484            Light2         NA          NA      7\n#> 485            Light1         NA          NA      1\n#> 486            Light2         NA          NA      7\n#> 487            Light1 6.31645570 4.781330867      1\n#> 488            Light2 6.31645570 6.960317460      7\n#> 489            Light1 6.24611673 5.788983695      1\n#> 490            Light2 6.24611673 6.731248540      7\n#> 491            Light1 5.46473182 4.872919288      1\n#> 492            Light2 5.46473182 6.041276004      7\n#> 493            Light1 5.51384781 5.043468328      1\n#> 494            Light2 5.51384781 5.978263445      7\n#> 495            Light1 5.72717348 5.105343749      1\n#> 496            Light2 5.72717348 6.695662830      7\n#> 497            Light1 5.63247791 4.945496634      1\n#> 498            Light2 5.63247791 6.356043738      7\n#> 499            Light1 5.57924641 4.529732894      1\n#> 500            Light2 5.57924641 6.759379434      7\n#> 501            Light1 5.59132390 4.763960580      1\n#> 502            Light2 5.59132390 6.445831216      7\n#> 503            Light1 5.57301132 4.706108630      1\n#> 504            Light2 5.57301132 6.542760472      7\n#> 505            Light1 5.33519490 4.519067178      1\n#> 506            Light2 5.33519490 6.419426523      7\n#> 507            Light1 5.78764018 4.719670576      1\n#> 508            Light2 5.78764018 6.837309433      7\n#> 509            Light1 5.33057851 4.250000000      1\n#> 510            Light2 5.33057851 6.851851852      7\n#> 511            Light1 5.38945911 4.521594339      1\n#> 512            Light2 5.38945911 6.435125490      7\n#> 513            Light1 6.29959329 5.478092167      1\n#> 514            Light2 6.29959329 6.953989867      7\n#> 515            Light1 5.43927084 4.601372356      1\n#> 516            Light2 5.43927084 6.415611472      7\n#> 517            Light1 5.13333333 3.939242424      1\n#> 518            Light2 5.13333333 6.067272727      7\n#> 519            Light1 4.99770247 4.082042225      1\n#> 520            Light2 4.99770247 5.616844694      7\n#> 521            Light1 5.97499933 5.478966669      1\n#> 522            Light2 5.97499933 6.456637600      7\n#> 523            Light1 6.14068826 5.557103175      1\n#> 524            Light2 6.14068826 6.679142300      7\n#> 525            Light1 5.69532210 4.919260083      1\n#> 526            Light2 5.69532210 6.442588919      7\n#> 527            Light1 6.07383693 5.309729246      1\n#> 528            Light2 6.07383693 6.787213115      7\n#> 529         Nitrogen1 2.60000000 1.666666667      1\n#> 530         Nitrogen2 2.60000000 3.717514124      9\n#> 531         Nitrogen1 2.33333333 1.235294118      1\n#> 532         Nitrogen2 2.33333333 3.470588235      9\n#> 533         Nitrogen1 3.27534541 1.916576087      1\n#> 534         Nitrogen2 3.27534541 4.450445178      9\n#> 535         Nitrogen1 3.00000000 1.818616894      1\n#> 536         Nitrogen2 3.00000000 4.319588449      9\n#> 537         Nitrogen1 3.55664906 2.647225559      1\n#> 538         Nitrogen2 3.55664906 4.822015602      9\n#> 539         Nitrogen1 3.17364476 2.463591249      1\n#> 540         Nitrogen2 3.17364476 4.187575957      9\n#> 541         Nitrogen1 3.36909162 2.838161820      1\n#> 542         Nitrogen2 3.36909162 4.049901011      9\n#> 543         Nitrogen1 3.09424094 2.727574581      1\n#> 544         Nitrogen2 3.09424094 3.496544316      9\n#> 545         Nitrogen1 3.34836639 2.963357772      1\n#> 546         Nitrogen2 3.34836639 3.825764015      9\n#> 547         Nitrogen1 3.37214190 2.998198257      1\n#> 548         Nitrogen2 3.37214190 3.815733962      9\n#> 549         Nitrogen1 4.84210526 3.632551020      1\n#> 550         Nitrogen2 4.84210526 6.076923077      9\n#> 551         Nitrogen1         NA          NA      1\n#> 552         Nitrogen2         NA          NA      9\n#> 553         Nitrogen1 4.00000000 2.333333333      1\n#> 554         Nitrogen2 4.00000000 5.480121212      9\n#> 555         Nitrogen1         NA          NA      1\n#> 556         Nitrogen2         NA          NA      9\n#> 557         Nitrogen1         NA          NA      1\n#> 558         Nitrogen2         NA          NA      9\n#> 559         Nitrogen1         NA          NA      1\n#> 560         Nitrogen2         NA          NA      9\n#> 561         Nitrogen1 4.57645777 3.722993078      1\n#> 562         Nitrogen2 4.57645777 5.442697108      9\n#> 563         Nitrogen1         NA          NA      1\n#> 564         Nitrogen2         NA          NA      9\n#> 565         Nitrogen1         NA          NA      1\n#> 566         Nitrogen2         NA          NA      9\n#> 567         Nitrogen1         NA          NA      1\n#> 568         Nitrogen2         NA          NA      9\n#> 569         Nitrogen1         NA          NA      1\n#> 570         Nitrogen2         NA          NA      9\n#> 571         Nitrogen1 3.80487805 3.000000000      1\n#> 572         Nitrogen2 3.80487805 5.634146341      9\n#> 573         Nitrogen1 3.92592814 2.999832215      1\n#> 574         Nitrogen2 3.92592814 4.612375017      9\n#> 575         Nitrogen1 3.48979592 1.845265589      1\n#> 576         Nitrogen2 3.48979592 6.000000000      9\n#> 577         Nitrogen1 3.70689655 3.000000000      1\n#> 578         Nitrogen2 3.70689655 4.804878049      9\n#> 579         Nitrogen1 3.65656566 2.422413793      1\n#> 580         Nitrogen2 3.65656566 4.677020202      9\n#> 581         Nitrogen1         NA          NA      1\n#> 582         Nitrogen2         NA          NA      9\n#> 583         Nitrogen1         NA          NA      1\n#> 584         Nitrogen2         NA          NA      9\n#> 585         Nitrogen1         NA          NA      1\n#> 586         Nitrogen2         NA          NA      9\n#> 587         Nitrogen1         NA          NA      1\n#> 588         Nitrogen2         NA          NA      9\n#> 589         Nitrogen1         NA          NA      1\n#> 590         Nitrogen2         NA          NA      9\n#> 591         Nitrogen1         NA          NA      1\n#> 592         Nitrogen2         NA          NA      9\n#> 593         Nitrogen1 5.59787234 4.681066760      1\n#> 594         Nitrogen2 5.59787234 6.511205674      9\n#> 595         Nitrogen1 5.17304277 4.693984330      1\n#> 596         Nitrogen2 5.17304277 5.651099750      9\n#> 597         Nitrogen1 3.77315609 2.510243180      1\n#> 598         Nitrogen2 3.77315609 4.928667954      9\n#> 599         Nitrogen1 3.74036934 2.522575563      1\n#> 600         Nitrogen2 3.74036934 4.880149220      9\n#> 601         Nitrogen1 3.76108845 2.822583736      1\n#> 602         Nitrogen2 3.76108845 4.495396003      9\n#> 603         Nitrogen1 3.63506648 2.657395793      1\n#> 604         Nitrogen2 3.63506648 4.433827737      9\n#> 605         Nitrogen1 5.32702967 4.159384488      1\n#> 606         Nitrogen2 5.32702967 6.326673343      9\n#> 607         Nitrogen1 5.28171681 4.027343323      1\n#> 608         Nitrogen2 5.28171681 6.555161507      9\n#> 609         Nitrogen1 4.12500000 2.917080251      1\n#> 610         Nitrogen2 4.12500000 5.700357143      9\n#> 611         Nitrogen1 4.74731704 3.354103343      1\n#> 612         Nitrogen2 4.74731704 5.881711318      9\n#> 613         Nitrogen1 5.29061584 4.317818042      1\n#> 614         Nitrogen2 5.29061584 6.354691645      9\n#> 615         Nitrogen1         NA          NA      1\n#> 616         Nitrogen2         NA          NA      9\n#> 617         Nitrogen1         NA          NA      1\n#> 618         Nitrogen2         NA          NA      9\n#> 619         Nitrogen1 5.77514249 3.580813118      1\n#> 620         Nitrogen2 5.77514249 8.484126984      9\n#> 621         Nitrogen1 4.91287436 4.259699191      1\n#> 622         Nitrogen2 4.91287436 5.755122819      9\n#> 623         Nitrogen1 3.89831390 3.111764842      1\n#> 624         Nitrogen2 3.89831390 4.765609587      9\n#> 625         Nitrogen1 3.88961416 1.981774674      1\n#> 626         Nitrogen2 3.88961416 5.489778763      9\n#> 627         Nitrogen1 3.67205651 2.530102764      1\n#> 628         Nitrogen2 3.67205651 4.754402834      9\n#> 629         Nitrogen1 6.42880106 5.136618282      1\n#> 630         Nitrogen2 6.42880106 7.627357471      9\n#> 631         Nitrogen1 6.58757267 4.574493146      1\n#> 632         Nitrogen2 6.58757267 8.351996461      9\n#> 633         Nitrogen1 6.44231889 4.955439761      1\n#> 634         Nitrogen2 6.44231889 7.663057988      9\n#> 635         Nitrogen1 6.21259213 4.623750963      1\n#> 636         Nitrogen2 6.21259213 7.290282363      9\n#> 637         Nitrogen1 6.11111111 4.653703704      1\n#> 638         Nitrogen2 6.11111111 7.662631437      9\n#> 639         Nitrogen1 6.25607942 4.465035457      1\n#> 640         Nitrogen2 6.25607942 8.057582470      9\n#> 641         Nitrogen1 6.07692308 4.500000000      1\n#> 642         Nitrogen2 6.07692308 7.825869835      9\n#> 643         Nitrogen1 5.81238274 4.493948521      1\n#> 644         Nitrogen2 5.81238274 7.548410307      9\n#> 645         Nitrogen1 7.63252340 6.277632200      1\n#> 646         Nitrogen2 7.63252340 8.743697383      9\n#> 647         Nitrogen1 6.11523199 4.695587202      1\n#> 648         Nitrogen2 6.11523199 7.736712413      9\n#> 649         Nitrogen1 5.06060606 3.749671053      1\n#> 650         Nitrogen2 5.06060606 6.500000000      9\n#> 651         Nitrogen1 4.42834220 3.677236621      1\n#> 652         Nitrogen2 4.42834220 5.141886496      9\n#> 653         Nitrogen1 3.17848800 2.594754508      1\n#> 654         Nitrogen2 3.17848800 3.779111104      9\n#> 655         Nitrogen1 3.60644656 2.866538462      1\n#> 656         Nitrogen2 3.60644656 4.550025510      9\n#> 657         Nitrogen1 6.13220760 4.824208323      1\n#> 658         Nitrogen2 6.13220760 7.365499722      9\n#> 659         Nitrogen1 5.46006681 3.594940476      1\n#> 660         Nitrogen2 5.46006681 7.587203939      9\n#> 661 Soil_disturbance1 3.47538337 2.054054054      1\n#> 662 Soil_disturbance2 3.47538337 4.809472362      9\n#> 663 Soil_disturbance1 3.84615385 2.000000000      1\n#> 664 Soil_disturbance2 3.84615385 6.500000000      9\n#> 665 Soil_disturbance1 3.67702251 2.110919540      1\n#> 666 Soil_disturbance2 3.67702251 5.589687342      9\n#> 667 Soil_disturbance1 5.33333333 3.385195853      1\n#> 668 Soil_disturbance2 5.33333333 7.119332298      9\n#> 669 Soil_disturbance1 4.27289967 2.976882142      1\n#> 670 Soil_disturbance2 4.27289967 5.555851265      9\n#> 671 Soil_disturbance1 5.14511960 3.409615385      1\n#> 672 Soil_disturbance2 5.14511960 6.823119873      9\n#> 673 Soil_disturbance1 4.03148101 2.972561873      1\n#> 674 Soil_disturbance2 4.03148101 4.994144144      9\n#> 675 Soil_disturbance1 5.06051535 3.947284623      1\n#> 676 Soil_disturbance2 5.06051535 5.910220365      9\n#> 677 Soil_disturbance1 4.10736121 2.758178748      1\n#> 678 Soil_disturbance2 4.10736121 5.479318736      9\n#> 679 Soil_disturbance1 4.32178477 3.155511400      1\n#> 680 Soil_disturbance2 4.32178477 5.578609711      9\n#> 681 Soil_disturbance1 4.42857143 2.682520325      1\n#> 682 Soil_disturbance2 4.42857143 6.470860566      9\n#> 683 Soil_disturbance1         NA          NA      1\n#> 684 Soil_disturbance2         NA          NA      9\n#> 685 Soil_disturbance1 3.90000000 2.499744898      1\n#> 686 Soil_disturbance2 3.90000000 5.483189655      9\n#> 687 Soil_disturbance1         NA          NA      1\n#> 688 Soil_disturbance2         NA          NA      9\n#> 689 Soil_disturbance1         NA          NA      1\n#> 690 Soil_disturbance2         NA          NA      9\n#> 691 Soil_disturbance1         NA          NA      1\n#> 692 Soil_disturbance2         NA          NA      9\n#> 693 Soil_disturbance1 3.25970322 2.486205237      1\n#> 694 Soil_disturbance2 3.25970322 4.238747901      9\n#> 695 Soil_disturbance1         NA          NA      1\n#> 696 Soil_disturbance2         NA          NA      9\n#> 697 Soil_disturbance1         NA          NA      1\n#> 698 Soil_disturbance2         NA          NA      9\n#> 699 Soil_disturbance1         NA          NA      1\n#> 700 Soil_disturbance2         NA          NA      9\n#> 701 Soil_disturbance1         NA          NA      1\n#> 702 Soil_disturbance2         NA          NA      9\n#> 703 Soil_disturbance1 3.19512195 1.780487805      1\n#> 704 Soil_disturbance2 3.19512195 5.439024390      9\n#> 705 Soil_disturbance1 4.50167785 2.744836116      1\n#> 706 Soil_disturbance2 4.50167785 6.289809582      9\n#> 707 Soil_disturbance1 4.00000000 2.333163265      1\n#> 708 Soil_disturbance2 4.00000000 5.757575758      9\n#> 709 Soil_disturbance1 3.43103448 2.568965517      1\n#> 710 Soil_disturbance2 3.43103448 5.439024390      9\n#> 711 Soil_disturbance1 4.06896552 2.585858586      1\n#> 712 Soil_disturbance2 4.06896552 5.711589636      9\n#> 713 Soil_disturbance1         NA          NA      1\n#> 714 Soil_disturbance2         NA          NA      9\n#> 715 Soil_disturbance1         NA          NA      1\n#> 716 Soil_disturbance2         NA          NA      9\n#> 717 Soil_disturbance1         NA          NA      1\n#> 718 Soil_disturbance2         NA          NA      9\n#> 719 Soil_disturbance1         NA          NA      1\n#> 720 Soil_disturbance2         NA          NA      9\n#> 721 Soil_disturbance1         NA          NA      1\n#> 722 Soil_disturbance2         NA          NA      9\n#> 723 Soil_disturbance1         NA          NA      1\n#> 724 Soil_disturbance2         NA          NA      9\n#> 725 Soil_disturbance1 2.34071085 1.671994536      1\n#> 726 Soil_disturbance2 2.34071085 3.281270032      9\n#> 727 Soil_disturbance1 2.17706434 1.896863125      1\n#> 728 Soil_disturbance2 2.17706434 2.625147007      9\n#> 729 Soil_disturbance1 3.40212766 2.380928571      1\n#> 730 Soil_disturbance2 3.40212766 4.625284091      9\n#> 731 Soil_disturbance1 3.25373134 2.302267442      1\n#> 732 Soil_disturbance2 3.25373134 4.430699260      9\n#> 733 Soil_disturbance1 3.77353148 2.808479219      1\n#> 734 Soil_disturbance2 3.77353148 4.921041929      9\n#> 735 Soil_disturbance1 3.97872470 2.974880818      1\n#> 736 Soil_disturbance2 3.97872470 5.140814731      9\n#> 737 Soil_disturbance1 3.07913333 2.184894606      1\n#> 738 Soil_disturbance2 3.07913333 4.308136426      9\n#> 739 Soil_disturbance1 2.89417781 2.195281440      1\n#> 740 Soil_disturbance2 2.89417781 4.023431994      9\n#> 741 Soil_disturbance1 3.90022624 2.222101449      1\n#> 742 Soil_disturbance2 3.90022624 6.250000000      9\n#> 743 Soil_disturbance1 2.49869452 1.831487956      1\n#> 744 Soil_disturbance2 2.49869452 4.353716327      9\n#> 745 Soil_disturbance1 5.17056594 3.237734394      1\n#> 746 Soil_disturbance2 5.17056594 6.784789528      9\n#> 747 Soil_disturbance1         NA          NA      1\n#> 748 Soil_disturbance2         NA          NA      9\n#> 749 Soil_disturbance1         NA          NA      1\n#> 750 Soil_disturbance2         NA          NA      9\n#> 751 Soil_disturbance1 4.50802811 2.160844448      1\n#> 752 Soil_disturbance2 4.50802811 8.460971152      9\n#> 753 Soil_disturbance1 3.72244571 2.975681714      1\n#> 754 Soil_disturbance2 3.72244571 4.647642389      9\n#> 755 Soil_disturbance1 3.34035884 2.652346217      1\n#> 756 Soil_disturbance2 3.34035884 4.316478019      9\n#> 757 Soil_disturbance1 3.35107263 2.203449197      1\n#> 758 Soil_disturbance2 3.35107263 5.322170608      9\n#> 759 Soil_disturbance1 3.11775237 2.168740064      1\n#> 760 Soil_disturbance2 3.11775237 5.087087078      9\n#> 761 Soil_disturbance1 4.72934036 2.701515793      1\n#> 762 Soil_disturbance2 4.72934036 7.042813695      9\n#> 763 Soil_disturbance1 6.34526243 2.832766500      1\n#> 764 Soil_disturbance2 6.34526243 8.671941557      9\n#> 765 Soil_disturbance1 4.50637343 2.390913651      1\n#> 766 Soil_disturbance2 4.50637343 7.018260088      9\n#> 767 Soil_disturbance1 3.60546272 2.036043967      1\n#> 768 Soil_disturbance2 3.60546272 6.500131926      9\n#> 769 Soil_disturbance1 4.54391757 2.273312042      1\n#> 770 Soil_disturbance2 4.54391757 7.594822399      9\n#> 771 Soil_disturbance1 5.62618508 2.504946445      1\n#> 772 Soil_disturbance2 5.62618508 8.421311276      9\n#> 773 Soil_disturbance1 5.85714286 2.148015873      1\n#> 774 Soil_disturbance2 5.85714286 8.412131249      9\n#> 775 Soil_disturbance1 5.29846814 2.434489967      1\n#> 776 Soil_disturbance2 5.29846814 7.661146834      9\n#> 777 Soil_disturbance1 7.11697034 5.038970242      1\n#> 778 Soil_disturbance2 7.11697034 8.825881321      9\n#> 779 Soil_disturbance1 4.44700608 2.262828947      1\n#> 780 Soil_disturbance2 4.44700608 7.028945621      9\n#> 781 Soil_disturbance1 4.63525499 2.710070850      1\n#> 782 Soil_disturbance2 4.63525499 6.266730769      9\n#> 783 Soil_disturbance1 2.94078836 2.197448402      1\n#> 784 Soil_disturbance2 2.94078836 3.848218137      9\n#> 785 Soil_disturbance1 4.39600648 3.306644992      1\n#> 786 Soil_disturbance2 4.39600648 5.545852412      9\n#> 787 Soil_disturbance1 4.40371630 3.049984568      1\n#> 788 Soil_disturbance2 4.40371630 5.870871385      9\n#> 789 Soil_disturbance1 4.54238010 2.874646256      1\n#> 790 Soil_disturbance2 4.54238010 6.352716530      9\n#> 791 Soil_disturbance1 4.56904762 2.462940379      1\n#> 792 Soil_disturbance2 4.56904762 7.142718529      9\n#>       N1               hoved                grunn    \n#>  Length:792         Length:792         T11-C-1 : 12  \n#>  Class :character   Class :character   T11-C-2 : 12  \n#>  Mode  :character   Mode  :character   T12-C-1 : 12  \n#>                                        T12-C-2 : 12  \n#>                                        T13-C-1 : 12  \n#>                                        T13-C-10: 12  \n#>                                        (Other) :720  \n#>     county             region                 Ind     \n#>  Length:792         Length:792         CC1      : 66  \n#>  Class :character   Class :character   CC2      : 66  \n#>  Mode  :character   Mode  :character   Light1   : 66  \n#>                                        Light2   : 66  \n#>                                        Nitrogen1: 66  \n#>                                        Nitrogen2: 66  \n#>                                        (Other)  :396  \n#>        Rv                Gv             maxmin     \n#>  Min.   :0.07599   Min.   :0.0000   Min.   :0.000  \n#>  1st Qu.:0.31409   1st Qu.:0.3156   1st Qu.:0.750  \n#>  Median :1.42385   Median :1.1076   Median :1.000  \n#>  Mean   :2.50244   Mean   :2.5277   Mean   :2.583  \n#>  3rd Qu.:4.76404   3rd Qu.:4.6944   3rd Qu.:2.500  \n#>  Max.   :7.63252   Max.   :8.8259   Max.   :9.000  \n#>  NA's   :192       NA's   :192\nhead(natopen.ref.cov.val)\n#>        N1 hoved  grunn county region Ind        Rv\n#> 1 natopen    NA T2-C-1    all    all CC1 0.2187255\n#> 2 natopen    NA T2-C-1    all    all CC2 0.2187255\n#> 3 natopen    NA T2-C-2    all    all CC1 0.1967109\n#> 4 natopen    NA T2-C-2    all    all CC2 0.1967109\n#> 5 natopen    NA T2-C-3    all    all CC1 0.1714199\n#> 6 natopen    NA T2-C-3    all    all CC2 0.1714199\n#>           Gv maxmin\n#> 1 0.08766832      0\n#> 2 0.38888889      1\n#> 3 0.05382353      0\n#> 4 0.28434874      1\n#> 5 0.03753882      0\n#> 6 0.39205879      1\n\n#### scaled values ####\nr.s <- 1    # reference value\nl.s <- 0.6  # limit value\na.s <- 0    # abscence of indicator, or indicator at maximum\n\n#### function for calculating scaled values for measured value ####\n\n## scaling function including truncation\nscal <- function() {\n  # place to hold the result\n   x <- numeric()\n  if (maxmin < ref) {\n    # values >= the reference value equal 1\n    if (val >= ref) {x <- 1}\n    # values < the reference value and >= the limit value can be deducted from the linear relationship between these two\n    if (val < ref & val >= lim) {x <- (l.s + (val-lim) * ( (r.s-l.s) / (ref-lim) ) )}\n    # values < the limit value and > maxmin can be deducted from the linear relationship between these two\n    if (val < lim & val > maxmin) {x <- (a.s + (val-maxmin) * ( (l.s-a.s) / (lim-maxmin) ) )}\n    # value equals or lower than maxmin\n    if (val <= maxmin) {x <-0}\n  } else {\n    # values <= the reference value equal 1\n    if (val <= ref) {x <- 1}\n    # values > the reference value and <= the limit value can be deducted from the linear relationship between these two\n    if (val > ref & val <= lim) {x <- ( r.s - ( (r.s - l.s) * (val - ref) / (lim - ref) ) )}\n    # values > the limit value and < maxmin can be deducted from the linear relationship between these two\n    if (val > lim) {x <- ( l.s - (l.s * (val - lim) / (maxmin - lim) ) )}\n    # value equals or larger than maxmin\n    if (val >= maxmin) {x <-0}\n  }\n  return(x)\n  \n}\n\n#### calculating scaled and non-truncated values for the indicators based on the dataset ####\nfor (i in 1:nrow(ANO.natopen) ) {  #\n  tryCatch({\n    print(i)\n    print(paste(ANO.natopen$ano_flate_id[i]))\n    print(paste(ANO.natopen$ano_punkt_id[i]))\n#    ANO.natopen$Hovedoekosystem_sirkel[i]\n#    ANO.natopen$Hovedoekosystem_rute[i]\n\n    # if the ANO.hovedtype exists in the reference\n    if (ANO.natopen$hovedtype_rute[i] %in% gsub(\"-\",\"\",unique(substr(natopen.ref.cov.val$grunn,1,3))) ) {\n      \n      # if there is any species present in current ANO point  \n      if ( length(ANO.sp.ind[ANO.sp.ind$ParentGlobalID==as.character(ANO.natopen$GlobalID[i]),'Species']) > 0 ) {\n        \n\n        # Grime's C\n        \n        dat <- ANO.sp.ind[ANO.sp.ind$ParentGlobalID==as.character(ANO.natopen$GlobalID[i]),c('art_dekning','CC')]\n        results.natopen.ANO[['original']][i,'richness'] <- nrow(dat)\n        dat <- dat[!is.na(dat$CC),]\n        \n        if ( nrow(dat)>0 ) {\n          \n          val <- sum(dat[,'art_dekning'] * dat[,'CC'],na.rm=T) / sum(dat[,'art_dekning'],na.rm=T)\n          # lower part of distribution\n          if( ANO.natopen$kartleggingsenhet_1m2[i] %in% c(\"T2-C-7\",\"T2-C-8\") ) {\n            ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='CC1' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),\"_BN\",sep=\"\"),'Rv']\n            lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='CC1' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),\"_BN\",sep=\"\"),'Gv']\n          } else {\n            ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='CC1' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n            lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='CC1' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n          }\n          maxmin <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='CC1' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n          # coercing x into results.natopen.ANO dataframe\n          results.natopen.ANO[['scaled']][i,'CC1'] <- scal() \n          results.natopen.ANO[['non-truncated']][i,'CC1'] <- scal.2() \n          results.natopen.ANO[['original']][i,'CC1'] <- val \n          \n          # upper part of distribution\n          if( ANO.natopen$kartleggingsenhet_1m2[i] %in% c(\"T2-C-7\",\"T2-C-8\") ) {\n            ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='CC2' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),\"_BN\",sep=\"\"),'Rv']\n            lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='CC2' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),\"_BN\",sep=\"\"),'Gv']\n          } else {\n            ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='CC2' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n            lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='CC2' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n          }          \n          maxmin <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='CC2' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n          # coercing x into results.natopen.ANO dataframe\n          results.natopen.ANO[['scaled']][i,'CC2'] <- scal() \n          results.natopen.ANO[['non-truncated']][i,'CC2'] <- scal.2() \n          results.natopen.ANO[['original']][i,'CC2'] <- val\n        }\n          \n        \n        # Grime's S\n        dat <- ANO.sp.ind[ANO.sp.ind$ParentGlobalID==as.character(ANO.natopen$GlobalID[i]),c('art_dekning','SS')]\n        results.natopen.ANO[['original']][i,'richness'] <- nrow(dat)\n        dat <- dat[!is.na(dat$SS),]\n        \n        if ( nrow(dat)>0 ) {\n          \n          val <- sum(dat[,'art_dekning'] * dat[,'SS'],na.rm=T) / sum(dat[,'art_dekning'],na.rm=T)\n          # lower part of distribution\n          if( ANO.natopen$kartleggingsenhet_1m2[i] %in% c(\"T2-C-7\",\"T2-C-8\") ) {\n            ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='SS1' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),\"_BN\",sep=\"\"),'Rv']\n            lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='SS1' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),\"_BN\",sep=\"\"),'Gv']\n          } else {\n            ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='SS1' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n            lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='SS1' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n          }          \n          maxmin <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='SS1' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n          # coercing x into results.natopen.ANO dataframe\n          results.natopen.ANO[['scaled']][i,'SS1'] <- scal() \n          results.natopen.ANO[['non-truncated']][i,'SS1'] <- scal.2() \n          results.natopen.ANO[['original']][i,'SS1'] <- val \n          \n          # upper part of distribution\n          if( ANO.natopen$kartleggingsenhet_1m2[i] %in% c(\"T2-C-7\",\"T2-C-8\") ) {\n            ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='SS2' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),\"_BN\",sep=\"\"),'Rv']\n            lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='SS2' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),\"_BN\",sep=\"\"),'Gv']\n          } else {\n            ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='SS2' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n            lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='SS2' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n          }          \n          maxmin <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='SS2' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n          # coercing x into results.natopen.ANO dataframe\n          results.natopen.ANO[['scaled']][i,'SS2'] <- scal() \n          results.natopen.ANO[['non-truncated']][i,'SS2'] <- scal.2() \n          results.natopen.ANO[['original']][i,'SS2'] <- val\n        }\n        \n        \n        # Grime's R\n        dat <- ANO.sp.ind[ANO.sp.ind$ParentGlobalID==as.character(ANO.natopen$GlobalID[i]),c('art_dekning','RR')]\n        results.natopen.ANO[['original']][i,'richness'] <- nrow(dat)\n        dat <- dat[!is.na(dat$RR),]\n        \n        if ( nrow(dat)>0 ) {\n          \n          val <- sum(dat[,'art_dekning'] * dat[,'RR'],na.rm=T) / sum(dat[,'art_dekning'],na.rm=T)\n          # lower part of distribution\n          if( ANO.natopen$kartleggingsenhet_1m2[i] %in% c(\"T2-C-7\",\"T2-C-8\") ) {\n            ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='RR1' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),\"_BN\",sep=\"\"),'Rv']\n            lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='RR1' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),\"_BN\",sep=\"\"),'Gv']\n          } else {\n            ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='RR1' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n            lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='RR1' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n          }          \n          maxmin <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='RR1' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n          # coercing x into results.natopen.ANO dataframe\n          results.natopen.ANO[['scaled']][i,'RR1'] <- scal() \n          results.natopen.ANO[['non-truncated']][i,'RR1'] <- scal.2() \n          results.natopen.ANO[['original']][i,'RR1'] <- val \n          \n          # upper part of distribution\n          if( ANO.natopen$kartleggingsenhet_1m2[i] %in% c(\"T2-C-7\",\"T2-C-8\") ) {\n            ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='RR2' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),\"_BN\",sep=\"\"),'Rv']\n            lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='RR2' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),\"_BN\",sep=\"\"),'Gv']\n          } else {\n            ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='RR2' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n            lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='RR2' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n          }          \n          maxmin <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='RR2' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n          # coercing x into results.natopen.ANO dataframe\n          results.natopen.ANO[['scaled']][i,'RR2'] <- scal() \n          results.natopen.ANO[['non-truncated']][i,'RR2'] <- scal.2() \n          results.natopen.ANO[['original']][i,'RR2'] <- val\n        }\n        \n        \n          # Light\n          dat <- ANO.sp.ind[ANO.sp.ind$ParentGlobalID==as.character(ANO.natopen$GlobalID[i]),c('art_dekning','Light')]\n          results.natopen.ANO[['original']][i,'richness'] <- nrow(dat)\n          dat <- dat[!is.na(dat$Light),]\n          \n          if ( nrow(dat)>0 ) {\n            \n            val <- sum(dat[,'art_dekning'] * dat[,'Light'],na.rm=T) / sum(dat[,'art_dekning'],na.rm=T)\n            # lower part of distribution\n            if( ANO.natopen$kartleggingsenhet_1m2[i] %in% c(\"T2-C-7\",\"T2-C-8\") ) {\n              ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Light1' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),\"_BN\",sep=\"\"),'Rv']\n              lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Light1' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),\"_BN\",sep=\"\"),'Gv']\n            } else {\n              ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Light1' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n              lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Light1' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n            }            \n            maxmin <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Light1' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n            # coercing x into results.natopen.ANO dataframe\n            results.natopen.ANO[['scaled']][i,'Light1'] <- scal() \n            results.natopen.ANO[['non-truncated']][i,'Light1'] <- scal.2() \n            results.natopen.ANO[['original']][i,'Light1'] <- val \n            \n            # upper part of distribution\n            if( ANO.natopen$kartleggingsenhet_1m2[i] %in% c(\"T2-C-7\",\"T2-C-8\") ) {\n              ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Light2' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),\"_BN\",sep=\"\"),'Rv']\n              lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Light2' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),\"_BN\",sep=\"\"),'Gv']\n            } else {\n              ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Light2' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n              lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Light2' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n            }            \n            maxmin <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Light2' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n            # coercing x into results.natopen.ANO dataframe\n            results.natopen.ANO[['scaled']][i,'Light2'] <- scal() \n            results.natopen.ANO[['non-truncated']][i,'Light2'] <- scal.2() \n            results.natopen.ANO[['original']][i,'Light2'] <- val\n          }\n          \n          \n         \n          \n          # Nitrogen\n          dat <- ANO.sp.ind[ANO.sp.ind$ParentGlobalID==as.character(ANO.natopen$GlobalID[i]),c('art_dekning','Nitrogen')]\n          results.natopen.ANO[['original']][i,'richness'] <- nrow(dat)\n          dat <- dat[!is.na(dat$Nitrogen),]\n          \n          if ( nrow(dat)>0 ) {\n            \n            val <- sum(dat[,'art_dekning'] * dat[,'Nitrogen'],na.rm=T) / sum(dat[,'art_dekning'],na.rm=T)\n            # lower part of distribution\n            if( ANO.natopen$kartleggingsenhet_1m2[i] %in% c(\"T2-C-7\",\"T2-C-8\") ) {\n              ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Nitrogen1' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),\"_BN\",sep=\"\"),'Rv']\n              lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Nitrogen1' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),\"_BN\",sep=\"\"),'Gv']\n            } else {\n              ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Nitrogen1' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n              lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Nitrogen1' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n            }            \n            maxmin <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Nitrogen1' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n            # coercing x into results.natopen.ANO dataframe\n            results.natopen.ANO[['scaled']][i,'Nitrogen1'] <- scal() \n            results.natopen.ANO[['non-truncated']][i,'Nitrogen1'] <- scal.2() \n            results.natopen.ANO[['original']][i,'Nitrogen1'] <- val \n            \n            # upper part of distribution\n            if( ANO.natopen$kartleggingsenhet_1m2[i] %in% c(\"T2-C-7\",\"T2-C-8\") ) {\n              ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Nitrogen2' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),\"_BN\",sep=\"\"),'Rv']\n              lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Nitrogen2' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),\"_BN\",sep=\"\"),'Gv']\n            } else {\n              ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Nitrogen2' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n              lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Nitrogen2' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n            }            \n            maxmin <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Nitrogen2' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n            # coercing x into results.natopen.ANO dataframe\n            results.natopen.ANO[['scaled']][i,'Nitrogen2'] <- scal() \n            results.natopen.ANO[['non-truncated']][i,'Nitrogen2'] <- scal.2() \n            results.natopen.ANO[['original']][i,'Nitrogen2'] <- val\n          }\n          \n          \n\n          \n          \n          # Soil_disturbance\n          dat <- ANO.sp.ind[ANO.sp.ind$ParentGlobalID==as.character(ANO.natopen$GlobalID[i]),c('art_dekning','Soil_disturbance')]\n          results.natopen.ANO[['original']][i,'richness'] <- nrow(dat)\n          dat <- dat[!is.na(dat$Soil_disturbance),]\n          \n          if ( nrow(dat)>0 ) {\n            \n            val <- sum(dat[,'art_dekning'] * dat[,'Soil_disturbance'],na.rm=T) / sum(dat[,'art_dekning'],na.rm=T)\n            # lower part of distribution\n            if( ANO.natopen$kartleggingsenhet_1m2[i] %in% c(\"T2-C-7\",\"T2-C-8\") ) {\n              ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Soil_disturbance1' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),\"_BN\",sep=\"\"),'Rv']\n              lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Soil_disturbance1' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),\"_BN\",sep=\"\"),'Gv']\n            } else {\n              ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Soil_disturbance1' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n              lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Soil_disturbance1' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n            }           \n            maxmin <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Soil_disturbance1' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n            # coercing x into results.natopen.ANO dataframe\n            results.natopen.ANO[['scaled']][i,'Soil_disturbance1'] <- scal() \n            results.natopen.ANO[['non-truncated']][i,'Soil_disturbance1'] <- scal.2() \n            results.natopen.ANO[['original']][i,'Soil_disturbance1'] <- val \n            \n            # upper part of distribution\n            if( ANO.natopen$kartleggingsenhet_1m2[i] %in% c(\"T2-C-7\",\"T2-C-8\") ) {\n              ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Soil_disturbance2' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),\"_BN\",sep=\"\"),'Rv']\n              lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Soil_disturbance2' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),\"_BN\",sep=\"\"),'Gv']\n            } else {\n              ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Soil_disturbance2' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Rv']\n              lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Soil_disturbance2' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'Gv']\n            }\n            maxmin <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Soil_disturbance2' & natopen.ref.cov.val$grunn==as.character(results.natopen.ANO[['original']][i,\"kartleggingsenhet_1m2\"]),'maxmin']\n            # coercing x into results.natopen.ANO dataframe\n            results.natopen.ANO[['scaled']][i,'Soil_disturbance2'] <- scal() \n            results.natopen.ANO[['non-truncated']][i,'Soil_disturbance2'] <- scal.2() \n            results.natopen.ANO[['original']][i,'Soil_disturbance2'] <- val\n          }\n          \n          \n          \n        }\n      }\n      \n\n    \n  }, error=function(e){cat(\"ERROR :\",conditionMessage(e), \"\\n\")})\n}\n\n# for using both sides of the plant indicators\nresults.natopen.ANO[['2-sided']] <- results.natopen.ANO[['non-truncated']]\n\n# remove values >1 for 2-sided indicators\nresults.natopen.ANO[['2-sided']]$CC1[results.natopen.ANO[['2-sided']]$CC1>1] <- NA\nresults.natopen.ANO[['2-sided']]$CC2[results.natopen.ANO[['2-sided']]$CC2>1] <- NA\n\nresults.natopen.ANO[['2-sided']]$SS1[results.natopen.ANO[['2-sided']]$SS1>1] <- NA\nresults.natopen.ANO[['2-sided']]$SS2[results.natopen.ANO[['2-sided']]$SS2>1] <- NA\n\nresults.natopen.ANO[['2-sided']]$RR1[results.natopen.ANO[['2-sided']]$RR1>1] <- NA\nresults.natopen.ANO[['2-sided']]$RR2[results.natopen.ANO[['2-sided']]$RR2>1] <- NA\n\nresults.natopen.ANO[['2-sided']]$Light1[results.natopen.ANO[['2-sided']]$Light1>1] <- NA\nresults.natopen.ANO[['2-sided']]$Light2[results.natopen.ANO[['2-sided']]$Light2>1] <- NA\n\nresults.natopen.ANO[['2-sided']]$Nitrogen1[results.natopen.ANO[['2-sided']]$Nitrogen1>1] <- NA\nresults.natopen.ANO[['2-sided']]$Nitrogen2[results.natopen.ANO[['2-sided']]$Nitrogen2>1] <- NA\n\nresults.natopen.ANO[['2-sided']]$Soil_disturbance1[results.natopen.ANO[['2-sided']]$Soil_disturbance1>1] <- NA\nresults.natopen.ANO[['2-sided']]$Soil_disturbance2[results.natopen.ANO[['2-sided']]$Soil_disturbance2>1] <- NA\n\n#### calculating scaled and non-truncated values for the indicators based on the dataset ####\nfor (i in 1:nrow(GRUK.natopen) ) {  #\n  tryCatch({\n    print(i)\n    print(paste(GRUK.natopen$Flate_ID[i]))\n    print(paste(GRUK.natopen$uPunkt_ID[i]))\n    #    GRUK.natopen$Hovedoekosystem_sirkel[i]\n    #    GRUK.natopen$Hovedoekosystem_rute[i]\n    \n    \n    \n    # if the GRUK.hovedtype exists in the reference\n#    if (GRUK.natopen$hovedtype_rute[i] %in% unique(substr(natopen.ref.cov.val$grunn,1,2)) ) {\n      \n      # if there is any species present in current GRUK point  \n      if ( length(GRUK.species.ind[GRUK.species.ind$ParentGlobalID==as.character(GRUK.natopen$GlobalID[i]),'Species']) > 0 ) {\n        \n        \n        # Grime's C\n        \n        dat <- GRUK.species.ind[GRUK.species.ind$ParentGlobalID==as.character(GRUK.natopen$GlobalID[i]),c('art_dekning','CC')]\n        results.natopen.GRUK[['original']][i,'richness'] <- nrow(dat)\n        dat <- dat[!is.na(dat$CC),]\n        \n        if ( nrow(dat)>0 ) {\n          \n          val <- sum(dat[,'art_dekning'] * dat[,'CC'],na.rm=T) / sum(dat[,'art_dekning'],na.rm=T)\n          # lower part of distribution\n          ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='CC1' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),\"_BN\",sep=\"\"),'Rv']\n          lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='CC1' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),\"_BN\",sep=\"\"),'Gv']\n          maxmin <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='CC1' & natopen.ref.cov.val$grunn==as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),'maxmin']\n          # coercing x into results.natopen.GRUK dataframe\n          results.natopen.GRUK[['scaled']][i,'CC1'] <- scal() \n          results.natopen.GRUK[['non-truncated']][i,'CC1'] <- scal.2() \n          results.natopen.GRUK[['original']][i,'CC1'] <- val \n          \n          # upper part of distribution\n          ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='CC2' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),\"_BN\",sep=\"\"),'Rv']\n          lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='CC2' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),\"_BN\",sep=\"\"),'Gv']\n          maxmin <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='CC2' & natopen.ref.cov.val$grunn==as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),'maxmin']\n          # coercing x into results.natopen.GRUK dataframe\n          results.natopen.GRUK[['scaled']][i,'CC2'] <- scal() \n          results.natopen.GRUK[['non-truncated']][i,'CC2'] <- scal.2() \n          results.natopen.GRUK[['original']][i,'CC2'] <- val\n\n        }\n        \n        \n        # Grime's S\n        dat <- GRUK.species.ind[GRUK.species.ind$ParentGlobalID==as.character(GRUK.natopen$GlobalID[i]),c('art_dekning','SS')]\n        results.natopen.GRUK[['original']][i,'richness'] <- nrow(dat)\n        dat <- dat[!is.na(dat$SS),]\n        \n        if ( nrow(dat)>0 ) {\n          \n          val <- sum(dat[,'art_dekning'] * dat[,'SS'],na.rm=T) / sum(dat[,'art_dekning'],na.rm=T)\n          # lower part of distribution\n          ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='SS1' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),\"_BN\",sep=\"\"),'Rv']\n          lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='SS1' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),\"_BN\",sep=\"\"),'Gv']\n          maxmin <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='SS1' & natopen.ref.cov.val$grunn==as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),'maxmin']\n          # coercing x into results.natopen.GRUK dataframe\n          results.natopen.GRUK[['scaled']][i,'SS1'] <- scal() \n          results.natopen.GRUK[['non-truncated']][i,'SS1'] <- scal.2() \n          results.natopen.GRUK[['original']][i,'SS1'] <- val\n          \n          # upper part of distribution\n          ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='SS2' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),\"_BN\",sep=\"\"),'Rv']\n          lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='SS2' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),\"_BN\",sep=\"\"),'Gv']\n          maxmin <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='SS2' & natopen.ref.cov.val$grunn==as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),'maxmin']\n          # coercing x into results.natopen.GRUK dataframe\n          results.natopen.GRUK[['scaled']][i,'SS2'] <- scal() \n          results.natopen.GRUK[['non-truncated']][i,'SS2'] <- scal.2() \n          results.natopen.GRUK[['original']][i,'SS2'] <- val\n          \n        }\n        \n        \n        # Grime's R\n        dat <- GRUK.species.ind[GRUK.species.ind$ParentGlobalID==as.character(GRUK.natopen$GlobalID[i]),c('art_dekning','RR')]\n        results.natopen.GRUK[['original']][i,'richness'] <- nrow(dat)\n        dat <- dat[!is.na(dat$RR),]\n        \n        if ( nrow(dat)>0 ) {\n          \n          val <- sum(dat[,'art_dekning'] * dat[,'RR'],na.rm=T) / sum(dat[,'art_dekning'],na.rm=T)\n          # lower part of distribution\n          ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='RR1' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),\"_BN\",sep=\"\"),'Rv']\n          lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='RR1' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),\"_BN\",sep=\"\"),'Gv']\n          maxmin <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='RR1' & natopen.ref.cov.val$grunn==as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),'maxmin']\n          # coercing x into results.natopen.GRUK dataframe\n          results.natopen.GRUK[['scaled']][i,'RR1'] <- scal() \n          results.natopen.GRUK[['non-truncated']][i,'RR1'] <- scal.2() \n          results.natopen.GRUK[['original']][i,'RR1'] <- val\n          \n          # upper part of distribution\n          ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='RR2' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),\"_BN\",sep=\"\"),'Rv']\n          lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='RR2' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),\"_BN\",sep=\"\"),'Gv']\n          maxmin <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='RR2' & natopen.ref.cov.val$grunn==as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),'maxmin']\n          # coercing x into results.natopen.GRUK dataframe\n          results.natopen.GRUK[['scaled']][i,'RR2'] <- scal() \n          results.natopen.GRUK[['non-truncated']][i,'RR2'] <- scal.2() \n          results.natopen.GRUK[['original']][i,'RR2'] <- val\n          \n        }\n        \n        \n        # Light\n        dat <- GRUK.species.ind[GRUK.species.ind$ParentGlobalID==as.character(GRUK.natopen$GlobalID[i]),c('art_dekning','Light')]\n        results.natopen.GRUK[['original']][i,'richness'] <- nrow(dat)\n        dat <- dat[!is.na(dat$Light),]\n        \n        if ( nrow(dat)>0 ) {\n          \n          val <- sum(dat[,'art_dekning'] * dat[,'Light'],na.rm=T) / sum(dat[,'art_dekning'],na.rm=T)\n          # lower part of distribution\n          ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Light1' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),\"_BN\",sep=\"\"),'Rv']\n          lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Light1' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),\"_BN\",sep=\"\"),'Gv']\n          maxmin <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Light1' & natopen.ref.cov.val$grunn==as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),'maxmin']\n          # coercing x into results.natopen.GRUK dataframe\n          results.natopen.GRUK[['scaled']][i,'Light1'] <- scal() \n          results.natopen.GRUK[['non-truncated']][i,'Light1'] <- scal.2() \n          results.natopen.GRUK[['original']][i,'Light1'] <- val\n          \n          # upper part of distribution\n          ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Light2' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),\"_BN\",sep=\"\"),'Rv']\n          lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Light2' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),\"_BN\",sep=\"\"),'Gv']\n          maxmin <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Light2' & natopen.ref.cov.val$grunn==as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),'maxmin']\n          # coercing x into results.natopen.GRUK dataframe\n          results.natopen.GRUK[['scaled']][i,'Light2'] <- scal() \n          results.natopen.GRUK[['non-truncated']][i,'Light2'] <- scal.2() \n          results.natopen.GRUK[['original']][i,'Light2'] <- val\n          \n\n        }\n        \n        \n        \n        \n        # Nitrogen\n        dat <- GRUK.species.ind[GRUK.species.ind$ParentGlobalID==as.character(GRUK.natopen$GlobalID[i]),c('art_dekning','Nitrogen')]\n        results.natopen.GRUK[['original']][i,'richness'] <- nrow(dat)\n        dat <- dat[!is.na(dat$Nitrogen),]\n        \n        if ( nrow(dat)>0 ) {\n          \n          val <- sum(dat[,'art_dekning'] * dat[,'Nitrogen'],na.rm=T) / sum(dat[,'art_dekning'],na.rm=T)\n          # lower part of distribution\n          ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Nitrogen1' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),\"_BN\",sep=\"\"),'Rv']\n          lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Nitrogen1' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),\"_BN\",sep=\"\"),'Gv']\n          maxmin <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Nitrogen1' & natopen.ref.cov.val$grunn==as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),'maxmin']\n          # coercing x into results.natopen.GRUK dataframe\n          results.natopen.GRUK[['scaled']][i,'Nitrogen1'] <- scal() \n          results.natopen.GRUK[['non-truncated']][i,'Nitrogen1'] <- scal.2() \n          results.natopen.GRUK[['original']][i,'Nitrogen1'] <- val\n          \n\n          # upper part of distribution\n          ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Nitrogen2' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),\"_BN\",sep=\"\"),'Rv']\n          lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Nitrogen2' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),\"_BN\",sep=\"\"),'Gv']\n          maxmin <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Nitrogen2' & natopen.ref.cov.val$grunn==as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),'maxmin']\n          # coercing x into results.natopen.GRUK dataframe\n          results.natopen.GRUK[['scaled']][i,'Nitrogen2'] <- scal() \n          results.natopen.GRUK[['non-truncated']][i,'Nitrogen2'] <- scal.2() \n          results.natopen.GRUK[['original']][i,'Nitrogen2'] <- val\n          \n        }\n        \n        \n        \n        \n        \n        \n        # Soil_disturbance\n        dat <- GRUK.species.ind[GRUK.species.ind$ParentGlobalID==as.character(GRUK.natopen$GlobalID[i]),c('art_dekning','Soil_disturbance')]\n        results.natopen.GRUK[['original']][i,'richness'] <- nrow(dat)\n        dat <- dat[!is.na(dat$Soil_disturbance),]\n        \n        if ( nrow(dat)>0 ) {\n          \n          val <- sum(dat[,'art_dekning'] * dat[,'Soil_disturbance'],na.rm=T) / sum(dat[,'art_dekning'],na.rm=T)\n          # lower part of distribution\n          ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Soil_disturbance1' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),\"_BN\",sep=\"\"),'Rv']\n          lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Soil_disturbance1' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),\"_BN\",sep=\"\"),'Gv']\n          maxmin <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Soil_disturbance1' & natopen.ref.cov.val$grunn==as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),'maxmin']\n          # coercing x into results.natopen.GRUK dataframe\n          results.natopen.GRUK[['scaled']][i,'Soil_disturbance1'] <- scal() \n          results.natopen.GRUK[['non-truncated']][i,'Soil_disturbance1'] <- scal.2() \n          results.natopen.GRUK[['original']][i,'Soil_disturbance1'] <- val\n          \n\n          # upper part of distribution\n          ref <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Soil_disturbance2' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),\"_BN\",sep=\"\"),'Rv']\n          lim <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Soil_disturbance2' & natopen.ref.cov.val$grunn==paste(as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),\"_BN\",sep=\"\"),'Gv']\n          maxmin <- natopen.ref.cov.val[natopen.ref.cov.val$Ind=='Soil_disturbance2' & natopen.ref.cov.val$grunn==as.character(results.natopen.GRUK[['original']][i,\"Kartleggingsenhet\"]),'maxmin']\n          # coercing x into results.natopen.GRUK dataframe\n          results.natopen.GRUK[['scaled']][i,'Soil_disturbance2'] <- scal() \n          results.natopen.GRUK[['non-truncated']][i,'Soil_disturbance2'] <- scal.2() \n          results.natopen.GRUK[['original']][i,'Soil_disturbance2'] <- val\n          \n        }\n        \n        \n        \n      }\n#    }\n    \n    \n    \n  }, error=function(e){cat(\"ERROR :\",conditionMessage(e), \"\\n\")})\n}\n\n# for using both sides of the plant indicators\nresults.natopen.GRUK[['2-sided']] <- results.natopen.GRUK[['non-truncated']]\n\n# remove values >1 for 2-sided indicators\nresults.natopen.GRUK[['2-sided']]$CC1[results.natopen.GRUK[['2-sided']]$CC1>1] <- NA\nresults.natopen.GRUK[['2-sided']]$CC2[results.natopen.GRUK[['2-sided']]$CC2>1] <- NA\n\nresults.natopen.GRUK[['2-sided']]$SS1[results.natopen.GRUK[['2-sided']]$SS1>1] <- NA\nresults.natopen.GRUK[['2-sided']]$SS2[results.natopen.GRUK[['2-sided']]$SS2>1] <- NA\n\nresults.natopen.GRUK[['2-sided']]$RR1[results.natopen.GRUK[['2-sided']]$RR1>1] <- NA\nresults.natopen.GRUK[['2-sided']]$RR2[results.natopen.GRUK[['2-sided']]$RR2>1] <- NA\n\nresults.natopen.GRUK[['2-sided']]$Light1[results.natopen.GRUK[['2-sided']]$Light1>1] <- NA\nresults.natopen.GRUK[['2-sided']]$Light2[results.natopen.GRUK[['2-sided']]$Light2>1] <- NA\n\nresults.natopen.GRUK[['2-sided']]$Nitrogen1[results.natopen.GRUK[['2-sided']]$Nitrogen1>1] <- NA\nresults.natopen.GRUK[['2-sided']]$Nitrogen2[results.natopen.GRUK[['2-sided']]$Nitrogen2>1] <- NA\n\nresults.natopen.GRUK[['2-sided']]$Soil_disturbance1[results.natopen.GRUK[['2-sided']]$Soil_disturbance1>1] <- NA\nresults.natopen.GRUK[['2-sided']]$Soil_disturbance2[results.natopen.GRUK[['2-sided']]$Soil_disturbance2>1] <- NA\nhead(results.natopen.ANO[['2-sided']])\n#>                                 GlobalID\n#> 1 {A24A765B-A1B4-4AF7-A1B9-A4A3F61F6295}\n#> 2 {67BECF0E-AA0C-4413-8D9D-34F1662D4AC9}\n#> 3 {628B2427-2D0D-4173-83D5-742F63AA2861}\n#> 4 {F30B90BB-CF0C-4AE2-BAB1-5D74497C8083}\n#> 5 {353E09DF-4A2C-4B48-AB34-9E03935E9CAB}\n#> 6 {006B784E-9024-40E7-8084-498884D4F81B}\n#>      registeringsdato klokkeslett_start ano_flate_id\n#> 1 2019-08-16 11:59:59             13:42      ANO0003\n#> 2 2019-09-02 11:59:59             16:49      ANO0006\n#> 3 2019-08-14 11:59:59             16:02      ANO0034\n#> 4 2019-09-10 11:59:59             14:41      ANO0066\n#> 5 2019-09-10 11:59:59             14:36      ANO0066\n#> 6 2019-08-12 11:59:59             18:21      ANO0083\n#>   ano_punkt_id         ssb_id program\n#> 1   ANO0003_46 20940006559500     ANO\n#> 2   ANO0006_62 23435007081000     ANO\n#> 3   ANO0034_66 21680006567500     ANO\n#> 4   ANO0066_35 22925006647000     ANO\n#> 5   ANO0066_26 22925006647000     ANO\n#> 6   ANO0083_31 21820006614000     ANO\n#>                                                                   instruks\n#> 1 https://nedlasting.miljodirektoratet.no/naturovervaking/ano_instruks.pdf\n#> 2 https://nedlasting.miljodirektoratet.no/naturovervaking/ano_instruks.pdf\n#> 3 https://nedlasting.miljodirektoratet.no/naturovervaking/ano_instruks.pdf\n#> 4 https://nedlasting.miljodirektoratet.no/naturovervaking/ano_instruks.pdf\n#> 5 https://nedlasting.miljodirektoratet.no/naturovervaking/ano_instruks.pdf\n#> 6 https://nedlasting.miljodirektoratet.no/naturovervaking/ano_instruks.pdf\n#>    aar      dataansvarlig_mdir                   dataeier\n#> 1 2019 Ole Einar Butli Hårstad Miljødirektoratet, VAL/VMK\n#> 2 2019 Ole Einar Butli Hårstad Miljødirektoratet, VAL/VMK\n#> 3 2019 Ole Einar Butli Hårstad Miljødirektoratet, VAL/VMK\n#> 4 2019 Ole Einar Butli Hårstad Miljødirektoratet, VAL/VMK\n#> 5 2019 Ole Einar Butli Hårstad Miljødirektoratet, VAL/VMK\n#> 6 2019 Ole Einar Butli Hårstad Miljødirektoratet, VAL/VMK\n#>                   vaer hovedoekosystem_punkt\n#> 1                  sol         naturlig_apne\n#> 2                  sol         naturlig_apne\n#> 3            overskyet         naturlig_apne\n#> 4            overskyet                  skog\n#> 5 overskyet,vindstille                  skog\n#> 6               nedbør         naturlig_apne\n#>   andel_hovedoekosystem_punkt utilgjengelig_punkt\n#> 1                          NA                <NA>\n#> 2                          NA                <NA>\n#> 3                          NA                <NA>\n#> 4                          NA                <NA>\n#> 5                          NA                <NA>\n#> 6                          NA                <NA>\n#>   utilgjengelig_begrunnelse  gps noeyaktighet\n#> 1                      <NA> <NA>         <NA>\n#> 2                      <NA> <NA>         <NA>\n#> 3                      <NA> <NA>         <NA>\n#> 4                      <NA> <NA>         <NA>\n#> 5                      <NA> <NA>         <NA>\n#> 6                      <NA> <NA>         <NA>\n#>   kommentar_posisjon klokkeslett_karplanter_start\n#> 1               <NA>                         <NA>\n#> 2               <NA>                         <NA>\n#> 3               <NA>                         <NA>\n#> 4               <NA>                         <NA>\n#> 5               <NA>                         <NA>\n#> 6               <NA>                         <NA>\n#>   art_alle_registrert karplanter_dekning\n#> 1                <NA>                 NA\n#> 2                <NA>               39.0\n#> 3                <NA>               10.0\n#> 4                <NA>               36.0\n#> 5                <NA>               74.0\n#> 6                <NA>               87.1\n#>   klokkeslett_karplanter_slutt karplanter_feltsjikt\n#> 1                         <NA>                   NA\n#> 2                         <NA>                   NA\n#> 3                         <NA>                   NA\n#> 4                         <NA>                   NA\n#> 5                         <NA>                   NA\n#> 6                         <NA>                   NA\n#>   moser_dekning torvmoser_dekning lav_dekning stroe_dekning\n#> 1            10                 0          30            95\n#> 2             3                 0          15            80\n#> 3            45                 0           0            65\n#> 4            15                 0          45             8\n#> 5            30                 0           0            70\n#> 6            20                 0           1             6\n#>   jord_grus_stein_berg_dekning stubber_kvister_dekning\n#> 1                           NA                      NA\n#> 2                            5                      NA\n#> 3                           NA                      NA\n#> 4                            8                      NA\n#> 5                            0                      NA\n#> 6                           NA                      NA\n#>   alger_fjell_dekning\n#> 1                  NA\n#> 2                  NA\n#> 3                  NA\n#> 4                  NA\n#> 5                  NA\n#> 6                  NA\n#>                                                              kommentar_ruteanalyse\n#> 1 Punktet ligger midt i en tørka/død røsslyng flekk. 90% av strøet er død røsslyng\n#> 2                                                                             <NA>\n#> 3                               en del gammel lyng som er bare grønn helt i toppen\n#> 4                                           Ligger i bratt kløft, flyttet 40 m øst\n#> 5                                                                             <NA>\n#> 6                                                                             <NA>\n#>   fastmerker kommentar_fastmerker kartleggingsenhet_1m2\n#> 1       <NA>                 <NA>                T2-C-1\n#> 2       <NA>                 <NA>                T2-C-1\n#> 3       <NA>                 <NA>                T2-C-1\n#> 4       <NA>                 <NA>                T2-C-1\n#> 5       <NA>                 <NA>                T2-C-1\n#> 6       <NA>                 <NA>                T2-C-1\n#>          hovedtype_1m2                  ke_beskrivelse_1m2\n#> 1 Åpen grunnlendt mark åpen kalkfattig grunnlendt lyngmark\n#> 2 Åpen grunnlendt mark åpen kalkfattig grunnlendt lyngmark\n#> 3 Åpen grunnlendt mark åpen kalkfattig grunnlendt lyngmark\n#> 4 Åpen grunnlendt mark åpen kalkfattig grunnlendt lyngmark\n#> 5 Åpen grunnlendt mark åpen kalkfattig grunnlendt lyngmark\n#> 6 Åpen grunnlendt mark åpen kalkfattig grunnlendt lyngmark\n#>   kartleggingsenhet_250m2 hovedtype_250m2\n#> 1                    <NA>            <NA>\n#> 2                    <NA>            <NA>\n#> 3                    <NA>            <NA>\n#> 4                    <NA>            <NA>\n#> 5                    <NA>            <NA>\n#> 6                    <NA>            <NA>\n#>   ke_beskrivelse_250m2 andel_kartleggingsenhet_250m2\n#> 1                 <NA>                            NA\n#> 2                 <NA>                            NA\n#> 3                 <NA>                            NA\n#> 4                 <NA>                            NA\n#> 5                 <NA>                            NA\n#> 6                 <NA>                            NA\n#>   groeftingsintensitet bruksintensitet beitetrykk\n#> 1                   NA              NA         NA\n#> 2                   NA              NA         NA\n#> 3                   NA              NA         NA\n#> 4                   NA              NA          1\n#> 5                   NA              NA          1\n#> 6                   NA              NA         NA\n#>   slatteintensitet tungekjoretoy slitasje forekomst_ntyp\n#> 1               NA             0       NA            nei\n#> 2               NA             0       NA            nei\n#> 3               NA             0       NA            nei\n#> 4               NA             0       NA            nei\n#> 5               NA             0       NA            nei\n#> 6               NA             0       NA            nei\n#>   ntyp\n#> 1 <NA>\n#> 2 <NA>\n#> 3 <NA>\n#> 4 <NA>\n#> 5 <NA>\n#> 6 <NA>\n#>                                                     kommentar_naturtyperegistering\n#> 1 Litt t4c5 i østre del. Området ligger i en helning med mye død/inntørka røsslyng\n#> 2                                                                             <NA>\n#> 3                ca. 50% er T1C2 nakent berg, men plottet har litt lyngvegetasjon \n#> 4                                                                         Lavrabbe\n#> 5                                                                             <NA>\n#> 6                                      ligger inn til blåbærskog med gran og bjørk\n#>   side_5_note krypende_vier_dekning\n#> 1        <NA>                    NA\n#> 2        <NA>                    NA\n#> 3        <NA>                    NA\n#> 4        <NA>                    NA\n#> 5        <NA>                    NA\n#> 6        <NA>                    NA\n#>   ikke_krypende_vier_dekning vedplanter_total_dekning\n#> 1                         NA                       45\n#> 2                         NA                       75\n#> 3                         NA                       40\n#> 4                         NA                       20\n#> 5                         NA                       30\n#> 6                         NA                       70\n#>   busker_dekning tresjikt_dekning treslag_registrert\n#> 1              5             25.0               <NA>\n#> 2              1              0.1               <NA>\n#> 3             15              5.0               <NA>\n#> 4              3             15.0               <NA>\n#> 5              1             40.0               <NA>\n#> 6             10             12.0               <NA>\n#>   roesslyng_dekning roesslyngblad pa_dekning pa_note\n#> 1                NA          <NA>         NA    <NA>\n#> 2                NA          <NA>         NA    <NA>\n#> 3                NA          <NA>         NA    <NA>\n#> 4                NA          <NA>         NA    <NA>\n#> 5                NA          <NA>         NA    <NA>\n#> 6                NA          <NA>         NA    <NA>\n#>   pa_registrert fa_total_dekning fa_registrert\n#> 1          <NA>                0          <NA>\n#> 2          <NA>                0          <NA>\n#> 3          <NA>                0          <NA>\n#> 4          <NA>                0          <NA>\n#> 5          <NA>                0          <NA>\n#> 6          <NA>                0          <NA>\n#>   kommentar_250m2_flate klokkeslett_slutt\n#> 1                  <NA>             13:50\n#> 2                  <NA>             17:12\n#> 3                  <NA>             16:14\n#> 4                  <NA>             14:41\n#> 5                  <NA>             14:36\n#> 6                  <NA>             18:32\n#>                                                                                             vedlegg_url\n#> 1 https://nin-felles-test.miljodirektoratet.no/api/Overvaking/list/a24a765b-a1b4-4af7-a1b9-a4a3f61f6295\n#> 2 https://nin-felles-test.miljodirektoratet.no/api/Overvaking/list/67becf0e-aa0c-4413-8d9d-34f1662d4ac9\n#> 3 https://nin-felles-test.miljodirektoratet.no/api/Overvaking/list/628b2427-2d0d-4173-83d5-742f63aa2861\n#> 4 https://nin-felles-test.miljodirektoratet.no/api/Overvaking/list/f30b90bb-cf0c-4ae2-bab1-5d74497c8083\n#> 5 https://nin-felles-test.miljodirektoratet.no/api/Overvaking/list/353e09df-4a2c-4b48-ab34-9e03935e9cab\n#> 6 https://nin-felles-test.miljodirektoratet.no/api/Overvaking/list/006b784e-9024-40e7-8084-498884d4f81b\n#>                    creator        creationdate\n#> 1 linvas_miljodirektoratet 2019-10-20 14:35:20\n#> 2 liting_miljodirektoratet 2019-09-10 20:47:12\n#> 3 chrpot_miljodirektoratet 2019-09-09 11:02:15\n#> 4 vegbak_miljodirektoratet 2019-11-17 22:03:56\n#> 5 vegbak_miljodirektoratet 2019-11-17 22:04:05\n#> 6 chrpot_miljodirektoratet 2019-09-09 11:11:04\n#>                     editor            editdate\n#> 1 linvas_miljodirektoratet 2019-10-20 14:35:20\n#> 2 liting_miljodirektoratet 2019-09-10 20:47:12\n#> 3 chrpot_miljodirektoratet 2019-09-09 11:02:15\n#> 4 vegbak_miljodirektoratet 2019-11-18 00:46:55\n#> 5 vegbak_miljodirektoratet 2019-11-18 00:47:04\n#> 6 chrpot_miljodirektoratet 2019-09-09 11:11:04\n#>   hovedtype_rute CC1       CC2 SS1       SS2       RR1 RR2\n#> 1             T2  NA        NA  NA        NA        NA  NA\n#> 2             T2  NA 0.8162954  NA 0.8246083 0.0000000  NA\n#> 3             T2  NA 0.9264837  NA 0.5876179 0.0000000  NA\n#> 4             T2  NA 0.8775111  NA 0.6840271 0.0000000  NA\n#> 5             T2  NA 0.9264837  NA 0.6809875 0.6546711  NA\n#> 6             T2  NA 0.9264837  NA 0.5876179 0.0000000  NA\n#>   Light1    Light2 Nitrogen1 Nitrogen2 Soil_disturbance1\n#> 1     NA        NA        NA        NA                NA\n#> 2     NA 0.7929370 0.7428571        NA                NA\n#> 3     NA 0.7704650 0.7428571        NA                NA\n#> 4     NA 0.7339481 0.8142857        NA                NA\n#> 5     NA 0.7941517 0.7138996        NA                NA\n#> 6     NA 0.7805271 0.7718878        NA                NA\n#>   Soil_disturbance2\n#> 1                NA\n#> 2         0.9733993\n#> 3         0.7827381\n#> 4         0.6927891\n#> 5         0.6603751\n#> 6         0.5830765\nhead(results.natopen.GRUK[['2-sided']])\n#>   Flate_ID ObjectID                             GlobalID\n#> 1      1-1      145 e9e9a90b-c7ac-482b-a3a8-38fcf0433168\n#> 2      1-1      146 0ed450f4-928c-42ec-af40-623d5cdc4e79\n#> 3      1-1      147 81f84075-dd64-4745-afa7-9d5fd1bc2e4e\n#> 4      1-1      148 fa9915c6-aab8-4afb-9522-57d6b721d412\n#> 5      1-1      149 c340e8ab-3dd5-4704-8b92-ee1f7089a4a8\n#> 6      1-2      132 92cd0a69-82ba-473b-8daa-75ddeeb39d24\n#>   year Klokkeslett_start    Registeringsdato Punkt_ID\n#> 1 2020             00:05 2020-06-04 10:00:00       NA\n#> 2 2020             00:12 2020-07-04 10:00:00       NA\n#> 3 2020             00:22 2020-06-04 10:00:00       NA\n#> 4 2020             00:25 2020-06-04 10:00:00       NA\n#> 5 2020             00:30 2020-06-04 10:00:00       NA\n#> 6 2020             00:46 2020-06-04 10:00:00       NA\n#>   uPunkt_ID Værforhold Hovedoekosystem_punkt GPS_type\n#> 1     1-1-1        sol         naturlig_apne     <NA>\n#> 2     1-1-2        sol         naturlig_apne     <NA>\n#> 3     1-1-3        sol         naturlig_apne     <NA>\n#> 4     1-1-4        sol         naturlig_apne     <NA>\n#> 5     1-1-5        sol         naturlig_apne     <NA>\n#> 6     1-2-1        sol         naturlig_apne     <NA>\n#>   Nøyaktighet Total dekning % av karplanter registert\n#> 1       <0,2m                                    18.5\n#> 2       <0,2m                                       0\n#> 3       <0,2m                                     6.2\n#> 4       <0,2m                                     0.3\n#> 5       <0,2m                                    30.9\n#> 6       <0,2m                                    50.4\n#>   Dekning % av karplanter i feltsjikt Dekning % av moser\n#> 1                                18.0                 30\n#> 2                                 0.0                  2\n#> 3                                 6.0                  2\n#> 4                                 0.1                  1\n#> 5                                25.0                 65\n#> 6                                50.0                  2\n#>   ...16 Dekning % av lav Dekning % av strø\n#> 1     0                1                99\n#> 2     0                0                99\n#> 3     0                0                99\n#> 4     0                0                99\n#> 5     0                5                99\n#> 6     0                0                99\n#>   Dekning % av bar jord/grus/stein/berg Klokkeslett_slutt\n#> 1                                    99              <NA>\n#> 2                                    99              <NA>\n#> 3                                    99              <NA>\n#> 4                                    99              <NA>\n#> 5                                    99              <NA>\n#> 6                                    99              <NA>\n#>   Kommentar til registreringene i kvadratruten ...22\n#> 1                                         <NA>   nei\n#> 2                                         <NA>   nei\n#> 3                                         <NA>   nei\n#> 4                                         <NA>   nei\n#> 5                                         <NA>   nei\n#> 6                                         <NA>   nei\n#>   Kommentar til merkingen av ruten Kartleggingsenhet\n#> 1                             <NA>            T2-C-7\n#> 2                             <NA>            T2-C-7\n#> 3                             <NA>            T2-C-7\n#> 4                             <NA>            T2-C-7\n#> 5                             <NA>            T2-C-7\n#> 6                             <NA>            T2-C-7\n#>   hovedtype_250m2 ke_beskrivelse_250m2\n#> 1            <NA>                 <NA>\n#> 2            <NA>                 <NA>\n#> 3            <NA>                 <NA>\n#> 4            <NA>                 <NA>\n#> 5            <NA>                 <NA>\n#> 6            <NA>                 <NA>\n#>   Spor etter ferdsel med tunge kjøretøy (%)\n#> 1                                         0\n#> 2                                         0\n#> 3                                         0\n#> 4                                         0\n#> 5                                         0\n#> 6                                         0\n#>   Spor etter slitasje og slitasjebetinget erosjon (%)\n#> 1                                                  20\n#> 2                                                  20\n#> 3                                                  10\n#> 4                                                  50\n#> 5                                                   5\n#> 6                                                  70\n#>   Dekning % av nakent berg\n#> 1                       50\n#> 2                       95\n#> 3                       95\n#> 4                       99\n#> 5                        2\n#> 6                       30\n#>   Menneskeskapte objekter i sirkelen?\n#> 1                                 nei\n#> 2                                 nei\n#> 3                                 nei\n#> 4                                 nei\n#> 5                                 nei\n#> 6                                 nei\n#>   Hvilke menneskeskapte objekt forekommer?\n#> 1                                     <NA>\n#> 2                                     <NA>\n#> 3                                     <NA>\n#> 4                                     <NA>\n#> 5                                     <NA>\n#> 6                                     <NA>\n#>   Kommentar knyttet til naturtyperegistreringene\n#> 1                                Nakent berg 80%\n#> 2                                Nakent berg 75%\n#> 3                  Nakent berg 60%. Sti i ruten.\n#> 4                                Nakent berg 75%\n#> 5                   Nakent berg 4%. Sti i ruten.\n#> 6                                Nakent berg 20%\n#>   Total dekning % av vedplanter i feltsjikt\n#> 1                                       0.1\n#> 2                                       0.0\n#> 3                                       1.0\n#> 4                                       1.0\n#> 5                                       2.0\n#> 6                                       1.0\n#>   Dekning % av busker i busksjikt Dekning % av tresjikt\n#> 1                             0.1                   0.1\n#> 2                             1.0                   0.0\n#> 3                             2.0                   0.0\n#> 4                             1.0                   1.0\n#> 5                             5.0                   5.0\n#> 6                             0.0                   0.0\n#>   Dekning % av problemarter\n#> 1                        NA\n#> 2                        NA\n#> 3                        NA\n#> 4                        NA\n#> 5                        NA\n#> 6                        NA\n#>   Kommentar knyttet til registreringen av problemarter\n#> 1                                                 <NA>\n#> 2                                                 <NA>\n#> 3                                                 <NA>\n#> 4                                                 <NA>\n#> 5                                                 <NA>\n#> 6                                                 <NA>\n#>   Total dekning % av fremmede arter\n#> 1                               0.0\n#> 2                               0.1\n#> 3                               0.0\n#> 4                               0.0\n#> 5                               0.1\n#> 6                               0.0\n#>   Kommentar knyttet til registreringene i sirkelen\n#> 1                                             <NA>\n#> 2                                             <NA>\n#> 3                                             <NA>\n#> 4                                             <NA>\n#> 5                                             <NA>\n#> 6                                             <NA>\n#>   Klokkeslett slutt: CreationDate                  Creator\n#> 1              00:10     44104.38 matand_miljodirektoratet\n#> 2              00:22     44104.39 matand_miljodirektoratet\n#> 3              00:26     44104.39 matand_miljodirektoratet\n#> 4              00:29     44104.40 matand_miljodirektoratet\n#> 5              00:36     44104.40 matand_miljodirektoratet\n#> 6              00:54     44103.62 matand_miljodirektoratet\n#>   EditDate                   Editor        x        y\n#> 1 44104.38 matand_miljodirektoratet 10.73178 59.94771\n#> 2 44104.39 matand_miljodirektoratet 10.73180 59.94770\n#> 3 44104.39 matand_miljodirektoratet 10.73177 59.94770\n#> 4 44104.40 matand_miljodirektoratet 10.73178 59.94769\n#> 5 44104.40 matand_miljodirektoratet 10.73183 59.94772\n#> 6 44103.62 matand_miljodirektoratet 10.41560 59.83847\n#>   tilstandsvurdering.x tilstandsgrunn.x\n#> 1                   NA             <NA>\n#> 2                   NA             <NA>\n#> 3                   NA             <NA>\n#> 4                   NA             <NA>\n#> 5                   NA             <NA>\n#> 6                   NA             <NA>\n#>   artsmangfoldvurdering.x lokalitetskvalitet.x\n#> 1                      NA                   NA\n#> 2                      NA                   NA\n#> 3                      NA                   NA\n#> 4                      NA                   NA\n#> 5                      NA                   NA\n#> 6                      NA                   NA\n#>   tilstandsvurdering.y tilstandsgrunn.y\n#> 1                   NA             <NA>\n#> 2                   NA             <NA>\n#> 3                   NA             <NA>\n#> 4                   NA             <NA>\n#> 5                   NA             <NA>\n#> 6                   NA             <NA>\n#>   artsmangfoldvurdering.y lokalitetskvalitet.y       CC1\n#> 1                      NA                   NA 0.8108544\n#> 2                      NA                   NA        NA\n#> 3                      NA                   NA        NA\n#> 4                      NA                   NA 0.0000000\n#> 5                      NA                   NA 0.8448384\n#> 6                      NA                   NA        NA\n#>         CC2       SS1      SS2       RR1       RR2\n#> 1        NA 0.5613561       NA        NA 0.5318042\n#> 2        NA        NA       NA        NA        NA\n#> 3 0.7419305 0.6790290       NA        NA 0.9706229\n#> 4        NA 0.3245936       NA        NA 0.2248923\n#> 5        NA        NA 0.839074 0.9666974        NA\n#> 6 0.7960141 0.5502071       NA        NA 0.7344459\n#>      Light1     Light2 Nitrogen1 Nitrogen2\n#> 1        NA 0.01480191        NA 0.8253947\n#> 2        NA         NA        NA        NA\n#> 3        NA 0.60200336        NA 0.5797957\n#> 4 0.9756365         NA        NA 0.5218162\n#> 5 0.8545689         NA 0.9339477        NA\n#> 6 0.8925407         NA        NA 0.6551686\n#>   Soil_disturbance1 Soil_disturbance2\n#> 1                NA         0.6609490\n#> 2                NA                NA\n#> 3         0.9346969                NA\n#> 4                NA         0.3408431\n#> 5         0.5025059                NA\n#> 6         0.7122831                NA"},{"path":"Functional-plant-indicators-open.html","id":"scaled-value-analyses-2","chapter":"8 Functional Plant Indicators - Naturally Open Ecosystems","heading":"8.7.1.2 Scaled value analyses","text":"order visualize results need rearrange results-objects wide long format (note lower upper condition indicator functional plant indicators).","code":"\n#### plotting scaled values by main ecosystem type ####\n## continuing with 2-sided\nres.natopen.ANO <- results.natopen.ANO[['2-sided']]\n\n# make long version of the scaled value part\nres.natopen.ANO <-\n  res.natopen.ANO %>% \n  pivot_longer(\n    cols = c(\"CC1\",\"CC2\",\n             \"SS1\",\"SS2\",\n             \"RR1\",\"RR2\",\n             \"Light1\",\"Light2\",\n             \"Nitrogen1\",\"Nitrogen2\",\n             \"Soil_disturbance1\",\"Soil_disturbance2\"),\n    names_to = \"fp_ind\",\n    values_to = \"scaled_value\",\n    values_drop_na = FALSE\n  )\n\n# add original values as well\nres.natopen.ANO <- \n  res.natopen.ANO %>% add_column(original = results.natopen.ANO[['original']] %>% \n                               pivot_longer(\n                                 cols = c(\"CC1\",\"CC2\",\n                                          \"SS1\",\"SS2\",\n                                          \"RR1\",\"RR2\",\n                                          \"Light1\",\"Light2\",\n                                          \"Nitrogen1\",\"Nitrogen2\",\n                                          \"Soil_disturbance1\",\"Soil_disturbance2\"),\n                                 names_to = NULL,\n                                 values_to = \"original\",\n                                 values_drop_na = FALSE\n                               ) %>%\n                               pull(original)\n  )\n\n# similarly for GRUK\nres.natopen.GRUK <- results.natopen.GRUK[['2-sided']]\n\n# make long version of the scaled value part\nres.natopen.GRUK <-\n  res.natopen.GRUK %>% \n  pivot_longer(\n    cols = c(\"CC1\",\"CC2\",\n             \"SS1\",\"SS2\",\n             \"RR1\",\"RR2\",\n             \"Light1\",\"Light2\",\n             \"Nitrogen1\",\"Nitrogen2\",\n             \"Soil_disturbance1\",\"Soil_disturbance2\"),\n    names_to = \"fp_ind\",\n    values_to = \"scaled_value\",\n    values_drop_na = FALSE\n  )\n\n# add original values as well\nres.natopen.GRUK <- \n  res.natopen.GRUK %>% add_column(original = results.natopen.GRUK[['original']] %>% \n                                   pivot_longer(\n                                     cols = c(\"CC1\",\"CC2\",\n                                              \"SS1\",\"SS2\",\n                                              \"RR1\",\"RR2\",\n                                              \"Light1\",\"Light2\",\n                                              \"Nitrogen1\",\"Nitrogen2\",\n                                              \"Soil_disturbance1\",\"Soil_disturbance2\"),\n                                     names_to = NULL,\n                                     values_to = \"original\",\n                                     values_drop_na = FALSE\n                                   ) %>%\n                                   pull(original)\n  )"},{"path":"Functional-plant-indicators-open.html","id":"ecosystem-sub-types-2","chapter":"8 Functional Plant Indicators - Naturally Open Ecosystems","heading":"8.7.2 Ecosystem sub-types","text":"can show resulting scaled values Violin plots indicator main ecosystem type\n\nANO results show high frequency low CSR-R values (CSR-R1) Soil disturbance also showing signs higher expected competition (CSR-C2), indicates number naturally open areas changing dominance structure physical stability. GRUK data show generally large spread scaled values, violin plots (shapes indicate relative amount observations across y-axis) suggest number sites high nitrogen (Nitrogen2), sites much disturbance (CSR-R2) light (Light2). Many GRUK sites popular outdoor locations local population, increase disturbance thus cause deviations towards high CSR-R values (CSR-R2).\nIncreased nitrogen may effect alien species, GRUK data records major pressure problem many monitoring sites.","code":"\ncolnames(res.natopen.GRUK)[38] <- \"fremmedartsdekning\"\nggplot(res.natopen.GRUK[res.natopen.GRUK$fp_ind==\"Nitrogen2\",], aes(x=fremmedartsdekning, y=scaled_value)) +\n  geom_point() +\n  xlab(\"Alien species cover (%)\") + ylab(\"Scaled Nitrogen2 value (GRUK data)\")\n#> Warning: Removed 347 rows containing missing values\n#> (`geom_point()`)."},{"path":"Functional-plant-indicators-open.html","id":"indicator-index-maps-2","chapter":"8 Functional Plant Indicators - Naturally Open Ecosystems","heading":"8.7.3 Indicator index maps","text":"can also show results map, instance CSR-R1 (lower ruderal/disturbance indicator) ANO Nitrogen2 (upper nitrogen indicator) GRUK, either directly plotting data onto map…\nGRUK can zoom area around Oslofjord…","code":"#> Reading layer `outlineOfNorway_EPSG25833' from data source \n#>   `/data/Egenutvikling/41001581_egenutvikling_anders_kolstad/github/ecosystemCondition/data/outlineOfNorway_EPSG25833.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 1 feature and 2 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -113472.7 ymin: 6448359 xmax: 1114618 ymax: 7939917\n#> Projected CRS: ETRS89 / UTM zone 33N\n#> Reading layer `regions' from data source \n#>   `/data/Egenutvikling/41001581_egenutvikling_anders_kolstad/github/ecosystemCondition/data/regions.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 5 features and 2 fields\n#> Geometry type: POLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -99551.21 ymin: 6426048 xmax: 1121941 ymax: 7962744\n#> Projected CRS: ETRS89 / UTM zone 33N\nboks <- st_bbox(c(xmin = 10.3, xmax = 10.8, ymax = 59.95, ymin = 59.4), crs = st_crs(4326))\n\ntm_shape(regnor,bbox=boks) +\n  tm_fill('GID_0', labels=\"\", title=\"\", legend.show = FALSE) + \n  tm_borders() +\n  tm_shape(res.natopen.GRUK2) +\n  tm_dots('Nitrogen2',midpoint=NA, palette=tmaptools::get_brewer_pal(\"YlOrRd\", 7, plot = FALSE), scale=3, legend.show = FALSE) + # \n  tm_layout(main.title = \"Nitrogen index (upper), natopen GRUK\",legend.position = c(\"right\", \"bottom\"), main.title.size=1.2) + \n  tm_add_legend(type = \"fill\", \n                col = c(tmaptools::get_brewer_pal(\"YlOrRd\", 7, plot = FALSE),'grey'),\n                labels = c(\"0.3 - 0.4\", \"0.4 - 0.5\", \"0.5 - 0.6\", \"0.6 - 0.7\", \n                           \"0.7 - 0.8\", \"0.8 - 0.9\", \"0.9 - 1.0\", \"NA\"),\n                title = \"index values\")"},{"path":"Functional-plant-indicators-open.html","id":"regions---maps-and-statistics-2","chapter":"8 Functional Plant Indicators - Naturally Open Ecosystems","heading":"8.7.4 Regions - maps and statistics","text":"Alternatively can calculate show region-wise means related standard errors. note calculating simple mean inappropriate data. :\n() scaled data bound 0 1, thus follow beta-distribution rather Gaussian one\n(ii) ANO GRUK datasets nested structureTherefore, need () use beta-model, (ii) can account nested structure data.\n, apply following function using either glmmTMB null-model beta-distribution, logit link, nesting random intercept, simple betareg null-model logit link nesting extensive enough mixed model.corresponding maps upper Nitrogen indicator GRUK data:","code":"\n\nexpit <- function(L) exp(L) / (1+exp(L)) # since the beta-models use a logit link, we need to calculate the estimates back to the identity scale\n\n# the function performs a glmmTMB if there's >= 5 random levels in the nesting structure\n# if that is not the case, then the function performs a betareg if theres >= 2 observations\n# if that is not the case either, then the function returns the value of the single observation with NA standard error\n\nindmean.beta <- function(df) {\n\n  st_geometry(df) <- NULL\n  colnames(df) <- c(\"y\",\"ran\")\n  \n  if ( nrow(df[!is.na(df[,1]),]) >= 2 ) {\n    \n    if ( length(unique(df[!is.na(df[,1]),2])) >=5 ) {\n      \n      mod1 <- glmmTMB(y ~ 1 +(1|ran), family=beta_family(), data=df)\n      \n      return(c(\n        expit(summary( mod1 )$coefficients$cond[1]),\n        \n        expit( summary( mod1 )$coefficients$cond[1] + \n                 summary( mod1 )$coefficients$cond[2] )-\n          expit( summary( mod1 )$coefficients$cond[1] ),\n        \n        nrow(df[!is.na(df$y),]),\n        summary( mod1 )$coefficients$cond[1],\n        summary( mod1 )$coefficients$cond[2]\n      ))\n      \n    } else {\n      \n      mod2 <- betareg(y ~ 1, data=df)\n      \n      return(c(\n        expit(summary( mod2 )$coefficients$mean[1]),\n        expit( summary( mod2 )$coefficients$mean[1] + \n                 summary( mod2 )$coefficients$mean[2] )-\n          expit( summary( mod2 )$coefficients$mean[1] ),\n        nrow(df[!is.na(df$y),]),\n        summary( mod2 )$coefficients$mean[1],\n        summary( mod2 )$coefficients$mean[2]\n      ))\n      \n    }\n    \n  } else {\n    \n    return(c(df$y,NA,1,NA,NA))\n    \n  }\n\n}\n# we have to join the ANO and GRUK results spatial objects with the Norway and region mask\nres.natopen.ANO2 = st_join(res.natopen.ANO2, regnor, left = TRUE)\nres.natopen.GRUK2 = st_join(res.natopen.GRUK2, regnor, left = TRUE)\n# we check if all there's any sitethat did not get a region assigned\nnrow(res.natopen.ANO2[is.na(res.natopen.ANO2$region),]) # no NA's for ANO\n#> [1] 0\nnrow(res.natopen.GRUK2[is.na(res.natopen.GRUK2$region),]) # some points didn't get assigned to a region. Why?\n#> [1] 303\n\ntm_shape(regnor, bbox = boks) +\n  tm_fill('GID_0', labels=\"\", title=\"\", legend.show = FALSE) + \n  tm_borders() +\n  tm_shape(res.natopen.GRUK2[is.na(res.natopen.GRUK2$region),]) +\n  tm_dots('Nitrogen2',midpoint=NA, palette=tmaptools::get_brewer_pal(\"YlOrRd\", 7, plot = FALSE), scale=2, legend.show = FALSE) + # \n  tm_layout(main.title = \"Nitrogen index (upper), natopen GRUK\",legend.position = c(\"right\", \"bottom\"), main.title.size=1.2) + \n  tm_add_legend(type = \"fill\", \n                col = c(tmaptools::get_brewer_pal(\"YlOrRd\", 7, plot = FALSE),'grey'),\n                labels = c(\"0.3 - 0.4\", \"0.4 - 0.5\", \"0.5 - 0.6\", \"0.6 - 0.7\", \n                           \"0.7 - 0.8\", \"0.8 - 0.9\", \"0.9 - 1.0\", \"NA\"),\n                title = \"index values\")\n# they seem to lie in water\n# all sites but the southernmost one are in Eastern Norway, the remaining one in Southern Norway\nsummary(res.natopen.GRUK2[is.na(res.natopen.GRUK2$region),\"y\"])\n#>        y                  geometry  \n#>  Min.   : 0.00   POINT        :303  \n#>  1st Qu.:59.83   epsg:25833   :  0  \n#>  Median :59.87   +proj=utm ...:  0  \n#>  Mean   :58.86                      \n#>  3rd Qu.:59.89                      \n#>  Max.   :59.91\nres.natopen.GRUK2[is.na(res.natopen.GRUK2$region) & res.natopen.GRUK2$y<59.83,c(\"y\",\"Flate_ID\")] # site 123-4 is in Southern Norway\n#> Simple feature collection with 75 features and 2 fields\n#> Geometry type: POINT\n#> Dimension:     XY\n#> Bounding box:  xmin: -1188659 ymin: 0 xmax: 253611.6 ymax: 6639450\n#> Projected CRS: ETRS89 / UTM zone 33N\n#> First 10 features:\n#>            y Flate_ID                 geometry\n#> 117 59.45180    123-4 POINT (241129.9 6599256)\n#> 118 59.45212    123-4 POINT (241110.1 6599293)\n#> 120 59.45194    123-4 POINT (241129.7 6599272)\n#> 121 59.45205    123-4 POINT (241099.7 6599286)\n#> 122 59.45185    123-4 POINT (241130.3 6599262)\n#> 123 59.45191    123-4 POINT (241110.9 6599270)\n#> 124 59.45200    123-4   POINT (241113 6599280)\n#> 125 59.45203    123-4 POINT (241117.6 6599283)\n#> 474 59.81732     25-1 POINT (253188.3 6639270)\n#> 475 59.81733     25-1 POINT (253168.3 6639273)\nres.natopen.GRUK2[res.natopen.GRUK2$Flate_ID==\"123-4\",\"region\"] <- \"Southern Norway\"\n# and all the other region=NA observations are in Eastern Norway\nres.natopen.GRUK2[is.na(res.natopen.GRUK2$region),\"region\"] <- \"Eastern Norway\"\nnrow(res.natopen.GRUK2[is.na(res.natopen.GRUK2$region),]) # no NA's left\n#> [1] 0\n\n# now we can calculate regionwise means and standard errors with beta-regression null-models\n# note that beta-models cannot handle observations that are exactly 0 or 1\nres.natopen.ANO2$RR1[res.natopen.ANO2$RR1==1] <- 0.999\nres.natopen.ANO2$RR1[res.natopen.ANO2$RR1==0] <- 0.001\nres.natopen.GRUK2$Nitrogen2[res.natopen.GRUK2$Nitrogen2==1] <- 0.999\nres.natopen.GRUK2$Nitrogen2[res.natopen.GRUK2$Nitrogen2==0] <- 0.001\n\nregnor <- regnor %>%\n  mutate(\n    RR1.ANO.reg.mean = c(indmean.beta(df=res.natopen.ANO2[res.natopen.ANO2$region==\"Northern Norway\",c(\"RR1\",\"ano_flate_id\")])[1],\n                         indmean.beta(df=res.natopen.ANO2[res.natopen.ANO2$region==\"Central Norway\",c(\"RR1\",\"ano_flate_id\")])[1],\n                         indmean.beta(df=res.natopen.ANO2[res.natopen.ANO2$region==\"Eastern Norway\",c(\"RR1\",\"ano_flate_id\")])[1],\n                         indmean.beta(df=res.natopen.ANO2[res.natopen.ANO2$region==\"Western Norway\",c(\"RR1\",\"ano_flate_id\")])[1],\n                         indmean.beta(df=res.natopen.ANO2[res.natopen.ANO2$region==\"Southern Norway\",c(\"RR1\",\"ano_flate_id\")])[1]\n    ),\n    RR1.ANO.reg.se = c(indmean.beta(df=res.natopen.ANO2[res.natopen.ANO2$region==\"Northern Norway\",c(\"RR1\",\"ano_flate_id\")])[2]*2,\n                       indmean.beta(df=res.natopen.ANO2[res.natopen.ANO2$region==\"Central Norway\",c(\"RR1\",\"ano_flate_id\")])[2]*2,\n                       indmean.beta(df=res.natopen.ANO2[res.natopen.ANO2$region==\"Eastern Norway\",c(\"RR1\",\"ano_flate_id\")])[2]*2,\n                       indmean.beta(df=res.natopen.ANO2[res.natopen.ANO2$region==\"Western Norway\",c(\"RR1\",\"ano_flate_id\")])[2]*2,\n                       indmean.beta(df=res.natopen.ANO2[res.natopen.ANO2$region==\"Southern Norway\",c(\"RR1\",\"ano_flate_id\")])[2]*2\n    ),\n    RR1.ANO.reg.n = c(nrow(res.natopen.ANO2[res.natopen.ANO2$region==\"Northern Norway\" & !is.na(res.natopen.ANO2$RR1),]),\n                      nrow(res.natopen.ANO2[res.natopen.ANO2$region==\"Central Norway\" & !is.na(res.natopen.ANO2$RR1),]),\n                      nrow(res.natopen.ANO2[res.natopen.ANO2$region==\"Eastern Norway\" & !is.na(res.natopen.ANO2$RR1),]),\n                      nrow(res.natopen.ANO2[res.natopen.ANO2$region==\"Western Norway\" & !is.na(res.natopen.ANO2$RR1),]),\n                      nrow(res.natopen.ANO2[res.natopen.ANO2$region==\"Southern Norway\" & !is.na(res.natopen.ANO2$RR1),])\n    ),\n    Nitrogen2.GRUK.reg.mean = c(indmean.beta(df=res.natopen.GRUK2[res.natopen.GRUK2$region==\"Northern Norway\",c(\"Nitrogen2\",\"Flate_ID\")])[1],\n                                indmean.beta(df=res.natopen.GRUK2[res.natopen.GRUK2$region==\"Central Norway\",c(\"Nitrogen2\",\"Flate_ID\")])[1],\n                                indmean.beta(df=res.natopen.GRUK2[res.natopen.GRUK2$region==\"Eastern Norway\",c(\"Nitrogen2\",\"Flate_ID\")])[1],\n                                indmean.beta(df=res.natopen.GRUK2[res.natopen.GRUK2$region==\"Western Norway\",c(\"Nitrogen2\",\"Flate_ID\")])[1],\n                                indmean.beta(df=res.natopen.GRUK2[res.natopen.GRUK2$region==\"Southern Norway\",c(\"Nitrogen2\",\"Flate_ID\")])[1]\n    ),\n    Nitrogen2.GRUK.reg.se = c(indmean.beta(df=res.natopen.GRUK2[res.natopen.GRUK2$region==\"Northern Norway\",c(\"Nitrogen2\",\"Flate_ID\")])[2]*2,\n                              indmean.beta(df=res.natopen.GRUK2[res.natopen.GRUK2$region==\"Central Norway\",c(\"Nitrogen2\",\"Flate_ID\")])[2]*2,\n                              indmean.beta(df=res.natopen.GRUK2[res.natopen.GRUK2$region==\"Eastern Norway\",c(\"Nitrogen2\",\"Flate_ID\")])[2]*2,\n                              indmean.beta(df=res.natopen.GRUK2[res.natopen.GRUK2$region==\"Western Norway\",c(\"Nitrogen2\",\"Flate_ID\")])[2]*2,\n                              indmean.beta(df=res.natopen.GRUK2[res.natopen.GRUK2$region==\"Southern Norway\",c(\"Nitrogen2\",\"Flate_ID\")])[2]*2\n    ),\n    Nitrogen2.GRUK.reg.n = c(0,\n                             0,\n                             nrow(res.natopen.GRUK2[res.natopen.GRUK2$region==\"Eastern Norway\" & !is.na(res.natopen.GRUK2$Nitrogen2),]),\n                             0,\n                             nrow(res.natopen.GRUK2[res.natopen.GRUK2$region==\"Southern Norway\" & !is.na(res.natopen.GRUK2$Nitrogen2),])\n    )\n  )\n\n\n## scaled value maps for CSR-R1 (lower indicator), ANO\n# mean\ntm_shape(regnor) +\n  tm_polygons(col=\"RR1.ANO.reg.mean\", title=\"CSR-R (lower), mean\", style=\"quantile\", palette=rev(get_brewer_pal(palette=\"OrRd\", n=5, plot=FALSE))) +\n  tm_text(\"RR1.ANO.reg.n\",col=\"black\",bg.color=\"grey\")\n# se\ntm_shape(regnor) +\n  tm_polygons(col=\"RR1.ANO.reg.se\", title=\"CSR-R (lower)\", style=\"quantile\", palette=(get_brewer_pal(palette=\"OrRd\", n=5, plot=FALSE))) +\n  tm_text(\"RR1.ANO.reg.n\",col=\"black\",bg.color=\"grey\")\n## scaled value maps for Nitrogen2 (upper indicator), ASO\n# mean\ntm_shape(regnor) +\n  tm_polygons(col=\"Nitrogen2.GRUK.reg.mean\", title=\"Nitrogen (upper), mean\", style=\"quantile\", palette=rev(get_brewer_pal(palette=\"OrRd\", n=5, plot=FALSE))) +\n  tm_text(\"Nitrogen2.GRUK.reg.n\",col=\"black\",bg.color=\"grey\")\n# se\ntm_shape(regnor) +\n  tm_polygons(col=\"Nitrogen2.GRUK.reg.se\", title=\"Nitrogen (upper), 2 SE\", style=\"quantile\", palette=(get_brewer_pal(palette=\"OrRd\", n=5, plot=FALSE))) +\n  tm_text(\"Nitrogen2.GRUK.reg.n\",col=\"black\",bg.color=\"grey\")"},{"path":"Functional-plant-indicators-open.html","id":"continue-here","chapter":"8 Functional Plant Indicators - Naturally Open Ecosystems","heading":"8.7.4.1 continue here","text":"","code":""},{"path":"Functional-plant-indicators-open.html","id":"unscaled-values-vs.-reference-2","chapter":"8 Functional Plant Indicators - Naturally Open Ecosystems","heading":"8.7.4.2 Unscaled values vs. reference","text":"can also compare unscaled values reference distribution order identify ecosystem types functional plant indicators showing deviation expectation. Since CSR-R ANO nitrogen GRUK show deviations, exemplify indicators unscaled values.CSR-R, ANO:Nitrogen, GRUK","code":"\n#summary(res.natopen.ANO[!is.na(res.natopen.ANO$original),]$kartleggingsenhet_1m2)\n#sort(unique(res.natopen.ANO$kartleggingsenhet_1m2))\n# 8 NiN-types with data to plot\n\npar(mfrow=c(2,4))\nfor ( i in sort(unique(res.natopen.ANO$kartleggingsenhet_1m2))[c(1,6,7,10,12,13,14,15)] ) {\n  \n  tryCatch({\n    \n    plot(density( as.matrix(natopen.ref.cov[['RR']][,i]) ,na.rm=T),\n         xlim=c(0,1), ylim=c(0,10), type=\"l\", main=i,xlab='CSR-R value')\n    points(res.natopen.ANO[res.natopen.ANO$fp_ind==\"RR1\" & res.natopen.ANO$kartleggingsenhet_1m2==i,]$original,\n           rep(0,length(res.natopen.ANO[res.natopen.ANO$fp_ind==\"RR1\" & res.natopen.ANO$kartleggingsenhet_1m2==i,]$original)),\n           col=\"red\")\n    points(density(res.natopen.ANO[res.natopen.ANO$fp_ind==\"RR1\" & res.natopen.ANO$kartleggingsenhet_1m2==i,]$original,na.rm=T),\n           type=\"l\", col=\"red\")\n\n    \n  }, error=function(e){cat(\"ERROR :\",conditionMessage(e), \"\\n\")})\n  \n}\n#> ERROR : need at least 2 points to select a bandwidth automatically\n#> ERROR : need at least 2 points to select a bandwidth automatically\n#> ERROR : need at least 2 points to select a bandwidth automatically\nlegend(\"topright\", legend=c(\"reference\",\"field data\"), pch=c(NULL,1), lty=1, col=c(\"black\",\"red\"),bty=\"n\", cex=1)\n\n# only two NiN types in GRUK, T2-C-7 and T2-C-8\npar(mfrow=c(1,2))\nfor ( i in unique(res.natopen.GRUK$Kartleggingsenhet) ) {\n  \n  tryCatch({\n    \n    plot(density( as.matrix(natopen.ref.cov[['Nitrogen']][,i]) ,na.rm=T),\n         xlim=c(1,9), ylim=c(0,2), type=\"l\", main=i,xlab='Nitrogen value')\n    points(res.natopen.GRUK[res.natopen.GRUK$fp_ind==\"Nitrogen1\" & res.natopen.GRUK$Kartleggingsenhet==i,]$original,\n           rep(0,length(res.natopen.GRUK[res.natopen.GRUK$fp_ind==\"Nitrogen1\" & res.natopen.GRUK$Kartleggingsenhet==i,]$original)),\n           col=\"red\")\n    points(density(res.natopen.GRUK[res.natopen.GRUK$fp_ind==\"Nitrogen1\" & res.natopen.GRUK$Kartleggingsenhet==i,]$original,na.rm=T),\n           type=\"l\", col=\"red\")\n\n    \n  }, error=function(e){cat(\"ERROR :\",conditionMessage(e), \"\\n\")})\n  \n}\nlegend(\"topright\", legend=c(\"reference\",\"field data\"), pch=c(NA,1), lty=1, col=c(\"black\",\"red\"), cex=1)"},{"path":"Functional-plant-indicators-open.html","id":"exp-fpin","chapter":"8 Functional Plant Indicators - Naturally Open Ecosystems","heading":"8.7.5 Eksport file (final product)","text":"","code":""},{"path":"trophic-level-biomass-ratios.html","id":"trophic-level-biomass-ratios","chapter":"9 Trophic level biomass ratios","heading":"9 Trophic level biomass ratios","text":"Author date:James D. M. Speed, Gunnar Austrheim, Erling J. SolbergAugust 2023","code":""},{"path":"trophic-level-biomass-ratios.html","id":"introduction-3","chapter":"9 Trophic level biomass ratios","heading":"9.1 Introduction","text":"develop indicators ecological condition Norway, based distribution biomass trophic levels – specifically vegetation vertebrate consumers. includes three trophic levels, plants, herbivores carnivores. Indicators trophic interactions based deviation observed biomass consumer trophic level expected biomass based biomass prey trophic level. expected biomass estimates derived global relationships plants vertebrate herbivores (Fløjgaard et al. 2022) vertebrate prey predators (Hatton et al 2015).","code":""},{"path":"trophic-level-biomass-ratios.html","id":"about-the-underlying-data-6","chapter":"9 Trophic level biomass ratios","heading":"9.2 About the underlying data","text":"plant biomass level use Net Primary Productivity. MODIS NPP selected since provides highest temporal extent available data sources (1999 present). Spatial resolution low relative remote sensing sources, however, spatial resolution still far higher consumer data, temporal extent prioritised.herbivore data extension data presented Austrheim et al. (2008) Speed et al. (2015). development trophic interaction indicators methods applied herbivore data going back 1907 (contra 1949 two studies ). data extracted Gunnar Austrheim (livestock) Erling J. Solberg (wild cervids). dataset, metabolic biomass raw biomass given species provided year municipality. 2007 municipalities used. data rasterized grid NPP data.Metabolic biomass measures used previous studies Norwegian herbivores cited . However, consistency global studies used find predicted biomass, use raw (unscaled) biomass .Herbivore species wild herbivores: moose/elg, red deer/hjort, roe deer/rådyr, wild reindeer/villrein; livestock: cattle/storfe, sheep/sau, horses/hest, goats/geit semi-domestic reindeer/tamrein.carnivore data taken back-cast population modelling large carnivores Norway (wolf/ulv, brown bear/bjørn, lynx/gaupe wolverine/jerv). data based hunting statistics, collated modelled Anna Sobocinski master thesis. thesis also presented metabolic biomass, use raw biomass make indicators. data also rasterized.calculate indicators (1) across ecosystems total consumer communities (localities herbivores carnivores) (2) specific indicators main ecosystem type.","code":""},{"path":"trophic-level-biomass-ratios.html","id":"representativity-in-time-and-space-7","chapter":"9 Trophic level biomass ratios","heading":"9.2.1 Representativity in time and space","text":"data spans 1907 2015, data points roughly every 10 years. whole Norway covered. Herbivore data collated municipality level (exception semi-domestic reindeer Finnmark county level) carnivore data county level. Municipalities counties valid 2007 used. NPP pixel resolution.","code":""},{"path":"trophic-level-biomass-ratios.html","id":"original-units-4","chapter":"9 Trophic level biomass ratios","heading":"9.2.2 Original units","text":"biomass trophic levels kg km-2.","code":""},{"path":"trophic-level-biomass-ratios.html","id":"temporal-coverage-6","chapter":"9 Trophic level biomass ratios","heading":"9.2.3 Temporal coverage","text":"data spans 1907 2015, data points roughly every 10 years.","code":""},{"path":"trophic-level-biomass-ratios.html","id":"ecosystem-characteristic-5","chapter":"9 Trophic level biomass ratios","heading":"9.3 Ecosystem characteristic","text":"","code":""},{"path":"trophic-level-biomass-ratios.html","id":"norwegain-standard-2","chapter":"9 Trophic level biomass ratios","heading":"9.3.1 Norwegain standard","text":"indicator within ecosystem characterstic “biomass distribution among trophic levels”","code":""},{"path":"trophic-level-biomass-ratios.html","id":"seea-ea-un-standard-1","chapter":"9 Trophic level biomass ratios","heading":"9.3.2 SEEA EA (UN standard)","text":"indicator alines closely B2 Structural state characteristics (although arguments made also B1 B3).","code":""},{"path":"trophic-level-biomass-ratios.html","id":"collinearities-with-other-indicators-8","chapter":"9 Trophic level biomass ratios","heading":"9.4 Collinearities with other indicators","text":"Colinearities likely exist climatic variables disturbance.","code":""},{"path":"trophic-level-biomass-ratios.html","id":"reference-condition-and-values-4","chapter":"9 Trophic level biomass ratios","heading":"9.5 Reference condition and values","text":"","code":""},{"path":"trophic-level-biomass-ratios.html","id":"reference-condition-4","chapter":"9 Trophic level biomass ratios","heading":"9.5.1 Reference condition","text":"Reference values taken published global relationships plants vertebrate herbivores (Fløjgaard et al. 2022) vertebrate prey predators (Hatton et al 2015).","code":""},{"path":"trophic-level-biomass-ratios.html","id":"reference-values-thresholds-for-defining-good-ecological-condition-minimum-andor-maximum-values-4","chapter":"9 Trophic level biomass ratios","heading":"9.5.2 Reference values, thresholds for defining good ecological condition, minimum and/or maximum values","text":"Deviations reference (expected) biomass consumer based consumed trophic level biomass expressed two-sided percentage. Good condition defined within ±40% reference value (.e. expected global relationships). Poor condition ±40% reference level. choice 40% arbitary.","code":""},{"path":"trophic-level-biomass-ratios.html","id":"uncertainties-7","chapter":"9 Trophic level biomass ratios","heading":"9.6 Uncertainties","text":"Uncertainties around estimates estimated. However, potential uncertainties around reported livestock hunting statistics demographic models used estimate metabolic biomass population level. See Austrheim et al. (2011) Speed et al. (2015) details.","code":""},{"path":"trophic-level-biomass-ratios.html","id":"references-8","chapter":"9 Trophic level biomass ratios","heading":"9.7 References","text":"Austrheim, G., Solberg, E. J., & Mysterud, . (2011). Spatio‐temporal variation large herbivore pressure Norway 1949‐1999: decreased grazing livestock countered increased browsing cervids? Wildlife Biology, 17(3), 286-298.\nFløjgaard, C., Pedersen, P. B. M., Sandom, C. J., Svenning, J. C., & Ejrnæs, R. (2022). Exploring natural baseline large‐herbivore biomass ecological restoration. Journal Applied Ecology, 59(1), 18-24.\nHatton, . ., McCann, K. S., Fryxell, J. M., Davies, T. J., Smerlak, M., Sinclair, . R., & Loreau, M. (2015). predator-prey power law: Biomass scaling across terrestrial aquatic biomes. Science, 349(6252), aac6284.\nSobocinski, . (2022). Mapping large carnivores Norway across 175 years changing policy (Master’s thesis, NTNU). https://hdl.handle.net/11250/3047580\nSpeed, J. D. M., Austrheim, G., Kolstad, . L., & Solberg, E. J. (2019). Long-term changes northern large-herbivore communities reveal differential rewilding rates space time. PLoS One, 14(5), e0217166.","code":""},{"path":"trophic-level-biomass-ratios.html","id":"additional-information-about-the-data","chapter":"9 Trophic level biomass ratios","heading":"9.8 Additional information about the data","text":"raw data available .","code":""},{"path":"trophic-level-biomass-ratios.html","id":"analyses-3","chapter":"9 Trophic level biomass ratios","heading":"9.9 Analyses","text":"","code":""},{"path":"trophic-level-biomass-ratios.html","id":"part-1-total-communities","chapter":"9 Trophic level biomass ratios","heading":"9.10 Part 1: Total communities","text":"start calculation biomass ratios across herbivores carnivores, regard ecosystem type.Now can plot raw biomass data.First NPP:Next total herbivore biomass:finally total carnivore biomass:Now use NPP estimate expected herbivore biomass (Fløjgaard et al. 2015, Figure 1/Table 1, Global relationship “mean NPP1km”):Now can calculate deviation observed herbivore biomass expected herbivore biomass. calculate % change:100 x (ActualBiomass – ExpectedBiomass) / (ExpectedBiomass + 1)display truncated 100%|-100%value 0 indicates locality expected biomass. Value 100 indicates locality 100% () higher biomass expected. Value -100 indicates locality 100% () lower biomass expected.«Good» condition assumed 0 |40%|see West coast, Trøndelag, Oppland double herbivore biomass expected. herbivore biomass expected parts Finnmark, Nordland Lierne lower herbivore biomass expected based NPP. Vestfold & Telemark (parts Viken) change herbivore biomass expected 2000 less expected 2015 (consistent reduction moose population regions)– Next move estimate expected carnivore biomass based observed herbivore biomass calculate deviation % difference expected herbivores. based Hatton et al. (2015, Figure 1, predator prey biomass relationships).see Norway less carnivore biomass expected based available herbivore biomass across time period. counties time periods (e.g. Hedmark today Finnmark 1907 carnivore biomass predicted.","code":"\n#NPP\n#Read in\nnpprast<-rast(paste0(pData,\"/Trophic_levels/NPP.tiff\"))\nviltrast<-rast(paste0(pData,\"/Trophic_levels/Vilt_RawBiomass.tiff\"))\nlivestockrast<-rast(paste0(pData,\"/Trophic_levels/Livestock_RawBiomass.tiff\"))\ncarnivorerast<-rast(paste0(pData,\"/Trophic_levels/Carnivores_RawBiomass.tiff\"))\n\n#Vector of years we work with\nallyears_vect<-c(1907,1917,1929,1938,1949,1959,1969,1979,1989,1999,2009,2015)\n\n#Livestock data from 1939 and vilt from 1938\nnames(livestockrast)<- sub(1939,1938,names(livestockrast))\n#names(livestockrast)\n\n#Norwegian counties to help plotting\nnorcounty_shp<-st_read(paste0(pData,\"/Trophic_levels/\"),\"ViltdataCounty\")\n#> Reading layer `ViltdataCounty' from data source \n#>   `/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/Trophic_levels' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 912 features and 8 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -76208 ymin: 6450245 xmax: 1114929 ymax: 7939986\n#> Projected CRS: ETRS89 / UTM zone 33N\n#Simplify by county nr\nnorcounty<-norcounty_shp %>% \n  group_by(FylkeNr) %>%\n  summarise(geometry = st_union(geometry)) \n#Select relevant years for NPP\nnpprast_yrs<-npprast[[names(npprast)%in%c(\"NPP_2000\",\"NPP_2009\",\"NPP_2015\")]]\n\nggplot()+geom_sf(data=norcounty,fill=\"white\",lwd=0.1)+\n         geom_spatraster(data=npprast_yrs)+facet_grid(~lyr)+\n         scale_fill_continuous(low=\"lightgreen\",high=\"darkgreen\",na.value=NA,expression('kg C km'^-2~'year'^-1))+theme_bw()\n#Total herbivore biomass\n#For some reason need to read the raster in again\nlivestockrast<-rast(paste0(pData,\"/Trophic_levels/Livestock_RawBiomass.tiff\"))\n\ntotalherbivorebiomass<-livestockrast[[sapply(strsplit(names(livestockrast),\"_\"),'[',1) %in% \"TotalHerbivoreBiomass\"]]\nnames(totalherbivorebiomass)<-allyears_vect\ntotalherbivorebiomass\n#> class       : SpatRaster \n#> dimensions  : 3378, 2701, 12  (nrow, ncol, nlyr)\n#> resolution  : 440.9985, 441.0127  (x, y)\n#> extent      : -76208, 1114929, 6450245, 7939986  (xmin, xmax, ymin, ymax)\n#> coord. ref. : +proj=utm +zone=33 +ellps=GRS80 +units=m +no_defs \n#> source      : Livestock_RawBiomass.tiff \n#> names       :     1907,     1917,     1929,     1938,        1949,        1959, ... \n#> min values  :     0.00,     0.00,     0.00,     0.00,    36.40469,    37.53634, ... \n#> max values  : 24068.81, 32279.18, 33138.37, 36387.98, 15082.97559, 22528.81055, ...\nggplot()+geom_sf(data=norcounty,fill=\"white\",lwd=0.1)+\n  geom_spatraster(data=totalherbivorebiomass)+facet_wrap(~lyr)+\n  scale_fill_continuous(trans='log10',low=\"lightskyblue\",high=\"darkblue\", na.value=NA,expression(atop('Herbivore \\nbiomass', 'kg km'^-2)))+theme_bw()\ncarnivorerast<-rast(paste0(pData,\"/Trophic_levels/Carnivores_RawBiomass.tiff\"))\n\ntotalcarnivores<-carnivorerast[[49:60]]\n# alter col names to show the year in the facet strip text\nnames(totalcarnivores)<-gsub(\"TotalRawBiomassDensity_\", \"\", names(totalcarnivores))\nggplot()+geom_sf(data=norcounty,fill=\"white\",lwd=0.1)+\n  geom_spatraster(data=totalcarnivores)+facet_wrap(~lyr)+\n  scale_fill_continuous(low='white',high='red', na.value=NA, expression(atop('Carnviore\\nbiomass', 'kg km'^-2)))+theme_bw()+\n  theme(strip.text.x = element_text(size = 10))\nexpected_herbivore_biomass<-(npprast_yrs^0.47 * 0.643)#Global \nggplot()+geom_sf(data=norcounty,fill=\"white\",lwd=0.1)+\n  ggtitle(\"Expected herbivore biomass\")+\n  geom_spatraster(data=expected_herbivore_biomass)+facet_wrap(~lyr)+theme_bw()+\n  scale_fill_continuous(low='lightskyblue',high=\"darkblue\",na.value=NA,expression('kg km'^-2))\ntotalherbivorebiomass<-livestockrast[[sapply(strsplit(names(livestockrast),\"_\"),'[',1) %in% \"TotalHerbivoreBiomass\"]]\nnames(totalherbivorebiomass)<-allyears_vect\ntotalherbivorebiomass_npp<-totalherbivorebiomass[[names(totalherbivorebiomass) %in% c(\"1999\",\"2009\",\"2015\")]]\n \n diffherb<-100*(totalherbivorebiomass_npp-expected_herbivore_biomass)/(expected_herbivore_biomass+1)\n names(diffherb)<-c(\"2000\",'2009','2015')\n   \n# #Plot on a diverging colour scale around 0\n ggplot()+geom_sf(data=norcounty,fill=\"white\",lwd=0.1)+\n   geom_spatraster(data=diffherb)+\n   ggtitle(\"Difference from expected herbivore biomass\")+\n   scale_fill_distiller(type=\"div\",limit=c(-100,100),oob=squish, na.value=NA,'% difference from \\nexpected biomass')+\n   facet_wrap(~lyr)+theme_bw()\n#> SpatRaster resampled to ncells = 500703\ntotalherbivorebiomass<-livestockrast[[sapply(strsplit(names(livestockrast),\"_\"),'[',1) %in% \"TotalHerbivoreBiomass\"]]\nnames(totalherbivorebiomass)<-allyears_vect\n#carnivorerast<-rast(paste0(pData,\"/Trophic_levels/Carnivores_RawBiomass.tiff\"))\ntotalcarnivores<-carnivorerast[[49:60]]\n\n#Expected carnivore biomass \n#Taken from Hatton et al. Figure 1\nexpected_carnivore_biomass<-(totalherbivorebiomass^0.73)*0.014#African carnivore and herbivore communities\nggplot()+geom_spatraster(data=expected_carnivore_biomass)+\n  ggtitle(\"Expected carnivore biomass\")+\n  facet_wrap(~lyr)+theme_bw()+\n  scale_fill_continuous(low='lightskyblue',high=\"darkblue\",na.value=NA,expression('kg km'^-2),trans='log10')\n#> SpatRaster resampled to ncells = 500703\n#> Warning: Transformation introduced infinite values in discrete\n#> y-axis\n\ndiffcarn<-100* (totalcarnivores-expected_carnivore_biomass)/(expected_carnivore_biomass+1)\nnames(diffcarn)<-allyears_vect\n\nggplot()+geom_sf(data=norcounty,fill=\"white\",lwd=0.1)+\n  geom_spatraster(data=diffcarn)+\n  ggtitle('Difference from expected carnivore biomass')+\n  scale_fill_distiller(type=\"div\",limit=c(-100,100),oob=squish,na.value=NA,\"% difference from \\nexpected biomass\")+\n  facet_wrap(~lyr)+theme_bw()\n#> SpatRaster resampled to ncells = 500703"},{"path":"trophic-level-biomass-ratios.html","id":"part-2---habitat-specific-biomass-distributions","chapter":"9 Trophic level biomass ratios","heading":"9.11 Part 2 - Habitat specific biomass distributions","text":"now create biomass ratios specific habitat types. need ecosystem map place consumer species within habitat.Indicators developed mire ecosystems. decision taken conversation mire ecosystem group, basis herbivores minimum use mire ecosystems.Table consumer species associated habitat.Since suitable ecosystem map still development, use AR50 land-cover map place-holding solution. AR50 give good representation naturlig åpne områder semi-naturlig mark, demonstrate habitat specific biomass distributions using forest class AR50 species outlined .maps, yellow indicates good condition (within 40% expected biomass 60% 140% expected biomass). Blue indicates poor condition, >40% less biomass expected (.e. <60% expected biomass), red indicates poor conditions >40% biomass expected (.e. >140% expected biomass).","code":"\n#Forest\n#AR50 type raster\n# options(timeout = max(1000, getOption(\"timeout\")))\n# filedownload<-\"downloadAR50.zip\"\n# download.file(\"https://ntnu.box.com/shared/static/mfrqmuyx14gtf8u9b8xlzb391m0f9fhy.zip\",\"downloadAR50.zip\")\n# unzip('downloadAR50.zip',exdir=\"AR50\")\n\nartype50<-rast(paste0(pData, \"AR50/AR50_artype_25_ETRS_1989_UTM_Zone_33N.tif\"))\n\n#Reclassify\nartype50_F<-artype50\narTdf<-data.frame(id=c(10,20,30,50,60,70,81,82,128),label=c(\"BuiltUp\",\"Pastures/Arable\",\"Forest\",\"Open\",\"Mires\",\"Ice\",\"Freshwater\",\"Sea\",\"Unmapped\"))\nlevels(artype50_F)<-arTdf\n\narcols<-c(\"black\",\"orange\",\"darkgreen\",\"wheat\",\"lightblue\",\"white\",\"blue\",\"blue\",NA)\nggplot()+geom_spatraster(data=artype50_F)+scale_fill_manual(values=arcols,na.value = NA)\n#> SpatRaster resampled to ncells = 500830\n\n#Project the AR50 to the NPP rasters\n\nartype50_FR<-project(resample(artype50_F,npprast,method='near'),npprast)\n\n#Combine herbivores\nallherbivores<-c(viltrast,livestockrast)\n\n#Mask out forest from rasters\nforest_expected_herbivore_biomass<-mask(expected_herbivore_biomass,artype50_FR,maskvalues=30,inverse=TRUE)\nforest_herbivores<-mask(allherbivores,artype50_FR,maskvalues=30,inverse=TRUE)\n#> \n|---------|---------|---------|---------|\n=========================================\n                                          \nforest_carnivores<-mask(carnivorerast,artype50_FR,maskvalues=30,inverse=TRUE)\nforest_expected_carnivore_biomass<-mask(expected_carnivore_biomass,artype50_FR,maskvalues=30,inverse=TRUE)\n\n#Sum up selected forest herbivore species\n#Here we select the relevant herbivore species for the ecosystem type\nallyears_vect<-c(1907,1917,1929,1938,1949,1959,1969,1979,1989,1999,2009,2015)\n\nforest_herbivores_selectspp<-rast(forest_herbivores,nlyrs=12)\nfor(i in 1:length(allyears_vect)){\n  print(i)\n  forest_herbivores_selectspp[[i]]<-sum(forest_herbivores[[sapply(strsplit(names(forest_herbivores),\"_\"),'[',3)\n                                                         %in% allyears_vect[i] &\n                                      sapply(strsplit(names(forest_herbivores),\"_\"),'[',2)\n                                                          %in% c(\"roe\",\"hjort\",\"elg\",\"storf\")]]\n)\n}\n#> [1] 1\n#> [1] 2\n#> [1] 3\n#> [1] 4\n#> [1] 5\n#> [1] 6\n#> [1] 7\n#> [1] 8\n#> [1] 9\n#> [1] 10\n#> [1] 11\n#> [1] 12\nnames(forest_herbivores_selectspp)<-allyears_vect\n \n #Sum up selected forest carnivore species\n #Here we select the relevant carnivore species for the habitat type\n forest_carnivores_selectspp<-rast(forest_carnivores,nlyrs=12)\n for(i in 1:length(allyears_vect)){\n   print(i)\n   forest_carnivores_selectspp[[i]]<-sum(forest_carnivores[[sapply(strsplit(names(forest_carnivores),\"_\"),'[',3) \n                                                            %in% allyears_vect[i] &\n                                                              sapply(strsplit(names(forest_carnivores),\"_\"),'[',2)\n                                                            %in% c(\"Wolf\",\"Lynx\",\"Bear\")]]\n   )\n }\n#> [1] 1\n#> [1] 2\n#> [1] 3\n#> [1] 4\n#> [1] 5\n#> [1] 6\n#> [1] 7\n#> [1] 8\n#> [1] 9\n#> [1] 10\n#> [1] 11\n#> [1] 12\n names(forest_carnivores_selectspp)<-allyears_vect\n \n \n #Difference in expected and actual biomass in forest\n forest_herbivores_selectspp_nppyrs<-forest_herbivores_selectspp[[names(forest_herbivores_selectspp)%in% c(\"1999\",\"2009\",\"2015\")]]\n \nforest_diffherb<-100*(forest_herbivores_selectspp_nppyrs - forest_expected_herbivore_biomass)/\n (forest_expected_herbivore_biomass+1)\n\n#norcounty_shp<-st_read(\"Vertebrates/data/Processed/\",\"ViltdataCounty\")\n #Simplify by county nr\nnorcounty<-norcounty_shp %>% \n   group_by(FylkeNr) %>%\n   summarise(geometry = st_union(geometry)) \n \nggplot()+geom_sf(data=norcounty,fill=\"white\",lwd=0.1)+\n   geom_spatraster(data=forest_diffherb)+\n   ggtitle(\"Difference in forest herbivores from expectation\")+\n   scale_fill_distiller(type=\"div\",palette='RdYlBu',limit=c(-100,100),oob=squish,na.value=NA, \"% difference from \\nexpected biomass\")+\n   facet_wrap(~lyr)+theme_bw()+\n  labs(x=\"Year\", y=\"Difference\")\n#> SpatRaster resampled to ncells = 500703\n \n \nforest_diffcarn<-100*(forest_carnivores_selectspp-forest_expected_carnivore_biomass)/\n   (forest_expected_carnivore_biomass+1)\n \nggplot()+geom_sf(data=norcounty,fill=\"white\",lwd=0.1)+\n   geom_spatraster(data=forest_diffcarn)+\n   ggtitle(\"Difference from expected carnivore biomass\")+\n   scale_fill_distiller(type=\"div\",palette='RdYlBu',limit=c(-100,100),oob=squish,na.value=NA,\"% difference from\\nexpected biomass\")+\n   facet_wrap(~lyr)+theme_bw()+\n  labs(x=\"Year\", y=\"Difference\")\n#> SpatRaster resampled to ncells = 500703\n \n \n \n# #Scaling as indicators\n \n ggplot()+geom_sf(data=norcounty,fill=\"white\",lwd=0.1)+\n   geom_spatraster(data=forest_diffherb)+\n   ggtitle(\"Difference from expected herbivore biomass\")+\n  scale_fill_gradientn(colors= c(\"blue\",\"yellow\",'yellow' ,  \"red\"),\n                       breaks=c(-100,-40,0,40,100),limits=c(-100,100),na.value=NA,\"% difference from\\nexpected biomass\")+\n   facet_wrap(~lyr)+theme_bw()\n#> SpatRaster resampled to ncells = 500703\n \n \n ggplot()+geom_sf(data=norcounty,fill=\"white\",lwd=0.1)+\n   geom_spatraster(data=forest_diffcarn)+\n   ggtitle(\"Difference from expected carnivore biomass\")+\n   scale_fill_gradientn(colors= c(\"blue\",\"yellow\",'yellow' ,  \"red\"),\n                     breaks=c(-100,-40,0,40,100),limits=c(-100,100),na.value=NA,\"% difference from\\nexpected biomass\")+\n   facet_wrap(~lyr)+theme_bw()\n#> SpatRaster resampled to ncells = 500703"},{"path":"trophic-level-biomass-ratios.html","id":"part-3-county-averages-over-time","chapter":"9 Trophic level biomass ratios","heading":"9.12 Part 3 County averages over time","text":"Finally summarise biomass deviations county time. 0% deviation represents reference condition. lines 40% -40% show limits good condition.","code":"\n #Simplify by county nr\nnorcounty<-norcounty_shp %>% \n  group_by(FylkeNr) %>%\n summarise(geometry = st_union(geometry)) \n\n#County timegraphs\n#Make spatVect \nnorcounty$CountyName<-norcounty$FylkeNr\n#Provide names (some issues with encoding...)\nnorcounty$CountyName<-c(\"_stfold\",\"Akershus\",\"Oslo\",\"Hedmark\",\"Oppland\",\"Buskerud\",\"Vestfold\",\"Telemark\",\"Aust-Agder\",\"Vest-Agder\",\"Rogaland\",\"Hordaland\",\"Sogn og Fjordane\",\n                        \"M_re og Romsdal\",\"S_r-Tr_ndelag\",\"Nord-Tr_ndelag\",\"Nordland\",\"Troms\",\"Finnmark\")\nnorcounty_vect<-vect(norcounty)\n\nforest_carn_herb_county<-terra::extract(forest_diffcarn,norcounty_vect,mean,na.rm=T)\nforest_carn_herb_county$ID<-norcounty_vect$FylkeNr#Replace IDs with Fylke Nrs\nforest_carn_herb_county$CountyName<-norcounty_vect$CountyName#Replace IDs with Fylke Nrs\nforest_carn_herb_countyDF<-gather(forest_carn_herb_county,key=\"Year\",value=\"Difference\",-ID,-CountyName)\n#forest_carn_herb_countyDF$YearN<-as.numeric(substr(forest_carn_herb_countyDF$Year,2,5))\nforest_carn_herb_countyDF$YearN<-as.numeric(forest_carn_herb_countyDF$Year)\n#> Warning: NAs introduced by coercion\n\nggplot(data=forest_carn_herb_countyDF,aes(x=YearN,y=Difference,color=CountyName))+geom_line()+scale_color_discrete()+\n  ggtitle(\"Forest: % Difference from expected carnivore biomass\")+theme_bw()+xlim(c(1905,2025))+geom_hline(yintercept=c(-40,0),lty=c(2,1))+\n  geom_text(data=forest_carn_herb_countyDF[forest_carn_herb_countyDF$YearN==2015,],aes(label = CountyName, x = 2015, y = Difference), hjust = -.1) \n#> Warning: Removed 228 rows containing missing values\n#> (`geom_line()`).\n#> Warning: Removed 228 rows containing missing values\n#> (`geom_text()`).\n\n\nforest_herb_veg_county<-terra::extract(forest_diffherb,norcounty_vect,mean,na.rm=T)\nforest_herb_veg_county$ID<-norcounty_vect$FylkeNr#Replace IDs with Fylke Nrs\nforest_herb_veg_county$CountyName<-norcounty_vect$CountyName#Replace IDs with Fylke Nrs\nforest_herb_veg_countyDF<-gather(forest_herb_veg_county,key=\"Year\",value=\"Difference\",-ID,-CountyName)\nforest_herb_veg_countyDF$YearN<-as.numeric(forest_herb_veg_countyDF$Year)\n#> Warning: NAs introduced by coercion\nggplot(data=forest_herb_veg_countyDF,aes(x=YearN,y=Difference,color=CountyName))+geom_line()+scale_color_discrete()+\n  ggtitle(\"Forest: % Difference from expected herbivore biomass\")+theme_bw()+xlim(c(1999,2018))+geom_hline(yintercept=c(-40,0,40),lty=c(2,1,2))+\n  geom_text(data=forest_herb_veg_countyDF[forest_herb_veg_countyDF$YearN==2015,],aes(label = CountyName, x = 2015, y = Difference), hjust = -.1) \n#> Warning: Removed 57 rows containing missing values\n#> (`geom_line()`).\n#> Warning: Removed 57 rows containing missing values\n#> (`geom_text()`)."},{"path":"insect-indicators.html","id":"insect-indicators","chapter":"10 Insect indicators","heading":"10 Insect indicators","text":"Author date:\nJens Åström 2023-10-05","code":""},{"path":"insect-indicators.html","id":"introduction-4","chapter":"10 Insect indicators","heading":"10.1 Introduction","text":"show calculate set indicators terrestrial insects Norway. Two adapted earlier work Nature Index Norway use data Norwegian monitoring program bumblebees butterflies (NMBB). others developed 2023, use data Norwegian insect monitoring program (NorIns).workflow shortened putting underlying code separate R-packages, freely available Github. relevant packages bombLepiSurv https://github.com/jenast/bombLepiSurv bumblebee butterfly indicators (public yet), Norimon https://github.com/jenast/Norimon rest indicators.indicators NMBB program, community reference values elicited experts, explained . indicators NorIns program, significantly harder , size communities, lack historical timeseries changes sampling identification techniques. therefore currently lack reference values many indicators.list indicators calculated document, state development. details expanded .Many indicators self-explanatory don’t require much justification. Bumblebees semi-natural grasslands Butterflies semi-natural grasslands functionally important pollinators, community dependent varied herbaceous flora. therefore represent key functionality, well indicators habitat quality. Biomass flying insects represent key functional characteristic ecosystem functioning food insectivores, response habitat quality management. Species richness flying insects represents total breadth insect community, Species richness pollinating insects complements butterfly bumblebee indicators taxonomic breadth spatial resolution.\nSpecies richness dung associated insects represent key functional group decomposition, function indicator grazing intensity diversity. Quotent Apocrita vs Symphyta species richness tries go beyond simple amounts, capture compositional changes insect community. Apocrita covers predatory parasitic wasps, Symphyta plant-feeding wasps. relative decrease predatory/parasitic wasps indicate degradation insect prey communities, decrease potential natural pest control. Lastly, Intraspecific genetic variation captures biodiversity now hidden, due lack practical technologies measure . need conserve genetic diversity identified Norwegian law, decreased intraspecific diversity signal population decreases, decreased potential adapt environmental changes, whole species lost area.","code":""},{"path":"insect-indicators.html","id":"about-the-underlying-data-7","chapter":"10 Insect indicators","heading":"10.2 About the underlying data","text":"data used comes ongoing monitoring programs “Norwegian insect monitoring” (NorIns) “Norwegian monitoring bumblebees butterflies” (NMBB). programs initiated financed Environmental agency, aim produce continuous, areal representative, time-series insect community data. NorIns program use malaise window traps sample broad community insect species, identified metabarcoding DNA. NMBB program use sweep netting along transect walks species identified manually field. information available links .","code":""},{"path":"insect-indicators.html","id":"representativity-in-time-and-space-8","chapter":"10 Insect indicators","heading":"10.2.1 Representativity in time and space","text":"NorIns program started 2020 monitoring semi-natural land forests south-eastern region Norway (Østlandet), long-term ambition cover entire country. 2021, program expanded semi-natural land central Norway (Trøndelag), 2022 semi-natural land south-western Norway (Sørlandet), 2023 semi-natural land northern Norway (Nord-Norge), possible expansion western Norway (Vestlandet) 2024. far, forest habitats monitored south-eastern Norway.5 regions represents planned spatial precision survey. Finer resolution evaluated future, although unlikely feasible without intense sampling. program uses staggered sampling scheme visit different locations year, return location every 5 years. sampling scheme, coupled strong yearly variation insect abundances makes reasonable use temporal resolution 5 years. [deal now? average 5 years? Add 5 year aggregation bootstrap_value()]NMBB program started 2009 subset south-eastern Norway (counties Vestfold Østfold), expanded central Norway (Trøndelag) 2010, south-western Norway 2013, western Norway (Vestland Møre og Romsdal fylke) 2022. spatial resolution aligns (now) 4 regions, recommended downscale predictions due limited number sampling locations region. Since locations visited year, yearly estimates condition calculated, interpreted caution due natural yearly variability.programs designed area representative, within respective habitat types regions. use semi-randomized selection schemes localities, NorIns selects random draws, NMBB predefined continuous network survey squares. programs however, subjective decisions made define habitat criteria discard unpractical survey locations.","code":""},{"path":"insect-indicators.html","id":"original-units-5","chapter":"10 Insect indicators","heading":"10.2.2 Original units","text":"original units NorIns include number species, total biomass wet weight, inter-specific genetic diversity (unit determined). NMBB program, original units number individuals species within transect, although presences transects (presence frequencies) used indicator calculations.","code":""},{"path":"insect-indicators.html","id":"temporal-coverage-7","chapter":"10 Insect indicators","heading":"10.2.3 Temporal coverage","text":"2009-present NMBB data, 2020-present NorIns data.","code":""},{"path":"insect-indicators.html","id":"ecosystem-characteristic-6","chapter":"10 Insect indicators","heading":"10.3 Ecosystem characteristic","text":"","code":""},{"path":"insect-indicators.html","id":"norwegian-standard-3","chapter":"10 Insect indicators","heading":"10.3.1 Norwegian standard","text":"Four indicators tied Økologisk egenskap (Ecological characteristic) Funksjonelt viktige arter og biofysiske stukturer (Funktionally important species structures), four Biologisk mangfold (Biodiversity).","code":""},{"path":"insect-indicators.html","id":"un-standard-2","chapter":"10 Insect indicators","heading":"10.3.2 UN standard","text":"Six indicators tied UN standard (ECT-classes) B1 Compositional state characteristics, two remaining B2 Structural state characteristics.","code":""},{"path":"insect-indicators.html","id":"collinearities-with-other-indicators-9","chapter":"10 Insect indicators","heading":"10.4 Collinearities with other indicators","text":"None measured far, reasonable assume indicators share causal relationships , therefore correlate degree. might also correlate indicators, described , well.","code":""},{"path":"insect-indicators.html","id":"reference-condition-and-values-5","chapter":"10 Insect indicators","heading":"10.5 Reference condition and values","text":"reference condition meant one minimal negative human impact, special interpretation semi-natural land. habitats formed maintained human activities. Thus, “minimal negative human impact” replaced state “good maintenance”, understood resembling traditional agricultural maintenance regime, existing several hundred years late 1800s. characterized extensive grazing, meadows lays, crop rotation legumes bind nitrogen addition fertilization manure, relatively small field sizes abundant field margins, lack artificial fertilization mechanized tilling.","code":""},{"path":"insect-indicators.html","id":"reference-condition-5","chapter":"10 Insect indicators","heading":"10.5.1 Reference condition","text":"Assessing current state insect communities may complicated task, due taxonomic functional breadth high temporal spatial variability. Still, even challenging establishing reference values, reference states extinct prohibitively difficult measure empirically. currently lack reference values indicators NorIns program. unlikely can solved “simply” surveying state reference area, since intact reference areas sufficient size numbers likely longer exist. question handle reference values currently unresolved, present indicator value calculations made reference values placeholders code.NMBB indicators, communities small enough well known enough identify reference communities expert opinion. communities specify expected rate observing species. current rates observation compared expected rates. calculations explained .","code":""},{"path":"insect-indicators.html","id":"reference-values-thresholds-for-defining-good-ecological-condition-minimum-andor-maximum-values-5","chapter":"10 Insect indicators","heading":"10.5.2 Reference values, thresholds for defining good ecological condition, minimum and/or maximum values","text":"specific reference communities NMBB indicators won’t spelled , see instead scripts . specified value good ecological condition yet, since lack straightforward empirical basis .","code":""},{"path":"insect-indicators.html","id":"uncertainties-8","chapter":"10 Insect indicators","heading":"10.6 Uncertainties","text":"uncertainties indicator values calculated bootstrapping average values locality within year. takes variability localities account. NorIns indicators, uncertainties given standard deviation, well confidence intervals.uncertainties NMBB indicators constituted distribution discrete values, therefore provide confidence intervals standard deviation.","code":""},{"path":"insect-indicators.html","id":"references-9","chapter":"10 Insect indicators","heading":"10.7 References","text":"Åström, Jens; Birkemoe, Tone; Brandsegg, Hege; Dahle, Sondre; Davey, Marie Louise; Ekrem, Torbjørn; Fossøy, Frode; Hanssen, Oddvar; Laugsand, Arne Endre; Majaneva, Markus; Staverløkk, Arnstein; Sverdrup-Thygeson, Anne; Ødegaard, Frode.\nInsektovervåking på Østlandet, Sørlandet og Trøndelag. Rapport fra feltsesong 2022. Trondheim: Norsk institutt naturforskning (NINA) 2023 (ISBN 978‐82‐426‐5037‐5) 99 s. NINA rapport(2241)Åström, Jens; Birkemoe, Tone; Brandsegg, Hege; Dahle, Sondre; Davey, Marie Louise; Ekrem, Torbjørn; Fossøy, Frode; Hanssen, Oddvar; Laugsand, Arne Endre; Majaneva, Markus; Staverløkk, Arnstein; Sverdrup-Thygeson, Anne; Ødegaard, Frode.\nInsektovervåking på Østlandet, Sørlandet og Trøndelag. Rapport fra feltsesong 2022. Trondheim: Norsk institutt naturforskning (NINA) 2023 (ISBN 978‐82‐426‐5037‐5) 99 s. NINA rapport(2241)Åström, Sandra Charlotte Helene; Åström, Jens; Bøhn, Kristoffer; Gjershaug, Jan Ove; Staverløkk, Arnstein; Dahle, Sondre; Ødegaard, Frode. Nasjonal overvåking av dagsommerfugler og humler Norge. Oppsummering av aktiviteten 2022. Trondheim: Norsk institutt naturforskning (NINA) 2023 (ISBN 978-82-426-5009-2) 54 s. NINA rapport(2214)Åström, Sandra Charlotte Helene; Åström, Jens; Bøhn, Kristoffer; Gjershaug, Jan Ove; Staverløkk, Arnstein; Dahle, Sondre; Ødegaard, Frode. Nasjonal overvåking av dagsommerfugler og humler Norge. Oppsummering av aktiviteten 2022. Trondheim: Norsk institutt naturforskning (NINA) 2023 (ISBN 978-82-426-5009-2) 54 s. NINA rapport(2214)Connor M French, Laura D Bertola, Ana C Carnaval, Evan P Economo, Jamie M Kass, David J Lohman, Katharine Marske, Rudolf Meier, Isaac Overcast, Andrew J. Rominger, Phillip Staniczenko, Michael J Hickerson. 2023. Global determinants insect mitochondrial genetic diversity. https://doi.org/10.1101/2022.02.09.479762Connor M French, Laura D Bertola, Ana C Carnaval, Evan P Economo, Jamie M Kass, David J Lohman, Katharine Marske, Rudolf Meier, Isaac Overcast, Andrew J. Rominger, Phillip Staniczenko, Michael J Hickerson. 2023. Global determinants insect mitochondrial genetic diversity. https://doi.org/10.1101/2022.02.09.479762Öberg, S., Gjershaug, J. O., Diserud, O. & Ødegaard, F. 2011. Videreutvikling av metodikk \narealrepresentativ overvåking av dagsommerfugler og humler. Naturindeks Norge. – NINA\nRapport 663.Öberg, S., Gjershaug, J. O., Diserud, O. & Ødegaard, F. 2011. Videreutvikling av metodikk \narealrepresentativ overvåking av dagsommerfugler og humler. Naturindeks Norge. – NINA\nRapport 663.","code":""},{"path":"insect-indicators.html","id":"analyses-4","chapter":"10 Insect indicators","heading":"10.8 Analyses","text":"","code":""},{"path":"insect-indicators.html","id":"calculation-principles-for-norins-indicators","chapter":"10 Insect indicators","heading":"10.8.1 Calculation principles for NorIns indicators","text":"indicators Norwegian insect monitoring calculated functions Norimon R-package link. methodology meant facilitate calculation broad variety insect indicators using data NorIns.Main steps workflow:Fetch data biomass community diversity centralized database. Diversity data can filtered several taxonomic levels, biomass available whole samples.Bootstrap observations calculate mean uncertainty point estimates.Compare observations reference points.Display plot resultsMost ecology comes step 1, choosing data use describe quality. can custom selection species, set higher taxa specific genuses, families even order. goal choose set taxa represent specific qualities community can indicate ecological status ecosystem. addition selection taxa, decide level aggregation, e.g. aggregate data region scale, locality scale, even individual sample occasion scale. ecological indicators, aggregate values year locality scale, variables summarises catches locality year.[NOTE, implement 5 year/region aggregation]second step get estimate uncertainty data, use bootstrap method. method flexible, bootstrap samples different sampling levels (samples within localities, regions within country). insect indicators, bootstrap summarize variables regional values, example expressing mean values insect biomass Trøndelag 2021, uncertainty.Ecological knowledge also comes step 3, comparing values reference state. several options. example use single defined value reference state. can also use point time reference point (e.g. start time series).Taken together, framework meant facilitate calculation arbitrary set insect indicators, based combination choices data fetch, aggregation level, reference comparison. can work example pollinators, showcase framework.example, start connecting database order fetch data.convenience, pollinator families can retrieved get_pollinators() function.fetch community data families get_observations function. additionally subset habitat type interested , semi-natural land. result tibble aggregated number species, shannon diversity, mean number genetic variants per species. default aggregation level “year_locality”, meaning total observations locality within year.Note output currently contains experimental values, awaiting robust methodology. “Shannon diversity” doesn’t really make sense without counts amounts, etc. replaced measurements genetic diversity based published peer-reviewed methodology (Connor et al. 2023), (hopefully near) future.","code":"\nconnect_to_insect_db()\npollinators <- get_pollinators()\n\npollinators_fam <- pollinators %>%\n  select(family_latin) %>%\n  pull()\n\npoll_loc_year <- get_observations(subset_families = pollinators_fam,\n                                  subset_habitat = \"Semi-nat\")\npoll_loc_year %>% \n  slice(1:5) %>% \nkableExtra::kbl()"},{"path":"insect-indicators.html","id":"bootstrap-observations","chapter":"10 Insect indicators","heading":"10.8.1.1 Bootstrap observations","text":"localities NorIns program (semi-)randomly selected can viewed samples larger population. Individually, represent single measurement insect community habitat type region. get sampling uncertainty representation, can bootstrap values simple process: choose random set localities within year region (replacement) calculate average values. repeat process large number times get bootstrap sample values, can used express uncertainty dataset.typically 10 localities given habitat type region year, much base uncertainty estimates . bootstrapping works fairly well small samples advantage doesn’t make assumptions statistical distribution errors. Note get larger dataset repeating surveys every 5 years, aggregating bootstrapping whole 5 year period.NorIns fully scaled , 50 localities covered habitat type every country region, 10 localities every year, rotating survey scheme 5 years. Since program rolled sequentially starting 2020, semi-natural land currently covers 4/5 country, varying amounts localities within region. map displays localities surveyed far.bootstrap routine implemented function bootstrap_value(), takes community (get_observation) weight dataset (get_biomass) first input. also needs know measurement dataset bootstrap, , , grouping structure aggregate results . example, bootstrap number pollinator species, aggregate results year regional scale.creates object type boot_stat. Calling prints simple summary bootstrap values.boot_stat object also stores individual bootstrap values later computation. default, use 999 bootstrap samples, results 999 samples * 6 groups = 5994 rows bootstrap values.","code":"\nsemi_loc <- get_localities(dataset = \"NasIns\",\n                           habitat_type = \"Semi-nat\")\nnorway_regions <- get_map()\ntm_shape(norway_regions) +\n  tm_polygons(\"region\") +\n  tm_shape(semi_loc) +\n  tm_symbols(col = \"red\",\n             shape = 22,\n             size = 0.8)\n\npoll_richness_boot <- bootstrap_value(poll_loc_year,\n                                      value = no_species,\n                                      groups = c(\"year\",\n                                                 \"region_name\")\n                                      )\npoll_richness_boot\n#> # A tibble: 6 × 6\n#>    year region_name no_species boot_sd boot_lower2.5 boot_…¹\n#>   <int> <chr>            <dbl>   <dbl>         <dbl>   <dbl>\n#> 1  2020 Østlandet         60.8    6.21          49      73.5\n#> 2  2021 Trøndelag         41.9    3.21          34.8    47.8\n#> 3  2021 Østlandet         53.5    6.10          41.5    64.5\n#> 4  2022 Sørlandet         29.8    5.87          17.9    41.7\n#> 5  2022 Trøndelag         34.7    2.41          30.1    39.6\n#> 6  2022 Østlandet         36.0    2.84          30.4    41.5\n#> # … with abbreviated variable name ¹​boot_upper97.5\npoll_richness_boot[2]\n#> $bootstrap_values\n#> # A tibble: 5,994 × 3\n#> # Groups:   year, region_name [6]\n#>     year region_name boot_values\n#>    <int> <chr>             <dbl>\n#>  1  2020 Østlandet          57.8\n#>  2  2020 Østlandet          59.9\n#>  3  2020 Østlandet          68.1\n#>  4  2020 Østlandet          58.7\n#>  5  2020 Østlandet          59.7\n#>  6  2020 Østlandet          69.8\n#>  7  2020 Østlandet          74.8\n#>  8  2020 Østlandet          61.5\n#>  9  2020 Østlandet          56.6\n#> 10  2020 Østlandet          62.6\n#> # … with 5,984 more rows"},{"path":"insect-indicators.html","id":"comparing-bootstrap-values-to-a-reference-point","chapter":"10 Insect indicators","heading":"10.8.1.2 Comparing bootstrap values to a reference point","text":"Setting aside practical difficulties establishing robust reference values, next step methodology compare observed values (bootstrapped uncertainty) chosen reference value. can made several ways. simply, single numeric value reference value, can simply subtract observed values. example, observe 13 species pollinators 2022 location, reference point 10, 2022 value increased 13 - 10 = 3 species. subtractions made set bootstrapped values, followed new summary statistics calculated, preserving uncertainty bootstrap. boot_stat subtraction method - just . example, set reference value arbitrarily 30 species.Alternatively, use reference point time series . Say example want use values species richness pollinators semi-natural land Østlandet 2020 reference point. can calculate difference (contrast) level levels. function boot_contrast()NB! functionality development. currently works single rows reference points, needs updating allow referencing several values simultaneously, e.g using start values regions habitat types reference points.","code":"\npoll_richness_boot\n#> # A tibble: 6 × 6\n#>    year region_name no_species boot_sd boot_lower2.5 boot_…¹\n#>   <int> <chr>            <dbl>   <dbl>         <dbl>   <dbl>\n#> 1  2020 Østlandet         60.8    6.21          49      73.5\n#> 2  2021 Trøndelag         41.9    3.21          34.8    47.8\n#> 3  2021 Østlandet         53.5    6.10          41.5    64.5\n#> 4  2022 Sørlandet         29.8    5.87          17.9    41.7\n#> 5  2022 Trøndelag         34.7    2.41          30.1    39.6\n#> 6  2022 Østlandet         36.0    2.84          30.4    41.5\n#> # … with abbreviated variable name ¹​boot_upper97.5\ndiff_poll_richness_boot <- poll_richness_boot - 30\ndiff_poll_richness_boot\n#> # A tibble: 6 × 6\n#>    year region_name no_species boot_sd boot_lower2.5 boot_…¹\n#>   <int> <chr>            <dbl>   <dbl>         <dbl>   <dbl>\n#> 1  2020 Østlandet       30.8      6.21        19        43.5\n#> 2  2021 Trøndelag       11.9      3.21         4.8      17.8\n#> 3  2021 Østlandet       23.5      6.10        11.5      34.5\n#> 4  2022 Sørlandet       -0.185    5.87       -12.1      11.7\n#> 5  2022 Trøndelag        4.72     2.41         0.100     9.6\n#> 6  2022 Østlandet        5.95     2.84         0.400    11.5\n#> # … with abbreviated variable name ¹​boot_upper97.5\n\ndiff_poll_richness_boot2 <- poll_richness_boot %>%\n  boot_contrast(year == 2020 & region_name == 'Østlandet')\ndiff_poll_richness_boot2\n#> # A tibble: 6 × 6\n#>    year region_name no_species boot_sd boot_lower2.5 boot_…¹\n#>   <int> <chr>            <dbl>   <dbl>         <dbl>   <dbl>\n#> 1  2020 Østlandet         0       0              0       0  \n#> 2  2021 Trøndelag       -18.8     6.77         -32.2    -5.7\n#> 3  2021 Østlandet        -7.24    8.85         -25       9.1\n#> 4  2022 Sørlandet       -30.9     8.45         -47.6   -14.1\n#> 5  2022 Trøndelag       -26.0     6.63         -40     -13.1\n#> 6  2022 Østlandet       -24.8     6.84         -38.9   -11.5\n#> # … with abbreviated variable name ¹​boot_upper97.5"},{"path":"insect-indicators.html","id":"normalizing-the-values","chapter":"10 Insect indicators","heading":"10.8.1.3 Normalizing the values","text":"comparison reference value, need normalize indicator values lie 0 1. can done several ways (se e.g. eaTools). simplest case use linear scaling, natural zero, e.g. can done dividing indicator values highest value state. boot_stat class / function divides bootstrap value given value, truncates highest values 1, recalculates summary values. can also simply divide reference state, compare values reference state, normalize one go. , exemplify method dividing value 30.","code":"\ndiff_poll_richness_boot3 <- poll_richness_boot / 30\ndiff_poll_richness_boot3\n#> # A tibble: 6 × 6\n#>    year region_name no_species boot_sd boot_lower2.5 boot_…¹\n#>   <int> <chr>            <dbl>   <dbl>         <dbl>   <dbl>\n#> 1  2020 Østlandet        1     0               1           1\n#> 2  2021 Trøndelag        1     0               1           1\n#> 3  2021 Østlandet        1     0               1           1\n#> 4  2022 Sørlandet        0.919 0.116           0.597       1\n#> 5  2022 Trøndelag        0.999 0.00616         1           1\n#> 6  2022 Østlandet        0.999 0.00597         1           1\n#> # … with abbreviated variable name ¹​boot_upper97.5"},{"path":"insect-indicators.html","id":"display-and-plot-bootstrap-values","chapter":"10 Insect indicators","heading":"10.8.1.4 Display and plot bootstrap values","text":"boot_stat class also plot function. tries plot comparison bootstrap distributions years, group. example, plot object diff_poll_richness_boot, can look yearly differences beetles species richness two geographic regions: (Note 1 year data Sørlandet far)cases used single row reference point, shows sharp spike 0.plotting options available, see Norimon indicator workflow vignette.","code":"\nplot(diff_poll_richness_boot)\nplot(diff_poll_richness_boot2)"},{"path":"insect-indicators.html","id":"map-plots","chapter":"10 Insect indicators","heading":"10.8.1.5 Map plots","text":"addition density plots , can also display values geographically. map_plot() function takes boot_stat object plots values according region names.default, shows regions data, can overridden manually:can also choose different palette, example NinaR package, visualize uncertainty setting transparency colors bootstrap standard deviations. way, functions can piped well:concludes tour Norimon functionality.","code":"\nmap_plot(poll_richness_boot)\nmap_plot(poll_richness_boot,\n         whole_country = TRUE)\ndiff_poll_richness_boot %>%\nmap_plot(palette = \"orange-green\",\n         whole_country = FALSE,\n         alpha_from_sd = TRUE)"},{"path":"insect-indicators.html","id":"calculation-principles-for-nbbm-indicators","chapter":"10 Insect indicators","heading":"10.8.2 Calculation principles for NBBM indicators","text":"indicators developed Nature Index Norway, back 2010 Ola Diserud Sandra Öberg (Öberg et. al 2011), calculated routinely yearly basis (see Åström et. al 2022 latest report).indicators summarize state bumblebee butterfly community estimating difference reference community. Formally, community indicator (CI) expressed relative change community state reference (SR), change calculated state change (SC).\\[CI = \\frac{SR-SC}{SR}\\]\nstate reference (SR) represents community species can expected observed given habitat type region. calculated assigning species class expected commonality: common (C), sporadic (S) rare (R) species. classification done expert opinion, informed known present past species distributions. Note state reference contains subset highlighted species, making historical reference community. Potential observations “new” species therefore don’t inform indicator value . Common species expected observed least 5 % surveyed transects habitat type region. Sporadic species similarly defined presence 5 % 1 %. Rare species seen 1 % transects, lastly, species seen transect assumed lost (L) purpose calculation.commonality class gets weight, common species inform reference state sporadic species, followed rare species. state reference (SR) thus value species adds state according commonality. Formally, defined :\\[SR = n_C * w_{C, SR} + n_S * w_{S, SR} + n_R * w_{R, SR} = \\sum_{= (C, S, R)} n_i * w_{, SR}, \\]\n\\(n_i\\) number species commonality class (C, S, R), weights \\([w_{C, SR}, w_{S, SR}, w_{R, SR}]\\) specify respective contribution reference state (SR). weights used \\([w_{C, SR}, w_{S, SR}, w_{R, SR}] = [1.0, 0.75, 0.50]\\), .e. sporadic species 75 % weight common species, rare species 50 % weight common species.state change (SC) calculated \n\\[SC = n_{CS} * w_{CS} + n_{CR} * w_{CR} + n_{CL} * w_{CL} + n_{SR} * w_{SR} + n_{SL} * w_{SL} + n_{RL} * w_{RL}, \\]\n\\(n_{CS}\\) number expected common species (C) observed sporadically (S), \\(w_{CS}\\) weight change. Similarly, \\(n_{CR}\\) number expected species observed rarely, \\(n_{RL}\\) number rare species lost, . Potential increases observation rates inform indicator. Changes common species weighted heavily changes less common species, larger decreases weighted heavily smaller decreases, \\([w_{CS}, w_{CR}, w_{CL}, w_{SR}, w_{SL}, w_{RL}]= [0.50, 0.75, 1.00, 0.50, 0.75, 0.50]\\).indicator values estimated uncertainty, bootstrapping set localities within region, calculating indicator 9999 samples.","code":""},{"path":"insect-indicators.html","id":"calculation-example","chapter":"10 Insect indicators","heading":"10.8.2.1 Calculation example","text":"calculations bootstrap sampling implemented R-package bombLepiSurv (Bombus Lepidoptera Survey). briefly show functionality bumblebees semi-natural lands example.connect internal database convenience function.can fetch observations bumblebees semi-natural land getAllData function. Species names shown Norwegian.summary records easily plotted surveyBarPlot:Note calculating indicator values, consider transects surveyed standard 3 times per year, cover phenology entire season without bias. Data complete survey rounds can fetched database function getComplData, fetches data one habitat type region time.observed relative expected occurrences can visualized plotArt function. requires reference community, can fetched getExpValues function.Species green bars species expected common, need reach green areas plot decrease indicator value (1). Similarly blue (sporadic species), red (rare species). see case Bombus soroeensis expected sporadic species, observed rarely.actual calculation bootstrapping indicator done function calcInd. function calls getComplData getExpectedValues functions internally. also requires weights commonality classes reference community (SR), weights changes state (CS). fetched internally via functions getAmountWeights getDiffWeights, respectively. classes coded Norwegian (v = common, m = sporadic, s = rare).Lastly, specify number samples bootstrap. speed , 999 samples used .result object class “comm_index” (community index). comes (still rudimentary) print plotting functions, showing point estimate limits 95% confidence interval. Due limited number species fixed “weights” species state change, indicator calculation returns distribution discrete values. Therefore can happen 95% 90% confidence intervals , case.Plotting functions series indicator values shown indicator calculations.","code":"\nbombLepiSurv::humlesommerfConnect()\nallBombusGrassland2022 <- getAllData(type = \"bumblebees\",\n                                     habitat = \"gressmark\",\n                                     year = 2022,\n                                     language = \"norsk\")\nsurveyBarplot(allBombusGrassland2022)\nbombus_trond_2022 <- getComplData(type = \"Humler\",\n                                  region_short = \"Trond\",\n                                  habitat = \"Gressmark\",\n                                  year = 2022)\nexp_bombus_trond <- getExpValues(type = \"Humler\",\n                                 region_short = \"Trond\",\n                                 habitat = \"Gressmark\")\nplotArt(bombus_trond_2022,\n        exp_bombus_trond)\ngetDiffWeights()\n#>      v    m   s\n#> v 0.00 0.00 0.0\n#> m 0.50 0.00 0.0\n#> s 0.75 0.50 0.0\n#> t 1.00 0.75 0.5\ngetAmountWeights()\n#>   v    m   s\n#> 1 1 0.75 0.5\nnIter = 999\nhInd2022TrondGress <- calcInd(type = \"Humler\",\n                              region_short = \"Trond\",\n                              habitat = \"Gressmark\",\n                              year = 2022,\n                              nIter = nIter,\n                              save.draws = T)\nhInd2022TrondGress\n#> $`Community indicator estimates, with percentiles`\n#>           2.5%             5% Point estimate            95% \n#>      0.5416667      0.5625000      0.7083333      0.7500000 \n#>          97.5% \n#>      0.7500000\nplot(hInd2022TrondGress)"},{"path":"insect-indicators.html","id":"data-sets-6","chapter":"10 Insect indicators","heading":"10.8.3 Data sets","text":"different ways access data required indicators. NMBB NorIns project store data internal database NINA. also export data GBIF, exports need restructured can processed following scripts.","code":""},{"path":"insect-indicators.html","id":"norins-data","chapter":"10 Insect indicators","heading":"10.8.3.1 NorIns data","text":"Norimon package convenience functions fetch data database, housed internally NINA. database currently available outside NINA, implement solution . Either make database externally available, provide alternative route data GBIF export. now, fetch data Norimon functions.","code":""},{"path":"insect-indicators.html","id":"nmbb-data","chapter":"10 Insect indicators","heading":"10.8.3.2 NMBB data","text":"data bumblebee butterfly indicators can accessed R-package bombLepiSurv.","code":""},{"path":"insect-indicators.html","id":"regions-2","chapter":"10 Insect indicators","heading":"10.8.3.3 Regions","text":"show import shape file regional delineation. indicators associated NorIns project can attributed 5 country regions Norway. Currently however, data program covers 4 5 regions.indicators NMBB program similary connected regions, exception south-east region covers old counties Vestfold Østfold, Nord-Norge isn’t covered yet.","code":"\nconnect_to_insect_db()\nnorway_regions <- Norimon::get_map()\nnorway_reg_NorIns <- norway_regions %>% \n  filter(region != \"Vestlandet\") %>% \n  select(region) %>% \n  group_by(region) %>% \n  summarize(geom = st_union(geom))\ntm_shape(norway_reg_NorIns) + \n  tm_polygons(col = \"region\") \nnbbm_norway_regions <- bombLepiSurv::get_map()\n\nnorway_reg_NBBM <- nbbm_norway_regions %>% \n  filter(region %in% c(\"Øst\", \"Sørlandet\", \"Trøndelag\", \"Vestlandet\")) %>% \n  select(region) %>% \n  group_by(region) %>% \n  summarize(geom = st_union(geom))\ntm_shape(norway_reg_NBBM) + \n  tm_polygons(col = \"region\") "},{"path":"insect-indicators.html","id":"calculation-of-norins-indicators","chapter":"10 Insect indicators","heading":"10.8.4 Calculation of NorIns indicators","text":"calculate indicators abbreviated form, following general framework outlined .","code":""},{"path":"insect-indicators.html","id":"biomass-of-flying-insects-in-semi-natural-land","chapter":"10 Insect indicators","heading":"10.8.4.1 Biomass of flying insects in semi-natural land","text":"Fetch data.Calculate indicator values region year.Compare values reference state. reference state set uniformly regions, made-value just able continue calculations. Alternatively, calculate indicator values region separately, compare individual reference states, put together .use single value reference state normalize values time, using / function.Plot results display uncertainty.Prepare export format.","code":"\nbiomass_sn <- get_biomass(subset_year = 2020:2022,\n                          subset_region = NULL)\nbiomass_sn_boot <- bootstrap_value(df = biomass_sn,\n                                   value = avg_wet_weight,\n                                   groups = c(\"year\",\n                                              \"region_name\")\n                                   )\nbiomass_ref <- 50\n  \nbiomass_sn_diff <- biomass_sn_boot / biomass_ref\nbiomass_sn_diff\n#> # A tibble: 6 × 6\n#>    year region_name avg_wet_weight boot_sd boot_lo…¹ boot_…²\n#>   <int> <chr>                <dbl>   <dbl>     <dbl>   <dbl>\n#> 1  2020 Østlandet            0.670  0.0815     0.519   0.840\n#> 2  2021 Trøndelag            0.863  0.0999     0.648   1    \n#> 3  2021 Østlandet            0.586  0.0760     0.440   0.736\n#> 4  2022 Sørlandet            0.469  0.0662     0.348   0.608\n#> 5  2022 Trøndelag            0.623  0.0690     0.504   0.770\n#> 6  2022 Østlandet            0.376  0.0398     0.300   0.456\n#> # … with abbreviated variable names ¹​boot_lower2.5,\n#> #   ²​boot_upper97.5\nplot(biomass_sn_diff)\nbiomass_sn_to_exp <- biomass_sn_diff$bootstrap_summary\n\nbiomass_sn_to_exp <- biomass_sn_to_exp %>% \n  select(year,\n         region = region_name,\n         ind_value = boot_value,\n         ind_sd = boot_sd,\n         ind_lower2.5 = boot_lower2.5,\n         ind_upper97.5 = boot_upper97.5)\n\nbiomass_sn_to_exp <- norway_reg_NorIns  %>% \n  inner_join(biomass_sn_to_exp,\n            by = c(\"region\" = \"region\"),\n            multiple = \"all\")\n\nbiomass_sn_to_exp\n#> Simple feature collection with 6 features and 6 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -76208 ymin: 6450245 xmax: 468357.5 ymax: 7237323\n#> Projected CRS: ETRS89 / UTM zone 33N\n#> # A tibble: 6 × 7\n#>   region                           geom  year ind_v…¹ ind_sd\n#>   <chr>              <MULTIPOLYGON [m]> <int>   <dbl>  <dbl>\n#> 1 Sørlandet (((-31605 6513854, -31464 …  2022   0.469 0.0662\n#> 2 Trøndelag (((227783 7068646, 227876 …  2021   0.863 0.0999\n#> 3 Trøndelag (((227783 7068646, 227876 …  2022   0.623 0.0690\n#> 4 Østlandet (((179915 6537265, 180246 …  2020   0.670 0.0815\n#> 5 Østlandet (((179915 6537265, 180246 …  2021   0.586 0.0760\n#> 6 Østlandet (((179915 6537265, 180246 …  2022   0.376 0.0398\n#> # … with 2 more variables: ind_lower2.5 <dbl>,\n#> #   ind_upper97.5 <dbl>, and abbreviated variable name\n#> #   ¹​ind_value"},{"path":"insect-indicators.html","id":"species-richness-of-flying-insects-in-semi-natural-land","chapter":"10 Insect indicators","heading":"10.8.4.2 Species richness of flying insects in semi-natural land","text":"Fetch data.Calculate indicator values region year.Compare arbitrary reference value normalize.Plot results display uncertainty.Prepare export format.","code":"\nrichness_sn <- get_observations(subset_year = 2020:2022,\n                                subset_region = NULL)\nrichness_sn_boot <- bootstrap_value(df = richness_sn,\n                                   value = no_species,\n                                   groups = c(\"year\",\n                                              \"region_name\")\n                                   )\nrichness_ref <- 4000\n  \nrichness_sn_diff <- richness_sn_boot / richness_ref\nrichness_sn_diff\n#> # A tibble: 6 × 6\n#>    year region_name no_species boot_sd boot_lower2.5 boot_…¹\n#>   <int> <chr>            <dbl>   <dbl>         <dbl>   <dbl>\n#> 1  2020 Østlandet        0.518  0.0476         0.429   0.615\n#> 2  2021 Trøndelag        0.696  0.0456         0.596   0.772\n#> 3  2021 Østlandet        0.768  0.0422         0.691   0.855\n#> 4  2022 Sørlandet        0.544  0.0658         0.423   0.680\n#> 5  2022 Trøndelag        0.630  0.0285         0.576   0.687\n#> 6  2022 Østlandet        0.627  0.0216         0.584   0.670\n#> # … with abbreviated variable name ¹​boot_upper97.5\nplot(richness_sn_diff)\nrichness_sn_to_exp <- richness_sn_diff$bootstrap_summary\n\nrichness_sn_to_exp <- richness_sn_to_exp %>% \n  select(year,\n         region = region_name,\n         ind_value = boot_value,\n         ind_sd = boot_sd,\n         ind_lower2.5 = boot_lower2.5,\n         ind_upper97.5 = boot_upper97.5)\n\nrichness_sn_to_exp <- norway_reg_NorIns  %>% \n  inner_join(richness_sn_to_exp,\n            by = c(\"region\" = \"region\"),\n            multiple = \"all\")\n\nrichness_sn_to_exp\n#> Simple feature collection with 6 features and 6 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -76208 ymin: 6450245 xmax: 468357.5 ymax: 7237323\n#> Projected CRS: ETRS89 / UTM zone 33N\n#> # A tibble: 6 × 7\n#>   region                           geom  year ind_v…¹ ind_sd\n#>   <chr>              <MULTIPOLYGON [m]> <int>   <dbl>  <dbl>\n#> 1 Sørlandet (((-31605 6513854, -31464 …  2022   0.544 0.0658\n#> 2 Trøndelag (((227783 7068646, 227876 …  2021   0.696 0.0456\n#> 3 Trøndelag (((227783 7068646, 227876 …  2022   0.630 0.0285\n#> 4 Østlandet (((179915 6537265, 180246 …  2020   0.518 0.0476\n#> 5 Østlandet (((179915 6537265, 180246 …  2021   0.768 0.0422\n#> 6 Østlandet (((179915 6537265, 180246 …  2022   0.627 0.0216\n#> # … with 2 more variables: ind_lower2.5 <dbl>,\n#> #   ind_upper97.5 <dbl>, and abbreviated variable name\n#> #   ¹​ind_value"},{"path":"insect-indicators.html","id":"species-richness-of-pollinators-in-semi-natural-land","chapter":"10 Insect indicators","heading":"10.8.4.3 Species richness of pollinators in semi-natural land","text":"Fetch data.Calculate indicator values region year.Compare arbitrary reference value normalize.Plot results display uncertainty.Prepare export format.","code":"\npollinator_fam <- get_pollinators() %>% \n  select(family_latin) %>% \n  pull()\n  \npollinators_sn <- get_observations(subset_year = 2020:2022,\n                                   subset_families = pollinator_fam,\n                                   subset_region = NULL)\npollinators_sn_boot <- bootstrap_value(df = pollinators_sn,\n                                       value = no_species,\n                                       groups = c(\"year\",\n                                                  \"region_name\")\n                                       )\npollinators_ref <- 50\n  \npollinators_sn_diff <- pollinators_sn_boot / pollinators_ref\npollinators_sn_diff\n#> # A tibble: 6 × 6\n#>    year region_name no_species boot_sd boot_lower2.5 boot_…¹\n#>   <int> <chr>            <dbl>   <dbl>         <dbl>   <dbl>\n#> 1  2020 Østlandet        0.926  0.0768         0.739   1    \n#> 2  2021 Trøndelag        0.838  0.0614         0.71    0.948\n#> 3  2021 Østlandet        0.904  0.0766         0.741   1    \n#> 4  2022 Sørlandet        0.593  0.113          0.37    0.824\n#> 5  2022 Trøndelag        0.694  0.0501         0.594   0.792\n#> 6  2022 Østlandet        0.634  0.0538         0.527   0.739\n#> # … with abbreviated variable name ¹​boot_upper97.5\nplot(pollinators_sn_diff)\npollinators_sn_to_exp <- pollinators_sn_diff$bootstrap_summary\n\npollinators_sn_to_exp <- pollinators_sn_to_exp %>% \n  select(year,\n         region = region_name,\n         ind_value = boot_value,\n         ind_sd = boot_sd,\n         ind_lower2.5 = boot_lower2.5,\n         ind_upper97.5 = boot_upper97.5)\n\npollinators_sn_to_exp <- norway_reg_NorIns  %>% \n  inner_join(pollinators_sn_to_exp,\n            by = c(\"region\" = \"region\"),\n            multiple = \"all\")\n\npollinators_sn_to_exp\n#> Simple feature collection with 6 features and 6 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -76208 ymin: 6450245 xmax: 468357.5 ymax: 7237323\n#> Projected CRS: ETRS89 / UTM zone 33N\n#> # A tibble: 6 × 7\n#>   region                           geom  year ind_v…¹ ind_sd\n#>   <chr>              <MULTIPOLYGON [m]> <int>   <dbl>  <dbl>\n#> 1 Sørlandet (((-31605 6513854, -31464 …  2022   0.593 0.113 \n#> 2 Trøndelag (((227783 7068646, 227876 …  2021   0.838 0.0614\n#> 3 Trøndelag (((227783 7068646, 227876 …  2022   0.694 0.0501\n#> 4 Østlandet (((179915 6537265, 180246 …  2020   0.926 0.0768\n#> 5 Østlandet (((179915 6537265, 180246 …  2021   0.904 0.0766\n#> 6 Østlandet (((179915 6537265, 180246 …  2022   0.634 0.0538\n#> # … with 2 more variables: ind_lower2.5 <dbl>,\n#> #   ind_upper97.5 <dbl>, and abbreviated variable name\n#> #   ¹​ind_value"},{"path":"insect-indicators.html","id":"species-richness-of-dung-associated-insects","chapter":"10 Insect indicators","heading":"10.8.4.4 Species richness of dung associated insects","text":"Note species list probably expanded, taxonomic review.Fetch data.[amended data based genus species lists. Need use lowest taxonomic resolution. implement species lookup list database]Calculate indicator values region year.Compare arbitrary reference value normalize.Plot results display uncertainty.Prepare export format.","code":"\ndung_fam <- c(\"Muscidae\") \n  \ndung_sn <- get_observations(subset_year = 2020:2022,\n                                   subset_families = dung_fam,\n                                   subset_region = NULL)\ndung_sn_boot <- bootstrap_value(df = dung_sn,\n                                       value = no_species,\n                                       groups = c(\"year\",\n                                                  \"region_name\")\n                                       )\ndung_ref <- 90\n  \ndung_sn_diff <- dung_sn_boot / dung_ref\ndung_sn_diff\n#> # A tibble: 6 × 6\n#>    year region_name no_species boot_sd boot_lower2.5 boot_…¹\n#>   <int> <chr>            <dbl>   <dbl>         <dbl>   <dbl>\n#> 1  2020 Østlandet        0.684  0.0498         0.584   0.782\n#> 2  2021 Trøndelag        0.923  0.0548         0.8     1    \n#> 3  2021 Østlandet        0.834  0.0502         0.727   0.933\n#> 4  2022 Sørlandet        0.673  0.0684         0.543   0.802\n#> 5  2022 Trøndelag        0.925  0.0400         0.839   1    \n#> 6  2022 Østlandet        0.639  0.0441         0.552   0.728\n#> # … with abbreviated variable name ¹​boot_upper97.5\nplot(dung_sn_diff)\ndung_sn_to_exp <- dung_sn_diff$bootstrap_summary\n\ndung_sn_to_exp <- dung_sn_to_exp %>% \n  select(year,\n         region = region_name,\n         ind_value = boot_value,\n         ind_sd = boot_sd,\n         ind_lower2.5 = boot_lower2.5,\n         ind_upper97.5 = boot_upper97.5)\n\ndung_sn_to_exp <- norway_reg_NorIns  %>% \n  inner_join(dung_sn_to_exp,\n            by = c(\"region\" = \"region\"),\n            multiple = \"all\")\n\ndung_sn_to_exp\n#> Simple feature collection with 6 features and 6 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -76208 ymin: 6450245 xmax: 468357.5 ymax: 7237323\n#> Projected CRS: ETRS89 / UTM zone 33N\n#> # A tibble: 6 × 7\n#>   region                           geom  year ind_v…¹ ind_sd\n#>   <chr>              <MULTIPOLYGON [m]> <int>   <dbl>  <dbl>\n#> 1 Sørlandet (((-31605 6513854, -31464 …  2022   0.673 0.0684\n#> 2 Trøndelag (((227783 7068646, 227876 …  2021   0.923 0.0548\n#> 3 Trøndelag (((227783 7068646, 227876 …  2022   0.925 0.0400\n#> 4 Østlandet (((179915 6537265, 180246 …  2020   0.684 0.0498\n#> 5 Østlandet (((179915 6537265, 180246 …  2021   0.834 0.0502\n#> 6 Østlandet (((179915 6537265, 180246 …  2022   0.639 0.0441\n#> # … with 2 more variables: ind_lower2.5 <dbl>,\n#> #   ind_upper97.5 <dbl>, and abbreviated variable name\n#> #   ¹​ind_value"},{"path":"insect-indicators.html","id":"relationship-between-symphyta-and-parasitica-in-semi-natural-land","chapter":"10 Insect indicators","heading":"10.8.4.5 Relationship between Symphyta and Parasitica in semi-natural land","text":"[Note, list needs checked e.g. Arnstein.]Divide richness Parasitica Symphyta. [make function later .]Bootstrap fraction Parasitica Symphyta.Compare arbitrary reference value normalize.Plot results display uncertainty.Prepare export format.","code":"\nsymphyta_fam <- c(\"Argidae\", \"Cephidae\", \"Cimbicidae\", \n                  \"Diprionidae\", \"Orussidae\", \"Pamphiliidae\", \n                  \"Pergidae\", \"Siricidae\", \"Anaxyelidae\",\n                  \"Tenthredinidae\", \"Xiphydriidae\", \"Xyelidae\") \n\nsymphyta_sn <- get_observations(subset_year = 2020:2022,\n                                subset_families = symphyta_fam,\n                                subset_region = NULL)\n\nsymphyta_sn\n#> # A tibble: 90 × 8\n#>     year locality habitat_…¹ regio…² no_sp…³ shann…⁴ mean_…⁵\n#>    <int> <chr>    <chr>      <chr>     <int>   <dbl>   <dbl>\n#>  1  2020 Skog_01  Forest     Østlan…      15   15       1   \n#>  2  2020 Skog_02  Forest     Østlan…      42   36.8     1.31\n#>  3  2020 Skog_03  Forest     Østlan…      24   21       1.38\n#>  4  2020 Skog_04  Forest     Østlan…       5    4.37    1.4 \n#>  5  2020 Skog_05  Forest     Østlan…      23   21.6     1.17\n#>  6  2020 Skog_06  Forest     Østlan…       9    8.71    1.11\n#>  7  2020 Skog_07  Forest     Østlan…      25   22.5     1.4 \n#>  8  2020 Skog_08  Forest     Østlan…       7    6.73    1.14\n#>  9  2020 Skog_09  Forest     Østlan…      18   17.4     1.11\n#> 10  2020 Skog_10  Forest     Østlan…      11    4.6     2.64\n#> # … with 80 more rows, 1 more variable: GDE_by_asv <dbl>,\n#> #   and abbreviated variable names ¹​habitat_type,\n#> #   ²​region_name, ³​no_species, ⁴​shannon_div,\n#> #   ⁵​mean_asv_per_species\nparasitica_fam <- c(\"Braconidae\", \"Ichneumonidae\", \"Chalcididae\", \n                    \"Eulophidae\", \"Pteromalidae\", \"Aphelinidae\", \n                    \"Scelionidae\", \"Eupelmidae\", \"Encyrtidae\", \n                    \"Mymaridae\", \"Diapriidae\", \"Bethylidae\", \n                    \"Evaniidae\", \"Ceraphronidae\", \"Torymidae\", \n                    \"Dryinidae\", \"Eucharitidae\", \"Mymarommatidae\", \n                    \"Orussidae\", \"Megaspilidae\", \"Stephanidae\", \n                    \"Trigonalidae\", \"Platygastridae\", \"Aulacidae\", \n                    \"Gasteruptiidae\", \"Rhopalosomatidae\", \"Larridae\", \n                    \"Agaonidae\", \"Pompilidae\", \"Bradynobaenidae\"\n                    )\n\nparasitica_sn <- get_observations(subset_year = 2020:2022,\n                                subset_families = parasitica_fam,\n                                subset_region = NULL)\n\nparasitica_sn\n#> # A tibble: 90 × 8\n#>     year locality habitat_…¹ regio…² no_sp…³ shann…⁴ mean_…⁵\n#>    <int> <chr>    <chr>      <chr>     <int>   <dbl>   <dbl>\n#>  1  2020 Skog_01  Forest     Østlan…     208   187.     1.34\n#>  2  2020 Skog_02  Forest     Østlan…     508   447.     1.39\n#>  3  2020 Skog_03  Forest     Østlan…     312   256.     1.56\n#>  4  2020 Skog_04  Forest     Østlan…     130   121.     1.2 \n#>  5  2020 Skog_05  Forest     Østlan…     236   208.     1.43\n#>  6  2020 Skog_06  Forest     Østlan…      99    90.3    1.23\n#>  7  2020 Skog_07  Forest     Østlan…     337   284.     1.46\n#>  8  2020 Skog_08  Forest     Østlan…     114   111.     1.08\n#>  9  2020 Skog_09  Forest     Østlan…     168   152.     1.27\n#> 10  2020 Skog_10  Forest     Østlan…     175   161.     1.22\n#> # … with 80 more rows, 1 more variable: GDE_by_asv <dbl>,\n#> #   and abbreviated variable names ¹​habitat_type,\n#> #   ²​region_name, ³​no_species, ⁴​shannon_div,\n#> #   ⁵​mean_asv_per_species\npar_sym <- symphyta_sn %>% \n  full_join(parasitica_sn,\n       by = c(\"year\" =\"year\",\n              \"locality\" = \"locality\",\n              \"habitat_type\" = \"habitat_type\",\n              \"region_name\" = \"region_name\"),\n       suffix = c(\"_sym\", \"_par\")\n       ) %>% \n  mutate(par_per_sym_richn = no_species_par / no_species_sym)\npar_sym_sn_boot <- bootstrap_value(par_sym,\n                                value = par_per_sym_richn,\n                                groups = c(\"year\", \n                                           \"region_name\"))\npar_sym_ref <- 40\n  \npar_sym_sn_diff <- par_sym_sn_boot / par_sym_ref\npar_sym_sn_diff\n#> # A tibble: 6 × 6\n#>    year region_name par_per_sym_ri…¹ boot_sd boot_…² boot_…³\n#>   <int> <chr>                  <dbl>   <dbl>   <dbl>   <dbl>\n#> 1  2020 Østlandet              0.289  0.0228   0.248   0.336\n#> 2  2021 Trøndelag              0.890  0.0944   0.695   1    \n#> 3  2021 Østlandet              0.604  0.0535   0.495   0.705\n#> 4  2022 Sørlandet              0.815  0.168    0.523   1    \n#> 5  2022 Trøndelag              0.561  0.0625   0.452   0.692\n#> 6  2022 Østlandet              0.698  0.135    0.469   1    \n#> # … with abbreviated variable names ¹​par_per_sym_richn,\n#> #   ²​boot_lower2.5, ³​boot_upper97.5\nplot(par_sym_sn_diff)\npar_sym_sn_exp <- par_sym_sn_diff$bootstrap_summary\n\npar_sym_sn_exp <- par_sym_sn_exp %>% \n  select(year,\n         region = region_name,\n         ind_value = boot_value,\n         ind_sd = boot_sd,\n         ind_lower2.5 = boot_lower2.5,\n         ind_upper97.5 = boot_upper97.5)\n\npar_sym_sn_exp <- norway_reg_NorIns  %>% \n  inner_join(par_sym_sn_exp,\n            by = c(\"region\" = \"region\"),\n            multiple = \"all\")\n\npar_sym_sn_exp\n#> Simple feature collection with 6 features and 6 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -76208 ymin: 6450245 xmax: 468357.5 ymax: 7237323\n#> Projected CRS: ETRS89 / UTM zone 33N\n#> # A tibble: 6 × 7\n#>   region                           geom  year ind_v…¹ ind_sd\n#>   <chr>              <MULTIPOLYGON [m]> <int>   <dbl>  <dbl>\n#> 1 Sørlandet (((-31605 6513854, -31464 …  2022   0.815 0.168 \n#> 2 Trøndelag (((227783 7068646, 227876 …  2021   0.890 0.0944\n#> 3 Trøndelag (((227783 7068646, 227876 …  2022   0.561 0.0625\n#> 4 Østlandet (((179915 6537265, 180246 …  2020   0.289 0.0228\n#> 5 Østlandet (((179915 6537265, 180246 …  2021   0.604 0.0535\n#> 6 Østlandet (((179915 6537265, 180246 …  2022   0.698 0.135 \n#> # … with 2 more variables: ind_lower2.5 <dbl>,\n#> #   ind_upper97.5 <dbl>, and abbreviated variable name\n#> #   ¹​ind_value"},{"path":"insect-indicators.html","id":"genetic-diversity-evenness-of-flying-insects-in-semi-natural-land","chapter":"10 Insect indicators","heading":"10.8.4.6 Genetic diversity evenness of flying insects in semi-natural land","text":"fully implemented yet, method shown functions placeholder, awaiting proper calculation. , intraspecific variation based simply number unique genetic variants (ASVs), relative abundance measured number DNA-reads samples. properly, need use full COI sequence calculate true GDE (see Connor et al. 2023). temporarily postponed due lack software, updated (amended ) soon possible.Fetch data.Calculate indicator values region year.Compare arbitrary reference value normalize.Plot results display uncertainty.Prepare export format.","code":"\nrichness_sn <- get_observations(subset_year = 2020:2022,\n                                subset_region = NULL)\ngde_sn_boot <- bootstrap_value(df = richness_sn,\n                                   value = GDE_by_asv,\n                                   groups = c(\"year\",\n                                              \"region_name\")\n                                   )\ngde_sn_ref <- 0.7\n  \ngde_sn_diff <- gde_sn_boot / gde_sn_ref\ngde_sn_diff\n#> # A tibble: 6 × 6\n#>    year region_name GDE_by_asv boot_sd boot_lower2.5 boot_…¹\n#>   <int> <chr>            <dbl>   <dbl>         <dbl>   <dbl>\n#> 1  2020 Østlandet        0.872  0.0295         0.812   0.934\n#> 2  2021 Trøndelag        0.755  0.0243         0.703   0.8  \n#> 3  2021 Østlandet        0.824  0.0190         0.781   0.859\n#> 4  2022 Sørlandet        0.810  0.0284         0.754   0.867\n#> 5  2022 Trøndelag        0.747  0.0219         0.706   0.79 \n#> 6  2022 Østlandet        0.933  0.0154         0.903   0.964\n#> # … with abbreviated variable name ¹​boot_upper97.5\nplot(gde_sn_diff)\ngde_sn_to_exp <- gde_sn_diff$bootstrap_summary\n\ngde_sn_to_exp <- gde_sn_to_exp %>% \n  select(year,\n         region = region_name,\n         ind_value = boot_value,\n         ind_sd = boot_sd,\n         ind_lower2.5 = boot_lower2.5,\n         ind_upper97.5 = boot_upper97.5)\n\ngde_sn_to_exp <- norway_reg_NorIns  %>% \n  inner_join(gde_sn_to_exp,\n            by = c(\"region\" = \"region\"),\n            multiple = \"all\")\n\ngde_sn_to_exp\n#> Simple feature collection with 6 features and 6 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -76208 ymin: 6450245 xmax: 468357.5 ymax: 7237323\n#> Projected CRS: ETRS89 / UTM zone 33N\n#> # A tibble: 6 × 7\n#>   region                           geom  year ind_v…¹ ind_sd\n#>   <chr>              <MULTIPOLYGON [m]> <int>   <dbl>  <dbl>\n#> 1 Sørlandet (((-31605 6513854, -31464 …  2022   0.810 0.0284\n#> 2 Trøndelag (((227783 7068646, 227876 …  2021   0.755 0.0243\n#> 3 Trøndelag (((227783 7068646, 227876 …  2022   0.747 0.0219\n#> 4 Østlandet (((179915 6537265, 180246 …  2020   0.872 0.0295\n#> 5 Østlandet (((179915 6537265, 180246 …  2021   0.824 0.0190\n#> 6 Østlandet (((179915 6537265, 180246 …  2022   0.933 0.0154\n#> # … with 2 more variables: ind_lower2.5 <dbl>,\n#> #   ind_upper97.5 <dbl>, and abbreviated variable name\n#> #   ¹​ind_value"},{"path":"insect-indicators.html","id":"calculation-of-nbbm-indicators","chapter":"10 Insect indicators","heading":"10.8.5 Calculation of NBBM indicators","text":"","code":""},{"path":"insect-indicators.html","id":"bumblebees-in-open-landscapes","chapter":"10 Insect indicators","heading":"10.8.6 Bumblebees in open landscapes","text":"\nFigure 10.1: Bumblebees grasslands 2021\n","code":"\nrequire(bombLepiSurv)\nhumlesommerfConnect(host = \"ninradardata01.nina.no\")\nallBombusGressmark2022 <- getAllData(type = \"bumblebees\",\n                          habitat = \"gressmark\",\n                          year = 2022,\n                          language = \"norsk\")\n\n\nsurveyBarplot(allBombusGressmark2022)\nnIter = 999\n\nhInd2022TrondGress <- calcInd(type = \"Humler\",\n                              region_short = \"Trond\",\n                              habitat = \"Gressmark\",\n                              year = 2022,\n                              nIter = nIter,\n                              save.draws = T)\nhInd2022SorGress <- calcInd(type = \"Humler\",\n                              region_short = \"Sor\",\n                              habitat = \"Gressmark\",\n                              year = 2022,\n                              nIter = nIter,\n                              save.draws = T)\nhInd2022OstGress <- calcInd(type = \"Humler\",\n                              region_short = \"Ost\",\n                              habitat = \"Gressmark\",\n                              year = 2022,\n                              nIter = nIter,\n                              save.draws = T)\nhInd2022VestGress <- calcInd(type = \"Humler\",\n                              region_short = \"Vest\",\n                              habitat = \"Gressmark\",\n                              year = 2022,\n                              nIter = nIter,\n                              save.draws = T)"},{"path":"insect-indicators.html","id":"butterflies-in-open-landscapes","chapter":"10 Insect indicators","heading":"10.8.7 Butterflies in open landscapes","text":"calculations earlier years already present datasets R-package can fetched individually. done, can plot timeseries values using function indPlot.loaded, yearly datasets can organized convenience function collectIndData, plotted indPlot.","code":"\nnIter = 999\n\nsInd2022TrondGress <- calcInd(type = \"Sommerfugl\",\n                              region_short = \"Trond\",\n                              habitat = \"Gressmark\",\n                              year = 2022,\n                              nIter = nIter,\n                              save.draws = T)\nsInd2022SorGress <- calcInd(type = \"Sommerfugl\",\n                              region_short = \"Sor\",\n                              habitat = \"Gressmark\",\n                              year = 2022,\n                              nIter = nIter,\n                              save.draws = T)\nsInd2022OstGress <- calcInd(type = \"Sommerfugl\",\n                              region_short = \"Ost\",\n                              habitat = \"Gressmark\",\n                              year = 2022,\n                              nIter = nIter,\n                              save.draws = T)\nsInd2022VestGress <- calcInd(type = \"Sommerfugl\",\n                              region_short = \"Vest\",\n                              habitat = \"Gressmark\",\n                              year = 2022,\n                              nIter = nIter,\n                              save.draws = T)\ndata(\"sInd2022VestGress\")\ndata(\"sInd2022VestSkog\")\ndata(\"sInd2022TrondGress\")\ndata(\"sInd2022TrondSkog\")\ndata(\"sInd2022OstGress\")\ndata(\"sInd2022OstSkog\")\ndata(\"sInd2022SorGress\")\ndata(\"sInd2022SorSkog\")\n\ndata(\"sInd2021TrondGress\")\ndata(\"sInd2021TrondSkog\")\ndata(\"sInd2021OstGress\")\ndata(\"sInd2021OstSkog\")\ndata(\"sInd2021SorGress\")\ndata(\"sInd2021SorSkog\")\n\ndata(\"sInd2020TrondGress\")\ndata(\"sInd2020TrondSkog\")\ndata(\"sInd2020OstGress\")\ndata(\"sInd2020OstSkog\")\ndata(\"sInd2020SorGress\")\ndata(\"sInd2020SorSkog\")\n\n\ndata(\"sInd2019TrondGress\")\ndata(\"sInd2019TrondSkog\")\ndata(\"sInd2019OstGress\")\ndata(\"sInd2019OstSkog\")\ndata(\"sInd2019SorGress\")\ndata(\"sInd2019SorSkog\")\ndata(\"sInd2018TrondGress\")\ndata(\"sInd2018TrondSkog\")\ndata(\"sInd2018OstGress\")\ndata(\"sInd2018OstSkog\")\ndata(\"sInd2018SorGress\")\ndata(\"sInd2018SorSkog\")\ndata(\"sInd2017TrondGress\")\ndata(\"sInd2017TrondSkog\")\ndata(\"sInd2017OstGress\")\ndata(\"sInd2017OstSkog\")\ndata(\"sInd2017SorGress\")\ndata(\"sInd2017SorSkog\")\ndata(\"sInd2016TrondGress\")\ndata(\"sInd2016TrondSkog\")\ndata(\"sInd2016OstGress\")\ndata(\"sInd2016OstSkog\")\ndata(\"sInd2016SorGress\")\ndata(\"sInd2016SorSkog\")\ndata(\"sInd2015TrondGress\")\ndata(\"sInd2015TrondSkog\")\ndata(\"sInd2015OstGress\")\ndata(\"sInd2015OstSkog\")\ndata(\"sInd2015SorGress\")\ndata(\"sInd2015SorSkog\")\ndata(\"sInd2014TrondGress\")\ndata(\"sInd2014TrondSkog\")\ndata(\"sInd2014OstGress\")\ndata(\"sInd2014OstSkog\")\ndata(\"sInd2014SorGress\")\ndata(\"sInd2014SorSkog\")\ndata(\"sInd2013TrondGress\")\ndata(\"sInd2013TrondSkog\")\ndata(\"sInd2013OstGress\")\ndata(\"sInd2013OstSkog\")\ndata(\"sInd2013SorGress\")\ndata(\"sInd2013SorSkog\")\ndata(\"sInd2012TrondGress\")\ndata(\"sInd2012TrondSkog\")\ndata(\"sInd2012OstGress\")\ndata(\"sInd2012OstSkog\")\ndata(\"sInd2011OstGress\")\ndata(\"sInd2011OstSkog\")\ndata(\"sInd2010OstGress\")\ndata(\"sInd2010OstSkog\")\ndata(\"sInd2009OstGress\")\ndata(\"sInd2009OstSkog\")\n\ndata(\"hInd2022VestGress\")\ndata(\"hInd2022VestSkog\")\ndata(\"hInd2022TrondGress\")\ndata(\"hInd2022TrondSkog\")\ndata(\"hInd2022OstGress\")\ndata(\"hInd2022OstSkog\")\ndata(\"hInd2022SorGress\")\ndata(\"hInd2022SorSkog\")\ndata(\"hInd2021TrondGress\")\ndata(\"hInd2021TrondSkog\")\ndata(\"hInd2021OstGress\")\ndata(\"hInd2021OstSkog\")\ndata(\"hInd2021SorGress\")\ndata(\"hInd2021SorSkog\")\ndata(\"hInd2020TrondGress\")\ndata(\"hInd2020TrondSkog\")\ndata(\"hInd2020OstGress\")\ndata(\"hInd2020OstSkog\")\ndata(\"hInd2020SorGress\")\ndata(\"hInd2020SorSkog\")\ndata(\"hInd2019TrondGress\")\ndata(\"hInd2019TrondSkog\")\ndata(\"hInd2019OstGress\")\ndata(\"hInd2019OstSkog\")\ndata(\"hInd2019SorGress\")\ndata(\"hInd2019SorSkog\")\ndata(\"hInd2018TrondGress\")\ndata(\"hInd2018TrondSkog\")\ndata(\"hInd2018OstGress\")\ndata(\"hInd2018OstSkog\")\ndata(\"hInd2018SorGress\")\ndata(\"hInd2018SorSkog\")\ndata(\"hInd2017TrondGress\")\ndata(\"hInd2017TrondSkog\")\ndata(\"hInd2017OstGress\")\ndata(\"hInd2017OstSkog\")\ndata(\"hInd2017SorGress\")\ndata(\"hInd2017SorSkog\")\ndata(\"hInd2016TrondGress\")\ndata(\"hInd2016TrondSkog\")\ndata(\"hInd2016OstGress\")\ndata(\"hInd2016OstSkog\")\ndata(\"hInd2016SorGress\")\ndata(\"hInd2016SorSkog\")\ndata(\"hInd2015TrondGress\")\ndata(\"hInd2015TrondSkog\")\ndata(\"hInd2015OstGress\")\ndata(\"hInd2015OstSkog\")\ndata(\"hInd2015SorGress\")\ndata(\"hInd2015SorSkog\")\ndata(\"hInd2014TrondGress\")\ndata(\"hInd2014TrondSkog\")\ndata(\"hInd2014OstGress\")\ndata(\"hInd2014OstSkog\")\ndata(\"hInd2014SorGress\")\ndata(\"hInd2014SorSkog\")\ndata(\"hInd2013TrondGress\")\ndata(\"hInd2013TrondSkog\")\ndata(\"hInd2013OstGress\")\ndata(\"hInd2013OstSkog\")\ndata(\"hInd2013SorGress\")\ndata(\"hInd2013SorSkog\")\ndata(\"hInd2012TrondGress\")\ndata(\"hInd2012TrondSkog\")\ndata(\"hInd2012OstGress\")\ndata(\"hInd2012OstSkog\")\ndata(\"hInd2011OstGress\")\ndata(\"hInd2011OstSkog\")\ndata(\"hInd2010OstGress\")\ndata(\"hInd2010OstSkog\")\ndata(\"hInd2009OstGress\")\ndata(\"hInd2009OstSkog\")\nhGressIndVals <- collectIndData(taxa = \"bumblebees\", \n                                habitat = \"gressmark\",\n                                years = 2009:2022)\n\nindPlot(input = hGressIndVals,\n        confLevel = \"95%\",\n        lineWidth = 1,\n        dodge = 0.5,\n        pointSize = 4) +\n  ggtitle(\"Indicator values for bumblebees in semi-natural landscapes\") +\n  scale_x_continuous(breaks = 2009:2022)\nsGressIndVals <- collectIndData(taxa = \"butterflies\", \n                                habitat = \"gressmark\",\n                                years = 2009:2022)\n\nindPlot(input = sGressIndVals,\n        confLevel = \"95%\",\n        lineWidth = 1,\n        dodge = 0.5,\n        pointSize = 4) +\n  ggtitle(\"Indicator values for butterflies in semi-natural landscapes\") +\n  scale_x_continuous(breaks = 2009:2022)"},{"path":"insect-indicators.html","id":"prepare-export","chapter":"10 Insect indicators","heading":"10.9 Prepare export","text":"fetch indicator regions sf join calculated indicator values.","code":"\nnorway_reg_NBBM <- bombLepiSurv::get_map() %>% \n  filter(region %in% c(\"Sør\", \"Vestlandet\", \"Øst\", \"Trøndelag\")) %>% \n  select(region) %>% \n  group_by(region) %>% \n  summarize(geom = st_union(geom))\n\nhGressIndVals_to_exp <- hGressIndVals %>% \n  select(year = Year,\n         region = Region,\n         ind_value = Indicator_value,\n         ind_sd = NULL,\n         ind_lower2.5 = lower95,\n         ind_upper97.5 = upper95)\n\nhGressIndVals_to_exp <- norway_reg_NBBM  %>% \n  inner_join(hGressIndVals_to_exp,\n            by = c(\"region\" = \"region\"),\n            multiple = \"all\")\n\nhGressIndVals_to_exp\n#> Simple feature collection with 36 features and 5 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -76208 ymin: 6450245 xmax: 468357.5 ymax: 7237323\n#> Projected CRS: ETRS89 / UTM zone 33N\n#> # A tibble: 36 × 6\n#>    region                         geom  year ind_v…¹ ind_l…²\n#>    <chr>            <MULTIPOLYGON [m]> <int>   <dbl>   <dbl>\n#>  1 Sør    (((-31605 6513854, -31464 6…  2013   0.596   0.423\n#>  2 Sør    (((-31605 6513854, -31464 6…  2014   0.635   0.5  \n#>  3 Sør    (((-31605 6513854, -31464 6…  2015   0.519   0.385\n#>  4 Sør    (((-31605 6513854, -31464 6…  2016   0.635   0.462\n#>  5 Sør    (((-31605 6513854, -31464 6…  2017   0.615   0.423\n#>  6 Sør    (((-31605 6513854, -31464 6…  2018   0.577   0.462\n#>  7 Sør    (((-31605 6513854, -31464 6…  2019   0.519   0.422\n#>  8 Sør    (((-31605 6513854, -31464 6…  2020   0.593   0.444\n#>  9 Sør    (((-31605 6513854, -31464 6…  2021   0.519   0.389\n#> 10 Sør    (((-31605 6513854, -31464 6…  2022   0.593   0.370\n#> # … with 26 more rows, 1 more variable:\n#> #   ind_upper97.5 <dbl>, and abbreviated variable names\n#> #   ¹​ind_value, ²​ind_lower2.5\n\n\nsGressIndVals_to_exp <- sGressIndVals %>% \n  select(year = Year,\n         region = Region,\n         ind_value = Indicator_value,\n         ind_sd = NULL,\n         ind_lower2.5 = lower95,\n         ind_upper97.5 = upper95)\n\nsGressIndVals_to_exp <- norway_reg_NBBM  %>% \n  inner_join(sGressIndVals_to_exp,\n            by = c(\"region\" = \"region\"),\n            multiple = \"all\")\n\nsGressIndVals_to_exp\n#> Simple feature collection with 36 features and 5 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -76208 ymin: 6450245 xmax: 468357.5 ymax: 7237323\n#> Projected CRS: ETRS89 / UTM zone 33N\n#> # A tibble: 36 × 6\n#>    region                         geom  year ind_v…¹ ind_l…²\n#>    <chr>            <MULTIPOLYGON [m]> <int>   <dbl>   <dbl>\n#>  1 Sør    (((-31605 6513854, -31464 6…  2013   0.259   0.151\n#>  2 Sør    (((-31605 6513854, -31464 6…  2014   0.374   0.273\n#>  3 Sør    (((-31605 6513854, -31464 6…  2015   0.345   0.230\n#>  4 Sør    (((-31605 6513854, -31464 6…  2016   0.302   0.216\n#>  5 Sør    (((-31605 6513854, -31464 6…  2017   0.345   0.237\n#>  6 Sør    (((-31605 6513854, -31464 6…  2018   0.309   0.201\n#>  7 Sør    (((-31605 6513854, -31464 6…  2019   0.388   0.281\n#>  8 Sør    (((-31605 6513854, -31464 6…  2020   0.419   0.284\n#>  9 Sør    (((-31605 6513854, -31464 6…  2021   0.399   0.270\n#> 10 Sør    (((-31605 6513854, -31464 6…  2022   0.358   0.25 \n#> # … with 26 more rows, 1 more variable:\n#> #   ind_upper97.5 <dbl>, and abbreviated variable names\n#> #   ¹​ind_value, ²​ind_lower2.5"},{"path":"insect-indicators.html","id":"eksport-file-final-product-1","chapter":"10 Insect indicators","heading":"10.9.1 Eksport file (final product)","text":"TBD. Need consult others.","code":""},{"path":"NDVI-indicator-natopen.html","id":"NDVI-indicator-natopen","chapter":"11 NDVI - Naturally Open Ecosystems","heading":"11 NDVI - Naturally Open Ecosystems","text":"NDVI (greenness) indicator, naturally open ecosystems treelineAuthor date:Joachim Töpper, Tessa BargmannSeptember 2023","code":""},{"path":"NDVI-indicator-natopen.html","id":"intro-ndvin","chapter":"11 NDVI - Naturally Open Ecosystems","heading":"11.1 Introduction","text":"Normalized difference vegetation index (NDVI) can used describe greenness area, may thus represent proxy amount chlorophyll plant productivity given area. Different ecosystem types naturally greenness signals different intensity also certain variance. Deviations beyond natural variation either direction may indicate reduction ecological condition given ecosystem. E.g. lower normal NDVI may indicate excessive disturbance, higher normal NDVI may indicate regrowth transitions towards densely vegetated systems. recent assessments ecological condition forest mountain ecosystems, two different NDVI-based indicators developed applied. forests, NDVI-values across country compared spatial reference NDVI-signal protected areas (Framstad et al. 2020). mountains, extent consistence temporal change NDVI-values last twenty years assessed (Framstad et al 2021). cases, NDVI-product MODIS satellite reflectance imagery used based available maps spatial ecosystem extent Norway (.e. national maps forest mountain ecosystems)., explore potential developing NDVI-indicator ecological condition representing naturally open ecosystems treeline (called natopen hereafter). task, three initial challenges can identified early :don’t yet national map natopen ecosystems, .e. don’t know exact locations natopen areas Norway, prerequisite extract satellite data right locations ecosystems, thus achieve good unbiased spatial representation assessment area.spatial extent single natopen ecosystem occurrences (hereafter polygons) includes many areas way smaller pixel size MODIS imagery (250 x 250 m) used forests mountains time series back year 2000.Natopen ecosystems Norway widely different physiognomy, ecology, thus vegetation, spanning highly disturbed hill slopes sparse ruderal vegetation nutrient rich shallow soils resource demanding plant species. Thus, large variation NDVI signals different natopen ecosystem types expected.draft development NDVI indicator ecological condition natopen systems approach challenges following ways:use ecosystem occurrence data NiN-mapping guide extraction satellite NDVI data pixels representing right ecosystem. However, ecosystem occurrences NiN data highly spatially biased thus provide good unbiased spatial representation assessment area. work therefore represents concept method development may applied assessment ecological condition spatially unbiased occurrence data national map natopen ecosystems available.include Sentinel-2 imagery natopen ecosystems resolution bands underlying NDVI product 10 x 10 m smaller almost natopen polygons NiN-data. However, since Sentinel-2 goes back 2015, lose much time series aspect compared MODIS data. addition, include Landsat imagery goes back 1984 resolution 30 x 30 m, also variable data due less frequent seasonal measurements. also still explore NDVI data MODIS (see details ).","code":""},{"path":"NDVI-indicator-natopen.html","id":"about-the-data-ndvin","chapter":"11 NDVI - Naturally Open Ecosystems","heading":"11.2 About the underlying data","text":"NDVI project natopen systems, use two kinds data (coming four datasets) building indicators ecological condition:NiN ecosystem data ‘Naturtypekartlegging etter Miljødirektoratets instruks’ guide extraction NDVI data right locations provide information field-assessed ecological condition mapped polygonsremote sensed NDVI data\nSentinel-2 satellite NDVI data\nMODIS satellite NDVI data\nLandsat satellite NDVI data\nSentinel-2 satellite NDVI dataMODIS satellite NDVI dataLandsat satellite NDVI dataNiN ecosystem data:\nNiN data study contain data ecosystem categories (cf. Halvorsen et al. 2020) present mapped sites wall spatial delimitation (form polygons). Since use NiN data collected following ‘Miljødirektoratets instruks’, data also include information ecological condition underlying condition variabels mapped sites (see Miljødirektoratets mapping manual details).\nPolygon sizes NiN data may vary <100 sqm 240 000 sqm.NiN ecosystem data:\nNiN data study contain data ecosystem categories (cf. Halvorsen et al. 2020) present mapped sites wall spatial delimitation (form polygons). Since use NiN data collected following ‘Miljødirektoratets instruks’, data also include information ecological condition underlying condition variabels mapped sites (see Miljødirektoratets mapping manual details).\nPolygon sizes NiN data may vary <100 sqm 240 000 sqm.NDVI data:\nNDVI data used work hand pixel means polygons NiN-data, .e. NiN polygon represented one NDVI value per measurement time (see details temporal resolution NDVI data). respect , make sense use NDVI data polygons least size resolution respective satellite, thus excluded polygons smaller satellite’s resolution.NDVI data:\nNDVI data used work hand pixel means polygons NiN-data, .e. NiN polygon represented one NDVI value per measurement time (see details temporal resolution NDVI data). respect , make sense use NDVI data polygons least size resolution respective satellite, thus excluded polygons smaller satellite’s resolution.(2a) Sentinel-2 satellite NDVI data:\nSentinel data resolution 10 x 10 m, thus excluded NiN-polygons smaller 100 sqm. Sentinel-2 revisit frequency 10 days thus provide enough measurements peak growing season provide robust measure maximum greenness.(2b) MODIS satellite NDVI data:\nMODIS data resolution 250 x 250 m, thus excluded NiN-polygons smaller 62500 sqm. MODIS revisit frequency 1-2 days thus provides extensive sample provide robust measure maximum greenness.(2c) Landsat satellite NDVI data:\nLandsat data resolution 30 x 30 m, thus excluded NiN-polygons smaller 900 sqm. Landsat revisit frequency 16 days thus provides poorest growing season sample among available NDVI data robust measure maximum greenness.","code":""},{"path":"NDVI-indicator-natopen.html","id":"rep-in-space-and-time-ndvin","chapter":"11 NDVI - Naturally Open Ecosystems","heading":"11.2.1 Representativity in time and space","text":"natopen systems, NiN data contain 2881 natopen polygons known area size across mainland Norway. However, NiN-mapping planned performed spatially representative way thus ecosystem occurrences spatial extent treated spatially biased. 2881 natopen polygons distributed across regions major ecosystem types following way:addition, 54 T2s, 57 T12s, 3 T18s, 5 T21s assigned region. (polygons likely lie water thus outside regional polygons due imprecise coordinates mapping device).NDVI data either satellite follow spatial distribution bias status NiN-data. Due larger number excluded polygons NDVI data MODIS (large pixel size MODIS, see ), MODIS NDVI data natopen occurrences NiN data likely even spatially biased case NDVI data Sentinel-2 Landsat.","code":""},{"path":"NDVI-indicator-natopen.html","id":"temp-coverage-ndvin","chapter":"11 NDVI - Naturally Open Ecosystems","heading":"11.2.2 Temporal coverage","text":"currently available NiN data natopen ecosystems span time period 2018-2021 thus represent contemporary sample ecosystem occurrences. Note none polygons NiN-data visited period.Available Sentinel-2 satellite NDVI data span years 2015-2022.Available MODIS satellite NDVI data span years 2000-2022.Available Landsat satellite NDVI data span years 1984-2021.","code":""},{"path":"NDVI-indicator-natopen.html","id":"collinearity-ndvin","chapter":"11 NDVI - Naturally Open Ecosystems","heading":"11.3 Collinearities with other indicators","text":"Unlike wetlands semi.natural systems, natopen areas subject shrub tree encroachment due changes land-use, Thus, expect co-linearity NDVI signal e.g. re-growth indicator based LiDAr derived canopy height.","code":""},{"path":"NDVI-indicator-natopen.html","id":"ref-ndvin","chapter":"11 NDVI - Naturally Open Ecosystems","heading":"11.4 Reference state and values","text":"","code":""},{"path":"NDVI-indicator-natopen.html","id":"ref2-ndvin","chapter":"11 NDVI - Naturally Open Ecosystems","heading":"11.4.1 Reference state and scaling values","text":"indicator project mainly exploratory, mapping possibilities lacking prerequisites satellite derived NDVI data inform ecological condition assessments. Therefore, lack concise strategy define reference state, especially prior access ecosystem map natopen ecosystems (cf. Jakobsson et al. 2020, Töpper & Jakobsson 2021). exploratory work, use condition classification NiN-data explore\n1. NDVI connects natopen ecology condition \n2. applicability defining reference state.use statistical models test whether NDVI varies systematically condition across time.","code":""},{"path":"NDVI-indicator-natopen.html","id":"uncertainties-ndvin","chapter":"11 NDVI - Naturally Open Ecosystems","heading":"11.5 Uncertainties","text":"Given condition index can achieved, can calculate mean indicator value (scaling) every region (delimited area interest) well corresponding standard error standard deviation measure spatial uncertainty geographical area (see Töpper & Jakobsson 2021).","code":""},{"path":"NDVI-indicator-natopen.html","id":"references-ndvin","chapter":"11 NDVI - Naturally Open Ecosystems","heading":"11.6 References","text":"Framstad, E., Kolstad, . L., Nybø, S., Töpper, J. & Vandvik, V. 2022. condition forest mountain ecosystems Norway. Assessment IBECA method. NINA Report 2100. Norwegian Institute Nature Research.Halvorsen, R., Skarpaas, O., Bryn, ., Bratli, H., Erikstad, L., Simensen, T., & Lieungh, E. (2020). Towards systematics ecodiversity: EcoSyst framework. Global Ecology Biogeography, 29(11), 1887-1906. doi:10.1111/geb.13164Jakobsson, S., Töpper, J.P., Evju, M., Framstad, E., Lyngstad, ., Pedersen, B., Sickel, H., Sverdrup-Thygeson, ., Vandvik. V., Velle, L.G., Aarrestad, P.. & Nybø, S. 2020. Setting reference levels limits good ecological condition terrestrial ecosystems. Insights case study based IBECA approach. Ecological Indicators 116: 106492.Miljødiretoratets mapping manual: https://www.miljodirektoratet./publikasjoner/2022/januar/kartleggingsinstruks-kartlegging-av-terrestriske-naturtyper-etter-nin/Töpper, J. & Jakobsson, S. 2021. Index-Based Ecological Condition Assessment (IBECA) - Technical protocol, version 1.0. NINA Report 1967. Norwegian Institute Nature Research.","code":""},{"path":"NDVI-indicator-natopen.html","id":"analyses-ndvin","chapter":"11 NDVI - Naturally Open Ecosystems","heading":"11.7 Analyses","text":"","code":""},{"path":"NDVI-indicator-natopen.html","id":"datasets-ndvin","chapter":"11 NDVI - Naturally Open Ecosystems","heading":"11.7.1 Data sets","text":"analyses document make use following data sets:NiN data (Naturtyper etter Miljødirektoratets instruks)Sentinel-2 NDVI dataMODIS NDVI dataLandsat NDVI data","code":""},{"path":"NDVI-indicator-natopen.html","id":"nin-data-and-geometry-for-norway-and-the-five-regions","chapter":"11 NDVI - Naturally Open Ecosystems","heading":"11.7.1.1 NiN data and geometry for Norway and the five regions","text":"read NiN data document cache NINA server……can also directly downloaded Miljødirektoratets kartkatalog (https://kartkatalog.miljodirektoratet./Dataset)upload maps Norway five regions: Southern, Western, Eastern, Central, Northern Norway","code":"\nurl <- \"https://nedlasting.miljodirektoratet.no/Miljodata//Naturtyper_nin/FILEGDB/4326/Naturtyper_nin_0000_norge_4326_FILEGDB.zip\"\ndownload(url, dest = \"P:/41201785_okologisk_tilstand_2022_2023/data/Naturtyper_nin_0000_norge_4326_FILEGDB.zip\", mode = \"wb\")\nunzip(\"P:/41201785_okologisk_tilstand_2022_2023/data/Naturtyper_nin_0000_norge_4326_FILEGDB.zip\",\n  exdir = \"P:/41201785_okologisk_tilstand_2022_2023/data/nin_data\"\n)\nst_layers(\"P:/41201785_okologisk_tilstand_2022_2023/data/nin_data/Naturtyper_nin_0000_norge_4326_FILEGDB.gdb\")\nnin <- st_read(\"P:/41201785_okologisk_tilstand_2022_2023/data/nin_data/Naturtyper_nin_0000_norge_4326_FILEGDB.gdb\",\n  layer = \"naturtyper_nin_omr\"\n)\n# Import region- og Norgeskart, make sure they have the same geometry as the nin data\nnor <- st_read(\"data/outlineOfNorway_EPSG25833.shp\") %>%\n  st_as_sf() %>%\n  st_transform(crs = st_crs(nin))\n#> Reading layer `outlineOfNorway_EPSG25833' from data source \n#>   `/data/Egenutvikling/41001581_egenutvikling_anders_kolstad/github/ecosystemCondition/data/outlineOfNorway_EPSG25833.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 1 feature and 2 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -113472.7 ymin: 6448359 xmax: 1114618 ymax: 7939917\n#> Projected CRS: ETRS89 / UTM zone 33N\n\nreg <- st_read(\"data/regions.shp\") %>%\n  st_as_sf() %>%\n  st_transform(crs = st_crs(nin))\n#> Reading layer `regions' from data source \n#>   `/data/Egenutvikling/41001581_egenutvikling_anders_kolstad/github/ecosystemCondition/data/regions.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 5 features and 2 fields\n#> Geometry type: POLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -99551.21 ymin: 6426048 xmax: 1121941 ymax: 7962744\n#> Projected CRS: ETRS89 / UTM zone 33N\n\n# change region names to something R-friendly\n  # reg$region\nreg$region <- c(\"Northern Norway\", \"Central Norway\", \"Eastern Norway\", \"Western Norway\", \"Southern Norway\")\n\n# combine the Norway and the region maps\nregnor <- st_intersection(reg, nor)"},{"path":"NDVI-indicator-natopen.html","id":"ndvi-data-ndvin","chapter":"11 NDVI - Naturally Open Ecosystems","heading":"11.7.1.2 NDVI data","text":"NDVI data calculated mean NDVI values respective NiN polygon available Sentinel-2, MODIS, Landsat image Google Earth Engine (GEE).","code":""},{"path":"NDVI-indicator-natopen.html","id":"sentinel-2-ndvi-data","chapter":"11 NDVI - Naturally Open Ecosystems","heading":"11.7.1.2.1 Sentinel-2 NDVI data","text":"GEE code can seen : https://code.earthengine.google.com/2ceb0c3e03adade9e6f6d0903184b8c4\nimage collection contains Sentinel imagery June, July August 2015-2022\nexceed GEE memory limits, exported files iterated grid resulted 42 separate csv files. script merges merges dataframe NiN data.","code":"\n# Import Sentinel NDVI Data\ndf.s <- list.files(\"P:/41201785_okologisk_tilstand_2022_2023/data/NDVI_åpenlavland/NDVI_data_Sentinel/\", pattern = \"*.csv\", full.names = TRUE) %>%\n  map_df(~ fread(.))"},{"path":"NDVI-indicator-natopen.html","id":"modis-ndvi-data","chapter":"11 NDVI - Naturally Open Ecosystems","heading":"11.7.1.2.2 MODIS NDVI data","text":"GEE code can seen : https://code.earthengine.google.com/efb84013701f1d5f6e1e81345f389b84\nimage collection contains MODIS imagery June, July August 2000-2022","code":"\n# Import MODIS NDVI Data\n# MODIS NDVI is scaled by 0.0001. Mean must be divided by 10000.\ndf.m <- read.csv(\"/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/NDVI_åpenlavland/NDVI_data_MODIS/modis_ndvi_ts_2000_2022.csv\")\ndf.m$mean <- df.m$mean / 10000"},{"path":"NDVI-indicator-natopen.html","id":"landsat-ndvi-data","chapter":"11 NDVI - Naturally Open Ecosystems","heading":"11.7.1.2.3 Landsat NDVI data","text":"GEE code can seen : https://code.earthengine.google.com/da8a9279238ef26d14be08a43788b6b7\nimage collection contains Landsat imagery June, July August 1984-2022\nexceed GEE memory limits, exported files iterated grid resulted 42 separate csv files. script merges merges dataframe NiN data.","code":"\n# Import Landsat NDVI Data\n# Set up conditional file paths\ndir <- substr(getwd(), 1, 2)\n\npath <- ifelse(dir == \"C:\",\n  \"R:/GeoSpatialData/Habitats_biotopes/Norway_Miljodirektoratet_Naturtyper_nin/Original/versjon20221231/Natur_Naturtyper_nin_norge_med_svalbard_25833/Natur_Naturtyper_NiN_norge_med_svalbard_25833.gdb\",\n  \"/data/R/GeoSpatialData/Habitats_biotopes/Norway_Miljodirektoratet_Naturtyper_nin/Original/versjon20221231/Natur_Naturtyper_nin_norge_med_svalbard_25833/Natur_Naturtyper_NiN_norge_med_svalbard_25833.gdb\"\n)\n\npData <- ifelse(dir == \"C:\",\n  \"P:/41201785_okologisk_tilstand_2022_2023/data/NDVI_åpenlavland/NDVI_data_Landsat\",\n  \"/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/NDVI_åpenlavland/NDVI_data_Landsat\"\n)\n\n\n# Fread doesn't like the weird path to the server version of the P drive\n# hence this horrendous work around\nfiles <- list.files(pData, pattern = \"*.csv\", full.names = TRUE)\n\ndf_list <- list() # initialise a list of dataframes\n# read in a dataframe in each slot of the df_list\nfor (i in files) {\n  name <- gsub(\"-\", \".\", i)\n  name <- gsub(\".csv\", \"\", name)\n  i <- paste(i, sep = \"\")\n  df_list[[i]] <- assign(name, read.csv(i, header = TRUE))\n}\n\ndf.l <- bind_rows(df_list, .id = \"column_label\")"},{"path":"NDVI-indicator-natopen.html","id":"data-handling-ndvin","chapter":"11 NDVI - Naturally Open Ecosystems","heading":"11.7.2 Data handling","text":"","code":""},{"path":"NDVI-indicator-natopen.html","id":"nin-data","chapter":"11 NDVI - Naturally Open Ecosystems","heading":"11.7.2.1 NiN data","text":"","code":"\n# fixing variable- and ecosystem-names with special characters\ncolnames(nin)\ncolnames(nin)[c(3, 8, 17, 26, 31, 33, 34)] <- c(\n  \"hovedoekosystem\", \"kartleggingsaar\", \"noyaktighet\",\n  \"omraadenavn\", \"uk_naertruet\", \"uk_sentraloekosystemfunksjon\",\n  \"uk_spesieltdaarligkartlagt\"\n)\nunique(nin$hovedoekosystem)\n\nnin <- nin %>%\n  mutate(hovedoekosystem = recode(hovedoekosystem,\n    \"Våtmark\" = \"Vaatmark\",\n    \"Semi-naturlig mark\" = \"Semi_naturlig\",\n    \"Naturlig åpne områder i lavlandet\" = \"Naturlig-aapent\",\n    \"Naturlig åpne områder under skoggrensa\" = \"Naturlig_aapent\"\n  )) %>%\n  mutate(validGeo = st_is_valid(SHAPE))\n\n# checking how many polygons have multiple ecosystem types\nunique(nin$ninkartleggingsenheter)\n\nnrow(nin)\n# 95469 polygons altogether\nnrow(nin %>%\n  filter(grepl(\",\", ninkartleggingsenheter)))\n# 21094 polygons have more than 1 ecosystem type (they are separated by commas in the ninkartleggingsenheter-variable)\n\nnrow(nin %>%\n  filter(!grepl(\",\", ninkartleggingsenheter)))\n# 74375 polygons should have only 1 ecosystem type\n\n# there's no information on the proportion of ecosystem types in the polygons, so we got to omit all polygons with multiple ecosystem types :(\nnin <- nin %>%\n  filter(!grepl(\",\", ninkartleggingsenheter))\n\n# fix the content in the ninkartleggingsenheter-variable\nsummary(as.factor(nin$ninkartleggingsenheter))\n# get rid of the NA- in the beginning\nnin <- nin %>% mutate(ninkartleggingsenheter = str_remove(ninkartleggingsenheter, \"NA_\"))\n# making a main ecosystem type variable\nnin <- nin %>% mutate(\n  hovedtype = substr(ninkartleggingsenheter, 1, 3),\n  hovedtype = str_remove(hovedtype, \"-\")\n)\n# checking mapping unit against main ecosystem type\nnin[, c(\"hovedoekosystem\", \"hovedtype\")]\nsummary(as.factor(nin$hovedtype[nin$hovedoekosystem == \"Vaatmark\"]))\nsummary(as.factor(nin$hovedtype[nin$hovedoekosystem == \"Semi_naturlig\"]))\nsummary(as.factor(nin$hovedtype[nin$hovedoekosystem == \"Naturlig_aapne\"]))\nsummary(as.factor(nin$hovedtype[nin$hovedoekosystem == \"Skog\"]))\nsummary(as.factor(nin$hovedtype[nin$hovedoekosystem == \"Fjell\"]))\n# making a new variable for the overarching ecosystem types based on the main ecosystem types\nnin$hovedoekosystem.orig <- nin$hovedoekosystem\n\nnin <- nin %>%\n  mutate(hovedoekosystem = case_when(\n    hovedtype %in% paste(\"V\", c(1, 3:7, 9:10), sep = \"\") ~ \"Vaatmark\",\n    hovedtype %in% paste(\"V\", 11:13, sep = \"\") ~ \"Vaatmark_sterkt_endret\",\n    hovedtype %in% paste(\"T\", c(31:34, 40:41), sep = \"\") ~ \"Semi_naturlig\",\n    hovedtype %in% paste(\"T\", c(2, 12, 18, 20:21), sep = \"\") ~ \"Naturlig_aapent\",\n    hovedtype %in% c(paste(\"T\", c(4, 30, 38), sep = \"\"), paste(\"V\", c(2, 8), sep = \"\")) ~ \"Skog\",\n    hovedtype %in% c(paste(\"T\", c(3, 7, 9, 10, 14, 22, 26), sep = \"\"), paste(\"V\", c(6, 7), sep = \"\")) ~ \"Fjell\",\n    TRUE ~ \"NA\"\n  ))\n\n\nsummary(as.factor(nin$tilstand))\n\nnin <- nin %>% mutate(tilstand = recode(tilstand,\n  \"Dårlig\" = \"Redusert\",\n  \"Svært redusert\" = \"Svaert_redusert\"\n))\nnin <- nin %>% mutate(tilstand_num = recode(tilstand,\n  \"God\" = 0, \"Moderat\" = 1,\n  \"Redusert\" = 2, \"Svaert_redusert\" = 3\n))\n\nsummary(as.factor(nin$tilstand))\nsummary(as.numeric(nin$tilstand_num))\n\n\n## filter out only natopen data\nnin.natopen <- nin %>%\n  filter(hovedoekosystem %in% c(\"Naturlig_aapent\")) %>%\n  mutate(id = identifikasjon_lokalid) %>%\n  filter(validGeo) %>%\n  drop_na(tilstand) %>%\n  dplyr::select(id, hovedoekosystem, hovedtype, ninkartleggingsenheter, lokalitetskvalitet, tilstand, tilstand_num, ninbeskrivelsesvariabler, kartleggingsaar)\n\n\n# merge NiN-data with region\nnin.natopen <- st_join(nin.natopen, regnor, left = TRUE)\nnin.natopen\n\ncolnames(nin.natopen)[c(1, 10)] <- c(\"id\", \"region_id\")\n\n# check that every nin-polygon still occurs only once\nsummary(as.factor(nin.natopen$id)) # ok\n\nnin.natopen <- nin.natopen %>%\n  mutate(area_meters_nin = st_area(nin.natopen))\n# check and edit the order of regions\nlevels(nin.natopen$region)\nnin.natopen$region <- as.factor(nin.natopen$region)\nlevels(nin.natopen$region)\nnin.natopen$region <- factor(nin.natopen$region, levels = c(\"Northern Norway\", \"Central Norway\", \"Eastern Norway\", \"Western Norway\", \"Southern Norway\"))\nlevels(nin.natopen$region)\n\n# splitting content in the ninbeskrivelsesvariabler-column into separate rows per variable and then separating that column into two for the variable name and value\nnin.natopen2 <- nin.natopen %>%\n  separate_rows(ninbeskrivelsesvariabler, sep = \",\") %>%\n  separate(\n    col = ninbeskrivelsesvariabler,\n    into = c(\"NiN_variable_code\", \"NiN_variable_value\"),\n    sep = \"_\",\n    remove = F\n  ) %>%\n  mutate(NiN_variable_value = as.numeric(NiN_variable_value)) %>%\n  mutate(NiN_variable_code = as.factor(NiN_variable_code)) %>%\n  subset(select = -ninbeskrivelsesvariabler)\nnin.natopen2 <- as.data.frame(nin.natopen2)"},{"path":"NDVI-indicator-natopen.html","id":"ndvi-data-ndvin","chapter":"11 NDVI - Naturally Open Ecosystems","heading":"11.7.2.2 NDVI data","text":"","code":"\n## Sentinel-2\n# join nin.natopen & Sentinel NDVI data\nSentinelNDVI.natopen <- full_join(nin.natopen, df.s, by = \"id\")\n#> Warning in sf_column %in% names(g): Each row in `x` is expected to match at most 1 row in `y`.\n#> ℹ Row 1 of `x` matches multiple rows.\n#> ℹ If multiple matches are expected, set `multiple = \"all\"`\n#>   to silence this warning.\n# summary(SentinelNDVI.natopen)\nSentinelNDVI.natopen <- SentinelNDVI.natopen %>%\n  mutate(\n    hovedoekosystem = as.factor(hovedoekosystem),\n    hovedtype = as.factor(hovedtype),\n    ninkartleggingsenheter = as.factor(ninkartleggingsenheter),\n    lokalitetskvalitet = as.factor(lokalitetskvalitet),\n    tilstand = as.factor(tilstand),\n    area_meters = st_area(SentinelNDVI.natopen)\n  )\n# summary(SentinelNDVI.natopen)\n# get rid of NAs (i.e. NDVI cells that were not in natopen polygons)\nSentinelNDVI.natopen <- SentinelNDVI.natopen %>% filter(!is.na(hovedtype))\nSentinelNDVI.natopen <- SentinelNDVI.natopen %>% filter(!is.na(mean))\n# summary(SentinelNDVI.natopen)\n# get rid of any nin-polygons smaller than the Sentinel grid cell size (100 sqm)\n  # dim(SentinelNDVI.natopen)\nSentinelNDVI.natopen <- SentinelNDVI.natopen %>% filter(as.numeric(area_meters) >= 100)\n  # dim(SentinelNDVI.natopen)\n# split date into year, month & day\nSentinelNDVI.natopen <- SentinelNDVI.natopen %>%\n  dplyr::mutate(\n    year = lubridate::year(date),\n    month = lubridate::month(date),\n    day = lubridate::day(date)\n  )\n# add column for sub-ecosystem types\nSentinelNDVI.natopen <- SentinelNDVI.natopen %>% mutate(\n  subtype = substring(ninkartleggingsenheter, 4),\n  subtype = str_remove(subtype, \"-\"),\n  subtype = str_remove(subtype, \"-\")\n)\n# we are using max NDVI per year in every NiN polygon\nSentinelNDVI.natopen <- SentinelNDVI.natopen %>%\n  group_by(id, year) %>%\n  filter(mean == max(mean, na.rm = TRUE))\n\n  # summary(SentinelNDVI.natopen)\n\n## MODIS\n# join nin.natopen and Modis NDVI data\nModisNDVI.natopen <- full_join(nin.natopen, df.m, by = \"id\")\n#> Warning in sf_column %in% names(g): Each row in `x` is expected to match at most 1 row in `y`.\n#> ℹ Row 1 of `x` matches multiple rows.\n#> ℹ If multiple matches are expected, set `multiple = \"all\"`\n#>   to silence this warning.\n\n# summary(ModisNDVI.natopen)\nModisNDVI.natopen <- ModisNDVI.natopen %>%\n  mutate(\n    hovedoekosystem = as.factor(hovedoekosystem),\n    hovedtype = as.factor(hovedtype),\n    ninkartleggingsenheter = as.factor(ninkartleggingsenheter),\n    lokalitetskvalitet = as.factor(lokalitetskvalitet),\n    tilstand = as.factor(tilstand),\n    area_meters = st_area(ModisNDVI.natopen)\n  )\n# summary(ModisNDVI.natopen)\n# get rid of NAs (i.e. NDVI cells that were not in natopen polygons)\nModisNDVI.natopen <- ModisNDVI.natopen %>% filter(!is.na(hovedtype))\nModisNDVI.natopen <- ModisNDVI.natopen %>% filter(!is.na(mean))\n# summary(ModisNDVI.natopen)\n# get rid of any nin-polygons smaller than the Modis grid cell size (62500 sqm)\n  # dim(ModisNDVI.natopen)\nModisNDVI.natopen <- ModisNDVI.natopen %>% filter(as.numeric(area_meters) >= 62500)\n  # dim(ModisNDVI.natopen)\n# split date into year, month & day\nModisNDVI.natopen <- ModisNDVI.natopen %>%\n  dplyr::mutate(\n    year = lubridate::year(date),\n    month = lubridate::month(date),\n    day = lubridate::day(date)\n  )\n# we are using max NDVI per year in every NiN polygon\nModisNDVI.natopen <- ModisNDVI.natopen %>%\n  group_by(id, year) %>%\n  filter(mean == max(mean, na.rm = TRUE))\n# summary(ModisNDVI.natopen)\n\n## Landsat\n# join nin.natopen & Landsat NDVI data\nLandsatNDVI.natopen <- full_join(nin.natopen, df.l, by = \"id\")\n#> Warning in sf_column %in% names(g): Each row in `x` is expected to match at most 1 row in `y`.\n#> ℹ Row 1 of `x` matches multiple rows.\n#> ℹ If multiple matches are expected, set `multiple = \"all\"`\n#>   to silence this warning.\n\n# summary(LandsatNDVI.natopen)\nLandsatNDVI.natopen <- LandsatNDVI.natopen %>%\n  mutate(\n    hovedoekosystem = as.factor(hovedoekosystem),\n    hovedtype = as.factor(hovedtype),\n    ninkartleggingsenheter = as.factor(ninkartleggingsenheter),\n    lokalitetskvalitet = as.factor(lokalitetskvalitet),\n    tilstand = as.factor(tilstand),\n    area_meters = st_area(LandsatNDVI.natopen)\n  )\n# summary(LandsatNDVI.natopen)\n# get rid of NAs (i.e. NDVI cells that were not in natopen polygons)\nLandsatNDVI.natopen <- LandsatNDVI.natopen %>% filter(!is.na(hovedtype))\nLandsatNDVI.natopen <- LandsatNDVI.natopen %>% filter(!is.na(mean))\n# summary(LandsatNDVI.natopen)\n# get rid of any nin-polygons smaller than the Landsat grid cell size (900 sqm)\n  # dim(LandsatNDVI.natopen)\nLandsatNDVI.natopen <- LandsatNDVI.natopen %>% filter(as.numeric(area_meters) >= 900)\n  # dim(LandsatNDVI.natopen)\n# split date into year, month & day\nLandsatNDVI.natopen <- LandsatNDVI.natopen %>%\n  dplyr::mutate(\n    year = lubridate::year(date),\n    month = lubridate::month(date),\n    day = lubridate::day(date)\n  )\n# we are using max NDVI per year in every NiN polygon\nLandsatNDVI.natopen <- LandsatNDVI.natopen %>%\n  group_by(id, year) %>%\n  filter(mean == max(mean, na.rm = TRUE))\n\n# summary(LandsatNDVI.natopen)"},{"path":"NDVI-indicator-natopen.html","id":"exporatory-analyses-ndvin","chapter":"11 NDVI - Naturally Open Ecosystems","heading":"11.7.3 Exploratory analyses, Sentinel-2","text":"natopen sites?\nFigure 11.1: map Norway showing location naturally open ecosystem sites. T12 = coastal meadows, T18 = flood plains, T2 = shallow soils, T20 = innfrysningsmark, T21 = sand dunes.\npolygon sizes distributed?\nFigure 11.2: Histogram naturally open ecosystem polygon sizes Norway.\nNatopen polygons stretch large number sizes just 100 sqm almost 250 000 sqm. 75% polygons 4213 sqm.\ndashed line indicates minimum size Sentinel-2 pixels NDVI, NiN-polygons smaller removed form data.NDVI vary years?\nFigure 11.3: figure showing NDVI values naturally open ecosystem time six different main nature types varying degrees condition.\n2022 stands highest NDVI values missing.\nomit 2022 analysisHow NDVI values vary major basic ecosystem types sites good condition? (using NDVI data matching NiN-mapping years)\nFigure 11.4: NDVI values major natopen ecosystem types good condition.\n\nFigure 11.5: NDVI values basic natopen ecosystem types good condition.\nNDVI varies major ecosystem types highest values open flood plains (T18) natural coastal meadows (T12), followed naturally open areas shallow soils (T2) vegetated sand dunes (T21). ’s little data T20 (isinnfrysingsmark) mapped areas type good condition. Therefore omit ecosystem type statistical analyses . overlaps ecosystem types considerable.\nrespect basic ecosystem types within major types, NDVI appears cover similar ranges across subtypes, sample size also rather small. obvious trend related structuring environmental gradients withing major types, also overlap large.NDVI vary across regions natopens (major types) good condition? (using NDVI data matching NiN-mapping years)\nFigure 11.6: NDVI variation across regions natopen ecosystems (major types) good condition.\nobvious trends geography.NDVI vary across condition classes (major types NDVI data matching NiN-mapping years)?\nFigure 11.7: NDVI values across natopen sites different ecological condition.\nplots suggest slight decrease NDVI condition deteriorates.\nOverlaps condition classes generally large.ecological relevant variable(s) condition measure NiN data related ?plots, panels different major ecosystem types differ Miljødirektoratets mapping manual (see reference list ) uses different variables major ecosystem types define condition.open systems shallow soils - T2 - reduced condition mainly related high levels alien species, also damage heavy vehicles. coastal meadows - T12 - reduced condition related high levels alien species, also wear/tear damage heavy vehicles. flood plains - T18 - reduced condition mainly related effects water regulation. sand dunes - T21 - reduced condition mainly related high levels alien species wear/tear.\nWear/tear damage related issues well water regulation might alter amount vegetation thus NDVI signal.","code":"\ntm_shape(regnor) +\n  tm_fill(\"GID_0\", labels = \"\", title = \"\", legend.show = FALSE, alpha=0) +\n  tm_borders() +\n  tm_shape(SentinelNDVI.natopen) +\n  tm_dots(\"hovedtype\", midpoint = NA, palette = tmaptools::get_brewer_pal(\"YlOrRd\", 5, plot = FALSE), scale = 2.5, legend.show = FALSE) +\n  tm_add_legend(\n    type = \"symbol\",\n    col = tmaptools::get_brewer_pal(\"YlOrRd\", 5, plot = FALSE),\n    labels = c(\n      \"T12\",\n      \"T18\",\n      \"T2\",\n      \"T20\",\n      \"T21\"\n    ),\n    title = \"Major ecosystem type\",\n    size = 1.5\n  ) +\n  tm_layout(\n    main.title = \"Naturally open ecosystems below \\nthe tree line \\n(NiN, Miljødirektoratets instruks)\",\n    main.title.size = 1.2, legend.position = c(\"right\", \"bottom\"),\n    legend.text.size = 1.3, legend.title.size = 1.4\n  )\nsummary(SentinelNDVI.natopen$area_meters)\n#>     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n#>    143.1    542.2   1192.8   4213.1   3267.2 243697.1\nhist(SentinelNDVI.natopen$area_meters, xlim = c(0, 20000), breaks = 50000,xlab=\"Area\",main=\"\")\nabline(v = 100, lty = 2)\nSentinelNDVI.natopen %>%\n  filter(tilstand!=\"\") %>%\n  ggplot(aes(x = year, y = mean)) +\n  geom_point() +\n  facet_grid(tilstand ~ hovedtype) +\n  theme(axis.text.x = element_text(angle = -45, vjust = 0.5, hjust = 0.2, size = 12)) +\n  ggtitle(\"NDVI across years for different ecosystem types in all condition classes\") +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Year\")\nSentinelNDVI.natopen <- SentinelNDVI.natopen %>% filter(year != \"2022\")\nSentinelNDVI.natopen %>%\n  filter(tilstand == \"God\") %>%\n  filter(year == kartleggingsaar) %>%\n  ggplot(aes(x = hovedtype, y = mean)) +\n  geom_violin() +\n  geom_point(size = 0.7, shape = 16, color = \"grey\", position = position_jitter(.1) ) +\n  ggtitle(\"NDVI for different ecosystem types in good condition\") +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Major ecosystem type\")\nSentinelNDVI.natopen$subtype <- factor(SentinelNDVI.natopen$subtype, levels = c(\"C1\", \"C2\", \"C3\", \"C4\", \"C5\", \"C6\", \"C7\", \"C8\", \"E1\"))\nSentinelNDVI.natopen %>%\n  filter(tilstand == \"God\") %>%\n  filter(year == kartleggingsaar) %>%\n  ggplot(aes(x = subtype, y = mean)) +\n  geom_violin() +\n  geom_point(size = 0.7, shape = 16, color = \"grey\", position = position_jitter(.1) ) +\n  facet_wrap(~hovedtype) +\n  theme(axis.text.x = element_text(angle = -45, vjust = 0.5, hjust = 0.2, size = 12)) +\n  ggtitle(\"NDVI for different ecosystem sub-types in good condition\") +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Ecosystem sub-type\")\nSentinelNDVI.natopen %>%\n  filter(tilstand == \"God\") %>%\n  filter(year == kartleggingsaar) %>%\n  filter(!is.na(region)) %>%\n  ggplot(aes(x = region, y = mean)) +\n  geom_violin() +\n  geom_point(size = 0.7, shape = 16, color = \"grey\", position = position_jitter(.1) ) +\n  facet_wrap(~hovedtype) +\n  theme(axis.text.x = element_text(angle = -45, vjust = 0.5, hjust = 0.2, size = 9)) +\n  ggtitle(\"NDVI for different ecosystems in good condition across regions\") +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Region\")\nSentinelNDVI.natopen %>%\n  filter(year == kartleggingsaar) %>%\n  filter(tilstand != \"\") %>%\n  ggplot(aes(x = tilstand, y = mean)) +\n  geom_violin() +\n  geom_point(size = 0.7, shape = 16, color = \"grey\", position = position_jitter(.1) ) +\n  facet_wrap(~hovedtype) +\n  theme(axis.text.x = element_text(angle = -45, vjust = 0.5, hjust = 0.2)) +\n  ggtitle(\"NDVI for different ecosystems in different condition classes\") +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Condition\")\nnin.natopen2 %>%\n  filter(hovedtype == \"T2\") %>%\n  filter(NiN_variable_code %in% c(\"7FA\", \"7SE\", \"7TK\", \"1AG-B\")) %>%\n  mutate(NiN_variable_des = recode(NiN_variable_code,\n    \"7FA\" = \"Alien species\",\n    \"7SE\" = \"Wear/tear\",\n    \"7TK\" = \"Heavy vehicles\",\n    \"1AG-B\" = \"Shrub cover\"\n  )) %>%\n  ggplot(aes(x = NiN_variable_value, y = tilstand_num)) +\n  geom_point(size = 2) +\n  geom_jitter(width = 0.25, height = 0.25) +\n  facet_wrap(~NiN_variable_des, ncol = 2) +\n  theme(legend.position = \"none\") +\n  ggtitle(\"Condition variables in open systems on shallow soils (T2)\") +\n  labs(y = \"Condition level (0-3='good' to 'very reduced')\", x = \"Condition variable score\")\n\n\nnin.natopen2 %>%\n  filter(hovedtype == \"T12\") %>%\n  filter(NiN_variable_code %in% c(\"7FA\", \"7SE\", \"7TK\")) %>%\n  mutate(NiN_variable_des = recode(NiN_variable_code,\n    \"7FA\" = \"Alien species\",\n    \"7SE\" = \"Wear/tear\",\n    \"7TK\" = \"Heavy vehicles\"\n  )) %>%\n  ggplot(aes(x = NiN_variable_value, y = tilstand_num)) +\n  geom_point(size = 2) +\n  geom_jitter(width = 0.25, height = 0.25) +\n  facet_wrap(~NiN_variable_des, ncol = 2) +\n  theme(legend.position = \"none\") +\n  ggtitle(\"Condition variables in natural coastal meadows (T12)\") +\n  labs(y = \"Condition level (0-3='good' to 'very reduced')\", x = \"Condition variable score\")\n\nnin.natopen2 %>%\n  filter(hovedtype == \"T18\") %>%\n  filter(NiN_variable_code %in% c(\"7FA\", \"7JB-BT\", \"7SE\", \"7VR-RI\")) %>%\n  mutate(NiN_variable_des = recode(NiN_variable_code,\n    \"7FA\" = \"Alien species\",\n    \"7JB-BT\" = \"Grazing pressure\",\n    \"7SE\" = \"Wear/tear\",\n    \"7VR-RI\" = \"Water regulation\"\n  )) %>%\n  ggplot(aes(x = NiN_variable_value, y = tilstand_num)) +\n  geom_point(size = 2) +\n  geom_jitter(width = 0.25, height = 0.25) +\n  facet_wrap(~NiN_variable_des, ncol = 2) +\n  theme(legend.position = \"none\") +\n  ggtitle(\"Condition variables in flood plains (T18)\") +\n  labs(y = \"Condition level (0-3='good' to 'very reduced')\", x = \"Condition variable score\")\n\nnin.natopen2 %>%\n  filter(hovedtype %in% c(\"T21\")) %>%\n  filter(NiN_variable_code %in% c(\"7FA\", \"7JB-BT\", \"7SE\", \"7TK\", \"7JB-GJ\")) %>%\n  mutate(NiN_variable_des = recode(NiN_variable_code,\n    \"7FA\" = \"Alien species\",\n    \"7JB-BT\" = \"Grazing pressure\",\n    \"7SE\" = \"Wear/tear\",\n    \"7TK\" = \"Heavy vehicles\",\n    \"7JB-GJ\" = \"Fertilization\"\n  )) %>%\n  ggplot(aes(x = NiN_variable_value, y = tilstand_num)) +\n  geom_point(size = 2) +\n  geom_jitter(width = 0.25, height = 0.25) +\n  facet_wrap(~NiN_variable_des, ncol = 2) +\n  theme(legend.position = \"none\") +\n  ggtitle(\"Condition variables in sand dunes (T21)\") +\n  labs(y = \"Condition level (0-3='good' to 'very reduced')\", x = \"Condition variable score\")"},{"path":"NDVI-indicator-natopen.html","id":"regressions-ndvin","chapter":"11 NDVI - Naturally Open Ecosystems","heading":"11.7.4 Regression analyses Sentinel-2, NDVI as a function of condition","text":"can investigate NDVI condition connected using regression analyses.First, take look balanced data across major ecosystem types, regions condition classes\nFigure 11.8: NDVI values across condition gradient, faceted natopen ecosystem types five regions Norway.\nT20 data present 1 condition class 2 regions, omit .\nNorthern Norway T2 occurrences,\ncentral Norway doesn’t T21 occurrences,\nwon’t able model types across regions.NDVI data bounded -1 1, thus require modelling appropriate method can handle bounded data.\ncan transform variable bounded 0 1 use beta-regression models:NDVI values vary :RegionsEcosystem typesCondition classesIt evident differences regions.\nsince interested statistics region differences, run separate models every region ease interpretation.Northern Norway\nFigure 11.9: NDVI ecosystem condition natopen ecosystems Northern Norway.\nmuch pattern either model figure.Central Norway\nFigure 11.10: NDVI ecosystem condition natopen ecosystems Central Norway.\nNDVI good condition: T12/T18 > T2No changes condition.Western Norway\nFigure 11.11: NDVI agains ecosystm condition natopen ecosystems W-Norway.\nNDVI good condition: T18 marginally > T2/T12/T21No changes condition.Eastern Norway\nFigure 11.12: NDVI ecosystem condition natopen ecosystems E-Norway.\nNDVI good condition: T18 > T2/T12 > T21No changes condition.Southern Norway\nFigure 11.13: NDVI ecosystem condition natopen ecosystems S-Norway.\nNDVI good condition: T12/T18 > T2/T21Reduced NDVI reduced condition sand dune vegetation types Southern Norway. Otherwise changes condition.Overall take home messages:naturally open ecosystems tree line, NDVI seems largely independent ecosystem condition. probably many regarding ecosystems structured natural disturbances anyways. system showing clear convincing trend sand dunes Southern Norway reduction NDVI condition deteriorates (due Wear/tear alien species).","code":"\n# NDVI across hovedtyper, regions and condition classes (only for NDVI years data matching NiN-mapping years)\nSentinelNDVI.natopen %>%\n  group_by(id, year) %>%\n  filter(year == kartleggingsaar) %>%\n  filter(tilstand != \"\") %>%\n  filter(!is.na(region)) %>%\n  ggplot(aes(x = tilstand, y = mean)) +\n  geom_violin() +\n  geom_point(size = 0.7, shape = 16, color = \"grey\",) +\n  facet_grid(region ~ hovedtype) +\n  theme(axis.text.x = element_text(angle = -45, vjust = 0.5, hjust = 0.2, size = 9)) +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Condition\")\nSentinelNDVI.natopen$mean_beta <- (SentinelNDVI.natopen$mean + 1) / 2\n# NDVI data from the year of NiN-mapping (and thus with condition assessment) to train the condition models\n# we drop T41 for the analysis as it lacks data for most combinations of condition and region, and thus would cause convergence issues\nSentinelNDVI.natopen.train <- SentinelNDVI.natopen %>%\n  filter(year == kartleggingsaar) %>%\n  filter(hovedtype != \"T20\")\n\n# check if there's any 0s or 1s (which beta cannot handle)\n  # summary(SentinelNDVI.natopen.train$mean_beta) # ok\n\n# We run a stepwise-function on the full model including condition, ecosystem type, and region to find the most parsimonious model\n# we exclude Northern Norway and T21 for this first exploratory model\nmodel.natopen.cond.Sent <- betareg(mean_beta ~ tilstand_num * region * hovedtype, data = SentinelNDVI.natopen.train[SentinelNDVI.natopen.train$region != \"Northern Norway\" & SentinelNDVI.natopen.train$hovedtype != \"T21\", ])\nmodel.natopen.cond.Sent <- StepBeta(model.natopen.cond.Sent)\n#> [1] \"100 % of the process\"\nsummary(model.natopen.cond.Sent)\n#> \n#> Call:\n#> c(\"betareg(formula =  mean_beta ~ hovedtype + region + tilstand_num + region:hovedtype + tilstand_num:region data = [ )\", \n#> \"betareg(formula =  mean_beta ~ hovedtype + region + tilstand_num + region:hovedtype + tilstand_num:region data = SentinelNDVI.natopen.train )\", \n#> \"betareg(formula =  mean_beta ~ hovedtype + region + tilstand_num + region:hovedtype + tilstand_num:region data = SentinelNDVI.natopen.train$region != \\\"Northern Norway\\\" & SentinelNDVI.natopen.train$hovedtype != \\\"T21\\\" )\", \n#> \"betareg(formula =  mean_beta ~ hovedtype + region + tilstand_num + region:hovedtype + tilstand_num:region data =  )\"\n#> )\n#> \n#> Standardized weighted residuals 2:\n#>     Min      1Q  Median      3Q     Max \n#> -3.6826 -0.6398  0.0606  0.6959  2.6998 \n#> \n#> Coefficients (mean model with logit link):\n#>                                    Estimate Std. Error\n#> (Intercept)                         1.56165    0.02045\n#> hovedtypeT18                        0.08094    0.03369\n#> hovedtypeT2                        -0.20463    0.05545\n#> regionEastern Norway               -0.20104    0.04100\n#> regionWestern Norway                0.01462    0.05877\n#> regionSouthern Norway               0.02528    0.03680\n#> tilstand_num                        0.06167    0.03310\n#> hovedtypeT18:regionEastern Norway   0.21499    0.05065\n#> hovedtypeT2:regionEastern Norway    0.19473    0.06850\n#> hovedtypeT18:regionWestern Norway   0.02995    0.07515\n#> hovedtypeT2:regionWestern Norway    0.06735    0.09042\n#> hovedtypeT18:regionSouthern Norway  0.01409    0.09531\n#> hovedtypeT2:regionSouthern Norway  -0.12881    0.07859\n#> regionEastern Norway:tilstand_num  -0.12009    0.03835\n#> regionWestern Norway:tilstand_num  -0.12763    0.06146\n#> regionSouthern Norway:tilstand_num -0.01373    0.04844\n#>                                    z value Pr(>|z|)    \n#> (Intercept)                         76.366  < 2e-16 ***\n#> hovedtypeT18                         2.403 0.016283 *  \n#> hovedtypeT2                         -3.691 0.000224 ***\n#> regionEastern Norway                -4.904 9.41e-07 ***\n#> regionWestern Norway                 0.249 0.803577    \n#> regionSouthern Norway                0.687 0.492069    \n#> tilstand_num                         1.863 0.062447 .  \n#> hovedtypeT18:regionEastern Norway    4.245 2.19e-05 ***\n#> hovedtypeT2:regionEastern Norway     2.843 0.004471 ** \n#> hovedtypeT18:regionWestern Norway    0.399 0.690251    \n#> hovedtypeT2:regionWestern Norway     0.745 0.456355    \n#> hovedtypeT18:regionSouthern Norway   0.148 0.882495    \n#> hovedtypeT2:regionSouthern Norway   -1.639 0.101211    \n#> regionEastern Norway:tilstand_num   -3.131 0.001740 ** \n#> regionWestern Norway:tilstand_num   -2.077 0.037827 *  \n#> regionSouthern Norway:tilstand_num  -0.283 0.776822    \n#> \n#> Phi coefficients (precision model with identity link):\n#>       Estimate Std. Error z value Pr(>|z|)    \n#> (phi)   60.966      2.176   28.02   <2e-16 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 \n#> \n#> Type of estimator: ML (maximum likelihood)\n#> Log-likelihood:  2540 on 17 Df\n#> Pseudo R-squared: 0.1497\n#> Number of iterations: 24 (BFGS) + 1 (Fisher scoring)\nmodel.natopen.cond.Sent.N <- betareg(mean_beta ~ tilstand_num * hovedtype, data = SentinelNDVI.natopen.train[SentinelNDVI.natopen.train$region == \"Northern Norway\", ])\nmodel.natopen.cond.Sent.C <- betareg(mean_beta ~ tilstand_num * hovedtype, data = SentinelNDVI.natopen.train[SentinelNDVI.natopen.train$region == \"Central Norway\", ])\nmodel.natopen.cond.Sent.W <- betareg(mean_beta ~ tilstand_num * hovedtype, data = SentinelNDVI.natopen.train[SentinelNDVI.natopen.train$region == \"Western Norway\", ])\nmodel.natopen.cond.Sent.E <- betareg(mean_beta ~ tilstand_num * hovedtype, data = SentinelNDVI.natopen.train[SentinelNDVI.natopen.train$region == \"Eastern Norway\", ])\nmodel.natopen.cond.Sent.S <- betareg(mean_beta ~ tilstand_num * hovedtype, data = SentinelNDVI.natopen.train[SentinelNDVI.natopen.train$region == \"Southern Norway\", ])\nSentinelNDVI.natopen.train %>%\n  filter(region == \"Northern Norway\") %>%\n  ggplot(aes(x = tilstand, y = mean)) +\n  geom_violin() +\n  geom_point(size = 0.7, shape = 16, color = \"grey\", position = position_jitter(.1) ) +\n  theme(axis.text.x = element_text(angle = -45, vjust = 0.5, hjust = 0.2, size = 9)) +\n  ggtitle(\"Northern Norway\") +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Condition\") +\n  facet_wrap(~hovedtype)\nsummary(model.natopen.cond.Sent.N)$coefficients\n#> $mean\n#>                              Estimate Std. Error    z value\n#> (Intercept)                1.47874752 0.02922669 50.5957848\n#> tilstand_num              -0.03216827 0.08501593 -0.3783793\n#> hovedtypeT18              -0.13351837 0.03491454 -3.8241485\n#> hovedtypeT21              -0.07849672 0.13432610 -0.5843743\n#> tilstand_num:hovedtypeT18 -0.01124750 0.08995815 -0.1250303\n#> tilstand_num:hovedtypeT21  0.13265089 0.18190713  0.7292231\n#>                               Pr(>|z|)\n#> (Intercept)               0.0000000000\n#> tilstand_num              0.7051488568\n#> hovedtypeT18              0.0001312248\n#> hovedtypeT21              0.5589685024\n#> tilstand_num:hovedtypeT18 0.9004995550\n#> tilstand_num:hovedtypeT21 0.4658651799\n#> \n#> $precision\n#>       Estimate Std. Error  z value    Pr(>|z|)\n#> (phi)  34.3952   1.745776 19.70195 2.07453e-86\nSentinelNDVI.natopen.train %>%\n  filter(region == \"Central Norway\") %>%\n  ggplot(aes(x = tilstand, y = mean)) +\n  geom_violin() +\n  geom_point(size = 0.7, shape = 16, color = \"grey\", position = position_jitter(.1) ) +\n  theme(axis.text.x = element_text(angle = -45, vjust = 0.5, hjust = 0.2, size = 9)) +\n  ggtitle(\"Central Norway\") +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Condition\") +  facet_wrap(~hovedtype) +\n  facet_wrap(~hovedtype)\nsummary(model.natopen.cond.Sent.C)$coefficients\n#> $mean\n#>                                Estimate Std. Error\n#> (Intercept)                1.5753723757 0.01967735\n#> tilstand_num              -0.0005827379 0.04854023\n#> hovedtypeT18               0.0605336826 0.03362481\n#> hovedtypeT2               -0.2151633049 0.05881656\n#> tilstand_num:hovedtypeT18  0.1074821469 0.06462158\n#> tilstand_num:hovedtypeT2   0.0677333044 0.11859900\n#>                               z value     Pr(>|z|)\n#> (Intercept)               80.06020546 0.0000000000\n#> tilstand_num              -0.01200526 0.9904214210\n#> hovedtypeT18               1.80026841 0.0718182663\n#> hovedtypeT2               -3.65820973 0.0002539832\n#> tilstand_num:hovedtypeT18  1.66325467 0.0962614677\n#> tilstand_num:hovedtypeT2   0.57111196 0.5679237536\n#> \n#> $precision\n#>       Estimate Std. Error  z value     Pr(>|z|)\n#> (phi) 71.96558   4.636427 15.52178 2.471101e-54\nSentinelNDVI.natopen.train %>%\n  filter(region == \"Western Norway\") %>%\n  ggplot(aes(x = tilstand, y = mean)) +\n  geom_violin() +\n  geom_point(size = 0.7, shape = 16, color = \"grey\", position = position_jitter(.1) ) +\n  theme(axis.text.x = element_text(angle = -45, vjust = 0.5, hjust = 0.2, size = 9)) +\n  ggtitle(\"Western Norway\") +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Condition\") +  facet_wrap(~hovedtype)\n  facet_wrap(~hovedtype)\n#> <ggproto object: Class FacetWrap, Facet, gg>\n#>     compute_layout: function\n#>     draw_back: function\n#>     draw_front: function\n#>     draw_labels: function\n#>     draw_panels: function\n#>     finish_data: function\n#>     init_scales: function\n#>     map_data: function\n#>     params: list\n#>     setup_data: function\n#>     setup_params: function\n#>     shrink: TRUE\n#>     train_scales: function\n#>     vars: function\n#>     super:  <ggproto object: Class FacetWrap, Facet, gg>\nsummary(model.natopen.cond.Sent.W)$coefficients\n#> $mean\n#>                              Estimate Std. Error    z value\n#> (Intercept)                1.55784725 0.05624467 27.6976845\n#> tilstand_num               0.01620582 0.09773274  0.1658177\n#> hovedtypeT18               0.14037004 0.07152772  1.9624564\n#> hovedtypeT2               -0.09759038 0.07742434 -1.2604612\n#> hovedtypeT21              -0.41797186 0.12442875 -3.3591260\n#> tilstand_num:hovedtypeT18 -0.09643801 0.11864650 -0.8128179\n#> tilstand_num:hovedtypeT2  -0.13632516 0.13682509 -0.9963462\n#> tilstand_num:hovedtypeT21  0.31819062 0.33281378  0.9560620\n#>                                Pr(>|z|)\n#> (Intercept)               7.445255e-169\n#> tilstand_num               8.683004e-01\n#> hovedtypeT18               4.970937e-02\n#> hovedtypeT2                2.075030e-01\n#> hovedtypeT21               7.818942e-04\n#> tilstand_num:hovedtypeT18  4.163225e-01\n#> tilstand_num:hovedtypeT2   3.190820e-01\n#> tilstand_num:hovedtypeT21  3.390409e-01\n#> \n#> $precision\n#>       Estimate Std. Error  z value     Pr(>|z|)\n#> (phi) 71.86576   8.034702 8.944421 3.739035e-19\nSentinelNDVI.natopen.train %>%\n  filter(region == \"Eastern Norway\") %>%\n  ggplot(aes(x = tilstand, y = mean)) +\n  geom_violin() +\n  geom_point(size = 0.7, shape = 16, color = \"grey\", position = position_jitter(.1) ) +\n  theme(axis.text.x = element_text(angle = -45, vjust = 0.5, hjust = 0.2, size = 9)) +\n  ggtitle(\"Eastern Norway\") +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Condition\") +  facet_wrap(~hovedtype)\n  facet_wrap(~hovedtype)\n#> <ggproto object: Class FacetWrap, Facet, gg>\n#>     compute_layout: function\n#>     draw_back: function\n#>     draw_front: function\n#>     draw_labels: function\n#>     draw_panels: function\n#>     finish_data: function\n#>     init_scales: function\n#>     map_data: function\n#>     params: list\n#>     setup_data: function\n#>     setup_params: function\n#>     shrink: TRUE\n#>     train_scales: function\n#>     vars: function\n#>     super:  <ggproto object: Class FacetWrap, Facet, gg>\nsummary(model.natopen.cond.Sent.E)$coefficients\n#> $mean\n#>                              Estimate Std. Error    z value\n#> (Intercept)                1.36897615 0.04740322 28.8793926\n#> tilstand_num              -0.08204417 0.05185250 -1.5822606\n#> hovedtypeT18               0.27714819 0.05109404  5.4242763\n#> hovedtypeT2               -0.02080965 0.05674090 -0.3667487\n#> hovedtypeT21              -0.32041847 0.09309699 -3.4417704\n#> tilstand_num:hovedtypeT18  0.03452959 0.05938858  0.5814179\n#> tilstand_num:hovedtypeT2   0.01880438 0.06404575  0.2936086\n#> tilstand_num:hovedtypeT21  0.11181593 0.08031978  1.3921343\n#>                                Pr(>|z|)\n#> (Intercept)               2.166902e-183\n#> tilstand_num               1.135901e-01\n#> hovedtypeT18               5.818981e-08\n#> hovedtypeT2                7.138065e-01\n#> hovedtypeT21               5.779205e-04\n#> tilstand_num:hovedtypeT18  5.609588e-01\n#> tilstand_num:hovedtypeT2   7.690570e-01\n#> tilstand_num:hovedtypeT21  1.638817e-01\n#> \n#> $precision\n#>       Estimate Std. Error  z value     Pr(>|z|)\n#> (phi) 51.59429   2.595269 19.88013 6.047901e-88\nSentinelNDVI.natopen.train %>%\n  filter(region == \"Southern Norway\") %>%\n  ggplot(aes(x = tilstand, y = mean)) +\n  geom_violin() +\n  geom_point(size = 0.7, shape = 16, color = \"grey\", position = position_jitter(.1) ) +\n  theme(axis.text.x = element_text(angle = -45, vjust = 0.5, hjust = 0.2, size = 9)) +\n  ggtitle(\"Southern Norway\") +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Condition\") +  facet_wrap(~hovedtype)\n  facet_wrap(~hovedtype)\n#> <ggproto object: Class FacetWrap, Facet, gg>\n#>     compute_layout: function\n#>     draw_back: function\n#>     draw_front: function\n#>     draw_labels: function\n#>     draw_panels: function\n#>     finish_data: function\n#>     init_scales: function\n#>     map_data: function\n#>     params: list\n#>     setup_data: function\n#>     setup_params: function\n#>     shrink: TRUE\n#>     train_scales: function\n#>     vars: function\n#>     super:  <ggproto object: Class FacetWrap, Facet, gg>\nsummary(model.natopen.cond.Sent.S)$coefficients\n#> $mean\n#>                              Estimate Std. Error    z value\n#> (Intercept)                1.59377861 0.03253414 48.9878778\n#> tilstand_num               0.01976630 0.04323083  0.4572271\n#> hovedtypeT18               0.12214718 0.11316875  1.0793366\n#> hovedtypeT2               -0.38939570 0.06627230 -5.8756928\n#> hovedtypeT21              -0.28978244 0.07442588 -3.8935708\n#> tilstand_num:hovedtypeT18 -0.04226168 0.13042010 -0.3240427\n#> tilstand_num:hovedtypeT2   0.13978160 0.08861534  1.5773973\n#> tilstand_num:hovedtypeT21 -0.32443033 0.07911115 -4.1009431\n#>                               Pr(>|z|)\n#> (Intercept)               0.000000e+00\n#> tilstand_num              6.475079e-01\n#> hovedtypeT18              2.804377e-01\n#> hovedtypeT2               4.210787e-09\n#> hovedtypeT21              9.877934e-05\n#> tilstand_num:hovedtypeT18 7.459057e-01\n#> tilstand_num:hovedtypeT2  1.147041e-01\n#> tilstand_num:hovedtypeT21 4.114697e-05\n#> \n#> $precision\n#>       Estimate Std. Error  z value     Pr(>|z|)\n#> (phi) 58.05791   5.108533 11.36489 6.254309e-30"},{"path":"NDVI-indicator-natopen.html","id":"ndvi-across-time-ndvin","chapter":"11 NDVI - Naturally Open Ecosystems","heading":"11.7.5 NDVI across time - Sentinel, MODIS & LandSat","text":"last step, can investigate NDVI changed time.\ninclude data MODIS Landsat addition Sentinel-2.First, ’s data handling . merge Sentinel, MODIS, Landsat data show full picture across time.\nmodel time series Satellite separately.Now can plot time series main ecosystem type, showing satellite time series separately:\nFigure 11.14: Comparing NDVI time series three data sets.\nquite obvious NDVI values three satellites quantitatively comparable.\nvary placement along y-axis variance.\nModis data basically available flood plains (T18), ecosystems types’ polygons small Modis pixel size.can test consistent temporal changes NDVI running regressions including year covariate.first investigate model testing NDVI function year main ecosystem type polygons good condition, separately Sentinel Landsat.’s increase NDVI time satellite time series T12 (coastal meadows) T18 (flood plains) good condition.\nSentinel data pattern absent T2 T21, Landsat data increase reduced.can check temporal changes T12 T18, well T21 Southern Norway, vary condition classes?temporal NDVI increase stronger flood plains reduced ecological condition, Landsat time series.\necosystem types show obvious patterns.","code":"\n## data handling for time series analysis\n# Sentinel time series checked in exploratory analysis script\n\n# checking time series for MODIS\n   # ModisNDVI.natopen %>%\n   #   group_by(id, year) %>%\n   #   filter(mean == max(mean, na.rm = TRUE)) %>%\n   #   ggplot(aes(x = year, y = mean)) +\n   #   geom_point() +\n   #   facet_wrap(~hovedtype)\n# 2022 does not stand out as in the Sentinel data, so we keep it\nModisNDVI.natopen <- ModisNDVI.natopen %>%\n  group_by(id, year) %>%\n  filter(mean == max(mean, na.rm = TRUE))\n\n# checking time series for Landsat\n   # LandsatNDVI.natopen %>%\n   #   group_by(id, year) %>%\n   #   filter(mean == max(mean, na.rm = TRUE)) %>%\n   #   ggplot(aes(x = year, y = mean)) +\n   #   geom_point() +\n   #   facet_wrap(~hovedtype)\n# nothing worrying to see here either\nLandsatNDVI.natopen <- LandsatNDVI.natopen %>%\n  group_by(id, year) %>%\n  filter(mean == max(mean, na.rm = TRUE))\n\n# transformation of NDVI scale to beta scale\n# SentinelNDVI.natopen$mean_beta <- (SentinelNDVI.natopen$mean + 1) / 2\nModisNDVI.natopen$mean_beta <- (ModisNDVI.natopen$mean + 1) / 2\nLandsatNDVI.natopen$mean_beta <- (LandsatNDVI.natopen$mean + 1) / 2\n\n# check if there's any 0s or 1s (which beta cannot handle)\n   # summary(SentinelNDVI.natopen$mean_beta) # ok\n   # summary(ModisNDVI.natopen$mean_beta) # ok\n   # summary(LandsatNDVI.natopen$mean_beta)\n# replace 1s in Landsat data with 0.9999\nLandsatNDVI.natopen <- LandsatNDVI.natopen %>%\n  mutate(mean_beta = replace(mean_beta, mean_beta == 1, 0.9999))\n\n# check if the three Satellite objects have the same structure (for concatenating them)\n   # names(SentinelNDVI.natopen)\n   # names(ModisNDVI.natopen)\n   # names(LandsatNDVI.natopen)\n# Sentinel and Landsat have each an extra column -> omit them when concatenating further below\n# one column is named slightly differently in the Sentinel data -> rename it\nSentinelNDVI.natopen <- SentinelNDVI.natopen %>%\n  dplyr::rename(\"system.index\" = \"system:index\")\n\n# check if they have the same geometry\n   # st_crs(SentinelNDVI.natopen)\n   # st_crs(ModisNDVI.natopen)\n   # st_crs(LandsatNDVI.natopen)\n# all good\n\n# add an increment to the year variable to avoid overlapping data being hidden in figures\nSentinelNDVI.natopen$year_jit <- SentinelNDVI.natopen$year + 0.3\nModisNDVI.natopen$year_jit <- ModisNDVI.natopen$year - 0.3\nLandsatNDVI.natopen$year_jit <- LandsatNDVI.natopen$year\n\n# concatenate the three Satellite objects\nallSatNDVI.natopen <- rbind(\n  SentinelNDVI.natopen[, !names(SentinelNDVI.natopen) %in% \"subtype\"],\n  ModisNDVI.natopen,\n  LandsatNDVI.natopen[, !names(LandsatNDVI.natopen) %in% \"column_label\"]\n)\n# add variable for Satellite identity\nallSatNDVI.natopen$Sat <- c(\n  rep(\"Sentinel\", nrow(SentinelNDVI.natopen)),\n  rep(\"Modis\", nrow(ModisNDVI.natopen)),\n  rep(\"Landsat\", nrow(LandsatNDVI.natopen))\n)\nallSatNDVI.natopen$Sat <- factor(allSatNDVI.natopen$Sat, levels = c(\"Sentinel\", \"Modis\", \"Landsat\"))\n   # levels(allSatNDVI.natopen$Sat)\n# plot\nallSatNDVI.natopen %>%\n  ggplot(aes(x = year_jit, y = mean, color = Sat)) +\n  geom_point() +\n  ggtitle(\"NDVI across time\") +\n  labs(y = \"NDVI values\", x = \"Year\") +\n  facet_wrap(~hovedtype, ncol = 1)\nmodel.natopen.time.GodTilst.Sent <- glmmTMB(mean_beta ~ year * hovedtype + (1 | id), family = beta_family(), data = SentinelNDVI.natopen[SentinelNDVI.natopen$tilstand == \"God\", ])\nmodel.natopen.time.GodTilst.Land <- glmmTMB(mean_beta ~ year * hovedtype + (1 | id), family = beta_family(), data = LandsatNDVI.natopen[LandsatNDVI.natopen$tilstand == \"God\", ])\nsummary(model.natopen.time.GodTilst.Sent)$coefficients$cond\n#>                        Estimate   Std. Error    z value\n#> (Intercept)       -36.935300701  2.671601660 -13.825153\n#> year                0.019061057  0.001323928  14.397357\n#> hovedtypeT18      -18.746226142  3.158582045  -5.935013\n#> hovedtypeT2        29.313518977  4.677147986   6.267392\n#> hovedtypeT20       34.348239797 22.307347905   1.539772\n#> hovedtypeT21       30.640990969  9.317135637   3.288671\n#> year:hovedtypeT18   0.009273977  0.001565284   5.924788\n#> year:hovedtypeT2   -0.014621002  0.002317759  -6.308249\n#> year:hovedtypeT20  -0.017037041  0.011054315  -1.541212\n#> year:hovedtypeT21  -0.015302734  0.004617052  -3.314395\n#>                       Pr(>|z|)\n#> (Intercept)       1.797309e-43\n#> year              5.376061e-47\n#> hovedtypeT18      2.938219e-09\n#> hovedtypeT2       3.671455e-10\n#> hovedtypeT20      1.236158e-01\n#> hovedtypeT21      1.006617e-03\n#> year:hovedtypeT18 3.127005e-09\n#> year:hovedtypeT2  2.822102e-10\n#> year:hovedtypeT20 1.232652e-01\n#> year:hovedtypeT21 9.184164e-04\nsummary(model.natopen.time.GodTilst.Land)$coefficients$cond\n#>                        Estimate   Std. Error     z value\n#> (Intercept)       -22.352086552 0.4510618533 -49.5543713\n#> year                0.011956021 0.0002251119  53.1114514\n#> hovedtypeT18       -4.475031773 0.5379636781  -8.3184645\n#> hovedtypeT2         4.869272134 0.9851027104   4.9429081\n#> hovedtypeT20       -2.778415547 4.2246325934  -0.6576703\n#> hovedtypeT21        4.502139369 1.8867783558   2.3861517\n#> year:hovedtypeT18   0.002214750 0.0002684923   8.2488402\n#> year:hovedtypeT2   -0.002509721 0.0004915495  -5.1057333\n#> year:hovedtypeT20   0.001404388 0.0021091469   0.6658559\n#> year:hovedtypeT21  -0.002413297 0.0009412395  -2.5639570\n#>                       Pr(>|z|)\n#> (Intercept)       0.000000e+00\n#> year              0.000000e+00\n#> hovedtypeT18      8.911016e-17\n#> hovedtypeT2       7.696578e-07\n#> hovedtypeT20      5.107500e-01\n#> hovedtypeT21      1.702573e-02\n#> year:hovedtypeT18 1.599391e-16\n#> year:hovedtypeT2  3.295142e-07\n#> year:hovedtypeT20 5.055032e-01\n#> year:hovedtypeT21 1.034864e-02\nmodel.natopen.time.tilst.T12.Sent <- glmmTMB(mean_beta ~ year * tilstand + (1 | id), family = beta_family(), data = SentinelNDVI.natopen[SentinelNDVI.natopen$hovedtype %in% c(\"T12\"), ])\nmodel.natopen.time.tilst.T12.Land <- glmmTMB(mean_beta ~ year * tilstand + (1 | id), family = beta_family(), data = LandsatNDVI.natopen[LandsatNDVI.natopen$hovedtype %in% c(\"T12\"), ])\nmodel.natopen.time.tilst.T18.Sent <- glmmTMB(mean_beta ~ year * tilstand + (1 | id), family = beta_family(), data = SentinelNDVI.natopen[SentinelNDVI.natopen$hovedtype %in% c(\"T18\"), ])\nmodel.natopen.time.tilst.T18.Land <- glmmTMB(mean_beta ~ year * tilstand + (1 | id), family = beta_family(), data = LandsatNDVI.natopen[LandsatNDVI.natopen$hovedtype %in% c(\"T18\"), ])\nmodel.natopen.time.tilst.T21.Sent <- glmmTMB(mean_beta ~ year * tilstand + (1 | id), family = beta_family(), data = SentinelNDVI.natopen[SentinelNDVI.natopen$hovedtype %in% c(\"T21\") & SentinelNDVI.natopen$region == \"Southern Norway\", ])\nmodel.natopen.time.tilst.T21.Land <- glmmTMB(mean_beta ~ year * tilstand + (1 | id), family = beta_family(), data = LandsatNDVI.natopen[LandsatNDVI.natopen$hovedtype %in% c(\"T21\") & LandsatNDVI.natopen$region == \"Southern Norway\", ])\nsummary(model.natopen.time.tilst.T12.Sent)$coefficients$cond\n#>                                   Estimate   Std. Error\n#> (Intercept)                  -3.710345e+01  2.075499655\n#> year                          1.914584e-02  0.001028500\n#> tilstandModerat               1.530732e+01  5.138673876\n#> tilstandRedusert              2.150146e+01 10.203836208\n#> tilstandSvaert_redusert      -2.396413e-01 26.998352055\n#> year:tilstandModerat         -7.623323e-03  0.002546438\n#> year:tilstandRedusert        -1.070133e-02  0.005056427\n#> year:tilstandSvaert_redusert  2.038877e-04  0.013379253\n#>                                    z value     Pr(>|z|)\n#> (Intercept)                  -17.876874751 1.785702e-71\n#> year                          18.615295922 2.415221e-77\n#> tilstandModerat                2.978845594 2.893365e-03\n#> tilstandRedusert               2.107193279 3.510083e-02\n#> tilstandSvaert_redusert       -0.008876147 9.929180e-01\n#> year:tilstandModerat          -2.993719944 2.755988e-03\n#> year:tilstandRedusert         -2.116382234 3.431231e-02\n#> year:tilstandSvaert_redusert   0.015239097 9.878414e-01\nsummary(model.natopen.time.tilst.T18.Sent)$coefficients$cond\n#>                                   Estimate   Std. Error\n#> (Intercept)                  -5.553334e+01  2.837477867\n#> year                          2.826069e-02  0.001406121\n#> tilstandModerat               3.982841e+00  6.138784981\n#> tilstandRedusert             -1.077785e+00  9.734943643\n#> tilstandSvaert_redusert       1.872128e+01 16.596270829\n#> year:tilstandModerat         -1.924304e-03  0.003042232\n#> year:tilstandRedusert         4.953817e-04  0.004824305\n#> year:tilstandSvaert_redusert -9.379814e-03  0.008224452\n#>                                  z value     Pr(>|z|)\n#> (Intercept)                  -19.5713738 2.712696e-85\n#> year                          20.0983280 7.632194e-90\n#> tilstandModerat                0.6487995 5.164680e-01\n#> tilstandRedusert              -0.1107130 9.118439e-01\n#> tilstandSvaert_redusert        1.1280413 2.593025e-01\n#> year:tilstandModerat          -0.6325304 5.270403e-01\n#> year:tilstandRedusert          0.1026846 9.182133e-01\n#> year:tilstandSvaert_redusert  -1.1404789 2.540868e-01\nsummary(model.natopen.time.tilst.T21.Sent)$coefficients$cond\n#>                            Estimate   Std. Error    z value\n#> (Intercept)            35.805280925 17.145006418  2.0883796\n#> year                   -0.017094995  0.008495813 -2.0121670\n#> tilstandModerat       -10.342574293 20.537961983 -0.5035833\n#> tilstandRedusert      -46.415364291 33.385627772 -1.3902798\n#> year:tilstandModerat    0.004988819  0.010177130  0.4901990\n#> year:tilstandRedusert   0.022687670  0.016543610  1.3713857\n#>                         Pr(>|z|)\n#> (Intercept)           0.03676361\n#> year                  0.04420234\n#> tilstandModerat       0.61455424\n#> tilstandRedusert      0.16444393\n#> year:tilstandModerat  0.62399308\n#> year:tilstandRedusert 0.17025476\nsummary(model.natopen.time.tilst.T12.Land)$coefficients$cond\n#>                                   Estimate   Std. Error\n#> (Intercept)                  -2.257603e+01 0.3592224744\n#> year                          1.207285e-02 0.0001792247\n#> tilstandModerat               9.942636e-01 1.0480499362\n#> tilstandRedusert              2.407909e+00 2.3128394175\n#> tilstandSvaert_redusert       1.220670e+01 4.3590250180\n#> year:tilstandModerat         -5.106564e-04 0.0005228819\n#> year:tilstandRedusert        -1.218127e-03 0.0011538302\n#> year:tilstandSvaert_redusert -5.887491e-03 0.0021752446\n#>                                  z value    Pr(>|z|)\n#> (Intercept)                  -62.8469354 0.000000000\n#> year                          67.3615626 0.000000000\n#> tilstandModerat                0.9486796 0.342783587\n#> tilstandRedusert               1.0411052 0.297826750\n#> tilstandSvaert_redusert        2.8003288 0.005105059\n#> year:tilstandModerat          -0.9766190 0.328757795\n#> year:tilstandRedusert         -1.0557249 0.291093905\n#> year:tilstandSvaert_redusert  -2.7065881 0.006797854\nsummary(model.natopen.time.tilst.T18.Land)$coefficients$cond\n#>                                   Estimate   Std. Error\n#> (Intercept)                  -26.684682919 0.3198164900\n#> year                           0.014097082 0.0001596524\n#> tilstandModerat               -8.865995020 0.8288648197\n#> tilstandRedusert              -7.328083962 1.3230496265\n#> tilstandSvaert_redusert       -5.653610976 2.0758288689\n#> year:tilstandModerat           0.004455210 0.0004138240\n#> year:tilstandRedusert          0.003638674 0.0006605013\n#> year:tilstandSvaert_redusert   0.002732487 0.0010359880\n#>                                 z value     Pr(>|z|)\n#> (Intercept)                  -83.437483 0.000000e+00\n#> year                          88.298593 0.000000e+00\n#> tilstandModerat              -10.696551 1.056370e-26\n#> tilstandRedusert              -5.538782 3.045818e-08\n#> tilstandSvaert_redusert       -2.723544 6.458564e-03\n#> year:tilstandModerat          10.765952 4.984396e-27\n#> year:tilstandRedusert          5.508958 3.609632e-08\n#> year:tilstandSvaert_redusert   2.637566 8.350328e-03\nsummary(model.natopen.time.tilst.T21.Land)$coefficients$cond\n#>                            Estimate  Std. Error    z value\n#> (Intercept)           -17.963080316 3.781165685 -4.7506726\n#> year                    0.009523126 0.001884278  5.0539924\n#> tilstandModerat        10.897562178 3.988209496  2.7324448\n#> tilstandRedusert        2.473501410 4.792342126  0.5161362\n#> year:tilstandModerat   -0.005429927 0.001987436 -2.7321276\n#> year:tilstandRedusert  -0.001340730 0.002387883 -0.5614723\n#>                           Pr(>|z|)\n#> (Intercept)           2.027411e-06\n#> year                  4.326688e-07\n#> tilstandModerat       6.286621e-03\n#> tilstandRedusert      6.057593e-01\n#> year:tilstandModerat  6.292677e-03\n#> year:tilstandRedusert 5.744756e-01"},{"path":"NDVI-indicator-natopen.html","id":"overall-conclusion","chapter":"11 NDVI - Naturally Open Ecosystems","heading":"11.8 Overall conclusion","text":"NDVI natopen ecosystem varies little condition. variance thus overlap condition classes ecosystem types large. Exceptions sand dunes Southern Norway, show reduced NDVI deteriorating condition Sentinel data, flood plains nationally, areas deteriorating condition show stronger increase NDVI time. two phenomena, NDVI appear sensitive measure ecological condition natopen systems.Beyond considerations, two general issues limit comprehensive robust application satellite based NDVI-data ecological condition context:lacking ecosystem maps natopen ecosystems\nanalysis hand clearly shows different natopen ecosystem types display different greenness levels thus need evaluated separately. Thus, need ecosystem maps, allow us treat NDVI values least different major ecosystem types within natopens separately.lacking ecosystem maps natopen ecosystemsThe analysis hand clearly shows different natopen ecosystem types display different greenness levels thus need evaluated separately. Thus, need ecosystem maps, allow us treat NDVI values least different major ecosystem types within natopens separately.lacking ecosystem maps natopen ecosystems\nanalysis hand clearly shows different natopen ecosystem types display different greenness levels thus need evaluated separately. Thus, need ecosystem maps, allow us treat NDVI values least different major ecosystem types within natopens separately.lacking ecosystem maps natopen ecosystemsThe analysis hand clearly shows different natopen ecosystem types display different greenness levels thus need evaluated separately. Thus, need ecosystem maps, allow us treat NDVI values least different major ecosystem types within natopens separately.","code":""},{"path":"NDVI-indicator-natopen.html","id":"export-ndvin","chapter":"11 NDVI - Naturally Open Ecosystems","heading":"11.8.1 Eksport file","text":"Nothing export.\n","code":""},{"path":"NDVI-indicator-seminat.html","id":"NDVI-indicator-seminat","chapter":"12 NDVI - Semi-natural Ecosystems","heading":"12 NDVI - Semi-natural Ecosystems","text":"NDVI (greenness) indicator, semi-natural ecosystems Norwegian name: Primærproduksjon Author date:Joachim Töpper, Tessa BargmannSeptember 2023","code":""},{"path":"NDVI-indicator-seminat.html","id":"intro-ndvis","chapter":"12 NDVI - Semi-natural Ecosystems","heading":"12.1 Introduction","text":"Normalized difference vegetation index (NDVI) can used \ndescribe greenness area, may thus represent proxy \namount chlorophyll plant productivity given area.\nDifferent ecosystem types naturally greenness signals different\nintensity also certain variance. Deviations beyond \nnatural variation either direction may indicate reduction \necological condition given ecosystem. E.g. lower normal NDVI\nmay indicate excessive disturbance, higher normal NDVI may\nindicate regrowth transitions towards densely vegetated\nsystems. recent assessments ecological condition forest \nmountain ecosystems, two different NDVI-based indicators developed\napplied. forests, NDVI-values across country compared\nspatial reference NDVI-signal protected areas (Framstad et al.\n2020). mountains, extent consistence temporal change\nNDVI-values last twenty years assessed (Framstad et al\n2021). cases, NDVI-product MODIS satellite\nreflectance imagery used based available maps spatial\necosystem extent Norway (.e. national maps forest \nmountain ecosystems)., explore potential developing NDVI-indicator \necological condition representing open semi-natural ecosystems. \ntask, two initial challenges can identified early :don’t yet national map semi-natural ecosystems, .e.\ndon’t know exact locations semi-natural areas \nNorway, prerequisite extract satellite data \nright locations ecosystems, thus achieve good unbiased\nspatial representation assessment area.spatial extent single semi-natural ecosystem occurrences\n(hereafter ‘polygons’) includes many areas way smaller\npixel size MODIS imagery (250 x 250 m) \nused forests mountains time series back year\n\ndraft development NDVI indicator ecological condition\nsemi-natural systems approach challenges following\nways:use ecosystem occurrence data NiN-mapping guide \nextraction satellite NDVI data pixels representing right\necosystem. However, ecosystem occurrences NiN data \nhighly spatially biased thus provide good unbiased\nspatial representation assessment area. work therefore\nrepresents concept method development may applied \nassessment ecological condition spatially unbiased\noccurrence data national map semi-natural ecosystems \navailable.include Sentinel-2 imagery semi-natural ecosystems \nresolution bands underlying NDVI product 10 x 10\nm smaller almost semi-natural polygons \nNiN-data. However, since Sentinel-2 goes back 2015, lose\nmuch time series aspect compared MODIS data. \naddition, include Landsat imagery goes back 1984 \nresolution 30 x 30 m, also variable data due \nless frequent seasonal measurements. also still explore NDVI data\nMODIS (see details ).","code":""},{"path":"NDVI-indicator-seminat.html","id":"underlying-data-ndvis","chapter":"12 NDVI - Semi-natural Ecosystems","heading":"12.2 About the underlying data","text":"NDVI project semi-natural systems, use two kinds data\n(coming four datasets) building indicators ecological\ncondition:NiN ecosystem data ‘Naturtypekartlegging etter\nMiljødirektoratets instruks’ guide extraction NDVI data \nright locations provide information field-assessed\necological condition mapped polygonsremote sensed NDVI data\nSentinel-2 satellite NDVI data\nMODIS satellite NDVI data\nLandsat satellite NDVI data\nSentinel-2 satellite NDVI dataMODIS satellite NDVI dataLandsat satellite NDVI dataNiN ecosystem data: NiN data study contain data \necosystem categories (cf. Halvorsen et al. 2020) present \nmapped sites wall spatial delimitation (form \npolygons). Since use NiN data collected following\n‘Miljødirektoratets instruks’, data also include information\necological condition underlying condition variabels \nmapped sites (see Miljødirektoratets mapping manual \ndetails). Polygon sizes NiN data may vary <100 sqm \ndimension sqkm’s.NiN ecosystem data: NiN data study contain data \necosystem categories (cf. Halvorsen et al. 2020) present \nmapped sites wall spatial delimitation (form \npolygons). Since use NiN data collected following\n‘Miljødirektoratets instruks’, data also include information\necological condition underlying condition variabels \nmapped sites (see Miljødirektoratets mapping manual \ndetails). Polygon sizes NiN data may vary <100 sqm \ndimension sqkm’s.NDVI data: NDVI data used work hand pixel means\npolygons NiN-data, .e. NiN polygon represented\none NDVI value per measurement time (see details\ntemporal resolution NDVI data). respect , \nmake sense use NDVI data polygons least\nsize resolution respective satellite, \nthus excluded polygons smaller satellite’s\nresolution.NDVI data: NDVI data used work hand pixel means\npolygons NiN-data, .e. NiN polygon represented\none NDVI value per measurement time (see details\ntemporal resolution NDVI data). respect , \nmake sense use NDVI data polygons least\nsize resolution respective satellite, \nthus excluded polygons smaller satellite’s\nresolution.(2a) Sentinel-2 satellite NDVI data: Sentinel data resolution\n10 x 10 m, thus excluded NiN-polygons smaller 100\nsqm. Sentinel-2 revisit frequency 10 days thus\nprovide enough measurements peak growing season provide \nrobust measure maximum greenness.(2b) MODIS satellite NDVI data: MODIS data resolution 250\nx 250 m, thus excluded NiN-polygons smaller 62500 sqm.\nMODIS revisit frequency 1-2 days thus provides extensive\nsample provide robust measure maximum greenness.(2c) Landsat satellite NDVI data: Landsat data resolution \n30 x 30 m, thus excluded NiN-polygons smaller 900 sqm.\nLandsat revisit frequency 16 days thus provides poorest\ngrowing season sample among available NDVI data robust measure\nmaximum greenness.","code":""},{"path":"NDVI-indicator-seminat.html","id":"representativity-ndvis","chapter":"12 NDVI - Semi-natural Ecosystems","heading":"12.2.1 Representativity in time and space","text":"semi-natural systems, NiN data contain 24494 semi-natural\npolygons known area size across mainland Norway. However, NiN-mapping\nplanned performed spatially representative way thus\necosystem occurrences spatial extent \ntreated spatially biased. 24494 semi-natural polygons \ndistributed across regions major ecosystem types following\nway:addition, 10 T31s, 78 T32s, 15 T33s, 59 T34s, 1 T40\nassigned region. (polygons likely lie water thus outside regional polygons due imprecise coordinates mapping device).NDVI data either satellite follow spatial distribution \nbias status NiN-data. Due larger number excluded\npolygons NDVI data MODIS (large pixel size \nMODIS, see ), MODIS NDVI data semi-natural occurrences\nNiN data likely even spatially biased \ncase NDVI data Sentinel-2 Landsat.","code":""},{"path":"NDVI-indicator-seminat.html","id":"temp-cov-ndvis","chapter":"12 NDVI - Semi-natural Ecosystems","heading":"12.2.2 Temporal coverage","text":"currently available NiN data semi-natural ecosystems span time\nperiod 2018-2021 thus represent contemporary sample \necosystem occurrences. Note none polygons NiN-data\nvisited period.Available Sentinel-2 satellite NDVI data span years 2015-2022.Available MODIS satellite NDVI data span years 2000-2022.Available Landsat satellite NDVI data span years 1984-2021.","code":""},{"path":"NDVI-indicator-seminat.html","id":"coll-ndvis","chapter":"12 NDVI - Semi-natural Ecosystems","heading":"12.3 Collinearities with other indicators","text":"NDVI signal may likely co-linear re-growth indicator\nbased LiDAR derived canopy height abandoned semi-natural areas\nshrub tree encroachment.","code":""},{"path":"NDVI-indicator-seminat.html","id":"ref-state-ndvis","chapter":"12 NDVI - Semi-natural Ecosystems","heading":"12.4 Reference state and values","text":"","code":""},{"path":"NDVI-indicator-seminat.html","id":"ref-state2-ndvis","chapter":"12 NDVI - Semi-natural Ecosystems","heading":"12.4.1 Reference state and scaling values","text":"indicator project mainly exploratory, mapping possibilities\nlacking prerequisites satellite derived NDVI data inform\necological condition assessments. Therefore, lack concise strategy\ndefine reference state, especially prior access\necosystem map semi-natural ecosystems (cf. Jakobsson et al.\n2020, Töpper & Jakobsson 2021). exploratory work, use\ncondition classification NiN-data explore (1) NDVI\nconnects semi-natural ecology condition (2) applicability\ndefining reference state. use statistical models test\nwhether NDVI varies systematically condition across\ntime.","code":""},{"path":"NDVI-indicator-seminat.html","id":"uncertainties-ndvis","chapter":"12 NDVI - Semi-natural Ecosystems","heading":"12.5 Uncertainties","text":"Given condition index can achieved, can calculate mean\nindicator value (scaling) every region (delimited\narea interest) well corresponding standard error \nstandard deviation measure spatial uncertainty \ngeographical area (see Töpper & Jakobsson 2021).","code":""},{"path":"NDVI-indicator-seminat.html","id":"references-10","chapter":"12 NDVI - Semi-natural Ecosystems","heading":"12.6 References","text":"Framstad, E., Kolstad, . L., Nybø, S., Töpper, J. & Vandvik, V. 2022.\ncondition forest mountain ecosystems Norway. Assessment \nIBECA method. NINA Report 2100. Norwegian Institute Nature\nResearch.Halvorsen, R., Skarpaas, O., Bryn, ., Bratli, H., Erikstad, L.,\nSimensen, T., & Lieungh, E. (2020). Towards systematics \necodiversity: EcoSyst framework. Global Ecology Biogeography,\n29(11), 1887-1906. doi:10.1111/geb.13164Jakobsson, S., Töpper, J.P., Evju, M., Framstad, E., Lyngstad, .,\nPedersen, B., Sickel, H., Sverdrup-Thygeson, ., Vandvik. V., Velle,\nL.G., Aarrestad, P.. & Nybø, S. 2020. Setting reference levels \nlimits good ecological condition terrestrial ecosystems. Insights\ncase study based IBECA approach. Ecological Indicators\n116: 106492.Miljødiretoratets mapping manual:\nhttps://www.miljodirektoratet./publikasjoner/2022/januar/kartleggingsinstruks-kartlegging-av-terrestriske-naturtyper-etter-nin/Töpper, J. & Jakobsson, S. 2021. Index-Based Ecological Condition\nAssessment (IBECA) - Technical protocol, version 1.0. NINA Report 1967.\nNorwegian Institute Nature Research.","code":""},{"path":"NDVI-indicator-seminat.html","id":"analyses-ndvis","chapter":"12 NDVI - Semi-natural Ecosystems","heading":"12.7 Analyses","text":"","code":""},{"path":"NDVI-indicator-seminat.html","id":"datasets-ndvis","chapter":"12 NDVI - Semi-natural Ecosystems","heading":"12.7.1 Data sets","text":"analyses document make use following data sets:NiN data (Naturtyper etter Miljødirektoratets instruks)Sentinel-2 NDVI dataMODIS NDVI dataLandsat NDVI data","code":""},{"path":"NDVI-indicator-seminat.html","id":"nin-data-and-geometry-for-norway-and-the-five-regions-1","chapter":"12 NDVI - Semi-natural Ecosystems","heading":"12.7.1.1 NiN data and geometry for Norway and the five regions","text":"read NiN data document cache GitHub\nrepository……can also directly downloaded Miljødirektoratets\nkartkatalog (https://kartkatalog.miljodirektoratet./Dataset)upload maps Norway five regions: Southern, Western,\nEastern, Central, Northern Norway","code":"\n# Add NiN data from cache\nnin <- readRDS(paste0(here::here(), \"/data/cache/nin.RDS\"))\nurl <- \"https://nedlasting.miljodirektoratet.no/Miljodata//Naturtyper_nin/FILEGDB/4326/Naturtyper_nin_0000_norge_4326_FILEGDB.zip\"\ndownload(url, dest = \"P:/41201785_okologisk_tilstand_2022_2023/data/Naturtyper_nin_0000_norge_4326_FILEGDB.zip\", mode = \"wb\")\nunzip(\"P:/41201785_okologisk_tilstand_2022_2023/data/Naturtyper_nin_0000_norge_4326_FILEGDB.zip\",\n  exdir = \"P:/41201785_okologisk_tilstand_2022_2023/data/nin_data\"\n)\nst_layers(\"P:/41201785_okologisk_tilstand_2022_2023/data/nin_data/Naturtyper_nin_0000_norge_4326_FILEGDB.gdb\")\nnin <- st_read(\"P:/41201785_okologisk_tilstand_2022_2023/data/nin_data/Naturtyper_nin_0000_norge_4326_FILEGDB.gdb\",\n  layer = \"naturtyper_nin_omr\"\n)\n# Import region- og Norgeskart, make sure they have the same geometry as the nin data\nnor <- st_read(\"data/outlineOfNorway_EPSG25833.shp\") %>%\n  st_as_sf() %>%\n  st_transform(crs = st_crs(nin))\n#> Reading layer `outlineOfNorway_EPSG25833' from data source \n#>   `/data/Egenutvikling/41001581_egenutvikling_anders_kolstad/github/ecosystemCondition/data/outlineOfNorway_EPSG25833.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 1 feature and 2 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -113472.7 ymin: 6448359 xmax: 1114618 ymax: 7939917\n#> Projected CRS: ETRS89 / UTM zone 33N\n\nreg <- st_read(\"data/regions.shp\") %>%\n  st_as_sf() %>%\n  st_transform(crs = st_crs(nin))\n#> Reading layer `regions' from data source \n#>   `/data/Egenutvikling/41001581_egenutvikling_anders_kolstad/github/ecosystemCondition/data/regions.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 5 features and 2 fields\n#> Geometry type: POLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -99551.21 ymin: 6426048 xmax: 1121941 ymax: 7962744\n#> Projected CRS: ETRS89 / UTM zone 33N\n\n# change region names to something R-friendly\nreg$region\n#> [1] \"Nord-Norge\"      \"Midt-Norge\"      \"Ã\\u0098stlandet\"\n#> [4] \"Vestlandet\"      \"SÃ¸rlandet\"\nreg$region <- c(\"Northern Norway\", \"Central Norway\", \"Eastern Norway\", \"Western Norway\", \"Southern Norway\")\n\n# combine the Norway and the region maps\nregnor <- st_intersection(reg, nor)\n#> Warning: attribute variables are assumed to be spatially\n#> constant throughout all geometries"},{"path":"NDVI-indicator-seminat.html","id":"ndvi-data","chapter":"12 NDVI - Semi-natural Ecosystems","heading":"12.7.1.2 NDVI data","text":"NDVI data calculated mean NDVI values respective NiN\npolygon available Sentinel-2, MODIS, Landsat image \nGoogle Earth Engine (GEE).","code":""},{"path":"NDVI-indicator-seminat.html","id":"sentinel-2-ndvi-data-1","chapter":"12 NDVI - Semi-natural Ecosystems","heading":"12.7.1.2.1 Sentinel-2 NDVI data","text":"GEE code can seen :\nhttps://code.earthengine.google.com/2ceb0c3e03adade9e6f6d0903184b8c4\nimage collection contains Sentinel imagery June, July \nAugust 2015-2022 exceed GEE memory limits, exported files \niterated grid resulted 42 separate csv files. \nscript merges merges dataframe NiN data.","code":"\n# Import Sentinel NDVI Data\ndf.s <- list.files(\"/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/NDVI_åpenlavland/NDVI_data_Sentinel/\", pattern = \"*.csv\", full.names = TRUE) %>%\n  map_df(~ fread(.))"},{"path":"NDVI-indicator-seminat.html","id":"modis-ndvi-data-1","chapter":"12 NDVI - Semi-natural Ecosystems","heading":"12.7.1.2.2 MODIS NDVI data","text":"GEE code can seen :\nhttps://code.earthengine.google.com/efb84013701f1d5f6e1e81345f389b84\nimage collection contains MODIS imagery June, July August\n2000-2022","code":"\n# Import MODIS NDVI Data\n# MODIS NDVI is scaled by 0.0001. Mean must be divided by 10000.\ndf.m <- read.csv(\"/data/P-Prosjekter241201785_okologisk_tilstand_2022_2023/data/NDVI_åpenlavland/NDVI_data_MODIS/modis_ndvi_ts_2000_2022.csv\", )\ndf.m$mean <- df.m$mean / 10000"},{"path":"NDVI-indicator-seminat.html","id":"landsat-ndvi-data-1","chapter":"12 NDVI - Semi-natural Ecosystems","heading":"12.7.1.2.3 Landsat NDVI data","text":"GEE code can seen :\nhttps://code.earthengine.google.com/da8a9279238ef26d14be08a43788b6b7\nimage collection contains Landsat imagery June, July August\n1984-2022 exceed GEE memory limits, exported files \niterated grid resulted 42 separate csv files. \nscript merges merges dataframe NiN data.","code":"\n# Import Landsat NDVI Data\n# Set up conditional file paths\ndir <- substr(getwd(), 1, 2)\n\npath <- ifelse(dir == \"C:\",\n  \"R:/GeoSpatialData/Habitats_biotopes/Norway_Miljodirektoratet_Naturtyper_nin/Original/versjon20221231/Natur_Naturtyper_nin_norge_med_svalbard_25833/Natur_Naturtyper_NiN_norge_med_svalbard_25833.gdb\",\n  \"/data/R/GeoSpatialData/Habitats_biotopes/Norway_Miljodirektoratet_Naturtyper_nin/Original/versjon20221231/Natur_Naturtyper_nin_norge_med_svalbard_25833/Natur_Naturtyper_NiN_norge_med_svalbard_25833.gdb\"\n)\n\npData <- ifelse(dir == \"C:\",\n  \"P:/41201785_okologisk_tilstand_2022_2023/data/NDVI_åpenlavland/NDVI_data_Landsat\",\n  \"/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/NDVI_åpenlavland/NDVI_data_Landsat\"\n)\n\n\n# Fread doesn't like the weird path to the server version of the P drive\n# hence this horrendous work around\nfiles <- list.files(pData, pattern = \"*.csv\", full.names = TRUE)\n\ndf_list <- list() # initialise a list of dataframes\n# read in a dataframe in each slot of the df_list\nfor (i in files) {\n  name <- gsub(\"-\", \".\", i)\n  name <- gsub(\".csv\", \"\", name)\n  i <- paste(i, sep = \"\")\n  df_list[[i]] <- assign(name, read.csv(i, header = TRUE))\n}\n\ndf.l <- bind_rows(df_list, .id = \"column_label\")"},{"path":"NDVI-indicator-seminat.html","id":"data-handling-ndvis","chapter":"12 NDVI - Semi-natural Ecosystems","heading":"12.7.2 Data handling","text":"","code":""},{"path":"NDVI-indicator-seminat.html","id":"nin-data-ndvis","chapter":"12 NDVI - Semi-natural Ecosystems","heading":"12.7.2.1 NiN data","text":"","code":"\n# fixing variable- and ecosystem-names with special characters\ncolnames(nin)\ncolnames(nin)[c(3, 8, 17, 26, 31, 33, 34)] <- c(\n  \"hovedoekosystem\", \"kartleggingsaar\", \"noyaktighet\",\n  \"omraadenavn\", \"uk_naertruet\", \"uk_sentraloekosystemfunksjon\",\n  \"uk_spesieltdaarligkartlagt\"\n)\nunique(nin$hovedoekosystem)\n\nnin <- nin %>%\n  mutate(hovedoekosystem = recode(hovedoekosystem,\n    \"Våtmark\" = \"Vaatmark\",\n    \"Semi-naturlig mark\" = \"Semi_naturlig\",\n    \"Naturlig åpne områder i lavlandet\" = \"Naturlig-aapent\",\n    \"Naturlig åpne områder under skoggrensa\" = \"Naturlig_aapent\"\n  )) %>%\n  mutate(validGeo = st_is_valid(SHAPE))\n\n# checking how many polygons have multiple ecosystem types\nunique(nin$ninkartleggingsenheter)\n\nnrow(nin)\n# 95469 polygons altogether\nnrow(nin %>%\n  filter(grepl(\",\", ninkartleggingsenheter)))\n# 21094 polygons have more than 1 ecosystem type (they are separated by commas in the ninkartleggingsenheter-variable)\n\nnrow(nin %>%\n  filter(!grepl(\",\", ninkartleggingsenheter)))\n# 74375 polygons should have only 1 ecosystem type\n\n# there's no information on the proportion of ecosystem types in the polygons, so we got to omit all polygons with multiple ecosystem types :(\nnin <- nin %>%\n  filter(!grepl(\",\", ninkartleggingsenheter))\n\n# fix the content in the ninkartleggingsenheter-variable\nsummary(as.factor(nin$ninkartleggingsenheter))\n# get rid of the NA- in the beginning\nnin <- nin %>% mutate(ninkartleggingsenheter = str_remove(ninkartleggingsenheter, \"NA_\"))\n# making a main ecosystem type variable\nnin <- nin %>% mutate(\n  hovedtype = substr(ninkartleggingsenheter, 1, 3),\n  hovedtype = str_remove(hovedtype, \"-\")\n)\n# checking mapping unit against main ecosystem type\nnin[, c(\"hovedoekosystem\", \"hovedtype\")]\nsummary(as.factor(nin$hovedtype[nin$hovedoekosystem == \"Vaatmark\"]))\nsummary(as.factor(nin$hovedtype[nin$hovedoekosystem == \"Semi_naturlig\"]))\nsummary(as.factor(nin$hovedtype[nin$hovedoekosystem == \"Naturlig_aapne\"]))\nsummary(as.factor(nin$hovedtype[nin$hovedoekosystem == \"Skog\"]))\nsummary(as.factor(nin$hovedtype[nin$hovedoekosystem == \"Fjell\"]))\n# making a new variable for the overarching ecosystem types based on the main ecosystem types\nnin$hovedoekosystem.orig <- nin$hovedoekosystem\n\nnin <- nin %>%\n  mutate(hovedoekosystem = case_when(\n    hovedtype %in% paste(\"V\", c(1, 3:7, 9:10), sep = \"\") ~ \"Vaatmark\",\n    hovedtype %in% paste(\"V\", 11:13, sep = \"\") ~ \"Vaatmark_sterkt_endret\",\n    hovedtype %in% paste(\"T\", c(31:34, 40:41), sep = \"\") ~ \"Semi_naturlig\",\n    hovedtype %in% paste(\"T\", c(2, 12, 18, 20:21), sep = \"\") ~ \"Naturlig_aapent\",\n    hovedtype %in% c(paste(\"T\", c(4, 30, 38), sep = \"\"), paste(\"V\", c(2, 8), sep = \"\")) ~ \"Skog\",\n    hovedtype %in% c(paste(\"T\", c(3, 7, 9, 10, 14, 22, 26), sep = \"\"), paste(\"V\", c(6, 7), sep = \"\")) ~ \"Fjell\",\n    TRUE ~ \"NA\"\n  ))\n\n\nsummary(as.factor(nin$tilstand))\n\nnin <- nin %>% mutate(tilstand = recode(tilstand,\n  \"Dårlig\" = \"Redusert\",\n  \"Svært redusert\" = \"Svaert_redusert\"\n))\nnin <- nin %>% mutate(tilstand_num = recode(tilstand,\n  \"God\" = 0, \"Moderat\" = 1,\n  \"Redusert\" = 2, \"Svaert_redusert\" = 3\n))\n\nsummary(as.factor(nin$tilstand))\nsummary(as.numeric(nin$tilstand_num))\n\n\n## filter out only semi-natural data\nnin.seminat <- nin %>%\n  filter(hovedoekosystem %in% c(\"Semi_naturlig\")) %>%\n  mutate(id = identifikasjon_lokalid) %>%\n  filter(validGeo) %>%\n  drop_na(tilstand) %>%\n  dplyr::select(id, hovedoekosystem, hovedtype, ninkartleggingsenheter, lokalitetskvalitet, tilstand, tilstand_num, ninbeskrivelsesvariabler, kartleggingsaar)\n\n\n# merge NiN-data with region\nnin.seminat <- st_join(nin.seminat, regnor, left = TRUE)\nnin.seminat\n\ncolnames(nin.seminat)[c(1, 10)] <- c(\"id\", \"region_id\")\n\n# check that every nin-polygon still occurs only once\nsummary(as.factor(nin.seminat$id)) # ok\n\nnin.seminat <- nin.seminat %>%\n  mutate(area_meters_nin = st_area(nin.seminat))\n# check and edit the order of regions\nlevels(nin.seminat$region)\nnin.seminat$region <- as.factor(nin.seminat$region)\nlevels(nin.seminat$region)\nnin.seminat$region <- factor(nin.seminat$region, levels = c(\"Northern Norway\", \"Central Norway\", \"Eastern Norway\", \"Western Norway\", \"Southern Norway\"))\nlevels(nin.seminat$region)\n\n# splitting content in the ninbeskrivelsesvariabler-column into separate rows per variable and then separating that column into two for the variable name and value\nnin.seminat2 <- nin.seminat %>%\n  separate_rows(ninbeskrivelsesvariabler, sep = \",\") %>%\n  separate(\n    col = ninbeskrivelsesvariabler,\n    into = c(\"NiN_variable_code\", \"NiN_variable_value\"),\n    sep = \"_\",\n    remove = F\n  ) %>%\n  mutate(NiN_variable_value = as.numeric(NiN_variable_value)) %>%\n  mutate(NiN_variable_code = as.factor(NiN_variable_code)) %>%\n  subset(select = -ninbeskrivelsesvariabler)\nnin.seminat2 <- as.data.frame(nin.seminat2)"},{"path":"NDVI-indicator-seminat.html","id":"ndvi-data-ndvis","chapter":"12 NDVI - Semi-natural Ecosystems","heading":"12.7.2.2 NDVI data","text":"","code":"\n## Sentinel-2\n# join nin.seminat & Sentinel NDVI data\nSentinelNDVI.seminat <- full_join(nin.seminat, df.s, by = \"id\")\n# summary(SentinelNDVI.seminat)\nSentinelNDVI.seminat <- SentinelNDVI.seminat %>%\n  mutate(\n    hovedoekosystem = as.factor(hovedoekosystem),\n    hovedtype = as.factor(hovedtype),\n    ninkartleggingsenheter = as.factor(ninkartleggingsenheter),\n    lokalitetskvalitet = as.factor(lokalitetskvalitet),\n    tilstand = as.factor(tilstand),\n    area_meters = st_area(SentinelNDVI.seminat)\n  )\n# summary(SentinelNDVI.seminat)\n# get rid of NAs (i.e. NDVI cells that were not in semi-natural polygons)\nSentinelNDVI.seminat <- SentinelNDVI.seminat %>% filter(!is.na(hovedtype))\nSentinelNDVI.seminat <- SentinelNDVI.seminat %>% filter(!is.na(mean))\n# summary(SentinelNDVI.seminat)\n# get rid of any nin-polygons smaller than the Sentinel grid cell size (100 sqm)\ndim(SentinelNDVI.seminat)\nSentinelNDVI.seminat <- SentinelNDVI.seminat %>% filter(as.numeric(area_meters) >= 100)\ndim(SentinelNDVI.seminat)\n# split date into year, month & day\nSentinelNDVI.seminat <- SentinelNDVI.seminat %>%\n  dplyr::mutate(\n    year = lubridate::year(date),\n    month = lubridate::month(date),\n    day = lubridate::day(date)\n  )\n# add column for sub-ecosystem types\nSentinelNDVI.seminat <- SentinelNDVI.seminat %>% mutate(\n  subtype = substring(ninkartleggingsenheter, 4),\n  subtype = str_remove(subtype, \"-\"),\n  subtype = str_remove(subtype, \"-\")\n)\n# we are using max NDVI per year in every NiN polygon\nSentinelNDVI.seminat <- SentinelNDVI.seminat %>%\n  group_by(id, year) %>%\n  filter(mean == max(mean, na.rm = TRUE))\n\nsummary(SentinelNDVI.seminat)\n\n## MODIS\n# join nin.seminat and Modis NDVI data\nModisNDVI.seminat <- full_join(nin.seminat, df.m, by = \"id\")\n\n# summary(ModisNDVI.seminat)\nModisNDVI.seminat <- ModisNDVI.seminat %>%\n  mutate(\n    hovedoekosystem = as.factor(hovedoekosystem),\n    hovedtype = as.factor(hovedtype),\n    ninkartleggingsenheter = as.factor(ninkartleggingsenheter),\n    lokalitetskvalitet = as.factor(lokalitetskvalitet),\n    tilstand = as.factor(tilstand),\n    area_meters = st_area(ModisNDVI.seminat)\n  )\n# summary(ModisNDVI.seminat)\n# get rid of NAs (i.e. NDVI cells that were not in semi-natural polygons)\nModisNDVI.seminat <- ModisNDVI.seminat %>% filter(!is.na(hovedtype))\nModisNDVI.seminat <- ModisNDVI.seminat %>% filter(!is.na(mean))\n# summary(ModisNDVI.seminat)\n# get rid of any nin-polygons smaller than the Modis grid cell size (62500 sqm)\ndim(ModisNDVI.seminat)\nModisNDVI.seminat <- ModisNDVI.seminat %>% filter(as.numeric(area_meters) >= 62500)\ndim(ModisNDVI.seminat)\n# split date into year, month & day\nModisNDVI.seminat <- ModisNDVI.seminat %>%\n  dplyr::mutate(\n    year = lubridate::year(date),\n    month = lubridate::month(date),\n    day = lubridate::day(date)\n  )\n# we are using max NDVI per year in every NiN polygon\nModisNDVI.seminat <- ModisNDVI.seminat %>%\n  group_by(id, year) %>%\n  filter(mean == max(mean, na.rm = TRUE))\n# summary(ModisNDVI.seminat)\n\n## Landsat\n# join nin.seminat & Landsat NDVI data\nLandsatNDVI.seminat <- full_join(nin.seminat, df.l, by = \"id\")\n\n# summary(LandsatNDVI.seminat)\nLandsatNDVI.seminat <- LandsatNDVI.seminat %>%\n  mutate(\n    hovedoekosystem = as.factor(hovedoekosystem),\n    hovedtype = as.factor(hovedtype),\n    ninkartleggingsenheter = as.factor(ninkartleggingsenheter),\n    lokalitetskvalitet = as.factor(lokalitetskvalitet),\n    tilstand = as.factor(tilstand),\n    area_meters = st_area(LandsatNDVI.seminat)\n  )\n# summary(LandsatNDVI.seminat)\n# get rid of NAs (i.e. NDVI cells that were not in semi-natural polygons)\nLandsatNDVI.seminat <- LandsatNDVI.seminat %>% filter(!is.na(hovedtype))\nLandsatNDVI.seminat <- LandsatNDVI.seminat %>% filter(!is.na(mean))\n# summary(LandsatNDVI.seminat)\n# get rid of any nin-polygons smaller than the Landsat grid cell size (900 sqm)\ndim(LandsatNDVI.seminat)\nLandsatNDVI.seminat <- LandsatNDVI.seminat %>% filter(as.numeric(area_meters) >= 900)\ndim(LandsatNDVI.seminat)\n# split date into year, month & day\nLandsatNDVI.seminat <- LandsatNDVI.seminat %>%\n  dplyr::mutate(\n    year = lubridate::year(date),\n    month = lubridate::month(date),\n    day = lubridate::day(date)\n  )\n# we are using max NDVI per year in every NiN polygon\nLandsatNDVI.seminat <- LandsatNDVI.seminat %>%\n  group_by(id, year) %>%\n  filter(mean == max(mean, na.rm = TRUE))\n\n# summary(LandsatNDVI.seminat)"},{"path":"NDVI-indicator-seminat.html","id":"exploratory-analyses-sentinel-2","chapter":"12 NDVI - Semi-natural Ecosystems","heading":"12.7.3 Exploratory analyses, Sentinel-2","text":"seminat sites?\nFigure 12.1: map Norway showing location semi-natural ecosystem sites.\nT31…Boreal heath, T32…semi-natural grasslands, T33…semi-natural coastal grasslands, T34…Coastal heathlands, T40/T41…previously heavily managed grasslands (now similar T32)polygon sizes distributed?\nFigure 12.2: histogram showing distribution polygon sizes.\nSemi-natural polygons stretch large number sizes just \n100 sqm almost 3 million sqm. 75% polygons 15297\nsqm.\ndashed line indicates minimum size Sentinel-2 pixels NDVI, NiN-polygons smaller removed form data.NDVI vary years\nFigure 12.3: figure showing NDVI values semi-natural ecosystem time six different main nature types varying degrees condition.\n2022 stands highest NDVI values missing.\nomit 2022 analysis.NDVI values vary major basic ecosystem types sites good condition? (using NDVI data matching NiN-mapping years)\nFigure 12.4: NDVI values major basic semi natural ecosystem types good condition.\n\nFigure 12.5: NDVI values major basic semi natural ecosystem types good condition.\nNDVI varies major ecosystem types highest values \nsemi-natural grasslands (T32) previously intensively used \naltered grasslands today resemble semi-natural grassland (T40,\nT41), lowest values coastal heathlands (T34). ecosystem types:\nBoreal heath (T31), semi-natural coastal grasslands (T33). overlaps\necosystem types considerable. respect basic\necosystem types within major types, NDVI appears cover \nsimilar ranges across subtypes, deviating violin\nplots smaller sample size. obvious trend related \nstructuring environmental gradients withing major types, \nalso overlap large.NDVI vary across regions semi-natural ecosystems (major types) good condition? (using NDVI data matching NiN-mapping years)\nFigure 12.6: DVI variation across regions semi-natural ecosystems (major types) good condition\nmeadow systems (T32, T33, T40, T41) obvious trends\ngeography. heath systems (T31, T34) distribution NDVI\nvalues Central Norway somewhat lower regions.NDVI vary across condition classes (major types NDVI data matching NiN-mapping years)\nFigure 12.7: NDVI values across semi-natural ecosystem sites different ecological condition.\ncoastal types (T33, T34, coastal meadows heathlands,\nrespectively) NDVI seems increase condition deteriorates, \nremaining types pattern absent. Overlaps condition\nclasses generally large.ecological relevant variable(s) condition measure NiN data related ?\nFigure 12.8: ecological relevant variable(s) condition measure NiN data related ?\n\nFigure 12.9: ecological relevant variable(s) condition measure NiN data related ?\n\nFigure 12.10: ecological relevant variable(s) condition measure NiN data related ?\n\nFigure 12.11: ecological relevant variable(s) condition measure NiN data related ?\n\nFigure 12.12: ecological relevant variable(s) condition measure NiN data related ?\nplots, panels different major ecosystem types\ndiffer Miljødirektoratets mapping manual (see reference list\n) uses different variables major ecosystem types define\ncondition.heath systems - T31 T34 - reduced condition mainly related\nlow levels grazing ongoing succession (also intensive\ngrazing). meadow systems - T32, T33, T40, T41 - reduced condition\nrelated low levels land-use intensity ongoing succession\n(also intensive land use). addition, reduced condition \nrelated high abundance alien species major semi-natural\necosystem types.","code":"\ntm_shape(regnor) +\n  tm_fill(\"GID_0\", labels = \"\", title = \"\", legend.show = FALSE, alpha=0) +\n  tm_borders() +\n  tm_shape(SentinelNDVI.seminat) +\n  tm_dots(\"hovedtype\", midpoint = NA, palette = tmaptools::get_brewer_pal(\"YlOrRd\", 5, plot = FALSE), scale = 2.5, legend.show = FALSE) +\n  tm_add_legend(\n    type = \"symbol\",\n    col = tmaptools::get_brewer_pal(\"YlOrRd\", 5, plot = FALSE),\n    labels = c(\n      \"T31\",\n      \"T32\",\n      \"T33\",\n      \"T34\",\n      \"T40/41\"\n    ),\n    title = \"Major ecosystem type\",\n    size = 1.5\n  ) +\n  tm_layout(\n    main.title = \"Semi-natural ecosystems \\n(NiN, Miljødirektoratets instruks)\",\n    main.title.size = 1.2, legend.position = c(\"right\", \"bottom\"),\n    legend.text.size = 1.3, legend.title.size = 1.4\n  )\nsummary(SentinelNDVI.seminat$area_meters)\n#>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. \n#>     111.6    1508.6    3714.9   15297.9   10059.0 2954478.0\nhist(SentinelNDVI.seminat$area_meters, xlim = c(0, 20000), breaks = 50000,xlab=\"Area\",main=\"\")\nabline(v = 100, lty = 2)\nSentinelNDVI.seminat %>%\n  filter(tilstand!=\"\") %>%\n  ggplot(aes(x = year, y = mean)) +\n  geom_point() +\n  facet_grid(tilstand ~ hovedtype) +\n  theme(axis.text.x = element_text(angle = -45, vjust = 0.5, hjust = 0.2, size = 12)) +\n  ggtitle(\"NDVI across years for different ecosystem types in all condition classes\") +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Year\")\nSentinelNDVI.seminat <- SentinelNDVI.seminat %>% filter(year != \"2022\")\nSentinelNDVI.seminat %>%\n  filter(tilstand == \"God\") %>%\n  filter(year == kartleggingsaar) %>%\n  ggplot(aes(x = hovedtype, y = mean)) +\n  geom_violin() +\n  geom_point(size = 0.7, shape = 16, color = \"grey\", position = position_jitter(.1) ) +\n  ggtitle(\"NDVI for different ecosystem types in good condition\") +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Major ecosystem type\")\n\nSentinelNDVI.seminat$subtype <- factor(SentinelNDVI.seminat$subtype, levels = c(\"C1\", \"C2\", \"C3\", \"C4\", \"C5\", \"C6\", \"C7\", \"C8\", \"C9\", \"C10\", \"C11\", \"C12\", \"C13\", \"C14\", \"C15\", \"C16\", \"C17\", \"C18\", \"C19\", \"C20\", \"C21\", \"E1\", \"E2\", \"E3\", \"E4\", \"E5\", \"E6\", \"E7\"))\nSentinelNDVI.seminat %>%\n  filter(tilstand == \"God\") %>%\n  filter(year == kartleggingsaar) %>%\n  ggplot(aes(x = subtype, y = mean)) +\n  geom_violin() +\n  geom_point(size = 0.7, shape = 16, color = \"grey\" ) +\n  facet_wrap(~hovedtype) +\n  theme(axis.text.x = element_text(angle = -45, vjust = 0.5, hjust = 0.2, size = 7)) +\n  ggtitle(\"NDVI for different ecosystem sub-types in good condition\") +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Ecosystem sub-type\")\nSentinelNDVI.seminat %>%\n  filter(tilstand == \"God\") %>%\n  filter(year == kartleggingsaar) %>%\n  filter(!is.na(region)) %>%\n  ggplot(aes(x = region, y = mean)) +\n  geom_violin() +\n  geom_point(size = 0.7, shape = 16, color = \"grey\", position = position_jitter(.1) ) +\n  facet_wrap(~hovedtype) +\n  theme(axis.text.x = element_text(angle = -45, vjust = 0.5, hjust = 0.2, size = 9)) +\n  ggtitle(\"NDVI for different ecosystems in good condition across regions\") +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Region\")\nSentinelNDVI.seminat %>%\n  filter(year == kartleggingsaar) %>%\n  ggplot(aes(x = tilstand, y = mean)) +\n  geom_violin() +\n  geom_point(size = 0.7, shape = 16, color = \"grey\", position = position_jitter(.1) ) +\n  facet_wrap(~hovedtype) +\n  theme(axis.text.x = element_text(angle = -45, vjust = 0.5, hjust = 0.2)) +\n  ggtitle(\"NDVI for different ecosystems in different condition classes\") +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Condition\")\nnin.seminat2 %>%\n  filter(hovedtype == \"T31\") %>%\n  filter(NiN_variable_code %in% c(\"7JB-BT\", \"7RA-BA\", \"7FA\", \"7TK\")) %>%\n  mutate(NiN_variable_des = recode(NiN_variable_code,\n    \"7JB-BT\" = \"Grazing pressure\",\n    \"7RA-BA\" = \"Succession\",\n    \"7FA\" = \"Alien species\",\n    \"7TK\" = \"Heavy vehicles\"\n  )) %>%\n  ggplot(aes(x = NiN_variable_value, y = tilstand_num)) +\n  geom_point(size = 2) +\n  geom_jitter(width = 0.25, height = 0.25) +\n  facet_wrap(~NiN_variable_des, nrow = 2, ncol = 3) +\n  theme(legend.position = \"none\") +\n  ggtitle(\"Condition variables in boreal heath (T31)\") +\n  labs(y = \"Condition level (0-3='good' to 'very reduced')\", x = \"Condition variable score\")\n\n\nnin.seminat2 %>%\n  filter(hovedtype == \"T32\") %>%\n  filter(NiN_variable_code %in% c(\"7JB-BA\", \"7RA-SJ\", \"7FA\", \"7SE\", \"7JB-GJ\")) %>%\n  mutate(NiN_variable_des = recode(NiN_variable_code,\n    \"7JB-BA\" = \"Land-use intensity\",\n    \"7RA-SJ\" = \"Succession\",\n    \"7FA\" = \"Alien species\",\n    \"7SE\" = \"Wear/tear\",\n    \"7JB-GJ\" = \"Fertilization\"\n  )) %>%\n  ggplot(aes(x = NiN_variable_value, y = tilstand_num)) +\n  geom_point(size = 2) +\n  geom_jitter(width = 0.25, height = 0.25) +\n  facet_wrap(~NiN_variable_des, nrow = 2, ncol = 3) +\n  theme(legend.position = \"none\") +\n  ggtitle(\"Condition variables in semi-natural grasslands (T32)\") +\n  labs(y = \"Condition level (0-3='good' to 'very reduced')\", x = \"Condition variable score\")\n\nnin.seminat2 %>%\n  filter(hovedtype == \"T33\") %>%\n  filter(NiN_variable_code %in% c(\"7JB-BA\", \"7RA-SJ\", \"7FA\", \"7JB-GJ\")) %>%\n  mutate(NiN_variable_des = recode(NiN_variable_code,\n    \"7JB-BA\" = \"Land-use intensity\",\n    \"7RA-SJ\" = \"Succession\",\n    \"7FA\" = \"Alien species\",\n    \"7JB-GJ\" = \"Fertilization\"\n  )) %>%\n  ggplot(aes(x = NiN_variable_value, y = tilstand_num)) +\n  geom_point(size = 2) +\n  geom_jitter(width = 0.25, height = 0.25) +\n  facet_wrap(~NiN_variable_des, nrow = 2, ncol = 3) +\n  theme(legend.position = \"none\") +\n  ggtitle(\"Condition variables in semi-natural coastal grasslands (T33)\") +\n  labs(y = \"Condition level (0-3='good' to 'very reduced')\", x = \"Condition variable score\")\n\nnin.seminat2 %>%\n  filter(hovedtype == \"T34\") %>%\n  filter(NiN_variable_code %in% c(\"7JB-BT\", \"7RA-SJ\", \"7FA\", \"7TK\")) %>%\n  mutate(NiN_variable_des = recode(NiN_variable_code,\n    \"7JB-BT\" = \"Grazing pressure\",\n    \"7RA-SJ\" = \"Succession\",\n    \"7FA\" = \"Alien species\",\n    \"7TK\" = \"Heavy vehicles\"\n  )) %>%\n  ggplot(aes(x = NiN_variable_value, y = tilstand_num)) +\n  geom_point(size = 2) +\n  geom_jitter(width = 0.25, height = 0.25) +\n  facet_wrap(~NiN_variable_des, nrow = 2, ncol = 3) +\n  theme(legend.position = \"none\") +\n  ggtitle(\"Condition variables in coastal heathlands (T34)\") +\n  labs(y = \"Condition level (0-3='good' to 'very reduced')\", x = \"Condition variable score\")\n\nnin.seminat2 %>%\n  filter(hovedtype %in% c(\"T40\", \"T41\")) %>%\n  filter(NiN_variable_code %in% c(\"7JB-BA\", \"7RA-SJ\", \"7FA\", \"7SE\", \"7JB-GJ\")) %>%\n  mutate(NiN_variable_des = recode(NiN_variable_code,\n    \"7JB-BA\" = \"Land-use intensity\",\n    \"7RA-SJ\" = \"Succession\",\n    \"7FA\" = \"Alien species\",\n    \"7SE\" = \"Wear/tear\",\n    \"7JB-GJ\" = \"Fertilization\"\n  )) %>%\n  ggplot(aes(x = NiN_variable_value, y = tilstand_num)) +\n  geom_point(size = 2) +\n  geom_jitter(width = 0.25, height = 0.25) +\n  facet_wrap(~NiN_variable_des, nrow = 2, ncol = 3) +\n  theme(legend.position = \"none\") +\n  ggtitle(\"Condition variables in previously heavily altered grasslands (T40/T41)\") +\n  labs(y = \"Condition level (0-3='good' to 'very reduced')\", x = \"Condition variable score\")"},{"path":"NDVI-indicator-seminat.html","id":"regression-analyses-sentinel-2-ndvi-as-a-function-of-condition","chapter":"12 NDVI - Semi-natural Ecosystems","heading":"12.7.4 Regression analyses Sentinel-2, NDVI as a function of condition","text":"can investigate NDVI condition connected using\nregression analyses.First, take look balanced data across major\necosystem types, regions condition classes\nFigure 12.13: NDVI values across condition gradient, faceted six semi natural ecosystem types five regions Norway.\nT41 data present 2 regions , omit\n. Northern Norway T34 occurrences T33\nT40, won’t able model together regions,\nmight need model T31 T32 .NDVI data bounded -1 1, thus require modelling \nappropriate method can handle bounded data. can transform \nvariable bounded 0 1 use beta-regression models:NDVI values vary : - Regions - Ecosystem types - Condition\nclassesIt evident differences regions.\nsince interested statistics region differences,\nrun separate models every region ease interpretation.Northern Norway\nFigure 12.14: NDVI agains ecosystm condition five semi-natural ecosystems Northern Norway.\nNDVI good condition: T32 > T31/T33 > T40 (last sig. \ndata)T31,T33,T40: NDVI increases condition deteriorates T32: NDVI \nchange conditionCentral Norway\nFigure 12.15: NDVI ecosystem condition five semi-natural ecosystems Central Norway.\nNDVI good condition: T32 > T33/T34/T40 > T31T31: NDVI increases condition deteriorates T32/T33/T34/T40: NDVI\nincreases sig. less T31 condition deteriorates, still\nincreasesWestern Norway\nFigure 12.16: NDVI agains ecosystm condition five semi-natural ecosystems W-Norway.\nNDVI good condition: T31/T32/T40 > T33/T34all types: NDVI increases slightly condition deteriorates, just\nsig.Eastern Norway\nFigure 12.17: NDVI ecosystem condition five semi-natural ecosystems E-Norway.\nNDVI good condition: T32 > T31/T40 > T33 > T34T31/T32/T34/T40: NDVI increases slightly condition deteriorates T33:\nNDVI increases condition deteriorates, strongly \ntypesSouthern Norway\nFigure 12.18: NDVI ecosystem condition five semi-natural ecosystems S-Norway.\nNDVI good condition: T32 > T31/T40 > T33/T34T31/T32: borderline NDVI increases condition deteriorates T33/T34:\nNDVI increases condition deteriorates T40: insufficient powerOverall take home messages:semi-natural ecosystems NDVI increases ecosystem condition deteriorates, effect sizes vary major ecosystem types. Boreal heath shows consistent increases, also coastal meadows coastal heathlands show increases parts country. Semi-natural semi-natural-looking meadows show tiny increases .","code":"\n# NDVI across hovedtyper, regions and condition classes (only for NDVI years data matching NiN-mapping years)\nSentinelNDVI.seminat %>%\n  group_by(id, year) %>%\n  filter(!is.na(region)) %>%\n  filter(year == kartleggingsaar) %>%\n  ggplot(aes(x = tilstand, y = mean)) +\n  geom_violin() +\n  geom_point(size = 0.7, shape = 16, color = \"grey\") +\n  facet_grid(region ~ hovedtype) +\n  theme(axis.text.x = element_text(angle = -45, vjust = 0.5, hjust = 0.2, size = 9)) +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Condition\")\nSentinelNDVI.seminat$mean_beta <- (SentinelNDVI.seminat$mean + 1) / 2\n# NDVI data from the year of NiN-mapping (and thus with condition assessment) to train the condition models\n# we drop T41 for the analysis as it lacks data for most combinations of condition and region, and thus would cause convergence issues\nSentinelNDVI.seminat.train <- SentinelNDVI.seminat %>%\n  filter(year == kartleggingsaar) %>%\n  filter(hovedtype != \"T41\")\n\n# check if there's any 0s or 1s (which beta cannot handle)\nsummary(SentinelNDVI.seminat.train$mean_beta) # ok\n#>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n#>  0.6286  0.8323  0.8627  0.8541  0.8847  0.9333\nLandsatNDVI.seminat$mean_beta <- (LandsatNDVI.seminat$mean + 1) / 2\n# replace 1s in Landsat data with 0.9999\nLandsatNDVI.seminat <- LandsatNDVI.seminat %>%\n  mutate(mean_beta = replace(mean_beta, mean_beta == 1, 0.9999))\n# We run a stepwise-function on the full model including condition, ecosystem type, and region to find the most parsimonious model\nmodel.seminat.cond.Sent <- betareg(mean_beta ~ tilstand_num * region * hovedtype, data = SentinelNDVI.seminat.train[SentinelNDVI.seminat.train$region != \"Northern Norway\", ])\nmodel.seminat.cond.Sent <- StepBeta(model.seminat.cond.Sent)\nsummary(model.seminat.cond.Sent)\n\n# Caching\nsaveRDS(model.seminat.cond.Sent, \n        \"/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/cache/model.seminat.cond.Sent.rds\")\nmodel.seminat.cond.Sent.N <- betareg(mean_beta ~ tilstand_num * hovedtype, data = SentinelNDVI.seminat.train[SentinelNDVI.seminat.train$region == \"Northern Norway\" & SentinelNDVI.seminat.train$hovedtype != \"T34\", ])\nmodel.seminat.cond.Sent.C <- betareg(mean_beta ~ tilstand_num * hovedtype, data = SentinelNDVI.seminat.train[SentinelNDVI.seminat.train$region == \"Central Norway\", ])\nmodel.seminat.cond.Sent.W <- betareg(mean_beta ~ tilstand_num * hovedtype, data = SentinelNDVI.seminat.train[SentinelNDVI.seminat.train$region == \"Western Norway\", ])\nmodel.seminat.cond.Sent.E <- betareg(mean_beta ~ tilstand_num * hovedtype, data = SentinelNDVI.seminat.train[SentinelNDVI.seminat.train$region == \"Eastern Norway\", ])\nmodel.seminat.cond.Sent.S <- betareg(mean_beta ~ tilstand_num * hovedtype, data = SentinelNDVI.seminat.train[SentinelNDVI.seminat.train$region == \"Southern Norway\", ])\nSentinelNDVI.seminat.train %>%\n  filter(region == \"Northern Norway\") %>%\n  ggplot(aes(x = tilstand, y = mean)) +\n  geom_violin() +\n  geom_point(size = 0.7, shape = 16, color = \"grey\", position = position_jitter(.1) ) +\n  theme(axis.text.x = element_text(angle = -45, vjust = 0.5, hjust = 0.2, size = 9)) +\n  ggtitle(\"Northern Norway\") +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Condition\") +\n  facet_wrap(~hovedtype)\nsummary(model.seminat.cond.Sent.N)$coefficients\n#> $mean\n#>                              Estimate  Std. Error\n#> (Intercept)                1.64415534 0.010995779\n#> tilstand_num               0.07658679 0.007020091\n#> hovedtypeT32               0.32588773 0.015169077\n#> hovedtypeT33              -0.04037829 0.079834264\n#> hovedtypeT40              -0.09084877 0.054787510\n#> tilstand_num:hovedtypeT32 -0.06323568 0.008606086\n#> tilstand_num:hovedtypeT33  0.04215782 0.056292800\n#> tilstand_num:hovedtypeT40 -0.01336016 0.080919730\n#>                               z value      Pr(>|z|)\n#> (Intercept)               149.5260480  0.000000e+00\n#> tilstand_num               10.9096585  1.036450e-27\n#> hovedtypeT32               21.4836879 2.212261e-102\n#> hovedtypeT33               -0.5057765  6.130136e-01\n#> hovedtypeT40               -1.6582023  9.727665e-02\n#> tilstand_num:hovedtypeT32  -7.3477868  2.015156e-13\n#> tilstand_num:hovedtypeT33   0.7489025  4.539160e-01\n#> tilstand_num:hovedtypeT40  -0.1651039  8.688622e-01\n#> \n#> $precision\n#>       Estimate Std. Error  z value Pr(>|z|)\n#> (phi) 208.7112   5.124613 40.72722        0\nSentinelNDVI.seminat.train %>%\n  filter(region == \"Central Norway\") %>%\n  ggplot(aes(x = tilstand, y = mean)) +\n  geom_violin() +\n  geom_point(size = 0.7, shape = 16, color = \"grey\", position = position_jitter(.1) ) +\n  theme(axis.text.x = element_text(angle = -45, vjust = 0.5, hjust = 0.2, size = 9)) +\n  ggtitle(\"Central Norway\") +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Condition\") +\n  facet_wrap(~hovedtype)\nsummary(model.seminat.cond.Sent.C)$coefficients\n#> $mean\n#>                              Estimate Std. Error   z value\n#> (Intercept)                1.22774728 0.01731295 70.914970\n#> tilstand_num               0.15691924 0.01329505 11.802830\n#> hovedtypeT32               0.62582634 0.01963605 31.871297\n#> hovedtypeT33               0.27267266 0.02650528 10.287483\n#> hovedtypeT34               0.07427412 0.01938164  3.832189\n#> hovedtypeT40               0.26718403 0.03474356  7.690173\n#> tilstand_num:hovedtypeT32 -0.09927187 0.01432066 -6.932074\n#> tilstand_num:hovedtypeT33 -0.08603560 0.02475601 -3.475341\n#> tilstand_num:hovedtypeT34 -0.07170670 0.01439664 -4.980793\n#> tilstand_num:hovedtypeT40 -0.12411621 0.03869858 -3.207255\n#>                                Pr(>|z|)\n#> (Intercept)                0.000000e+00\n#> tilstand_num               3.774033e-32\n#> hovedtypeT32              6.673860e-223\n#> hovedtypeT33               8.024663e-25\n#> hovedtypeT34               1.270081e-04\n#> hovedtypeT40               1.469358e-14\n#> tilstand_num:hovedtypeT32  4.147161e-12\n#> tilstand_num:hovedtypeT33  5.102038e-04\n#> tilstand_num:hovedtypeT34  6.332410e-07\n#> tilstand_num:hovedtypeT40  1.340081e-03\n#> \n#> $precision\n#>       Estimate Std. Error  z value Pr(>|z|)\n#> (phi) 119.0685   2.215105 53.75297        0\nSentinelNDVI.seminat.train %>%\n  filter(region == \"Western Norway\") %>%\n  ggplot(aes(x = tilstand, y = mean)) +\n  geom_violin() +\n  geom_point(size = 0.7, shape = 16, color = \"grey\", position = position_jitter(.1) ) +\n  theme(axis.text.x = element_text(angle = -45, vjust = 0.5, hjust = 0.2, size = 9)) +\n  ggtitle(\"Western Norway\") +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Condition\") +\n  facet_wrap(~hovedtype)\nsummary(model.seminat.cond.Sent.W)$coefficients\n#> $mean\n#>                               Estimate Std. Error\n#> (Intercept)                1.735847267 0.05313826\n#> tilstand_num               0.057295177 0.02511492\n#> hovedtypeT32               0.083194970 0.05376401\n#> hovedtypeT33              -0.334452794 0.06349165\n#> hovedtypeT34              -0.260143425 0.05477030\n#> hovedtypeT40              -0.085010435 0.06743251\n#> tilstand_num:hovedtypeT32 -0.005239066 0.02561689\n#> tilstand_num:hovedtypeT33 -0.018241211 0.03678248\n#> tilstand_num:hovedtypeT34  0.003840380 0.02579273\n#> tilstand_num:hovedtypeT40 -0.039969775 0.04700781\n#>                              z value      Pr(>|z|)\n#> (Intercept)               32.6666195 4.654419e-234\n#> tilstand_num               2.2813203  2.252950e-02\n#> hovedtypeT32               1.5474100  1.217644e-01\n#> hovedtypeT33              -5.2676656  1.381695e-07\n#> hovedtypeT34              -4.7497167  2.037018e-06\n#> hovedtypeT40              -1.2606743  2.074262e-01\n#> tilstand_num:hovedtypeT32 -0.2045161  8.379502e-01\n#> tilstand_num:hovedtypeT33 -0.4959212  6.199500e-01\n#> tilstand_num:hovedtypeT34  0.1488939  8.816373e-01\n#> tilstand_num:hovedtypeT40 -0.8502795  3.951697e-01\n#> \n#> $precision\n#>       Estimate Std. Error  z value Pr(>|z|)\n#> (phi) 128.1346    2.73882 46.78459        0\nSentinelNDVI.seminat.train %>%\n  filter(region == \"Eastern Norway\") %>%\n  ggplot(aes(x = tilstand, y = mean)) +\n  geom_violin() +\n  geom_point(size = 0.7, shape = 16, color = \"grey\", position = position_jitter(.1) ) +\n  theme(axis.text.x = element_text(angle = -45, vjust = 0.5, hjust = 0.2, size = 9)) +\n  ggtitle(\"Eastern Norway\") +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Condition\") +\n  facet_wrap(~hovedtype)\nsummary(model.seminat.cond.Sent.E)$coefficients\n#> $mean\n#>                                Estimate  Std. Error\n#> (Intercept)                1.6546047246 0.016449665\n#> tilstand_num               0.0263501777 0.008052426\n#> hovedtypeT32               0.2002941827 0.018021762\n#> hovedtypeT33              -0.2773641962 0.036663349\n#> hovedtypeT34              -0.8724991879 0.173082055\n#> hovedtypeT40              -0.0002143578 0.025184855\n#> tilstand_num:hovedtypeT32  0.0081680904 0.008958606\n#> tilstand_num:hovedtypeT33  0.0737223863 0.025204980\n#> tilstand_num:hovedtypeT34  0.0361838511 0.116924722\n#> tilstand_num:hovedtypeT40  0.0067977292 0.018495037\n#>                                 z value     Pr(>|z|)\n#> (Intercept)               100.585920439 0.000000e+00\n#> tilstand_num                3.272327931 1.066658e-03\n#> hovedtypeT32               11.114017527 1.072244e-28\n#> hovedtypeT33               -7.565162528 3.873799e-14\n#> hovedtypeT34               -5.040956959 4.632096e-07\n#> hovedtypeT40               -0.008511377 9.932090e-01\n#> tilstand_num:hovedtypeT32   0.911759109 3.618955e-01\n#> tilstand_num:hovedtypeT33   2.924913468 3.445520e-03\n#> tilstand_num:hovedtypeT34   0.309462793 7.569695e-01\n#> tilstand_num:hovedtypeT40   0.367543424 7.132137e-01\n#> \n#> $precision\n#>       Estimate Std. Error  z value Pr(>|z|)\n#> (phi) 146.5212   2.806937 52.19967        0\nSentinelNDVI.seminat.train %>%\n  filter(region == \"Southern Norway\") %>%\n  ggplot(aes(x = tilstand, y = mean)) +\n  geom_violin() +\n  geom_point(size = 0.7, shape = 16, color = \"grey\", position = position_jitter(.1) ) +\n  theme(axis.text.x = element_text(angle = -45, vjust = 0.5, hjust = 0.2, size = 9)) +\n  ggtitle(\"Southern Norway\") +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Condition\") +\n  facet_wrap(~hovedtype)\nsummary(model.seminat.cond.Sent.S)$coefficients\n#> $mean\n#>                               Estimate Std. Error\n#> (Intercept)                1.659442006 0.02805242\n#> tilstand_num               0.031677650 0.01582980\n#> hovedtypeT32               0.209644262 0.03143978\n#> hovedtypeT33              -0.141424820 0.05424488\n#> hovedtypeT34              -0.095889437 0.07510055\n#> hovedtypeT40              -0.135125543 0.05475481\n#> tilstand_num:hovedtypeT32  0.003853678 0.01755278\n#> tilstand_num:hovedtypeT33  0.052543902 0.02912373\n#> tilstand_num:hovedtypeT34  0.095449312 0.03230053\n#> tilstand_num:hovedtypeT40 -0.049736550 0.06712609\n#>                              z value     Pr(>|z|)\n#> (Intercept)               59.1550299 0.000000e+00\n#> tilstand_num               2.0011409 4.537721e-02\n#> hovedtypeT32               6.6681208 2.590995e-11\n#> hovedtypeT33              -2.6071554 9.129791e-03\n#> hovedtypeT34              -1.2768141 2.016679e-01\n#> hovedtypeT40              -2.4678295 1.359350e-02\n#> tilstand_num:hovedtypeT32  0.2195480 8.262232e-01\n#> tilstand_num:hovedtypeT33  1.8041611 7.120606e-02\n#> tilstand_num:hovedtypeT34  2.9550388 3.126297e-03\n#> tilstand_num:hovedtypeT40 -0.7409422 4.587285e-01\n#> \n#> $precision\n#>       Estimate Std. Error  z value      Pr(>|z|)\n#> (phi) 153.2421   5.511914 27.80198 4.105499e-170"},{"path":"NDVI-indicator-seminat.html","id":"ndvi-across-time---sentinel-modis-landsat","chapter":"12 NDVI - Semi-natural Ecosystems","heading":"12.7.5 NDVI across time - Sentinel, MODIS & LandSat","text":"last step, can investigate NDVI changed time. \ninclude data MODIS Landsat addition \nSentinel-2.First, ’s data handling . merge Sentinel,\nMODIS, Landsat data show full picture across time. \nmodel time series Satellite separately.Now can plot time series main ecosystem type, showing\nsatellite time series separately:\nFigure 12.19: Comparing NDVI time series three data sets.\nquite obvious NDVI values three satellites \nquantitatively comparable. vary placement along\ny-axis variance. Modis data absent \nT40/T41-ecosystem types large pixel size compared \nNiN-polygon sizes. types, Modis poorly represented\nreason.can test consistent temporal changes NDVI running\nregressions including year covariate.first investigate model testing NDVI function year main\necosystem type polygons good condition, separately\nsatellite.’s increase NDVI time mainly Sentinel Landsat\ntime series boreal heath good condition, pattern \nreduced absent semi-natural ecosystem types. MODIS \nshow trends time also way less statistical power\ncompared Sentinel Landsat.Given consistently higher NDVI-values decreasing condition \nboreal heath, may ask question temporal NDVI increase\nmight stronger reduced condition?temporal NDVI increase boreal heath stronger \nreduced ecological condition. temporal NDVI approach seem\nlike promising way go.check pattern T32 \nT34, just semi-natural major ecosystem types\nsubstantial number occurrences NiN data. ’s code , stored later., patterns identifiable Sentinel Landsat data,\nModis. Semi-natural grasslands (T32) indeed show \nstronger increase NDVI condition deteriorates, temporal\napproach may useful reduced\nland-management/shrub-/tree-encroachment scenario. Coastal heathlands\n(T34), hand, show stronger temporal increases \nreduced condition. Coastal heathlands subject management cycle,\nincludes developmental successional changes course \n15-25 years followed prescribed burning resets process.\n, expect increases greenness coastal heathlands \ntime also well-managed areas, thus temporal changes NDVI \nlargely irrelevant assessing ecological condition.","code":"\n## data handling for time series analysis\n# Sentinel time series checked in exploratory analysis script\n\n# checking time series for MODIS\n   #ModisNDVI.seminat %>%\n   #  group_by(id, year) %>%\n   #  filter(mean == max(mean, na.rm = TRUE)) %>%\n   #  ggplot(aes(x = year, y = mean)) +\n   #  geom_point() +\n   #  facet_wrap(~hovedtype)\n# 2022 does not stand out as in the Sentinel data, so we keep it\nModisNDVI.seminat <- ModisNDVI.seminat %>%\n  group_by(id, year) %>%\n  filter(mean == max(mean, na.rm = TRUE))\n\n# checking time series for Landsat\n   #LandsatNDVI.seminat %>%\n   #  group_by(id, year) %>%\n   #  filter(mean == max(mean, na.rm = TRUE)) %>%\n   #  ggplot(aes(x = year, y = mean)) +\n   #  geom_point() +\n   #  facet_wrap(~hovedtype)\n# nothing worrying to see here either\nLandsatNDVI.seminat <- LandsatNDVI.seminat %>%\n  group_by(id, year) %>%\n  filter(mean == max(mean, na.rm = TRUE))\n\n# transformation of NDVI scale to beta scale\n# SentinelNDVI.seminat$mean_beta <- (SentinelNDVI.seminat$mean + 1) / 2\nModisNDVI.seminat$mean_beta <- (ModisNDVI.seminat$mean + 1) / 2\nLandsatNDVI.seminat$mean_beta <- (LandsatNDVI.seminat$mean + 1) / 2\n\n# check if there's any 0s or 1s (which beta cannot handle)\nsummary(SentinelNDVI.seminat$mean_beta) # ok\nsummary(ModisNDVI.seminat$mean_beta) # ok\nsummary(LandsatNDVI.seminat$mean_beta) # has 1's\n# replace 1s in Landsat data with 0.9999\nLandsatNDVI.seminat <- LandsatNDVI.seminat %>%\n  mutate(mean_beta = replace(mean_beta, mean_beta == 1, 0.9999))\n\n# check if the three Satellite objects have the same structure (for concatenating them)\nnames(SentinelNDVI.seminat)\nnames(ModisNDVI.seminat)\nnames(LandsatNDVI.seminat)\n# Sentinel and Landsat have each an extra column -> omit them when concatenating further below\n# one column is named slightly differently in the Sentinel data -> rename it\nSentinelNDVI.seminat <- SentinelNDVI.seminat %>%\n  dplyr::rename(\"system.index\" = \"system:index\")\n\n# check if they have the same geometry\nst_crs(SentinelNDVI.seminat)\nst_crs(ModisNDVI.seminat)\nst_crs(LandsatNDVI.seminat)\n# all good\n\n# add an increment to the year variable to avoid overlapping data being hidden in figures\nSentinelNDVI.seminat$year_jit <- SentinelNDVI.seminat$year + 0.3\nModisNDVI.seminat$year_jit <- ModisNDVI.seminat$year - 0.3\nLandsatNDVI.seminat$year_jit <- LandsatNDVI.seminat$year\n\n# concatenate the three Satellite objects\nallSatNDVI.seminat <- rbind(\n  SentinelNDVI.seminat[, !names(SentinelNDVI.seminat) %in% \"subtype\"],\n  ModisNDVI.seminat,\n  LandsatNDVI.seminat[, !names(LandsatNDVI.seminat) %in% \"column_label\"]\n)\n# add variable for Satellite identity\nallSatNDVI.seminat$Sat <- c(\n  rep(\"Sentinel\", nrow(SentinelNDVI.seminat)),\n  rep(\"Modis\", nrow(ModisNDVI.seminat)),\n  rep(\"Landsat\", nrow(LandsatNDVI.seminat))\n)\nallSatNDVI.seminat$Sat <- factor(allSatNDVI.seminat$Sat, levels = c(\"Sentinel\", \"Modis\", \"Landsat\"))\nlevels(allSatNDVI.seminat$Sat)\n# plot\nallSatNDVI.seminat %>%\n  ggplot(aes(x = year_jit, y = mean, color = Sat)) +\n  geom_point() +\n  ggtitle(\"NDVI across time\") +\n  labs(y = \"NDVI values\", x = \"Year\") +\n  facet_wrap(~hovedtype, ncol = 1)\nmodel.seminat.time.GodTilst.Sent <- glmmTMB(mean_beta ~ year * hovedtype + (1 | id), family = beta_family(), data = SentinelNDVI.seminat[SentinelNDVI.seminat$tilstand == \"God\", ])\nmodel.seminat.time.GodTilst.Modi <- glmmTMB(mean_beta ~ year * hovedtype + (1 | id), family = beta_family(), data = ModisNDVI.seminat[ModisNDVI.seminat$tilstand == \"God\", ])\nmodel.seminat.time.GodTilst.Land <- glmmTMB(mean_beta ~ year * hovedtype + (1 | id), family = beta_family(), data = LandsatNDVI.seminat[LandsatNDVI.seminat$tilstand == \"God\", ])\nsummary(model.seminat.time.GodTilst.Sent)$coefficients$cond\n#>                        Estimate   Std. Error     z value\n#> (Intercept)       -45.780951305  3.081255872 -14.8578869\n#> year                0.023458652  0.001526906  15.3635239\n#> hovedtypeT32       26.244560360  3.242217032   8.0946340\n#> hovedtypeT33       12.760090321  4.237644667   3.0111280\n#> hovedtypeT34      -19.042562520  3.602208159  -5.2863582\n#> hovedtypeT40       28.738193372  4.289513342   6.6996396\n#> hovedtypeT41      -15.690936569 31.070809016  -0.5050057\n#> year:hovedtypeT32  -0.012861099  0.001606667  -8.0048299\n#> year:hovedtypeT33  -0.006381392  0.002099939  -3.0388456\n#> year:hovedtypeT34   0.009328309  0.001785065   5.2257530\n#> year:hovedtypeT40  -0.014212323  0.002125635  -6.6861550\n#> year:hovedtypeT41   0.008020360  0.015397374   0.5208914\n#>                       Pr(>|z|)\n#> (Intercept)       6.184530e-50\n#> year              2.875127e-53\n#> hovedtypeT32      5.743676e-16\n#> hovedtypeT33      2.602791e-03\n#> hovedtypeT34      1.247755e-07\n#> hovedtypeT40      2.089342e-11\n#> hovedtypeT41      6.135548e-01\n#> year:hovedtypeT32 1.196319e-15\n#> year:hovedtypeT33 2.374866e-03\n#> year:hovedtypeT34 1.734478e-07\n#> year:hovedtypeT40 2.291104e-11\n#> year:hovedtypeT41 6.024424e-01\nsummary(model.seminat.time.GodTilst.Modi)$coefficients$cond\n#>                        Estimate  Std. Error    z value\n#> (Intercept)        0.9417938119 2.404923160  0.3916108\n#> year               0.0005957467 0.001195488  0.4983291\n#> hovedtypeT32      -0.7198852149 3.147259223 -0.2287340\n#> hovedtypeT33      -9.0494604384 6.513110325 -1.3894223\n#> hovedtypeT34      10.4299968766 2.611678729  3.9935987\n#> year:hovedtypeT32  0.0004530230 0.001564548  0.2895551\n#> year:hovedtypeT33  0.0044483793 0.003237828  1.3738775\n#> year:hovedtypeT34 -0.0053189040 0.001298233 -4.0970321\n#>                       Pr(>|z|)\n#> (Intercept)       6.953458e-01\n#> year              6.182521e-01\n#> hovedtypeT32      8.190757e-01\n#> hovedtypeT33      1.647044e-01\n#> hovedtypeT34      6.507796e-05\n#> year:hovedtypeT32 7.721566e-01\n#> year:hovedtypeT33 1.694797e-01\n#> year:hovedtypeT34 4.184809e-05\nsummary(model.seminat.time.GodTilst.Land)$coefficients$cond\n#>                        Estimate   Std. Error     z value\n#> (Intercept)       -2.178073e+01 0.4411725413 -49.3701030\n#> year               1.171816e-02 0.0002202274  53.2093510\n#> hovedtypeT32       5.090566e+00 0.4696298758  10.8395273\n#> hovedtypeT33       6.886573e+00 0.7448223401   9.2459269\n#> hovedtypeT34       8.433829e+00 0.5162507377  16.3366909\n#> hovedtypeT40      -3.864882e-01 0.8262214619  -0.4677779\n#> year:hovedtypeT32 -2.395131e-03 0.0002344365 -10.2165460\n#> year:hovedtypeT33 -3.499599e-03 0.0003717377  -9.4141633\n#> year:hovedtypeT34 -4.304575e-03 0.0002576806 -16.7050824\n#> year:hovedtypeT40  1.969451e-04 0.0004124556   0.4774941\n#>                       Pr(>|z|)\n#> (Intercept)       0.000000e+00\n#> year              0.000000e+00\n#> hovedtypeT32      2.236234e-27\n#> hovedtypeT33      2.332105e-20\n#> hovedtypeT34      5.411108e-60\n#> hovedtypeT40      6.399434e-01\n#> year:hovedtypeT32 1.671925e-24\n#> year:hovedtypeT33 4.768650e-21\n#> year:hovedtypeT34 1.203615e-62\n#> year:hovedtypeT40 6.330103e-01\nmodel.seminat.time.tilst.T31.Sent <- glmmTMB(mean_beta ~ year * tilstand + (1 | id), family = beta_family(), data = SentinelNDVI.seminat[SentinelNDVI.seminat$hovedtype %in% c(\"T31\"), ])\nmodel.seminat.time.tilst.T31.Modi <- glmmTMB(mean_beta ~ year * tilstand + (1 | id), family = beta_family(), data = ModisNDVI.seminat[ModisNDVI.seminat$hovedtype %in% c(\"T31\"), ])\nmodel.seminat.time.tilst.T31.Land <- glmmTMB(mean_beta ~ year * tilstand + (1 | id), family = beta_family(), data = LandsatNDVI.seminat[LandsatNDVI.seminat$hovedtype %in% c(\"T31\"), ])\nsummary(model.seminat.time.tilst.T31.Sent)$coefficients$cond\n#>                                   Estimate  Std. Error\n#> (Intercept)                  -4.575579e+01 3.120798729\n#> year                          2.344589e-02 0.001546508\n#> tilstandModerat               6.019395e-02 3.297959059\n#> tilstandRedusert              1.011284e+01 3.577419807\n#> tilstandSvaert_redusert      -9.457218e-01 3.651673254\n#> year:tilstandModerat         -2.646114e-05 0.001634299\n#> year:tilstandRedusert        -4.942408e-03 0.001772783\n#> year:tilstandSvaert_redusert  5.537298e-04 0.001809584\n#>                                   z value     Pr(>|z|)\n#> (Intercept)                  -14.66156419 1.136249e-48\n#> year                          15.16054003 6.453651e-52\n#> tilstandModerat                0.01825188 9.854379e-01\n#> tilstandRedusert               2.82685399 4.700776e-03\n#> tilstandSvaert_redusert       -0.25898313 7.956483e-01\n#> year:tilstandModerat          -0.01619112 9.870819e-01\n#> year:tilstandRedusert         -2.78793699 5.304486e-03\n#> year:tilstandSvaert_redusert   0.30599834 7.596059e-01\nsummary(model.seminat.time.tilst.T31.Modi)$coefficients$cond\n#>                                   Estimate   Std. Error\n#> (Intercept)                   0.9376760636 1.9284718315\n#> year                          0.0005998599 0.0009586688\n#> tilstandModerat               0.8882297240 2.0971098697\n#> tilstandRedusert              4.3529934686 2.3864880714\n#> tilstandSvaert_redusert       1.3122148220 2.3407551762\n#> year:tilstandModerat         -0.0004437392 0.0010424992\n#> year:tilstandRedusert        -0.0020959207 0.0011863530\n#> year:tilstandSvaert_redusert -0.0006143634 0.0011636174\n#>                                 z value   Pr(>|z|)\n#> (Intercept)                   0.4862275 0.62680587\n#> year                          0.6257218 0.53149746\n#> tilstandModerat               0.4235494 0.67189443\n#> tilstandRedusert              1.8240164 0.06814959\n#> tilstandSvaert_redusert       0.5605946 0.57507390\n#> year:tilstandModerat         -0.4256494 0.67036332\n#> year:tilstandRedusert        -1.7666923 0.07727977\n#> year:tilstandSvaert_redusert -0.5279772 0.59751516\nsummary(model.seminat.time.tilst.T31.Land)$coefficients$cond\n#>                                   Estimate   Std. Error\n#> (Intercept)                  -2.179185e+01 0.4337005742\n#> year                          1.172387e-02 0.0002165269\n#> tilstandModerat               9.872640e-01 0.4581637325\n#> tilstandRedusert              1.055443e+00 0.4974375073\n#> tilstandSvaert_redusert       5.571359e+00 0.5074515791\n#> year:tilstandModerat         -4.819522e-04 0.0002287408\n#> year:tilstandRedusert        -4.465030e-04 0.0002483586\n#> year:tilstandSvaert_redusert -2.684806e-03 0.0002533521\n#>                                 z value     Pr(>|z|)\n#> (Intercept)                  -50.246300 0.000000e+00\n#> year                          54.145093 0.000000e+00\n#> tilstandModerat                2.154828 3.117531e-02\n#> tilstandRedusert               2.121760 3.385794e-02\n#> tilstandSvaert_redusert       10.979095 4.817235e-28\n#> year:tilstandModerat          -2.106980 3.511935e-02\n#> year:tilstandRedusert         -1.797815 7.220627e-02\n#> year:tilstandSvaert_redusert -10.597132 3.072578e-26\nmodel.seminat.time.tilst.T32.Sent <- glmmTMB(mean_beta ~ year * tilstand + (1 | id), family = beta_family(), data = SentinelNDVI.seminat[SentinelNDVI.seminat$hovedtype %in% c(\"T32\"), ])\nmodel.seminat.time.tilst.T32.Modi <- glmmTMB(mean_beta ~ year * tilstand + (1 | id), family = beta_family(), data = ModisNDVI.seminat[ModisNDVI.seminat$hovedtype %in% c(\"T32\"), ])\nmodel.seminat.time.tilst.T32.Land <- glmmTMB(mean_beta ~ year * tilstand + (1 | id), family = beta_family(), data = LandsatNDVI.seminat[LandsatNDVI.seminat$hovedtype %in% c(\"T32\"), ])\nsummary(model.seminat.time.tilst.T32.Sent)$coefficients$cond\nsummary(model.seminat.time.tilst.T32.Modi)$coefficients$cond\nsummary(model.seminat.time.tilst.T32.Land)$coefficients$cond\n\nmodel.seminat.time.tilst.T34.Sent <- glmmTMB(mean_beta ~ year * tilstand + (1 | id), family = beta_family(), data = SentinelNDVI.seminat[SentinelNDVI.seminat$hovedtype %in% c(\"T34\"), ])\nmodel.seminat.time.tilst.T34.Modi <- glmmTMB(mean_beta ~ year * tilstand + (1 | id), family = beta_family(), data = ModisNDVI.seminat[ModisNDVI.seminat$hovedtype %in% c(\"T34\"), ])\nmodel.seminat.time.tilst.T34.Land <- glmmTMB(mean_beta ~ year * tilstand + (1 | id), family = beta_family(), data = LandsatNDVI.seminat[LandsatNDVI.seminat$hovedtype %in% c(\"T34\"), ])\nsummary(model.seminat.time.tilst.T34.Sent)$coefficients$cond\nsummary(model.seminat.time.tilst.T34.Modi)$coefficients$cond\nsummary(model.seminat.time.tilst.T34.Land)$coefficients$cond"},{"path":"NDVI-indicator-seminat.html","id":"overall-conclusion-1","chapter":"12 NDVI - Semi-natural Ecosystems","heading":"12.8 Overall conclusion","text":"NDVI semi-natural ecosystem vary condition also \necosystem type, variance thus overlap condition\nclasses ecosystem types large. Especially boreal heath \nsemi-natural grasslands greenness change time appear \nindicative ecological condition local ecosystems, linking well\nregistered condition variables behind lower condition scores\n(shrub/tree encroachment, low land-use intensity, succession) thus\nreduced land-use main pressure identified systems.\nHowever, large variance thus overlap condition classes\necosystem types makes generally difficult define useful\nscaling values absolute NDVI values. Since ecological condition also\nrelates temporal development NDVI values semi-natural\ngrasslands, potential way way approach can define\nscaling values time slopes instance done \nNDVI indicator ecological condition assessment Norwegian\nmountains (Framstad et al. 2022 references , see coded example\nhttps://ninanor.github.io/IBECA/ndvi-trend_fjell.html).Beyond considerations, two general issues limit \ncomprehensive robust application satellite based NDVI-data\necological condition context:lacking ecosystem maps semi-natural ecosystems\nanalysis hand clearly shows different semi-natural ecosystem\ntypes display different greenness levels thus need evaluated\nseparately. Thus, need ecosystem maps, allow us treat NDVI\nvalues, temporal changes , least different major\necosystem types within semi-natural systems separately.lacking good ecological understanding ground-truthing NDVI \nsemi-natural ecosystems Unlike ecosystems like forests, tundra,\nsavannah similar, little empirical work ground-truthing\ndata documented link NDVI values ecological phenomena \nsemi-natural systems. , need field studies investigating \nthoroughly NDVI ecological drivers, like example shrub-/tree\nencroachment, connected. includes need understanding\ntemporal increases NDVI ecosystems good condition.addition, investigations test NDVI-condition\npattern vary across biogeographic regions addition administrative\nregions (ecologically irrelevant), order better\nunderstand results administrative regions.","code":""},{"path":"NDVI-indicator-seminat.html","id":"eksport-file-final-product-2","chapter":"12 NDVI - Semi-natural Ecosystems","heading":"12.8.1 Eksport file (final product)","text":"","code":""},{"path":"NDVI-indicator-wetland.html","id":"NDVI-indicator-wetland","chapter":"13 NDVI - wetland ecosystems","heading":"13 NDVI - wetland ecosystems","text":"NDVI (greenness) indicator, wetland ecosystems Norwegian name: Primærproduksjon Author date:Joachim Töpper, Tessa BargmannSeptember 2023","code":""},{"path":"NDVI-indicator-wetland.html","id":"intro-ndviw","chapter":"13 NDVI - wetland ecosystems","heading":"13.1 Introduction","text":"Normalized difference vegetation index (NDVI) can used describe greenness area,\nmay thus represent proxy amount chlorophyll plant productivity given area.\nDifferent ecosystem types naturally greenness signals different intensity also certain variance.\nDeviations beyond natural variation either direction may indicate reduction ecological condition given ecosystem.\nE.g. lower normal NDVI may indicate excessive disturbance, higher normal NDVI may indicate regrowth transitions towards densely vegetated systems.\nrecent assessments ecological condition forest mountain ecosystems, two different NDVI-based indicators developed applied.\nforests, NDVI-values across country compared spatial reference NDVI-signal protected areas (Framstad et al. 2020).\nmountains, extent consistence temporal change NDVI-values last twenty years assessed (Framstad et al 2021).\ncases, NDVI-product MODIS satellite reflectance imagery used based available maps spatial ecosystem extent Norway (.e. national maps forest mountain ecosystems)., explore potential developing NDVI-indicator ecological condition representing open wetland ecosystems (.e. excluding forest swamps).\ntask, three initial challenges can identified early :don’t yet national wetland map, .e. don’t know exact locations wetlands Norway, prerequisite extract satellite data right locations ecosystems, thus achieve good unbiased spatial representation assessment area.spatial extent single wetland ecosystem occurrences (hereafter ‘polygons’) includes many wetland areas way smaller pixel size MODIS imagery (250 x 250 m) used forests mountains time series back year 2000.NDVI wetland systems lacks thorough ground-truthing known globally large ecosystems forests, tundra Savannah. Normal variation, like stochastic rain events moss moisture status may influence NDVI signals greatly (Valøen, 2019). current understanding NDVI changes different wetland ecosystems mean thus limited.draft development wetland NDVI indicator ecological condition approach challenges following ways:use ecosystem occurrence data NiN-mapping guide extraction satellite NDVI data pixels representing right ecosystem. However, ecosystem occurrences NiN data highly spatially biased thus provide good unbiased spatial representation assessment area. work therefore represents concept method development may applied assessment ecological condition spatially unbiased occurrence data national map wetland ecosystems available.include Sentinel-2 imagery wetland ecosystems resolution bands underlying NDVI product 10 x 10 m smaller almost wetland polygons NiN-data. However, since Sentinel-2 goes back 2015, lose much time series aspect compared MODIS data. addition, include Landsat imagery goes back 1984 resolution 30 x 30 m, also variable data due less frequent seasonal measurements. also still explore NDVI data MODIS (see details ).","code":""},{"path":"NDVI-indicator-wetland.html","id":"underlying-data-ndviw","chapter":"13 NDVI - wetland ecosystems","heading":"13.2 About the underlying data","text":"NDVI project wetlands, use two kinds data (coming four datasets) building indicators ecological condition:NiN ecosystem data ‘Naturtypekartlegging etter Miljødirektoratets instruks’ guide extraction NDVI data right locations provide information field-assessed ecological condition mapped polygonsremote sensed NDVI data\nSentinel-2 satellite NDVI data\nMODIS satellite NDVI data\nLandsat satellite NDVI data\nSentinel-2 satellite NDVI dataMODIS satellite NDVI dataLandsat satellite NDVI dataNiN ecosystem data:\nNiN data study contain data ecosystem categories (cf. Halvorsen et al. 2020) present mapped sites wall spatial delimitation (form polygons). Since use NiN data collected following ‘Miljødirektoratets instruks’, data also include information ecological condition underlying condition variabels mapped sites (see Miljødirektoratets mapping manual details).\nPolygon sizes NiN data may vary <100 sqm dimension sqkm’s.NiN ecosystem data:\nNiN data study contain data ecosystem categories (cf. Halvorsen et al. 2020) present mapped sites wall spatial delimitation (form polygons). Since use NiN data collected following ‘Miljødirektoratets instruks’, data also include information ecological condition underlying condition variabels mapped sites (see Miljødirektoratets mapping manual details).\nPolygon sizes NiN data may vary <100 sqm dimension sqkm’s.NDVI data:\nNDVI data used work hand pixel means polygons NiN-data, .e. NiN polygon represented one NDVI value per measurement time (see details temporal resolution NDVI data). respect , make sense use NDVI data polygons least size resolution respective satellite, thus excluded polygons smaller satellite’s resolution.NDVI data:\nNDVI data used work hand pixel means polygons NiN-data, .e. NiN polygon represented one NDVI value per measurement time (see details temporal resolution NDVI data). respect , make sense use NDVI data polygons least size resolution respective satellite, thus excluded polygons smaller satellite’s resolution.(2a) Sentinel-2 satellite NDVI data:\nSentinel data resolution 10 x 10 m, thus excluded NiN-polygons smaller 100 sqm. Sentinel-2 revisit frequency 10 days thus provide enough measurements peak growing season provide robust measure maximum greenness.(2b) MODIS satellite NDVI data:\nMODIS data resolution 250 x 250 m, thus excluded NiN-polygons smaller 62500 sqm. MODIS revisit frequency 1-2 days thus provides extensive sample provide robust measure maximum greenness.(2c) Landsat satellite NDVI data:\nLandsat data resolution 30 x 30 m, thus excluded NiN-polygons smaller 900 sqm. Landsat revisit frequency 16 days thus provides poorest growing season sample among available NDVI data robust measure maximum greenness.","code":""},{"path":"NDVI-indicator-wetland.html","id":"representativity-ndviw","chapter":"13 NDVI - wetland ecosystems","heading":"13.2.1 Representativity in time and space","text":"wetlands, NiN data contain 6502 wetland polygons known area size across mainland Norway. However, NiN-mapping planned performed spatially representative way thus ecosystem occurrences spatial extent treated spatially biased. 6502 wetland polygons distributed across regions major ecosystem types following way:addition, 3 V3s, 1 V4, 4 V9s, 9 V10s assigned region. (polygons likely lie water thus outside regional polygons due imprecise coordinates mapping device).NDVI data either satellite follow spatial distribution bias status NiN-data.\nDue larger number excluded polygons NDVI data MODIS (large pixel size MODIS, see ),\nMODIS NDVI data wetland occurrences NiN data likely even spatially biased case NDVI data Sentinel-2 Landsat.","code":""},{"path":"NDVI-indicator-wetland.html","id":"temporal-coverage-temp-cov-ndvis","chapter":"13 NDVI - wetland ecosystems","heading":"13.2.2 Temporal coverage {#temp-cov-ndvis","text":"currently available NiN data wetland ecosystems span time period 2018-2021 thus represent contemporary sample ecosystem occurrences.\nNote none polygons NiN-data visited period.Available Sentinel-2 satellite NDVI data span years 2015-2022.Available MODIS satellite NDVI data span years 2000-2022.Available Landsat satellite NDVI data span years 1984-2021.","code":""},{"path":"NDVI-indicator-wetland.html","id":"coll-ndvis","chapter":"13 NDVI - wetland ecosystems","heading":"13.3 Collinearities with other indicators","text":"NDVI signal may likely co-linear re-growth indicator based LiDAR derived canopy height drained wetland areas shrub tree encroachment.","code":""},{"path":"NDVI-indicator-wetland.html","id":"ref-state-ndviw","chapter":"13 NDVI - wetland ecosystems","heading":"13.4 Reference state and values","text":"","code":""},{"path":"NDVI-indicator-wetland.html","id":"ref-state2-ndviw","chapter":"13 NDVI - wetland ecosystems","heading":"13.4.1 Reference state and scaling values","text":"indicator project mainly exploratory, mapping possibilities lacking prerequisites satellite derived NDVI data inform ecological condition assessments.\nTherefore, lack concise strategy define reference state, especially prior access ecosystem map wetland ecosystems (cf. Jakobsson et al. 2020, Töpper & Jakobsson 2021).\nexploratory work, use condition classification NiN-data explorehow NDVI connects wetland ecology condition andits applicability defining reference state.use statistical models test whether NDVI varies systematically condition across time.","code":""},{"path":"NDVI-indicator-wetland.html","id":"uncertainties-ndviw","chapter":"13 NDVI - wetland ecosystems","heading":"13.5 Uncertainties","text":"Given condition index can achieved, can calculate mean indicator value (scaling) every region\n(delimited area interest) well corresponding standard error standard deviation \nmeasure spatial uncertainty geographical area (see Töpper & Jakobsson 2021).","code":""},{"path":"NDVI-indicator-wetland.html","id":"references-11","chapter":"13 NDVI - wetland ecosystems","heading":"13.6 References","text":"Framstad, E., Kolstad, . L., Nybø, S., Töpper, J. & Vandvik, V. 2022. condition forest mountain ecosystems Norway. Assessment IBECA method. NINA Report 2100. Norwegian Institute Nature Research.Halvorsen, R., Skarpaas, O., Bryn, ., Bratli, H., Erikstad, L., Simensen, T., & Lieungh, E. (2020). Towards systematics ecodiversity: EcoSyst framework. Global Ecology Biogeography, 29(11), 1887-1906. doi:10.1111/geb.13164Jakobsson, S., Töpper, J.P., Evju, M., Framstad, E., Lyngstad, ., Pedersen, B., Sickel, H., Sverdrup-Thygeson, ., Vandvik. V., Velle, L.G., Aarrestad, P.. & Nybø, S. 2020. Setting reference levels limits good ecological condition terrestrial ecosystems. Insights case study based IBECA approach. Ecological Indicators 116: 106492.Miljødiretoratets mapping manual: https://www.miljodirektoratet./publikasjoner/2022/januar/kartleggingsinstruks-kartlegging-av-terrestriske-naturtyper-etter-nin/Töpper, J. & Jakobsson, S. 2021. Index-Based Ecological Condition Assessment (IBECA) - Technical protocol, version 1.0. NINA Report 1967. Norwegian Institute Nature Research.Valøen, K. 2019. Stochastic rain events increase NDVI moss water content: High-Arctic field experiment. Master Thesis NTNU.","code":""},{"path":"NDVI-indicator-wetland.html","id":"analyses-ndviw","chapter":"13 NDVI - wetland ecosystems","heading":"13.7 Analyses","text":"","code":""},{"path":"NDVI-indicator-wetland.html","id":"datasets-ndviw","chapter":"13 NDVI - wetland ecosystems","heading":"13.7.1 Data sets","text":"analyses document make use following data sets:NiN data (Naturtyper etter Miljødirektoratets instruks)Sentinel-2 NDVI dataMODIS NDVI dataLandsat NDVI data","code":""},{"path":"NDVI-indicator-wetland.html","id":"nindata-ndviw","chapter":"13 NDVI - wetland ecosystems","heading":"13.7.1.1 NiN data and geometry for Norway and the five regions","text":"NiN data can directly downloaded Miljødirektoratets kartkatalog (https://kartkatalog.miljodirektoratet./Dataset)upload maps Norway five regions: Southern, Western, Eastern, Central, Northern Norway","code":"\nurl <- \"https://nedlasting.miljodirektoratet.no/Miljodata//Naturtyper_nin/FILEGDB/4326/Naturtyper_nin_0000_norge_4326_FILEGDB.zip\"\ndownload(url, dest = \"P:/41201785_okologisk_tilstand_2022_2023/data/Naturtyper_nin_0000_norge_4326_FILEGDB.zip\", mode = \"wb\")\nunzip(\"P:/41201785_okologisk_tilstand_2022_2023/data/Naturtyper_nin_0000_norge_4326_FILEGDB.zip\",\n  exdir = \"P:/41201785_okologisk_tilstand_2022_2023/data/nin_data\"\n)\nst_layers(\"P:/41201785_okologisk_tilstand_2022_2023/data/nin_data/Naturtyper_nin_0000_norge_4326_FILEGDB.gdb\")\nnin <- st_read(\"P:/41201785_okologisk_tilstand_2022_2023/data/nin_data/Naturtyper_nin_0000_norge_4326_FILEGDB.gdb\",\n  layer = \"naturtyper_nin_omr\"\n)\n# Import region- og Norgeskart, make sure they have the same geometry as the nin data\nnor <- st_read(\"data/outlineOfNorway_EPSG25833.shp\") %>%\n  st_as_sf() %>%\n  st_transform(crs = st_crs(nin))\n#> Reading layer `outlineOfNorway_EPSG25833' from data source \n#>   `/data/Egenutvikling/41001581_egenutvikling_anders_kolstad/github/ecosystemCondition/data/outlineOfNorway_EPSG25833.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 1 feature and 2 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -113472.7 ymin: 6448359 xmax: 1114618 ymax: 7939917\n#> Projected CRS: ETRS89 / UTM zone 33N\n\nreg <- st_read(\"data/regions.shp\") %>%\n  st_as_sf() %>%\n  st_transform(crs = st_crs(nin))\n#> Reading layer `regions' from data source \n#>   `/data/Egenutvikling/41001581_egenutvikling_anders_kolstad/github/ecosystemCondition/data/regions.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 5 features and 2 fields\n#> Geometry type: POLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -99551.21 ymin: 6426048 xmax: 1121941 ymax: 7962744\n#> Projected CRS: ETRS89 / UTM zone 33N\n\n# change region names to something R-friendly\n#reg$region\nreg$region <- c(\"Northern Norway\", \"Central Norway\", \"Eastern Norway\", \"Western Norway\", \"Southern Norway\")\n\n# combine the Norway and the region maps\nregnor <- st_intersection(reg, nor)\n#> Warning: attribute variables are assumed to be spatially\n#> constant throughout all geometries"},{"path":"NDVI-indicator-wetland.html","id":"ndvidata-ndviw","chapter":"13 NDVI - wetland ecosystems","heading":"13.7.1.2 NDVI data","text":"NDVI data calculated mean NDVI values respective NiN polygon available Sentinel-2, MODIS, Landsat image Google Earth Engine (GEE).","code":""},{"path":"NDVI-indicator-wetland.html","id":"sentinelldata-ndviw","chapter":"13 NDVI - wetland ecosystems","heading":"13.7.1.2.1 Sentinel-2 NDVI data","text":"GEE code can seen : https://code.earthengine.google.com/2ceb0c3e03adade9e6f6d0903184b8c4\nimage collection contains Sentinel imagery June, July August 2015-2022\nexceed GEE memory limits, exported files iterated grid resulted 42 separate csv files.\nscript merges merges dataframe NiN data.","code":"\n# Import Sentinel NDVI Data\ndf.s <- list.files(\"/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/NDVI_åpenlavland/NDVI_data_Sentinel/\", pattern = \"*.csv\", full.names = TRUE) %>%\n  map_df(~ fread(.))"},{"path":"NDVI-indicator-wetland.html","id":"modisdata-ndviw","chapter":"13 NDVI - wetland ecosystems","heading":"13.7.1.2.2 MODIS NDVI data","text":"GEE code can seen : https://code.earthengine.google.com/efb84013701f1d5f6e1e81345f389b84\nimage collection contains MODIS imagery June, July August 2000-2022","code":"\n# Import MODIS NDVI Data\n# MODIS NDVI is scaled by 0.0001. Mean must be divided by 10000.\ndf.m <- read.csv(\"/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/NDVI_åpenlavland/NDVI_data_MODIS/modis_ndvi_ts_2000_2022.csv\")\ndf.m$mean <- df.m$mean / 10000"},{"path":"NDVI-indicator-wetland.html","id":"landsatdata-ndviw","chapter":"13 NDVI - wetland ecosystems","heading":"13.7.1.2.3 Landsat NDVI data","text":"GEE code can seen : https://code.earthengine.google.com/da8a9279238ef26d14be08a43788b6b7\nimage collection contains Landsat imagery June, July August 1984-2022\nexceed GEE memory limits, exported files iterated grid resulted 42 separate csv files.\nscript merges merges dataframe NiN data.","code":"\n# Import Landsat NDVI Data\n# Set up conditional file paths\ndir <- substr(getwd(), 1, 2)\n\npath <- ifelse(dir == \"C:\",\n  \"R:/GeoSpatialData/Habitats_biotopes/Norway_Miljodirektoratet_Naturtyper_nin/Original/versjon20221231/Natur_Naturtyper_nin_norge_med_svalbard_25833/Natur_Naturtyper_NiN_norge_med_svalbard_25833.gdb\",\n  \"/data/R/GeoSpatialData/Habitats_biotopes/Norway_Miljodirektoratet_Naturtyper_nin/Original/versjon20221231/Natur_Naturtyper_nin_norge_med_svalbard_25833/Natur_Naturtyper_NiN_norge_med_svalbard_25833.gdb\"\n)\n\npData <- ifelse(dir == \"C:\",\n  \"P:/41201785_okologisk_tilstand_2022_2023/data/NDVI_åpenlavland/NDVI_data_Landsat\",\n  \"/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/NDVI_åpenlavland/NDVI_data_Landsat\"\n)\n\n\n# Fread doesn't like the weird path to the server version of the P drive\n# hence this horrendous work around\nfiles <- list.files(pData, pattern = \"*.csv\", full.names = TRUE)\n\ndf_list <- list() # initialise a list of dataframes\n# read in a dataframe in each slot of the df_list\nfor (i in files) {\n  name <- gsub(\"-\", \".\", i)\n  name <- gsub(\".csv\", \"\", name)\n  i <- paste(i, sep = \"\")\n  df_list[[i]] <- assign(name, read.csv(i, header = TRUE))\n}\n\ndf.l <- bind_rows(df_list, .id = \"column_label\")"},{"path":"NDVI-indicator-wetland.html","id":"data-handling-ndviw","chapter":"13 NDVI - wetland ecosystems","heading":"13.7.2 Data handling","text":"","code":""},{"path":"NDVI-indicator-wetland.html","id":"nin-data-handling-ndviw","chapter":"13 NDVI - wetland ecosystems","heading":"13.7.2.1 NiN data","text":"","code":"\n# fixing variable- and ecosystem-names with special characters\ncolnames(nin)\ncolnames(nin)[c(3, 8, 17, 26, 31, 33, 34)] <- c(\n  \"hovedoekosystem\", \"kartleggingsaar\", \"noyaktighet\",\n  \"omraadenavn\", \"uk_naertruet\", \"uk_sentraloekosystemfunksjon\",\n  \"uk_spesieltdaarligkartlagt\"\n)\nunique(nin$hovedoekosystem)\n\nnin <- nin %>%\n  mutate(hovedoekosystem = recode(hovedoekosystem,\n    \"Våtmark\" = \"Vaatmark\",\n    \"Semi-naturlig mark\" = \"Semi_naturlig\",\n    \"Naturlig åpne områder i lavlandet\" = \"Naturlig-aapent\",\n    \"Naturlig åpne områder under skoggrensa\" = \"Naturlig_aapent\"\n  )) %>%\n  mutate(validGeo = st_is_valid(SHAPE))\n\n# checking how many polygons have multiple ecosystem types\nunique(nin$ninkartleggingsenheter)\n\nnrow(nin)\n# 95469 polygons altogether\nnrow(nin %>%\n  filter(grepl(\",\", ninkartleggingsenheter)))\n# 21094 polygons have more than 1 ecosystem type (they are separated by commas in the ninkartleggingsenheter-variable)\n\nnrow(nin %>%\n  filter(!grepl(\",\", ninkartleggingsenheter)))\n# 74375 polygons should have only 1 ecosystem type\n\n# there's no information on the proportion of ecosystem types in the polygons, so we got to omit all polygons with multiple ecosystem types :(\nnin <- nin %>%\n  filter(!grepl(\",\", ninkartleggingsenheter))\n\n# fix the content in the ninkartleggingsenheter-variable\nsummary(as.factor(nin$ninkartleggingsenheter))\n# get rid of the NA- in the beginning\nnin <- nin %>% mutate(ninkartleggingsenheter = str_remove(ninkartleggingsenheter, \"NA_\"))\n# making a main ecosystem type variable\nnin <- nin %>% mutate(\n  hovedtype = substr(ninkartleggingsenheter, 1, 3),\n  hovedtype = str_remove(hovedtype, \"-\")\n)\n# checking mapping unit against main ecosystem type\nnin[, c(\"hovedoekosystem\", \"hovedtype\")]\nsummary(as.factor(nin$hovedtype[nin$hovedoekosystem == \"Vaatmark\"]))\nsummary(as.factor(nin$hovedtype[nin$hovedoekosystem == \"Semi_naturlig\"]))\nsummary(as.factor(nin$hovedtype[nin$hovedoekosystem == \"Naturlig_aapne\"]))\nsummary(as.factor(nin$hovedtype[nin$hovedoekosystem == \"Skog\"]))\nsummary(as.factor(nin$hovedtype[nin$hovedoekosystem == \"Fjell\"]))\n# making a new variable for the overarching ecosystem types based on the main ecosystem types\nnin$hovedoekosystem.orig <- nin$hovedoekosystem\n\nnin <- nin %>%\n  mutate(hovedoekosystem = case_when(\n    hovedtype %in% paste(\"V\", c(1, 3:7, 9:10), sep = \"\") ~ \"Vaatmark\",\n    hovedtype %in% paste(\"V\", 11:13, sep = \"\") ~ \"Vaatmark_sterkt_endret\",\n    hovedtype %in% paste(\"T\", c(31:34, 40:41), sep = \"\") ~ \"Semi_naturlig\",\n    hovedtype %in% paste(\"T\", c(2, 12, 18, 20:21), sep = \"\") ~ \"Naturlig_aapent\",\n    hovedtype %in% c(paste(\"T\", c(4, 30, 38), sep = \"\"), paste(\"V\", c(2, 8), sep = \"\")) ~ \"Skog\",\n    hovedtype %in% c(paste(\"T\", c(3, 7, 9, 10, 14, 22, 26), sep = \"\"), paste(\"V\", c(6, 7), sep = \"\")) ~ \"Fjell\",\n    TRUE ~ \"NA\"\n  ))\n\n\nsummary(as.factor(nin$tilstand))\n\nnin <- nin %>% mutate(tilstand = recode(tilstand,\n  \"Dårlig\" = \"Redusert\",\n  \"Svært redusert\" = \"Svaert_redusert\"\n))\nnin <- nin %>% mutate(tilstand_num = recode(tilstand,\n  \"God\" = 0, \"Moderat\" = 1,\n  \"Redusert\" = 2, \"Svaert_redusert\" = 3\n))\n\nsummary(as.factor(nin$tilstand))\nsummary(as.numeric(nin$tilstand_num))\n\n\n## filter out only wetland data\nnin.wetland <- nin %>%\n  filter(hovedoekosystem %in% c(\"Vaatmark\")) %>%\n  mutate(id = identifikasjon_lokalid) %>%\n  filter(validGeo) %>%\n  drop_na(tilstand) %>%\n  dplyr::select(id, hovedoekosystem, hovedtype, ninkartleggingsenheter, lokalitetskvalitet, tilstand, tilstand_num, ninbeskrivelsesvariabler, kartleggingsaar)\n\n\n# merge NiN-data with region\nnin.wetland <- st_join(nin.wetland, regnor, left = TRUE)\nnin.wetland\n\ncolnames(nin.wetland)[c(1, 10)] <- c(\"id\", \"region_id\")\n\n# check that every nin-polygon still occurs only once\nsummary(as.factor(nin.wetland$id))\nnin.wetland[nin.wetland$id == \"NINFP2110008060\", ]\n# this one was assigned to both Western and Central Norway, we drop the latter\nnin.wetland <- nin.wetland[!row.names(nin.wetland) %in% \"1144.1\", ]\n\nnin.wetland <- nin.wetland %>%\n  mutate(area_meters_nin = st_area(nin.wetland))\n# check and edit the order of regions\nlevels(nin.wetland$region)\nnin.wetland$region <- as.factor(nin.wetland$region)\nlevels(nin.wetland$region)\nnin.wetland$region <- factor(nin.wetland$region, levels = c(\"Northern Norway\", \"Central Norway\", \"Eastern Norway\", \"Western Norway\", \"Southern Norway\"))\nlevels(nin.wetland$region)\n\n# splitting content in the ninbeskrivelsesvariabler-column into separate rows per variable and then separating that column into two for the variable name and value\nnin.wetland2 <- nin.wetland %>%\n  separate_rows(ninbeskrivelsesvariabler, sep = \",\") %>%\n  separate(\n    col = ninbeskrivelsesvariabler,\n    into = c(\"NiN_variable_code\", \"NiN_variable_value\"),\n    sep = \"_\",\n    remove = F\n  ) %>%\n  mutate(NiN_variable_value = as.numeric(NiN_variable_value)) %>%\n  mutate(NiN_variable_code = as.factor(NiN_variable_code)) %>%\n  subset(select = -ninbeskrivelsesvariabler)\nnin.wetland2 <- as.data.frame(nin.wetland2)"},{"path":"NDVI-indicator-wetland.html","id":"ndvi-data-ndviw","chapter":"13 NDVI - wetland ecosystems","heading":"13.7.2.2 NDVI data","text":"","code":"\n## Sentinel-2\n# join nin.wetland & Sentinel NDVI data\nSentinelNDVI.wetland <- full_join(nin.wetland, df.s, by = \"id\")\n#> Warning in sf_column %in% names(g): Each row in `x` is expected to match at most 1 row in `y`.\n#> ℹ Row 1 of `x` matches multiple rows.\n#> ℹ If multiple matches are expected, set `multiple = \"all\"`\n#>   to silence this warning.\n# summary(SentinelNDVI.wetland)\nSentinelNDVI.wetland <- SentinelNDVI.wetland %>%\n  mutate(\n    hovedoekosystem = as.factor(hovedoekosystem),\n    hovedtype = as.factor(hovedtype),\n    ninkartleggingsenheter = as.factor(ninkartleggingsenheter),\n    lokalitetskvalitet = as.factor(lokalitetskvalitet),\n    tilstand = as.factor(tilstand),\n    area_meters = st_area(SentinelNDVI.wetland)\n  )\n# summary(SentinelNDVI.wetland)\n# get rid of NAs (i.e. NDVI cells that were not in wetland polygons)\nSentinelNDVI.wetland <- SentinelNDVI.wetland %>% filter(!is.na(hovedtype))\nSentinelNDVI.wetland <- SentinelNDVI.wetland %>% filter(!is.na(mean))\n# summary(SentinelNDVI.wetland)\n# get rid of any nin-polygons smaller than the Sentinel grid cell size (100 sqm)\n  # dim(SentinelNDVI.wetland)\nSentinelNDVI.wetland <- SentinelNDVI.wetland %>% filter(as.numeric(area_meters) >= 100)\n  # dim(SentinelNDVI.wetland)\n# split date into year, month & day\nSentinelNDVI.wetland <- SentinelNDVI.wetland %>%\n  dplyr::mutate(\n    year = lubridate::year(date),\n    month = lubridate::month(date),\n    day = lubridate::day(date)\n  )\n# add column for sub-ecosystem types\nSentinelNDVI.wetland <- SentinelNDVI.wetland %>% mutate(\n  subtype = substring(ninkartleggingsenheter, 4),\n  subtype = str_remove(subtype, \"-\"),\n  subtype = str_remove(subtype, \"-\")\n)\n# we are using max NDVI per year in every NiN polygon\nSentinelNDVI.wetland <- SentinelNDVI.wetland %>%\n  group_by(id, year) %>%\n  filter(mean == max(mean, na.rm = TRUE))\n\n  # summary(SentinelNDVI.wetland)\n\n## MODIS\n# join nin.wetland and Modis NDVI data\nModisNDVI.wetland <- full_join(nin.wetland, df.m, by = \"id\")\n#> Warning in sf_column %in% names(g): Each row in `x` is expected to match at most 1 row in `y`.\n#> ℹ Row 1 of `x` matches multiple rows.\n#> ℹ If multiple matches are expected, set `multiple = \"all\"`\n#>   to silence this warning.\n\n# summary(ModisNDVI.wetland)\nModisNDVI.wetland <- ModisNDVI.wetland %>%\n  mutate(\n    hovedoekosystem = as.factor(hovedoekosystem),\n    hovedtype = as.factor(hovedtype),\n    ninkartleggingsenheter = as.factor(ninkartleggingsenheter),\n    lokalitetskvalitet = as.factor(lokalitetskvalitet),\n    tilstand = as.factor(tilstand),\n    area_meters = st_area(ModisNDVI.wetland)\n  )\n# summary(ModisNDVI.wetland)\n# get rid of NAs (i.e. NDVI cells that were not in wetland polygons)\nModisNDVI.wetland <- ModisNDVI.wetland %>% filter(!is.na(hovedtype))\nModisNDVI.wetland <- ModisNDVI.wetland %>% filter(!is.na(mean))\n# summary(ModisNDVI.wetland)\n# get rid of any nin-polygons smaller than the Modis grid cell size (62500 sqm)\n  # dim(ModisNDVI.wetland)\nModisNDVI.wetland <- ModisNDVI.wetland %>% filter(as.numeric(area_meters) >= 62500)\n  # dim(ModisNDVI.wetland)\n# split date into year, month & day\nModisNDVI.wetland <- ModisNDVI.wetland %>%\n  dplyr::mutate(\n    year = lubridate::year(date),\n    month = lubridate::month(date),\n    day = lubridate::day(date)\n  )\n# we are using max NDVI per year in every NiN polygon\nModisNDVI.wetland <- ModisNDVI.wetland %>%\n  group_by(id, year) %>%\n  filter(mean == max(mean, na.rm = TRUE))\n# summary(ModisNDVI.wetland)\n\n## Landsat\n# join nin.wetland & Landsat NDVI data\nLandsatNDVI.wetland <- full_join(nin.wetland, df.l, by = \"id\")\n#> Warning in sf_column %in% names(g): Each row in `x` is expected to match at most 1 row in `y`.\n#> ℹ Row 1 of `x` matches multiple rows.\n#> ℹ If multiple matches are expected, set `multiple = \"all\"`\n#>   to silence this warning.\n\n# summary(LandsatNDVI.wetland)\nLandsatNDVI.wetland <- LandsatNDVI.wetland %>%\n  mutate(\n    hovedoekosystem = as.factor(hovedoekosystem),\n    hovedtype = as.factor(hovedtype),\n    ninkartleggingsenheter = as.factor(ninkartleggingsenheter),\n    lokalitetskvalitet = as.factor(lokalitetskvalitet),\n    tilstand = as.factor(tilstand),\n    area_meters = st_area(LandsatNDVI.wetland)\n  )\n# summary(LandsatNDVI.wetland)\n# get rid of NAs (i.e. NDVI cells that were not in wetland polygons)\nLandsatNDVI.wetland <- LandsatNDVI.wetland %>% filter(!is.na(hovedtype))\nLandsatNDVI.wetland <- LandsatNDVI.wetland %>% filter(!is.na(mean))\n# summary(LandsatNDVI.wetland)\n# get rid of any nin-polygons smaller than the Landsat grid cell size (900 sqm)\n  # dim(LandsatNDVI.wetland)\nLandsatNDVI.wetland <- LandsatNDVI.wetland %>% filter(as.numeric(area_meters) >= 900)\n  # dim(LandsatNDVI.wetland)\n# split date into year, month & day\nLandsatNDVI.wetland <- LandsatNDVI.wetland %>%\n  dplyr::mutate(\n    year = lubridate::year(date),\n    month = lubridate::month(date),\n    day = lubridate::day(date)\n  )\n# we are using max NDVI per year in every NiN polygon\nLandsatNDVI.wetland <- LandsatNDVI.wetland %>%\n  group_by(id, year) %>%\n  filter(mean == max(mean, na.rm = TRUE))\n\n# summary(LandsatNDVI.wetland)"},{"path":"NDVI-indicator-wetland.html","id":"exploratory-ndviw","chapter":"13 NDVI - wetland ecosystems","heading":"13.7.3 Exploratory analyses, Sentinel-2","text":"wetland sites?\nFigure 13.1: map Norway showing location wetland ecosystem sites. V1 = minerotrophic mires, V3 = ombrotrophic bogs, V4 = cold springs, V6 = wet snowbeds, V9 = semi-natural mires, V10 = semi-natural wet meadows.\npolygon sizes distributed?\nFigure 13.2: Histogram wetland ecosystem polygon sizes Norway.\nWetland polygons stretch large number sizes just 100 sqm 4 million sqm. 75% polygons 14264 sqm.\ndashed line indicates minimum size Sentinel-2 pixels NDVI, NiN-polygons smaller removed form data.NDVI vary years?\nFigure 13.3: figure showing NDVI values wetland ecosystem time six different main nature types varying degrees condition. V1 = minerotrophic mires, V3 = ombrotrophic bogs, V4 = cold springs, V9 = semi-natural mires, V10 = semi-natural wet meadows.\n2022 stands highest NDVI values missing.\nomit 2022 analysisHow NDVI values vary major basic ecosystem types sites good condition? (using NDVI data matching NiN-mapping years)\nFigure 13.4: NDVI values major wetland ecosystem types good condition. V1 = minerotrophic mires, V3 = ombrotrophic bogs, V4 = cold springs, V9 = semi-natural mires, V10 = semi-natural wet meadows\n\nFigure 13.5: NDVI values basic wetland ecosystem types good condition. V1 = minerotrophic mires, V3 = ombrotrophic bogs, V4 = cold springs, V9 = semi-natural mires, V10 = semi-natural wet meadows.\nNDVI varies major ecosystem types highest values semi-natural wet-meadows (V10), lowest values ombrotrophic bogs (V3). overlaps ecosystem types considerable.\nrespect basic ecosystem types within major types, NDVI appears increase increasing limestone level (C1-C4, C5-C8, E1-E3 V1, C1-C3 major types), also overlap large.NDVI vary across regions wetlands (major types) good condition? (using NDVI data matching NiN-mapping years)\nFigure 13.6: NDVI variation across regions wetland ecosystems (major types) good condition. V1 = minerotrophic mires, V3 = ombrotrophic bogs, V4 = cold springs, V9 = semi-natural mires, V10 = semi-natural wet meadows.\nobvious trends geography, exception V3 shows lower values Central Norway.NDVI vary across condition classes (major types NDVI data matching NiN-mapping years)\nFigure 13.7: NDVI values across wetland sites different ecological condition. V1 = minerotrophic mires, V3 = ombrotrophic bogs, V4 = cold springs, V9 = semi-natural mires, V10 = semi-natural wet meadows.\nsemi-natural types (V9,V10), kaldkilde (V4), ombrotrophic bogs (V3) NDVI seems increase condition deteriorates,\nminertrophic fens (V1) much pattern.\nOverlaps condition classes generally large.ecological relevant variable(s) condition measure NiN data related ?\nFigure 13.8: ecological relevant variable(s) condition measure NiN data related ?\n\nFigure 13.9: ecological relevant variable(s) condition measure NiN data related ?\n\nFigure 13.10: ecological relevant variable(s) condition measure NiN data related ?\nplots, panels V1, V9 V10 differ Miljødirektoratets mapping manual (see reference list ) uses different variables major ecosystem types define condition.V9, semi-natural mires, reduced condition mainly related increasing cover shrubs trees.\nV10, semi-natural wet-meadows, reduced condition related insufficient land-use intensity succession.\ncases, ’d expect increase greenness signal.\nThus, NDVI can, principle, indicative ecological condition semi-natural wetlands due direct connection main pressures ecosystems.\nV1 (minerotrophic fens), reduced condition mainly related abundance ditches, also increased use heavy vehicles high alien species abundance related reduce condition.\ndrivers, greenness directly affected, although drainage due ditches may lead succession woody plant encroachment, thus greening, longer run.\nCurrently, NDVI seems poorly linked ecological condition , major pressures , minerotrophic fens.","code":"\ntm_shape(regnor) +\n  tm_fill(\"GID_0\", labels = \"\", title = \"\", legend.show = FALSE, alpha=0) +\n  tm_borders() +\n  tm_shape(SentinelNDVI.wetland) +\n  tm_dots(\"hovedtype\", midpoint = NA, palette = tmaptools::get_brewer_pal(\"YlOrRd\", 6, plot = FALSE), scale = 2.5, legend.show = FALSE) +\n  tm_add_legend(\n    type = \"symbol\",\n    col = tmaptools::get_brewer_pal(\"YlOrRd\", 6, plot = FALSE),\n    labels = c(\n      \"V1\",\n      \"V3\",\n      \"V4\",\n      \"V6\",\n      \"V9\",\n      \"V10\"\n    ),\n    title = \"Major ecosystem type\",\n    size = 1.5\n  ) +\n  tm_layout(\n    main.title = \"Wetland ecosystems \\n(NiN, Miljødirektoratets instruks)\",\n    main.title.size = 1.2, legend.position = c(\"right\", \"bottom\"),\n    legend.text.size = 1.3, legend.title.size = 1.4\n  )\nsummary(SentinelNDVI.wetland$area_meters)\n#>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n#>     100    2103    5034   22302   14264 4462705\nhist(SentinelNDVI.wetland$area_meters, xlim = c(0, 20000), breaks = 50000,xlab=\"Area\",main=\"\")\nabline(v = 100, lty = 2)\nSentinelNDVI.wetland %>%\n  ggplot(aes(x = year, y = mean)) +\n  geom_point() +\n  facet_grid(tilstand ~ hovedtype) +\n  theme(axis.text.x = element_text(angle = -45, vjust = 0.5, hjust = 0.2, size = 12)) +\n  ggtitle(\"NDVI across years for different ecosystem types in all condition classes\") +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Year\")\nSentinelNDVI.wetland <- SentinelNDVI.wetland %>% filter(year != \"2022\")\nSentinelNDVI.wetland %>%\n  filter(tilstand == \"God\") %>%\n  filter(year == kartleggingsaar) %>%\n  ggplot(aes(x = hovedtype, y = mean)) +\n  geom_violin() +\n  geom_point(size = 0.7, shape = 16, color = \"grey\", position = position_jitter(.1) ) +\n  ggtitle(\"NDVI for different ecosystem types in good condition\") +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Major ecosystem type\")\nSentinelNDVI.wetland %>%\n  filter(tilstand == \"God\") %>%\n  filter(year == kartleggingsaar) %>%\n  ggplot(aes(x = subtype, y = mean)) +\n  geom_violin() +\n  geom_point(size = 0.7, shape = 16, color = \"grey\") +\n  facet_wrap(~hovedtype) +\n  theme(axis.text.x = element_text(angle = -45, vjust = 0.5, hjust = 0.2, size = 9)) +\n  ggtitle(\"NDVI for different ecosystem sub-types in good condition\") +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Ecosystem sub-type\")\nSentinelNDVI.wetland %>%\n  filter(tilstand == \"God\") %>%\n  filter(year == kartleggingsaar) %>%\n  filter(!is.na(region)) %>%\n  ggplot(aes(x = region, y = mean)) +\n  geom_violin() +\n  geom_point(size = 0.7, shape = 16, color = \"grey\", position = position_jitter(.1) ) +\n  facet_wrap(~hovedtype) +\n  theme(axis.text.x = element_text(angle = -45, vjust = 0.5, hjust = 0.2, size = 9)) +\n  ggtitle(\"NDVI for different ecosystems in good condition across regions\") +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Region\")\nSentinelNDVI.wetland %>%\n  filter(year == kartleggingsaar) %>%\n  ggplot(aes(x = tilstand, y = mean)) +\n  geom_violin() +\n  geom_point(size = 0.7, shape = 16, color = \"grey\", position = position_jitter(.1) ) +\n  facet_wrap(~hovedtype) +\n  theme(axis.text.x = element_text(angle = -45, vjust = 0.5, hjust = 0.2)) +\n  ggtitle(\"NDVI for different ecosystems in different condition classes\") +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Condition\")\nnin.wetland2 %>%\n  filter(hovedtype == \"V9\") %>%\n  filter(NiN_variable_code %in% c(\"1AG-B\", \"7GR-GI\", \"1AG-A-G\", \"1AR-C-L\", \"7TK\", \"PRSL\")) %>%\n  mutate(NiN_variable_des = recode(NiN_variable_code,\n    \"1AG-B\" = \"Shrub cover\",\n    \"7GR-GI\" = \"Abundance of ditches\",\n    \"1AG-A-G\" = \"Tree cover\",\n    \"1AR-C-L\" = \"Woody plants in field layer\",\n    \"7TK\" = \"Heavy vehicles\",\n    \"PRSL\" = \"Wear/tear\"\n  )) %>%\n  ggplot(aes(x = NiN_variable_value, y = tilstand_num)) +\n  geom_point(size = 2) +\n  geom_jitter(width = 0.25, height = 0.25) +\n  facet_wrap(~NiN_variable_des, nrow = 2, ncol = 3) +\n  theme(legend.position = \"none\") +\n  ggtitle(\"Condition variables in semi-natural mires (V9)\") +\n  labs(y = \"Condition level (0-3='good' to 'very reduced')\", x = \"Condition variable score\")\nnin.wetland2 %>%\n  filter(hovedtype == \"V10\") %>%\n  filter(NiN_variable_code %in% c(\"7JB-BA\", \"7RA-SJ\", \"7FA\", \"7JB-GJ\")) %>%\n  mutate(NiN_variable_des = recode(NiN_variable_code,\n    \"7JB-BA\" = \"Land use intensity\",\n    \"7RA-SJ\" = \"Succession\",\n    \"7FA\" = \"Alien species\",\n    \"7JB-GJ\" = \"Fertilization\"\n  )) %>%\n  ggplot(aes(x = NiN_variable_value, y = tilstand_num)) +\n  geom_point(size = 2) +\n  geom_jitter(width = 0.25, height = 0.25) +\n  facet_wrap(~NiN_variable_des, nrow = 2, ncol = 2) +\n  theme(legend.position = \"none\") +\n  ggtitle(\"Condition variables in semi-natural wet-meadows (V10)\") +\n  labs(y = \"Condition level (0-3='good' to 'very reduced')\", x = \"Condition variable score\")\nnin.wetland2 %>%\n  filter(hovedtype == \"V1\") %>%\n  filter(NiN_variable_code %in% c(\"7GR-GI\", \"PRTK\", \"7FA\", \"7TK\", \"7SE\", \"PRSL\")) %>%\n  mutate(NiN_variable_des = recode(NiN_variable_code,\n    \"7GR-GI\" = \"Abundance of ditches\",\n    \"PRTK\" = \"Heavy vehicles\",\n    \"7FA\" = \"Alien species\",\n    \"7TK\" = \"Heavy vehicles2\",\n    \"7SE\" = \"Wear/tear\",\n    \"PRSL\" = \"Wear/tear2\"\n  )) %>%\n  ggplot(aes(x = NiN_variable_value, y = tilstand_num)) +\n  geom_point(size = 2) +\n  geom_jitter(width = 0.25, height = 0.25) +\n  facet_wrap(~NiN_variable_des, nrow = 2, ncol = 3) +\n  theme(legend.position = \"none\") +\n  ggtitle(\"Condition variables in minerotrophic fens (V1)\") +\n  labs(y = \"Condition level (0-3='good' to 'very reduced')\", x = \"Condition variable score\")"},{"path":"NDVI-indicator-wetland.html","id":"regression-ndviw","chapter":"13 NDVI - wetland ecosystems","heading":"13.7.4 Regression analyses Sentinel-2, NDVI as a function of condition","text":"can investigate NDVI condition connected using regression analyses.First, take look balanced data across major ecosystem types, regions condition classes\nFigure 13.11: NDVI values across condition gradient, faceted five wetland ecosystem types five regions Norway.\nV4 sparse data lacking combinations region condition level, drop .NDVI data bounded -1 1, thus require modelling appropriate method can handle bounded data. can transform variable bounded 0 1 use beta-regression models:NDVI values vary :RegionsEcosystem typesCondition classesIt evident differences regions. since interested statistics region differences, run separate models every region ease interpretation.Northern Norway\nFigure 13.12: NDVI ecosystem condition four wetland ecosystems Northern Norway.\nNDVI good condition: V10 > V1 > V9 > V3V1: NDVI decreases condition deterioratesV3: NDVI change condition deterioratesV9 & V10: NDVI increases condition deterioratesCentral Norway\nFigure 13.13: NDVI ecosystem condition four wetland ecosystems Central Norway.\nNDVI good condition: V10 > V1 & V9 > V3V1: NDVI decreases condition deterioratesV3, V9 & V10: NDVI increases condition deterioratesWestern Norway\nFigure 13.14: NDVI ecosystem condition four wetland ecosystems W-Norway.\nNDVI good condition: V10 > V9 & V3 > V1V1 & V10: NDVI increases condition deterioratesV3: NDVI decreases condition deteriorates (really insufficient data)V9: NDVI change condition deterioratesEastern Norway\nFigure 13.15: NDVI ecosystem condition four wetland ecosystems E-Norway.\nNDVI good condition: V10 > V1 > V3 & V9V1 & V3: NDVI change condition deterioratesV9 & V10: NDVI increases condition deterioratesSouthern Norway\nFigure 13.16: NDVI ecosystem condition four wetland ecosystems S-Norway.\nNDVI good condition: V10 > V9 > V1 & V3V1, V9 & V10: NDVI increases condition deterioratesV3: NDVI change condition deteriorates (also insuffcient data)Overall take home messages:semi-natural wetland ecosystems (V9, V10) NDVI increases ecosystem condition deteriorates, consistent entire country. supports conclusion exploratory analyses NDVI indicative ecological condition semi-natural wetland ecosystems.\nnatural minerotrophic fens (V1) NDVI increases South decreases North ecosystem condition deteriorates. factor potential affecting vegetation composition productivity, thus NDVI, Nitrogen deposition. Nitrogen deposition higher Southern parts Norway north, thus responsible increased NDVI reduced condition South, clear Nitrogen deposition variables underlying condition assessment V1 (Ditches, Alien species, Heavy vehicles, Wear/tear) connected. Furthermore date lacking documented empirical ground-truthed information connection NDVI Nitrogen effects wetlands. bogs (V3) consistent pattern.","code":"\n# NDVI across hovedtyper, regions and condition classes (only for NDVI years data matching NiN-mapping years)\nSentinelNDVI.wetland %>%\n  group_by(id, year) %>%\n  filter(year == kartleggingsaar) %>%\n  filter(!is.na(region)) %>%\n  ggplot(aes(x = tilstand, y = mean)) +\n  geom_violin() +\n  geom_point(size = 0.7, shape = 16, color = \"grey\") +\n  facet_grid(region ~ hovedtype) +\n  theme(axis.text.x = element_text(angle = -45, vjust = 0.5, hjust = 0.2, size = 9)) +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Condition\")\nSentinelNDVI.wetland$mean_beta <- (SentinelNDVI.wetland$mean + 1) / 2\n# NDVI data from the year of NiN-mapping (and thus with condition assessment) to train the condition models\n# we drop V4 for the analysis as it lacks data for most combinations of condition and region, and thus would cause convergence issues\nSentinelNDVI.wetland.train <- SentinelNDVI.wetland %>%\n  filter(year == kartleggingsaar) %>%\n  filter(hovedtype != \"V4\")\n\n# We run a stepwise-function on the full model including condition, ecosystem type, and region to find the most parsimonious model\nmodel.wetland.cond.Sent <- betareg(mean_beta ~ tilstand_num * region * hovedtype, data = SentinelNDVI.wetland.train)\nmodel.wetland.cond.Sent <- StepBeta(model.wetland.cond.Sent)\n#> [1] \"100 % of the process\"\nsummary(model.wetland.cond.Sent)\n#> \n#> Call:\n#> \"betareg(formula =  mean_beta ~ hovedtype + region + tilstand_num + region:hovedtype + tilstand_num:hovedtype + tilstand_num:region:hovedtype data = SentinelNDVI.wetland.train )\"\n#> \n#> Standardized weighted residuals 2:\n#>     Min      1Q  Median      3Q     Max \n#> -3.8916 -0.6702 -0.0255  0.6375  3.7930 \n#> \n#> Coefficients (mean model with logit link):\n#>                                                   Estimate\n#> (Intercept)                                      1.6708640\n#> hovedtypeV10                                     0.2108959\n#> hovedtypeV3                                     -0.1524467\n#> hovedtypeV9                                      0.0181524\n#> regionCentral Norway                            -0.1779053\n#> regionEastern Norway                             0.0303260\n#> regionWestern Norway                            -0.1062018\n#> regionSouthern Norway                           -0.0522541\n#> tilstand_num                                    -0.0463176\n#> hovedtypeV10:regionCentral Norway                0.1464568\n#> hovedtypeV3:regionCentral Norway                -0.0787934\n#> hovedtypeV9:regionCentral Norway                 0.1288021\n#> hovedtypeV10:regionEastern Norway                0.0274397\n#> hovedtypeV3:regionEastern Norway                 0.0636284\n#> hovedtypeV9:regionEastern Norway                -0.0370905\n#> hovedtypeV10:regionWestern Norway                0.0233371\n#> hovedtypeV3:regionWestern Norway                 0.1823422\n#> hovedtypeV9:regionWestern Norway                 0.0951785\n#> hovedtypeV10:regionSouthern Norway               0.1587937\n#> hovedtypeV3:regionSouthern Norway                0.1370854\n#> hovedtypeV9:regionSouthern Norway                0.1292549\n#> hovedtypeV10:tilstand_num                        0.0994613\n#> hovedtypeV3:tilstand_num                         0.0362305\n#> hovedtypeV9:tilstand_num                         0.1083055\n#> hovedtypeV1:regionCentral Norway:tilstand_num    0.0163315\n#> hovedtypeV10:regionCentral Norway:tilstand_num   0.0140504\n#> hovedtypeV3:regionCentral Norway:tilstand_num    0.0681189\n#> hovedtypeV9:regionCentral Norway:tilstand_num   -0.0124844\n#> hovedtypeV1:regionEastern Norway:tilstand_num    0.0288659\n#> hovedtypeV10:regionEastern Norway:tilstand_num  -0.0040408\n#> hovedtypeV3:regionEastern Norway:tilstand_num   -0.0012722\n#> hovedtypeV9:regionEastern Norway:tilstand_num   -0.0087535\n#> hovedtypeV1:regionWestern Norway:tilstand_num    0.1099644\n#> hovedtypeV10:regionWestern Norway:tilstand_num   0.0221430\n#> hovedtypeV3:regionWestern Norway:tilstand_num   -0.0573753\n#> hovedtypeV9:regionWestern Norway:tilstand_num   -0.0477682\n#> hovedtypeV1:regionSouthern Norway:tilstand_num   0.1194407\n#> hovedtypeV10:regionSouthern Norway:tilstand_num -0.0087023\n#> hovedtypeV3:regionSouthern Norway:tilstand_num   0.0003832\n#> hovedtypeV9:regionSouthern Norway:tilstand_num  -0.0190572\n#>                                                 Std. Error\n#> (Intercept)                                      0.0090128\n#> hovedtypeV10                                     0.0343499\n#> hovedtypeV3                                      0.0179386\n#> hovedtypeV9                                      0.0192686\n#> regionCentral Norway                             0.0124275\n#> regionEastern Norway                             0.0187436\n#> regionWestern Norway                             0.0159522\n#> regionSouthern Norway                            0.0326521\n#> tilstand_num                                     0.0140607\n#> hovedtypeV10:regionCentral Norway                0.0529350\n#> hovedtypeV3:regionCentral Norway                 0.0211338\n#> hovedtypeV9:regionCentral Norway                 0.0274319\n#> hovedtypeV10:regionEastern Norway                0.0524074\n#> hovedtypeV3:regionEastern Norway                 0.0378203\n#> hovedtypeV9:regionEastern Norway                 0.0327965\n#> hovedtypeV10:regionWestern Norway                0.0496855\n#> hovedtypeV3:regionWestern Norway                 0.0302974\n#> hovedtypeV9:regionWestern Norway                 0.0266669\n#> hovedtypeV10:regionSouthern Norway               0.0734277\n#> hovedtypeV3:regionSouthern Norway                0.0492598\n#> hovedtypeV9:regionSouthern Norway                0.0480220\n#> hovedtypeV10:tilstand_num                        0.0215979\n#> hovedtypeV3:tilstand_num                         0.0194711\n#> hovedtypeV9:tilstand_num                         0.0185078\n#> hovedtypeV1:regionCentral Norway:tilstand_num    0.0167452\n#> hovedtypeV10:regionCentral Norway:tilstand_num   0.0293834\n#> hovedtypeV3:regionCentral Norway:tilstand_num    0.0143445\n#> hovedtypeV9:regionCentral Norway:tilstand_num    0.0188535\n#> hovedtypeV1:regionEastern Norway:tilstand_num    0.0187904\n#> hovedtypeV10:regionEastern Norway:tilstand_num   0.0250147\n#> hovedtypeV3:regionEastern Norway:tilstand_num    0.0237466\n#> hovedtypeV9:regionEastern Norway:tilstand_num    0.0184443\n#> hovedtypeV1:regionWestern Norway:tilstand_num    0.0229877\n#> hovedtypeV10:regionWestern Norway:tilstand_num   0.0290413\n#> hovedtypeV3:regionWestern Norway:tilstand_num    0.0408132\n#> hovedtypeV9:regionWestern Norway:tilstand_num    0.0163002\n#> hovedtypeV1:regionSouthern Norway:tilstand_num   0.0351652\n#> hovedtypeV10:regionSouthern Norway:tilstand_num  0.0375637\n#> hovedtypeV3:regionSouthern Norway:tilstand_num   0.0542752\n#> hovedtypeV9:regionSouthern Norway:tilstand_num   0.0224351\n#>                                                 z value\n#> (Intercept)                                     185.388\n#> hovedtypeV10                                      6.140\n#> hovedtypeV3                                      -8.498\n#> hovedtypeV9                                       0.942\n#> regionCentral Norway                            -14.315\n#> regionEastern Norway                              1.618\n#> regionWestern Norway                             -6.658\n#> regionSouthern Norway                            -1.600\n#> tilstand_num                                     -3.294\n#> hovedtypeV10:regionCentral Norway                 2.767\n#> hovedtypeV3:regionCentral Norway                 -3.728\n#> hovedtypeV9:regionCentral Norway                  4.695\n#> hovedtypeV10:regionEastern Norway                 0.524\n#> hovedtypeV3:regionEastern Norway                  1.682\n#> hovedtypeV9:regionEastern Norway                 -1.131\n#> hovedtypeV10:regionWestern Norway                 0.470\n#> hovedtypeV3:regionWestern Norway                  6.018\n#> hovedtypeV9:regionWestern Norway                  3.569\n#> hovedtypeV10:regionSouthern Norway                2.163\n#> hovedtypeV3:regionSouthern Norway                 2.783\n#> hovedtypeV9:regionSouthern Norway                 2.692\n#> hovedtypeV10:tilstand_num                         4.605\n#> hovedtypeV3:tilstand_num                          1.861\n#> hovedtypeV9:tilstand_num                          5.852\n#> hovedtypeV1:regionCentral Norway:tilstand_num     0.975\n#> hovedtypeV10:regionCentral Norway:tilstand_num    0.478\n#> hovedtypeV3:regionCentral Norway:tilstand_num     4.749\n#> hovedtypeV9:regionCentral Norway:tilstand_num    -0.662\n#> hovedtypeV1:regionEastern Norway:tilstand_num     1.536\n#> hovedtypeV10:regionEastern Norway:tilstand_num   -0.162\n#> hovedtypeV3:regionEastern Norway:tilstand_num    -0.054\n#> hovedtypeV9:regionEastern Norway:tilstand_num    -0.475\n#> hovedtypeV1:regionWestern Norway:tilstand_num     4.784\n#> hovedtypeV10:regionWestern Norway:tilstand_num    0.762\n#> hovedtypeV3:regionWestern Norway:tilstand_num    -1.406\n#> hovedtypeV9:regionWestern Norway:tilstand_num    -2.931\n#> hovedtypeV1:regionSouthern Norway:tilstand_num    3.397\n#> hovedtypeV10:regionSouthern Norway:tilstand_num  -0.232\n#> hovedtypeV3:regionSouthern Norway:tilstand_num    0.007\n#> hovedtypeV9:regionSouthern Norway:tilstand_num   -0.849\n#>                                                 Pr(>|z|)\n#> (Intercept)                                      < 2e-16\n#> hovedtypeV10                                    8.27e-10\n#> hovedtypeV3                                      < 2e-16\n#> hovedtypeV9                                     0.346154\n#> regionCentral Norway                             < 2e-16\n#> regionEastern Norway                            0.105676\n#> regionWestern Norway                            2.78e-11\n#> regionSouthern Norway                           0.109526\n#> tilstand_num                                    0.000987\n#> hovedtypeV10:regionCentral Norway               0.005662\n#> hovedtypeV3:regionCentral Norway                0.000193\n#> hovedtypeV9:regionCentral Norway                2.66e-06\n#> hovedtypeV10:regionEastern Norway               0.600567\n#> hovedtypeV3:regionEastern Norway                0.092494\n#> hovedtypeV9:regionEastern Norway                0.258086\n#> hovedtypeV10:regionWestern Norway               0.638572\n#> hovedtypeV3:regionWestern Norway                1.76e-09\n#> hovedtypeV9:regionWestern Norway                0.000358\n#> hovedtypeV10:regionSouthern Norway              0.030573\n#> hovedtypeV3:regionSouthern Norway               0.005387\n#> hovedtypeV9:regionSouthern Norway               0.007111\n#> hovedtypeV10:tilstand_num                       4.12e-06\n#> hovedtypeV3:tilstand_num                        0.062781\n#> hovedtypeV9:tilstand_num                        4.86e-09\n#> hovedtypeV1:regionCentral Norway:tilstand_num   0.329415\n#> hovedtypeV10:regionCentral Norway:tilstand_num  0.632527\n#> hovedtypeV3:regionCentral Norway:tilstand_num   2.05e-06\n#> hovedtypeV9:regionCentral Norway:tilstand_num   0.507858\n#> hovedtypeV1:regionEastern Norway:tilstand_num   0.124489\n#> hovedtypeV10:regionEastern Norway:tilstand_num  0.871671\n#> hovedtypeV3:regionEastern Norway:tilstand_num   0.957275\n#> hovedtypeV9:regionEastern Norway:tilstand_num   0.635079\n#> hovedtypeV1:regionWestern Norway:tilstand_num   1.72e-06\n#> hovedtypeV10:regionWestern Norway:tilstand_num  0.445783\n#> hovedtypeV3:regionWestern Norway:tilstand_num   0.159782\n#> hovedtypeV9:regionWestern Norway:tilstand_num   0.003384\n#> hovedtypeV1:regionSouthern Norway:tilstand_num  0.000682\n#> hovedtypeV10:regionSouthern Norway:tilstand_num 0.816795\n#> hovedtypeV3:regionSouthern Norway:tilstand_num  0.994366\n#> hovedtypeV9:regionSouthern Norway:tilstand_num  0.395639\n#>                                                    \n#> (Intercept)                                     ***\n#> hovedtypeV10                                    ***\n#> hovedtypeV3                                     ***\n#> hovedtypeV9                                        \n#> regionCentral Norway                            ***\n#> regionEastern Norway                               \n#> regionWestern Norway                            ***\n#> regionSouthern Norway                              \n#> tilstand_num                                    ***\n#> hovedtypeV10:regionCentral Norway               ** \n#> hovedtypeV3:regionCentral Norway                ***\n#> hovedtypeV9:regionCentral Norway                ***\n#> hovedtypeV10:regionEastern Norway                  \n#> hovedtypeV3:regionEastern Norway                .  \n#> hovedtypeV9:regionEastern Norway                   \n#> hovedtypeV10:regionWestern Norway                  \n#> hovedtypeV3:regionWestern Norway                ***\n#> hovedtypeV9:regionWestern Norway                ***\n#> hovedtypeV10:regionSouthern Norway              *  \n#> hovedtypeV3:regionSouthern Norway               ** \n#> hovedtypeV9:regionSouthern Norway               ** \n#> hovedtypeV10:tilstand_num                       ***\n#> hovedtypeV3:tilstand_num                        .  \n#> hovedtypeV9:tilstand_num                        ***\n#> hovedtypeV1:regionCentral Norway:tilstand_num      \n#> hovedtypeV10:regionCentral Norway:tilstand_num     \n#> hovedtypeV3:regionCentral Norway:tilstand_num   ***\n#> hovedtypeV9:regionCentral Norway:tilstand_num      \n#> hovedtypeV1:regionEastern Norway:tilstand_num      \n#> hovedtypeV10:regionEastern Norway:tilstand_num     \n#> hovedtypeV3:regionEastern Norway:tilstand_num      \n#> hovedtypeV9:regionEastern Norway:tilstand_num      \n#> hovedtypeV1:regionWestern Norway:tilstand_num   ***\n#> hovedtypeV10:regionWestern Norway:tilstand_num     \n#> hovedtypeV3:regionWestern Norway:tilstand_num      \n#> hovedtypeV9:regionWestern Norway:tilstand_num   ** \n#> hovedtypeV1:regionSouthern Norway:tilstand_num  ***\n#> hovedtypeV10:regionSouthern Norway:tilstand_num    \n#> hovedtypeV3:regionSouthern Norway:tilstand_num     \n#> hovedtypeV9:regionSouthern Norway:tilstand_num     \n#> \n#> Phi coefficients (precision model with identity link):\n#>       Estimate Std. Error z value Pr(>|z|)    \n#> (phi)  159.671      2.905   54.96   <2e-16 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 \n#> \n#> Type of estimator: ML (maximum likelihood)\n#> Log-likelihood: 1.278e+04 on 41 Df\n#> Pseudo R-squared: 0.5115\n#> Number of iterations: 51 (BFGS) + 2 (Fisher scoring)\nmodel.wetland.cond.Sent.N <- betareg(mean_beta ~ tilstand_num * hovedtype, data = SentinelNDVI.wetland.train[SentinelNDVI.wetland.train$region == \"Northern Norway\", ])\nmodel.wetland.cond.Sent.C <- betareg(mean_beta ~ tilstand_num * hovedtype, data = SentinelNDVI.wetland.train[SentinelNDVI.wetland.train$region == \"Central Norway\", ])\nmodel.wetland.cond.Sent.W <- betareg(mean_beta ~ tilstand_num * hovedtype, data = SentinelNDVI.wetland.train[SentinelNDVI.wetland.train$region == \"Western Norway\", ])\nmodel.wetland.cond.Sent.E <- betareg(mean_beta ~ tilstand_num * hovedtype, data = SentinelNDVI.wetland.train[SentinelNDVI.wetland.train$region == \"Eastern Norway\", ])\nmodel.wetland.cond.Sent.S <- betareg(mean_beta ~ tilstand_num * hovedtype, data = SentinelNDVI.wetland.train[SentinelNDVI.wetland.train$region == \"Southern Norway\", ])\nSentinelNDVI.wetland.train %>%\n  filter(region == \"Northern Norway\") %>%\n  ggplot(aes(x = tilstand, y = mean)) +\n  geom_violin() +\n  geom_point(size = 0.7, shape = 16, color = \"grey\", position = position_jitter(.1) ) +\n  theme(axis.text.x = element_text(angle = -45, vjust = 0.5, hjust = 0.2, size = 9)) +\n  ggtitle(\"Northern Norway\") +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Condition\") +\n  facet_wrap(~hovedtype)\nsummary(model.wetland.cond.Sent.N)$coefficients\n#> $mean\n#>                              Estimate  Std. Error\n#> (Intercept)                1.67333314 0.008318038\n#> tilstand_num              -0.04643158 0.012959228\n#> hovedtypeV10               0.21150547 0.031686815\n#> hovedtypeV3               -0.15282168 0.016532632\n#> hovedtypeV9                0.01819835 0.017764052\n#> tilstand_num:hovedtypeV10  0.09975973 0.019917685\n#> tilstand_num:hovedtypeV3   0.03632141 0.017944353\n#> tilstand_num:hovedtypeV9   0.10859877 0.017061551\n#>                              z value     Pr(>|z|)\n#> (Intercept)               201.169208 0.000000e+00\n#> tilstand_num               -3.582897 3.398044e-04\n#> hovedtypeV10                6.674873 2.474460e-11\n#> hovedtypeV3                -9.243639 2.382542e-20\n#> hovedtypeV9                 1.024448 3.056237e-01\n#> tilstand_num:hovedtypeV10   5.008601 5.482719e-07\n#> tilstand_num:hovedtypeV3    2.024114 4.295847e-02\n#> tilstand_num:hovedtypeV9    6.365117 1.951404e-10\n#> \n#> $precision\n#>       Estimate Std. Error  z value      Pr(>|z|)\n#> (phi) 188.7014    6.66989 28.29153 4.393116e-176\nSentinelNDVI.wetland.train %>%\n  filter(region == \"Central Norway\") %>%\n  ggplot(aes(x = tilstand, y = mean)) +\n  geom_violin() +\n  geom_point(size = 0.7, shape = 16, color = \"grey\", position = position_jitter(.1) ) +\n  theme(axis.text.x = element_text(angle = -45, vjust = 0.5, hjust = 0.2, size = 9)) +\n  ggtitle(\"Central Norway\") +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Condition\") +\n  facet_wrap(~hovedtype)\nsummary(model.wetland.cond.Sent.C)$coefficients\n#> $mean\n#>                              Estimate  Std. Error\n#> (Intercept)                1.48904059 0.009730197\n#> tilstand_num              -0.02986332 0.010324515\n#> hovedtypeV10               0.35557629 0.045636443\n#> hovedtypeV3               -0.23033949 0.012687183\n#> hovedtypeV9                0.14627542 0.022150023\n#> tilstand_num:hovedtypeV10  0.09659936 0.029484671\n#> tilstand_num:hovedtypeV3   0.08767876 0.011747020\n#> tilstand_num:hovedtypeV9   0.07911535 0.019427414\n#>                              z value     Pr(>|z|)\n#> (Intercept)               153.032930 0.000000e+00\n#> tilstand_num               -2.892467 3.822287e-03\n#> hovedtypeV10                7.791499 6.621894e-15\n#> hovedtypeV3               -18.155291 1.166093e-73\n#> hovedtypeV9                 6.603850 4.006160e-11\n#> tilstand_num:hovedtypeV10   3.276257 1.051928e-03\n#> tilstand_num:hovedtypeV3    7.463916 8.398842e-14\n#> tilstand_num:hovedtypeV9    4.072356 4.653991e-05\n#> \n#> $precision\n#>       Estimate Std. Error  z value      Pr(>|z|)\n#> (phi) 123.0947   3.562555 34.55236 1.313652e-261\nSentinelNDVI.wetland.train %>%\n  filter(region == \"Western Norway\") %>%\n  ggplot(aes(x = tilstand, y = mean)) +\n  geom_violin() +\n  geom_point(size = 0.7, shape = 16, color = \"grey\", position = position_jitter(.1) ) +\n  theme(axis.text.x = element_text(angle = -45, vjust = 0.5, hjust = 0.2, size = 9)) +\n  ggtitle(\"Western Norway\") +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Condition\") +\n  facet_wrap(~hovedtype)\nsummary(model.wetland.cond.Sent.W)$coefficients\n#> $mean\n#>                              Estimate Std. Error\n#> (Intercept)                1.56690485 0.01212684\n#> tilstand_num               0.06381437 0.01673950\n#> hovedtypeV10               0.23487085 0.03305072\n#> hovedtypeV3                0.02996982 0.02246694\n#> hovedtypeV9                0.11362231 0.01696498\n#> tilstand_num:hovedtypeV10  0.01171594 0.02770462\n#> tilstand_num:hovedtypeV3  -0.13143403 0.03919401\n#> tilstand_num:hovedtypeV9  -0.04955503 0.01956023\n#>                               z value     Pr(>|z|)\n#> (Intercept)               129.2096140 0.000000e+00\n#> tilstand_num                3.8122020 1.377342e-04\n#> hovedtypeV10                7.1063768 1.191289e-12\n#> hovedtypeV3                 1.3339521 1.822196e-01\n#> hovedtypeV9                 6.6974617 2.120708e-11\n#> tilstand_num:hovedtypeV10   0.4228878 6.723771e-01\n#> tilstand_num:hovedtypeV3   -3.3534216 7.981904e-04\n#> tilstand_num:hovedtypeV9   -2.5334586 1.129431e-02\n#> \n#> $precision\n#>       Estimate Std. Error  z value      Pr(>|z|)\n#> (phi) 189.3318   8.789978 21.53951 6.640391e-103\nSentinelNDVI.wetland.train %>%\n  filter(region == \"Eastern Norway\") %>%\n  ggplot(aes(x = tilstand, y = mean)) +\n  geom_violin() +\n  geom_point(size = 0.7, shape = 16, color = \"grey\", position = position_jitter(.1) ) +\n  theme(axis.text.x = element_text(angle = -45, vjust = 0.5, hjust = 0.2, size = 9)) +\n  ggtitle(\"Eastern Norway\") +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Condition\") +\n  facet_wrap(~hovedtype)\nsummary(model.wetland.cond.Sent.E)$coefficients\n#> $mean\n#>                               Estimate Std. Error\n#> (Intercept)                1.704888063 0.01455067\n#> tilstand_num              -0.017517523 0.01102260\n#> hovedtypeV10               0.239364865 0.03503891\n#> hovedtypeV3               -0.089152665 0.02943892\n#> hovedtypeV9               -0.019019876 0.02347098\n#> tilstand_num:hovedtypeV10  0.066889663 0.02003607\n#> tilstand_num:hovedtypeV3   0.006116913 0.02050429\n#> tilstand_num:hovedtypeV9   0.070976897 0.01656420\n#>                               z value     Pr(>|z|)\n#> (Intercept)               117.1690768 0.000000e+00\n#> tilstand_num               -1.5892374 1.120068e-01\n#> hovedtypeV10                6.8314015 8.408902e-12\n#> hovedtypeV3                -3.0283942 2.458572e-03\n#> hovedtypeV9                -0.8103571 4.177350e-01\n#> tilstand_num:hovedtypeV10   3.3384627 8.424333e-04\n#> tilstand_num:hovedtypeV3    0.2983236 7.654562e-01\n#> tilstand_num:hovedtypeV9    4.2849573 1.827743e-05\n#> \n#> $precision\n#>       Estimate Std. Error  z value     Pr(>|z|)\n#> (phi)  205.477   10.16601 20.21217 7.651633e-91\nSentinelNDVI.wetland.train %>%\n  filter(region == \"Southern Norway\") %>%\n  ggplot(aes(x = tilstand, y = mean)) +\n  geom_violin() +\n  geom_point(size = 1, shape = 16, color = \"grey\", position = position_jitter(.1) ) +\n  theme(axis.text.x = element_text(angle = -45, vjust = 0.5, hjust = 0.2, size = 9)) +\n  ggtitle(\"Southern Norway\") +\n  labs(y = \"NDVI values (Sentinel-2)\", x = \"Condition\") +\n  facet_wrap(~hovedtype)\nsummary(model.wetland.cond.Sent.S)$coefficients\n#> $mean\n#>                              Estimate Std. Error    z value\n#> (Intercept)                1.62525471 0.02369318 68.5958826\n#> tilstand_num               0.07371408 0.02435052  3.0272082\n#> hovedtypeV10               0.37289353 0.04909476  7.5953840\n#> hovedtypeV3               -0.01546251 0.03461680 -0.4466765\n#> hovedtypeV9                0.14854854 0.03321194  4.4727444\n#> tilstand_num:hovedtypeV10 -0.02881262 0.03532794 -0.8155759\n#> tilstand_num:hovedtypeV3  -0.08348705 0.04654306 -1.7937595\n#> tilstand_num:hovedtypeV9  -0.03041127 0.02824395 -1.0767359\n#>                               Pr(>|z|)\n#> (Intercept)               0.000000e+00\n#> tilstand_num              2.468239e-03\n#> hovedtypeV10              3.068811e-14\n#> hovedtypeV3               6.551087e-01\n#> hovedtypeV9               7.722205e-06\n#> tilstand_num:hovedtypeV10 4.147427e-01\n#> tilstand_num:hovedtypeV3  7.285156e-02\n#> tilstand_num:hovedtypeV9  2.815983e-01\n#> \n#> $precision\n#>       Estimate Std. Error z value     Pr(>|z|)\n#> (phi) 283.6989   22.81418 12.4352 1.683209e-35"},{"path":"NDVI-indicator-wetland.html","id":"across-time-ndviw","chapter":"13 NDVI - wetland ecosystems","heading":"13.7.5 NDVI across time - Sentinel, MODIS & LandSat","text":"last step, can investigate NDVI changed time. include data MODIS Landsat addition Sentinel-2.First, ’s data handling . merge Sentinel, MODIS, Landsat data show full picture across time. model time series Satellite separately.Now can plot time series main ecosystem type, showing satellite time series separately:\nFigure 13.17: Comparing NDVI time series three data sets.\nquite obvious NDVI values three satellites quantitatively comparable.\nvary placement along y-axis variance.\nModis data absent V4-ecosystem type large pixel size compared NiN-polygon sizes.\nV10, Modis poorly represented reason.can test consistent temporal changes NDVI running regressions including year covariate.first investigate model testing NDVI function year main ecosystem type polygons good condition, separately satellite.’s increase NDVI time three satellite time series essentially major wetland ecosystem types good condition.\nworth pointing though model MODIS data shows 1/10 effect size time slope way less statistical power compared Sentinel Landsat.Given systematically higher NDVI-values decreasing condition semi-natural wetlands, may ask question temporal NDVI increase might stronger reduced condition?Indeed, temporal NDVI increase stronger semi-natural wetlands reduced ecological condition, Sentinel Landsat.\nMODIS, time slope 1/10 slopes two satellite time series, significant.","code":"\n## data handling for time series analysis\n# Sentinel time series checked in exploratory analysis script\n\n# checking time series for MODIS\n   # ModisNDVI.wetland %>%\n   #   group_by(id, year) %>%\n   #   filter(mean == max(mean, na.rm = TRUE)) %>%\n   #   ggplot(aes(x = year, y = mean)) +\n   #   geom_point() +\n   #   facet_wrap(~hovedtype)\n# 2022 does not stand out as in the Sentinel data, so we keep it\nModisNDVI.wetland <- ModisNDVI.wetland %>%\n  group_by(id, year) %>%\n  filter(mean == max(mean, na.rm = TRUE))\n\n# checking time series for Landsat\n   # LandsatNDVI.wetland %>%\n   #   group_by(id, year) %>%\n   #   filter(mean == max(mean, na.rm = TRUE)) %>%\n   #   ggplot(aes(x = year, y = mean)) +\n   #   geom_point() +\n   #   facet_wrap(~hovedtype)\n# nothing worrying to see here either\nLandsatNDVI.wetland <- LandsatNDVI.wetland %>%\n  group_by(id, year) %>%\n  filter(mean == max(mean, na.rm = TRUE))\n\n# transformation of NDVI scale to beta scale\n# SentinelNDVI.wetland$mean_beta <- (SentinelNDVI.wetland$mean + 1) / 2\nModisNDVI.wetland$mean_beta <- (ModisNDVI.wetland$mean + 1) / 2\nLandsatNDVI.wetland$mean_beta <- (LandsatNDVI.wetland$mean + 1) / 2\n\n# check if there's any 0s or 1s (which beta cannot handle)\n   # summary(SentinelNDVI.wetland$mean_beta)\n   # summary(ModisNDVI.wetland$mean_beta)\n   # summary(LandsatNDVI.wetland$mean_beta)\n# replace 1s in Landsat data with 0.9999\nLandsatNDVI.wetland <- LandsatNDVI.wetland %>%\n  mutate(mean_beta = replace(mean_beta, mean_beta == 1, 0.9999))\n\n# check if the three Satellite objects have the same structure (for concatenating them)\n   # names(SentinelNDVI.wetland)\n   # names(ModisNDVI.wetland)\n   # names(LandsatNDVI.wetland)\n# Sentinel and Landsat have each an extra column -> omit them when concatenating further below\n# one column is named slightly differently in the Sentinel data -> rename it\nSentinelNDVI.wetland <- SentinelNDVI.wetland %>%\n  dplyr::rename(\"system.index\" = \"system:index\")\n\n# check if they have the same geometry\n   # st_crs(SentinelNDVI.wetland)\n   # st_crs(ModisNDVI.wetland)\n   # st_crs(LandsatNDVI.wetland)\n# all good\n\n# add an increment to the year variable to avoid overlapping data being hidden in figures\nSentinelNDVI.wetland$year_jit <- SentinelNDVI.wetland$year + 0.3\nModisNDVI.wetland$year_jit <- ModisNDVI.wetland$year - 0.3\nLandsatNDVI.wetland$year_jit <- LandsatNDVI.wetland$year\n\n# concatenate the three Satellite objects\nallSatNDVI.wetland <- rbind(\n  SentinelNDVI.wetland[, !names(SentinelNDVI.wetland) %in% \"subtype\"],\n  ModisNDVI.wetland,\n  LandsatNDVI.wetland[, !names(LandsatNDVI.wetland) %in% \"column_label\"]\n)\n# add variable for Satellite identity\nallSatNDVI.wetland$Sat <- c(\n  rep(\"Sentinel\", nrow(SentinelNDVI.wetland)),\n  rep(\"Modis\", nrow(ModisNDVI.wetland)),\n  rep(\"Landsat\", nrow(LandsatNDVI.wetland))\n)\nallSatNDVI.wetland$Sat <- factor(allSatNDVI.wetland$Sat, levels = c(\"Sentinel\", \"Modis\", \"Landsat\"))\n  # levels(allSatNDVI.wetland$Sat)\n# plot\nallSatNDVI.wetland %>%\n  ggplot(aes(x = year_jit, y = mean, color = Sat)) +\n  geom_point() +\n  ggtitle(\"NDVI across time\") +\n  labs(y = \"NDVI values\", x = \"Year\") +\n  facet_wrap(~hovedtype, ncol = 1)\nmodel.wetland.time.GodTilst.Sent <- glmmTMB(mean_beta ~ year * hovedtype + (1 | id), family = beta_family(), data = SentinelNDVI.wetland[SentinelNDVI.wetland$tilstand == \"God\", ])\nmodel.wetland.time.GodTilst.Modi <- glmmTMB(mean_beta ~ year * hovedtype + (1 | id), family = beta_family(), data = ModisNDVI.wetland[ModisNDVI.wetland$tilstand == \"God\", ])\nmodel.wetland.time.GodTilst.Land <- glmmTMB(mean_beta ~ year * hovedtype + (1 | id), family = beta_family(), data = LandsatNDVI.wetland[LandsatNDVI.wetland$tilstand == \"God\", ])\nsummary(model.wetland.time.GodTilst.Sent)$coefficients$cond\n#>                        Estimate   Std. Error     z value\n#> (Intercept)       -1.925588e+01 0.9754640428 -19.7402253\n#> year               1.033546e-02 0.0004833795  21.3816715\n#> hovedtypeV10      -9.969031e+00 3.8172312004  -2.6115870\n#> hovedtypeV3       -1.011107e+01 1.4976132157  -6.7514561\n#> hovedtypeV4       -6.859260e-01 4.3058771904  -0.1593000\n#> hovedtypeV9       -7.163768e-01 1.8330129528  -0.3908193\n#> year:hovedtypeV10  5.062563e-03 0.0018916053   2.6763315\n#> year:hovedtypeV3   4.889985e-03 0.0007421254   6.5891629\n#> year:hovedtypeV4   4.147249e-04 0.0021337353   0.1943657\n#> year:hovedtypeV9   3.864512e-04 0.0009083285   0.4254531\n#>                        Pr(>|z|)\n#> (Intercept)        9.734292e-87\n#> year              1.979126e-101\n#> hovedtypeV10       9.012306e-03\n#> hovedtypeV3        1.463687e-11\n#> hovedtypeV4        8.734326e-01\n#> hovedtypeV9        6.959308e-01\n#> year:hovedtypeV10  7.443299e-03\n#> year:hovedtypeV3   4.423132e-11\n#> year:hovedtypeV4   8.458896e-01\n#> year:hovedtypeV9   6.705064e-01\nsummary(model.wetland.time.GodTilst.Modi)$coefficients$cond\n#>                       Estimate   Std. Error    z value\n#> (Intercept)      -1.0322620875 1.0901088732 -0.9469349\n#> year              0.0015527003 0.0005418631  2.8654842\n#> hovedtypeV3      -1.2427690096 1.4970870034 -0.8301248\n#> hovedtypeV9       0.4793622528 2.4276936759  0.1974558\n#> year:hovedtypeV3  0.0005978803 0.0007441607  0.8034291\n#> year:hovedtypeV9 -0.0002091212 0.0012067644 -0.1732908\n#>                    Pr(>|z|)\n#> (Intercept)      0.34367198\n#> year             0.00416372\n#> hovedtypeV3      0.40646824\n#> hovedtypeV9      0.84347085\n#> year:hovedtypeV3 0.42172678\n#> year:hovedtypeV9 0.86242282\nsummary(model.wetland.time.GodTilst.Land)$coefficients$cond\n#>                        Estimate   Std. Error     z value\n#> (Intercept)       -2.074622e+01 1.614497e-01 -128.499599\n#> year               1.124142e-02 8.060694e-05  139.459752\n#> hovedtypeV10       1.169580e+00 6.726923e-01    1.738656\n#> hovedtypeV3        4.633300e+00 2.466544e-01   18.784579\n#> hovedtypeV4       -2.500609e+00 1.695836e+00   -1.474559\n#> hovedtypeV9        1.528318e+00 2.998024e-01    5.097751\n#> year:hovedtypeV10 -4.819325e-04 3.359055e-04   -1.434727\n#> year:hovedtypeV3  -2.441902e-03 1.231224e-04  -19.833130\n#> year:hovedtypeV4   1.365779e-03 8.468504e-04    1.612775\n#> year:hovedtypeV9  -7.481056e-04 1.496844e-04   -4.997888\n#>                       Pr(>|z|)\n#> (Intercept)       0.000000e+00\n#> year              0.000000e+00\n#> hovedtypeV10      8.209535e-02\n#> hovedtypeV3       1.009844e-78\n#> hovedtypeV4       1.403312e-01\n#> hovedtypeV9       3.437116e-07\n#> year:hovedtypeV10 1.513650e-01\n#> year:hovedtypeV3  1.541442e-87\n#> year:hovedtypeV4  1.067934e-01\n#> year:hovedtypeV9  5.796166e-07\nmodel.wetland.time.tilst.V9V10.Sent <- glmmTMB(mean_beta ~ year * tilstand + (1 | id), family = beta_family(), data = SentinelNDVI.wetland[SentinelNDVI.wetland$hovedtype %in% c(\"V9\", \"V10\"), ])\nmodel.wetland.time.tilst.V9V10.Modi <- glmmTMB(mean_beta ~ year * tilstand + (1 | id), family = beta_family(), data = ModisNDVI.wetland[ModisNDVI.wetland$hovedtype %in% c(\"V9\", \"V10\"), ])\nmodel.wetland.time.tilst.V9V10.Land <- glmmTMB(mean_beta ~ year * tilstand + (1 | id), family = beta_family(), data = LandsatNDVI.wetland[LandsatNDVI.wetland$hovedtype %in% c(\"V9\", \"V10\"), ])\nsummary(model.wetland.time.tilst.V9V10.Sent)$coefficients$cond\n#>                                   Estimate  Std. Error\n#> (Intercept)                  -21.318811477 1.671765664\n#> year                           0.011403740 0.000828431\n#> tilstandModerat               -8.338657043 2.558213254\n#> tilstandRedusert             -11.704682247 2.468918581\n#> tilstandSvaert_redusert      -10.747458539 3.649454324\n#> year:tilstandModerat           0.004174034 0.001267707\n#> year:tilstandRedusert          0.005898434 0.001223461\n#> year:tilstandSvaert_redusert   0.005429102 0.001808474\n#>                                 z value     Pr(>|z|)\n#> (Intercept)                  -12.752273 3.027877e-37\n#> year                          13.765468 4.112137e-43\n#> tilstandModerat               -3.259563 1.115840e-03\n#> tilstandRedusert              -4.740813 2.128619e-06\n#> tilstandSvaert_redusert       -2.944949 3.230074e-03\n#> year:tilstandModerat           3.292585 9.927104e-04\n#> year:tilstandRedusert          4.821105 1.427649e-06\n#> year:tilstandSvaert_redusert   3.002035 2.681810e-03\nsummary(model.wetland.time.tilst.V9V10.Modi)$coefficients$cond\n#>                                   Estimate  Std. Error\n#> (Intercept)                  -0.5581407751 2.019245745\n#> year                          0.0013465648 0.001004007\n#> tilstandModerat               1.4013664258 2.951242988\n#> tilstandRedusert              1.9299854474 4.462294111\n#> tilstandSvaert_redusert       5.1700628311 5.305636372\n#> year:tilstandModerat         -0.0006888262 0.001467401\n#> year:tilstandRedusert        -0.0008692581 0.002218744\n#> year:tilstandSvaert_redusert -0.0025437860 0.002637961\n#>                                 z value  Pr(>|z|)\n#> (Intercept)                  -0.2764105 0.7822328\n#> year                          1.3411904 0.1798587\n#> tilstandModerat               0.4748394 0.6349015\n#> tilstandRedusert              0.4325097 0.6653710\n#> tilstandSvaert_redusert       0.9744473 0.3298345\n#> year:tilstandModerat         -0.4694191 0.6387701\n#> year:tilstandRedusert        -0.3917794 0.6952212\n#> year:tilstandSvaert_redusert -0.9643001 0.3348955\nsummary(model.wetland.time.tilst.V9V10.Land)$coefficients$cond\n#>                                   Estimate   Std. Error\n#> (Intercept)                  -19.216406849 0.2536004285\n#> year                           0.010503751 0.0001266447\n#> tilstandModerat               -3.130595762 0.3877833509\n#> tilstandRedusert              -4.340231073 0.3849970602\n#> tilstandSvaert_redusert       -5.380941705 0.5655042387\n#> year:tilstandModerat           0.001600110 0.0001936701\n#> year:tilstandRedusert          0.002271715 0.0001922920\n#> year:tilstandSvaert_redusert   0.002801372 0.0002824738\n#>                                 z value     Pr(>|z|)\n#> (Intercept)                  -75.774347 0.000000e+00\n#> year                          82.938724 0.000000e+00\n#> tilstandModerat               -8.073054 6.856151e-16\n#> tilstandRedusert             -11.273414 1.775502e-29\n#> tilstandSvaert_redusert       -9.515299 1.811917e-21\n#> year:tilstandModerat           8.262039 1.432052e-16\n#> year:tilstandRedusert         11.813881 3.309240e-32\n#> year:tilstandSvaert_redusert   9.917278 3.501744e-23"},{"path":"NDVI-indicator-wetland.html","id":"overall-conclusion-2","chapter":"13 NDVI - wetland ecosystems","heading":"13.8 Overall conclusion","text":"NDVI wetland ecosystem vary condition also ecosystem type variance thus overlap condition classes ecosystem types large. Especially semi-natural wetland ecosystems show consistent pattern higher NDVI larger temporal NDVI increase sites reduced ecological condition, also links well registered condition variables behind lower condition scores (shrub/tree encroachment, low land-use intensity, succession) thus reduced land-use main pressure identified systems.\nlarge variance thus overlap condition classes ecosystem types makes generally difficult define useful scaling values absolute NDVI values.\nSince ecological condition also relates temporal development NDVI values analyses , alternative approach can define scaling values time slopes instance done NDVI indicator ecological condition assessment Norwegian mountains (Framstad et al. 2022 references , see coded example https://ninanor.github.io/IBECA/ndvi-trend_fjell.html).Beyond considerations, two general issues limit comprehensive robust application satellite based NDVI-data ecological condition context:lacking ecosystem maps wetland ecosystems\nanalysis hand clearly shows different wetland ecosystem types display different greenness levels thus need evaluated separately. Thus, need ecosystem maps, allow us treat NDVI values, temporal changes , least different major ecosystem types within wetlands separately.lacking good ecological understanding ground-truthing NDVI wetland ecosystems\nUnlike ecosystems like forests, tundra, savannah similar, little empirical work ground-truthing data documented link NDVI values ecological phenomena wetlands., need field studies investigating:connection NDVI ecological drivers like example potential effects Nitrogen deposition. includes need understanding temporal increases NDVI ecosystems good condition.reflectance different wetland types affected moist moss layer time measuring. literature suggests high variability NDVI measurements mosses particular, part due moisture content (Valøen, 2019). Minerotrophic wetlands (V1) dominated graminoids V3, moss-layer generally visible . time, wetlands generally drier western parts Norway East (Moen et al. 2011), NDVI patterns may, least part, determined moisture.addition, investigations test NDVI-condition pattern vary across biogeographic regions addition administrative regions (ecologically irrelevant), order better understand results administrative regions.References introduced conclusion:Moen, ., Lyngstad, . & Øien, D.-. 2011. Kunnskapsstatus og innspill til faggrunnlag oseanisk nedbørmyr som utvalgt naturtype. – NTNU Vitensk.mus. Rapp. bot. Ser. 2011-7: 1-72Valøen, K. 2019. Stochastic rain events increase NDVI moss water content: High-Arctic field experiment. NTNU","code":""},{"path":"NDVI-indicator-wetland.html","id":"export-ndviw","chapter":"13 NDVI - wetland ecosystems","heading":"13.8.1 Eksport","text":"","code":""},{"path":"areal-av-isbreer.html","id":"areal-av-isbreer","chapter":"14 Areal av isbreer","heading":"14 Areal av isbreer","text":"Author date:Anders L. KolstadMarch 2023","code":""},{"path":"areal-av-isbreer.html","id":"introduction-5","chapter":"14 Areal av isbreer","heading":"14.1 Introduction","text":"indicator describes relative change glacial extent fire regions Norway. slightly different indicator used alpine assessment.","code":""},{"path":"areal-av-isbreer.html","id":"about-the-underlying-data-8","chapter":"14 Areal av isbreer","heading":"14.2 About the underlying data","text":"indicator uses maps glacier extent ( breatlas ) 2018-2019 compares similar map 1947-1985. maps owned NVE (Norsk vassdrags og energidirektorat). new map based Sentinel images, old map digitised version N50 maps, additional areal photo interpretation top.","code":""},{"path":"areal-av-isbreer.html","id":"representativity-in-time-and-space-9","chapter":"14 Areal av isbreer","heading":"14.2.1 Representativity in time and space","text":"data set (map) covers entire Norwegian mainland. two time steps, expect changes glacial extent relatively linear consistent time.\nolder map may underestimated glacial extent due better chance smaller snow ice patches captured Sentinel contra aerial photo interpretations.","code":""},{"path":"areal-av-isbreer.html","id":"original-units-6","chapter":"14 Areal av isbreer","heading":"14.2.2 Original units","text":"Area units (e.g. km2)","code":""},{"path":"areal-av-isbreer.html","id":"temporal-coverage-8","chapter":"14 Areal av isbreer","heading":"14.2.3 Temporal coverage","text":"1947-2019","code":""},{"path":"areal-av-isbreer.html","id":"aditional-comments-about-the-dataset-3","chapter":"14 Areal av isbreer","heading":"14.2.4 Aditional comments about the dataset","text":"None","code":""},{"path":"areal-av-isbreer.html","id":"ecosystem-characteristic-7","chapter":"14 Areal av isbreer","heading":"14.3 Ecosystem characteristic","text":"","code":""},{"path":"areal-av-isbreer.html","id":"norwegian-standard-4","chapter":"14 Areal av isbreer","heading":"14.3.1 Norwegian standard","text":"indicator initially assigned Abiotiske forhold characteristic, now considered Landskapsøkologiske mønstre. initial justificaton glacial melting influence water availability downstream. Now put weight glaciers just resevoirs ice water, habitat, presence abundance specific habitat can though aspect landscape state.","code":""},{"path":"areal-av-isbreer.html","id":"seea-ect","chapter":"14 Areal av isbreer","heading":"14.3.2 SEEA ECT","text":"indicator similarly assiged SEEA ECT class C1 Landscape characteristics.","code":""},{"path":"areal-av-isbreer.html","id":"collinearities-with-other-indicators-10","chapter":"14 Areal av isbreer","heading":"14.4 Collinearities with other indicators","text":"None known.","code":""},{"path":"areal-av-isbreer.html","id":"reference-state-and-values-4","chapter":"14 Areal av isbreer","heading":"14.5 Reference state and values","text":"","code":""},{"path":"areal-av-isbreer.html","id":"reference-state-3","chapter":"14 Areal av isbreer","heading":"14.5.1 Reference state","text":"indicator uses reference state indicators developed similar projects, defined Nybø et al (2017): Fagsystem fastsetting av god økologisk tilstand. glacial extent primarily, solely, dependent climate, case actual data climatic reference period previous normal period 1961-1990.","code":""},{"path":"areal-av-isbreer.html","id":"reference-values-thresholds-for-defining-good-ecological-condition-minimum-andor-maximum-values-6","chapter":"14 Areal av isbreer","heading":"14.5.2 Reference values, thresholds for defining good ecological condition, minimum and/or maximum values","text":"reference value zero change glacial extent time. threshold defining good ecological condition set 40% reduction glacial extent, default solution. normalization follows linear model, although sigmoidal weibull function might appropriate.minimum value set zero.","code":""},{"path":"areal-av-isbreer.html","id":"uncertainties-9","chapter":"14 Areal av isbreer","heading":"14.6 Uncertainties","text":"add 3% error side estimates, reported glacier maps NVE.","code":""},{"path":"areal-av-isbreer.html","id":"references-12","chapter":"14 Areal av isbreer","heading":"14.7 References","text":"Andreassen, L.M., & Winsvold, S.H. (eds.). 2012. Inventory Norwegian glaciers. NVE Rapport 38, Norges Vassdrags- og energidirektorat, 236 sAndreassen, L.M., & Winsvold, S.H. (eds.). 2012. Inventory Norwegian glaciers. NVE Rapport 38, Norges Vassdrags- og energidirektorat, 236 sAndreassen, L.M., Elvehøy, H., Kjøllmoen, B. & Belart, J.M.C. 2020. Glacier change Norway since 1960s – overview mass balance, area, length surface elevation changes. Journal Glaciology 66: 313–328Andreassen, L.M., Elvehøy, H., Kjøllmoen, B. & Belart, J.M.C. 2020. Glacier change Norway since 1960s – overview mass balance, area, length surface elevation changes. Journal Glaciology 66: 313–328Andreassen, L.M., Nagy, T., Kjøllmoen, B. & Leigh, J.R. 2022. Sentinel-2 based inventory Norway’s glaciers ice-marginal lakes 2018/2019. Journal Glaciology (review)Andreassen, L.M., Nagy, T., Kjøllmoen, B. & Leigh, J.R. 2022. Sentinel-2 based inventory Norway’s glaciers ice-marginal lakes 2018/2019. Journal Glaciology (review)Winsvold, S.H., Andreassen, L.M. & Kienholz, C.. 2014. Glacier area length changes Norway repeat inventories. Cryosphere 8: 1885-1903Winsvold, S.H., Andreassen, L.M. & Kienholz, C.. 2014. Glacier area length changes Norway repeat inventories. Cryosphere 8: 1885-1903","code":""},{"path":"areal-av-isbreer.html","id":"analyses-5","chapter":"14 Areal av isbreer","heading":"14.8 Analyses","text":"","code":""},{"path":"areal-av-isbreer.html","id":"importing-the-data-sets","chapter":"14 Areal av isbreer","heading":"14.8.1 Importing the data sets","text":"four data sets:glacial atlasn50 (old glacial atlas)regional delineation Norway (fire regions)outline mainland NorwayWe assuming glaciers found mountins, se need mask glacial atlas data using ecosystem delineation map.","code":""},{"path":"areal-av-isbreer.html","id":"glacial-atlas","chapter":"14 Areal av isbreer","heading":"14.8.1.1 Glacial atlas","text":"new glacial atlas 2018 2019 based Sentinell (ref. Liss Marie Andreassen, NVE)maps made project need CRS: EPSG:25833 - ETRS89 / UTM zone 33N.\none UTM 33N ETRS89, even defined old Proj.4 way.6915 polygons. Let’s calculate area polygons study distribution size classes.polygons small, couple big ones. largest polygon 50 km2, note polygons somewhat arbitrarily split.","code":"\n\n# server path\nbreatlas_path <- '/data/P-Prosjekter/41201042_okologisk_tilstand_fastlandsnorge_2020_dataanaly/fjell2021/data/breatlas/breatlas_2018_2019/Breatlas_20182019_temp20210922_lma.shp'\n\n# local path \n#breatlas_path <- 'P:/41201042_okologisk_tilstand_fastlandsnorge_2020_dataanaly/fjell2021/data/breatlas/breatlas_2018_2019/Breatlas_20182019_temp20210922_lma.shp'\n\n\nbreatlas <- sf::st_read(breatlas_path)\n#> Reading layer `Breatlas_20182019_temp20210922_lma' from data source `/data/P-Prosjekter/41201042_okologisk_tilstand_fastlandsnorge_2020_dataanaly/fjell2021/data/breatlas/breatlas_2018_2019/Breatlas_20182019_temp20210922_lma.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 6915 features and 27 fields (with 4 geometries empty)\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -9874.591 ymin: 6624398 xmax: 810132 ymax: 7836994\n#> Projected CRS: ETRS89 / UTM zone 33N\nbreatlas$area <- st_area(breatlas)\npar(mfrow=c(1,2))\nhist(breatlas$area)\nplot(breatlas$area)"},{"path":"areal-av-isbreer.html","id":"map-of-norway","chapter":"14 Areal av isbreer","heading":"14.8.1.2 Map of Norway","text":"map stored GitHub repository indicators/data/.","code":"\nnor <- sf::read_sf(\"data/outlineOfNorway_EPSG25833.shp\")\n\nplot(nor$geometry, axes=T, main = \"Breatlas 2018-2019\")\n  plot(breatlas$geometry, add=T, border = \"blue\")"},{"path":"areal-av-isbreer.html","id":"n50","chapter":"14 Areal av isbreer","heading":"14.8.1.3 N50","text":"old glacial extent map. Import transform , .Let’s now plot top .red areas map far right ice retreated selected glacier west coast.\nNow need devide map regions compare area n50 new glacial extent map breatlas.","code":"\n\n# server path\nn50_path <- '/data/P-Prosjekter/41201042_okologisk_tilstand_fastlandsnorge_2020_dataanaly/fjell2021/data/breatlas/n50/cryoclim_GAO_NO_1952_1985_UTM_33N.shp'\n\n# local path\n#n50_path <- 'P:/41201042_okologisk_tilstand_fastlandsnorge_2020_dataanaly/fjell2021/data/breatlas/n50/cryoclim_GAO_NO_1952_1985_UTM_33N.shp'\n\nn50 <- sf::st_read(n50_path)%>%\n  st_transform(crs = crs(breatlas))\n#> Reading layer `cryoclim_GAO_NO_1952_1985_UTM_33N' from data source `/data/P-Prosjekter/41201042_okologisk_tilstand_fastlandsnorge_2020_dataanaly/fjell2021/data/breatlas/n50/cryoclim_GAO_NO_1952_1985_UTM_33N.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 7141 features and 30 fields\n#> Geometry type: POLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -7278.562 ymin: 6623024 xmax: 812207.8 ymax: 7841654\n#> Projected CRS: WGS 84 / UTM zone 33N\nplot(nor$geometry, axes=T, main = \"n50 - 1952-1985\")\n  plot(n50$geometry, add=T, border = \"red\")\n\n# define some boundary boxes for zooming in on specific regions\nmyExt <- raster::extent(c(0, 100000, 6840000, 6900000))\nmyExt2 <- raster::extent(c(5000, 10000, 6880000, 6885000))\n\n# Prepare plotting device with one row, three columns\npar(mfrow=c(1,3))\n\n# Create three maps, each zooming in a bit further.\nplot(nor$geometry, axes=T)\n    plot(n50$geometry,  border = \"orange\", col = scales::alpha(\"orange\", 1), add=T)\n    plot(myExt, add=T, lwd=2)\n\nplot(nor$geometry, xlim=c(0, 100000),\n          ylim=c(6840000, 6900000),\n          axes=T)\n    plot(n50$geometry, add=T, col = \"grey\")\n    plot(myExt2, add=T, lwd=3, col=\"orange\")\n\n# for this last map I plot the old extent in red and the new as grey on top. The red areas still visible will be areas where the glaciers have retreated.        \nplot(nor$geometry, xlim=c(5000, 10000),\n          ylim=c(6880000, 6885000),\n     axes=T)\n    plot(n50$geometry, add=T, col = \"red\")\n    plot(breatlas$geometry, add=T, col = \"grey\")"},{"path":"areal-av-isbreer.html","id":"regions-3","chapter":"14 Areal av isbreer","heading":"14.8.1.4 Regions","text":"Importing shape file regional delineation.Let’s plot make sure correct.Get region namesThese odd. Let fix Norwegian letters manually.going need fix problem glacier polygons crossing .68 polygons valid.\nLet’s look first four reasons .convinient function fix .Let plot new, fixed map top old see match. give new valid map blue transparent colour, old map yellow transparent colour.seems worked.\nNotice also larger polygons somewhat arbitrarely divided several adjoining polygons. new map, old n50 map.Delete invalid data set.","code":"\nreg <- st_read(\"data/regions.shp\")\n#> Reading layer `regions' from data source \n#>   `/data/Egenutvikling/41001581_egenutvikling_anders_kolstad/github/ecosystemCondition/data/regions.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 5 features and 2 fields\n#> Geometry type: POLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -99551.21 ymin: 6426048 xmax: 1121941 ymax: 7962744\n#> Projected CRS: ETRS89 / UTM zone 33N\nst_crs(reg)\n#> Coordinate Reference System:\n#>   User input: ETRS89 / UTM zone 33N \n#>   wkt:\n#> PROJCRS[\"ETRS89 / UTM zone 33N\",\n#>     BASEGEOGCRS[\"ETRS89\",\n#>         ENSEMBLE[\"European Terrestrial Reference System 1989 ensemble\",\n#>             MEMBER[\"European Terrestrial Reference Frame 1989\"],\n#>             MEMBER[\"European Terrestrial Reference Frame 1990\"],\n#>             MEMBER[\"European Terrestrial Reference Frame 1991\"],\n#>             MEMBER[\"European Terrestrial Reference Frame 1992\"],\n#>             MEMBER[\"European Terrestrial Reference Frame 1993\"],\n#>             MEMBER[\"European Terrestrial Reference Frame 1994\"],\n#>             MEMBER[\"European Terrestrial Reference Frame 1996\"],\n#>             MEMBER[\"European Terrestrial Reference Frame 1997\"],\n#>             MEMBER[\"European Terrestrial Reference Frame 2000\"],\n#>             MEMBER[\"European Terrestrial Reference Frame 2005\"],\n#>             MEMBER[\"European Terrestrial Reference Frame 2014\"],\n#>             ELLIPSOID[\"GRS 1980\",6378137,298.257222101,\n#>                 LENGTHUNIT[\"metre\",1]],\n#>             ENSEMBLEACCURACY[0.1]],\n#>         PRIMEM[\"Greenwich\",0,\n#>             ANGLEUNIT[\"degree\",0.0174532925199433]],\n#>         ID[\"EPSG\",4258]],\n#>     CONVERSION[\"UTM zone 33N\",\n#>         METHOD[\"Transverse Mercator\",\n#>             ID[\"EPSG\",9807]],\n#>         PARAMETER[\"Latitude of natural origin\",0,\n#>             ANGLEUNIT[\"degree\",0.0174532925199433],\n#>             ID[\"EPSG\",8801]],\n#>         PARAMETER[\"Longitude of natural origin\",15,\n#>             ANGLEUNIT[\"degree\",0.0174532925199433],\n#>             ID[\"EPSG\",8802]],\n#>         PARAMETER[\"Scale factor at natural origin\",0.9996,\n#>             SCALEUNIT[\"unity\",1],\n#>             ID[\"EPSG\",8805]],\n#>         PARAMETER[\"False easting\",500000,\n#>             LENGTHUNIT[\"metre\",1],\n#>             ID[\"EPSG\",8806]],\n#>         PARAMETER[\"False northing\",0,\n#>             LENGTHUNIT[\"metre\",1],\n#>             ID[\"EPSG\",8807]]],\n#>     CS[Cartesian,2],\n#>         AXIS[\"(E)\",east,\n#>             ORDER[1],\n#>             LENGTHUNIT[\"metre\",1]],\n#>         AXIS[\"(N)\",north,\n#>             ORDER[2],\n#>             LENGTHUNIT[\"metre\",1]],\n#>     USAGE[\n#>         SCOPE[\"Engineering survey, topographic mapping.\"],\n#>         AREA[\"Europe between 12°E and 18°E: Austria; Denmark - offshore and offshore; Germany - onshore and offshore; Norway including Svalbard - onshore and offshore.\"],\n#>         BBOX[46.4,12,84.42,18]],\n#>     ID[\"EPSG\",25833]]\nplot(nor$geometry, axes=T)\n  plot(reg$geometry, add=T, border = \"black\", \n       col = scales::alpha(c(\"blue\", \n                             \"red\", \n                             \"green\",\n                             \"yellow\",\n                             \"brown\"), .2))\nunique(reg$region)\n#> [1] \"Nord-Norge\"      \"Midt-Norge\"      \"Ã\\u0098stlandet\"\n#> [4] \"Vestlandet\"      \"SÃ¸rlandet\"\nreg$region[reg$region==\"Ã\\u0098stlandet\"] <- \"Østlandet\"\nreg$region[reg$region==\"SÃ¸rlandet\"] <- \"Sørlandet\"\ntable(st_is_valid(breatlas))\n#> \n#> FALSE  TRUE \n#>    68  6847\nunique(st_is_valid(breatlas, reason=T))[1:5]\n#> [1] \"Valid Geometry\"                                       \n#> [2] \"Ring Self-intersection[100236.4931 6912507.5864]\"     \n#> [3] \"Ring Self-intersection[92500.2095999997 6900940.8003]\"\n#> [4] \"Ring Self-intersection[91965.6612 6883260.4912]\"      \n#> [5] \"Ring Self-intersection[120595.9254 6853573.4955]\"\n# requires lwgeom\nbreatlas2 <- st_make_valid(breatlas)\ntable(st_is_valid(breatlas2))\n#> \n#> TRUE \n#> 6915\n\n# same result:\n#breatlas2 <- st_buffer(breatlas, 0.0)\n#table(st_is_valid(breatlas2))\nplot(nor$geometry, xlim=c(5000, 10000),\n          ylim=c(6880000, 6885000),\n     axes=T)\n    plot(breatlas2$geometry, add=T, col = scales::alpha(\"blue\",0.5))\n    plot(breatlas$geometry, add=T, col = scales::alpha(\"yellow\",0.5))\nbreatlas <- breatlas2\nrm(breatlas2)"},{"path":"areal-av-isbreer.html","id":"glacial-area-per-region","chapter":"14 Areal av isbreer","heading":"14.8.2 Glacial area per region","text":"","code":""},{"path":"areal-av-isbreer.html","id":"contemporary-area","chapter":"14 Areal av isbreer","heading":"14.8.2.1 Contemporary area","text":"one method getting glacial area region.Checking happens polygons span regions. Central Norway red western Norway green. 50% transparency means get third colour overlap.worked fine.Calculating area polygonsSouthern Norway <1km2 glaciers 2018-2019.","code":"\n# This intersection operation is a bit heavy, so I do it once and store it locally so that I can import it again quickly. \n#brealtas_reg <- st_intersection(breatlas, reg)\n#saveRDS(brealtas_reg, \"indicators/data/brealtas_reg_helperfile.rds\")\n\n# Importing what I create above\nbrealtas_reg <- readRDS(\"data/brealtas_reg_helperfile.rds\")\nplot(brealtas_reg$geometry[brealtas_reg$region==\"Midt-Norge\"], \n    col = scales::alpha(\"red\",0.5), border=NA, axes=T, \n     ylim=c(6900000, 6905000),\n     xlim=c(85000, 100000))\nplot(brealtas_reg$geometry[brealtas_reg$region==\"Vestlandet\"], \n     col = scales::alpha(\"green\",0.5), border=NA, add=T)\n  plot(nor$geometry, add=T)\n#Calculating the area of the polygons\nbrealtas_reg$area_crop <- st_area(brealtas_reg)\n\n# summing the area for each region\nbretabell <- tapply(\n       brealtas_reg$area_crop,\n       brealtas_reg$region,\n       FUN = sum)\n\n# converting from m2 to km2\nbretabell <- bretabell/1000000\n\n# plotting\nbarplot(\n  bretabell,\n  ylab=\"Breareal (km2)\"\n)"},{"path":"areal-av-isbreer.html","id":"same-for-n50","chapter":"14 Areal av isbreer","heading":"14.8.2.2 Same for N50","text":"Thats good.\nNow plot reference values (n50) contemporary data together.figure , glacial area reference periond light grey todays area dark grey. height light grey bar depicts reduction glacial area.little glaicers southern Norway reference period, 4 km2. condition poor! ’m entirely sure representative. alternative set NA, think - one argue glaciers important central alpine ecosystems south.","code":"\nn50x <- st_make_valid(n50)\n#n50_reg <- st_intersection(n50x, reg)\n#saveRDS(n50_reg, \"indicators/data/n50_helperfile.rds\")\nn50_reg <- readRDS(\"data/n50_helperfile.rds\")\nplot(n50_reg$geometry[n50_reg$region==\"Midt-Norge\"], \n    col = scales::alpha(\"red\",0.5), border=NA, axes=T, \n     ylim=c(6900000, 6905000),\n     xlim=c(85000, 100000))\nplot(n50_reg$geometry[n50_reg$region==\"Vestlandet\"], \n     col = scales::alpha(\"green\",0.5), border=NA, add=T)\n  plot(nor$geometry, add=T)\nn50_reg$area_crop <- st_area(n50_reg)\n\nn50tabell <- tapply(\n       n50_reg$area_crop,\n       n50_reg$region,\n       FUN = sum)\nn50tabell <- n50tabell/1000000 \n\n\nbarplot(\n  n50tabell,\n  ylab=\"Breareal (km2)\",\n  col=\"grey\"\n)\nbarplot(\n  bretabell,\n  ylab=\"Breareal (km2)\",\n  add=T,\n  col=\"grey30\"\n)"},{"path":"areal-av-isbreer.html","id":"scaled-indicator-values-1","chapter":"14 Areal av isbreer","heading":"14.8.3 Scaled indicator values","text":"Making table indicator values.Scaling clipping regions outline NorwayPlotting static map scaled indicator valuesCalculating total change glacier extentWe’ve lost 30% glacial area time.","code":"\nmyTbl <- tibble(region           = names(bretabell),\n                indikator        = bretabell,\n                referanseverdi   = n50tabell)\nmyTbl$skalert_indikator <- myTbl$indikator/myTbl$referanseverdi\n\nknitr::kable(myTbl)\n# paste the scaled indicato values into the shape file with the regions, using the match function to make sure the align correctly\nreg$skalert_indikator <- myTbl$skalert_indikator[match(reg$region, myTbl$region)]\n\n# cutting away the marine areas\nreg_clipped <- st_intersection(reg, nor)\n#> Warning: attribute variables are assumed to be spatially\n#> constant throughout all geometries\n# round of to 2 decimals\nreg_clipped$skalert_indikator_r <- round(reg_clipped$skalert_indikator, 2)\ntmap_mode(\"plot\") # mode 'view' takes a lot longer to render, but looks better\n#> tmap mode set to plotting\ntm_shape(reg_clipped) + \n  tm_polygons(col=\"skalert_indikator\", \n              border.col = \"white\")+\n  tm_text(\"skalert_indikator_r\", size=1.5)+\n  tm_shape(nor)+\n  tm_polygons(alpha = 0,border.col = \"black\")\n# removing the value for souther norway\nreg_clipped$skalert_indikator[reg_clipped$region==\"Sørlandet\"] <- NA\nsum(bretabell)/sum(n50tabell)\n#> [1] 0.7003536"},{"path":"areal-av-isbreer.html","id":"uncertainty-2","chapter":"14 Areal av isbreer","heading":"14.8.4 Uncertainty","text":"NVE reports 3% uncertainty method. interpret +- 3% represent 99.9%CI estimate (ca 2 SD).\noriginal indicator re-sampled indicator value 10000 times , 0.015sd, get distribution indicator values. time settle reporting sd single value .","code":""},{"path":"areal-av-isbreer.html","id":"prepare-export-1","chapter":"14 Areal av isbreer","heading":"14.9 Prepare export","text":"Now can prepare final exported data file. shape file raw scaled indicator values, reference reference values, uncertainties.names columns standardised (region, v_YYYY, sd_YYYY, i_YYYY, reference).","code":"\nnames(reg_clipped)\n#> [1] \"id\"                  \"region\"             \n#> [3] \"skalert_indikator\"   \"GID_0\"              \n#> [5] \"NAME_0\"              \"geometry\"           \n#> [7] \"skalert_indikator_r\"\n# paste the raw variable estimates\nreg_clipped$v_2019 <- myTbl$indikator[match(reg_clipped$region, myTbl$region)]              \n\n# paste the reference values\nreg_clipped$reference <- myTbl$referanseverdi[match(reg_clipped$region, myTbl$region)]      \n\n# add 3% (one-sided) errors (SD=1.5% so that 1.95SD equals about 3%). \nreg_clipped$sd_2019 <- reg_clipped$v_2019*0.015\n        \n# subset the shape file to include only the columns of interest, and rename the column with the scaled indicator values, assigning the value to year 2019.\nexp <- dplyr::select(reg_clipped,\n                     region,\n                     v_2019,\n                     sd_2019,\n                     reference,\n                     i_2019 = skalert_indikator,\n                     geometry)"},{"path":"areal-av-isbreer.html","id":"eksport-shape-file-final-product","chapter":"14 Areal av isbreer","heading":"14.9.1 Eksport shape file (final product)","text":"","code":"\nsf::st_write(exp, \"indicators/indicatorMaps/breareal.shp\")\nknitr::kable(exp[,1:5])"},{"path":"areal-uten-død-eller-skadet-røsslyng-i-kystlynghei.html","id":"areal-uten-død-eller-skadet-røsslyng-i-kystlynghei","chapter":"15 Areal uten død eller skadet røsslyng i kystlynghei","heading":"15 Areal uten død eller skadet røsslyng i kystlynghei","text":"Author date:Anders L. KolstadMarch 2023","code":""},{"path":"areal-uten-død-eller-skadet-røsslyng-i-kystlynghei.html","id":"introduction-6","chapter":"15 Areal uten død eller skadet røsslyng i kystlynghei","heading":"15.1 Introduction","text":"quickly go ANO data set years 2019-2021 investigate frequeny poins fall within coastal heathlands (kystlynghei). decide whether can use data inform indicator proportion dead Calluna vulgaris (røsslyng).","code":""},{"path":"areal-uten-død-eller-skadet-røsslyng-i-kystlynghei.html","id":"analyses-6","chapter":"15 Areal uten død eller skadet røsslyng i kystlynghei","heading":"15.2 Analyses","text":"","code":""},{"path":"areal-uten-død-eller-skadet-røsslyng-i-kystlynghei.html","id":"ano-data","chapter":"15 Areal uten død eller skadet røsslyng i kystlynghei","heading":"15.2.0.1 ANO data","text":"Data downloaded .Import list terms:Table number sampling points per year:\nFigure 15.1: distribution ANO points fall within different main ecosystems.\nSub-setting data consider seni natural areas.230 points semi-natural.49 1m2 samples kystlynghei.26 250m2 circles kystlynghei. variable interest called Dekning av død/skadet røsslyng recorded 26 circles.","code":"\nano <- sf::st_read(\"/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/Naturovervaking_eksport.gdb\",\n                   layer = \"ANO_SurveyPoint\")\n#> Reading layer `ANO_SurveyPoint' from data source \n#>   `/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/Naturovervaking_eksport.gdb' \n#>   using driver `OpenFileGDB'\n#> Simple feature collection with 8974 features and 71 fields\n#> Geometry type: POINT\n#> Dimension:     XY\n#> Bounding box:  xmin: -51950 ymin: 6467050 xmax: 1094950 ymax: 7923950\n#> Projected CRS: ETRS89 / UTM zone 33N\n#st_crs(ano)\nnames(ano)\n#>  [1] \"GlobalID\"                      \n#>  [2] \"registeringsdato\"              \n#>  [3] \"klokkeslett_start\"             \n#>  [4] \"ano_flate_id\"                  \n#>  [5] \"ano_punkt_id\"                  \n#>  [6] \"ssb_id\"                        \n#>  [7] \"program\"                       \n#>  [8] \"instruks\"                      \n#>  [9] \"aar\"                           \n#> [10] \"dataansvarlig_mdir\"            \n#> [11] \"dataeier\"                      \n#> [12] \"vaer\"                          \n#> [13] \"hovedoekosystem_punkt\"         \n#> [14] \"andel_hovedoekosystem_punkt\"   \n#> [15] \"utilgjengelig_punkt\"           \n#> [16] \"utilgjengelig_begrunnelse\"     \n#> [17] \"gps\"                           \n#> [18] \"noeyaktighet\"                  \n#> [19] \"kommentar_posisjon\"            \n#> [20] \"klokkeslett_karplanter_start\"  \n#> [21] \"art_alle_registrert\"           \n#> [22] \"karplanter_dekning\"            \n#> [23] \"klokkeslett_karplanter_slutt\"  \n#> [24] \"karplanter_feltsjikt\"          \n#> [25] \"moser_dekning\"                 \n#> [26] \"torvmoser_dekning\"             \n#> [27] \"lav_dekning\"                   \n#> [28] \"stroe_dekning\"                 \n#> [29] \"jord_grus_stein_berg_dekning\"  \n#> [30] \"stubber_kvister_dekning\"       \n#> [31] \"alger_fjell_dekning\"           \n#> [32] \"kommentar_ruteanalyse\"         \n#> [33] \"fastmerker\"                    \n#> [34] \"kommentar_fastmerker\"          \n#> [35] \"kartleggingsenhet_1m2\"         \n#> [36] \"hovedtype_1m2\"                 \n#> [37] \"ke_beskrivelse_1m2\"            \n#> [38] \"kartleggingsenhet_250m2\"       \n#> [39] \"hovedtype_250m2\"               \n#> [40] \"ke_beskrivelse_250m2\"          \n#> [41] \"andel_kartleggingsenhet_250m2\" \n#> [42] \"bv_7gr_gi\"                     \n#> [43] \"bv_7jb_ba\"                     \n#> [44] \"bv_7jb_bt\"                     \n#> [45] \"bv_7jb_si\"                     \n#> [46] \"bv_7tk\"                        \n#> [47] \"bv_7se\"                        \n#> [48] \"forekomst_ntyp\"                \n#> [49] \"ntyp\"                          \n#> [50] \"kommentar_naturtyperegistering\"\n#> [51] \"side_5_note\"                   \n#> [52] \"krypende_vier_dekning\"         \n#> [53] \"ikke_krypende_vier_dekning\"    \n#> [54] \"vedplanter_total_dekning\"      \n#> [55] \"busker_dekning\"                \n#> [56] \"tresjikt_dekning\"              \n#> [57] \"treslag_registrert\"            \n#> [58] \"roesslyng_dekning\"             \n#> [59] \"roesslyngblad\"                 \n#> [60] \"pa_dekning\"                    \n#> [61] \"pa_note\"                       \n#> [62] \"pa_registrert\"                 \n#> [63] \"fa_total_dekning\"              \n#> [64] \"fa_registrert\"                 \n#> [65] \"kommentar_250m2_flate\"         \n#> [66] \"klokkeslett_slutt\"             \n#> [67] \"vedlegg_url\"                   \n#> [68] \"creator\"                       \n#> [69] \"creationdate\"                  \n#> [70] \"editor\"                        \n#> [71] \"editdate\"                      \n#> [72] \"SHAPE\"\ntable(ano$aar)\n#> \n#> 2019 2020 2021 \n#> 1111 3411 4452\npar(mar=c(15,5,0,0))\nbarplot(table(ano$hovedoekosystem_punkt), las=2)\nsnat <- ano[ano$hovedoekosystem_punkt == \"semi_naturlig_mark\",]\nsnat2 <- snat[!is.na(snat$GlobalID),]\ntable(snat$hovedtype_1m2)\n#> \n#>       Åpen jordvannsmyr              Boreal hei \n#>                       4                     107 \n#>               Kaldkilde             Kystlynghei \n#>                       1                      49 \n#>             Nakent berg              Nedbørsmyr \n#>                       2                       1 \n#>       Semi-naturlig eng       Semi-naturlig myr \n#>                      51                       6 \n#> Semi-naturlig strandeng    Semi-naturlig våteng \n#>                       1                       1 \n#>               Skogsmark \n#>                       4\ntable(ano$hovedtype_250m2)\n#> \n#>                                      Åker \n#>                                        62 \n#>                         Åpen flomfastmark \n#>                                         1 \n#>                      Åpen grunnlendt mark \n#>                                        92 \n#>                         Åpen jordvannsmyr \n#>                                       427 \n#>                                 Blokkmark \n#>                                       204 \n#>                                Boreal hei \n#>                                        94 \n#>        Breforland og snøavsmeltingsområde \n#>                                        33 \n#>               Eng-liknende oppdyrket mark \n#>                                        19 \n#>       Eng-liknende sterkt endret fastmark \n#>                                         2 \n#>                Fjellgrashei og grastundra \n#>                                        32 \n#>                 Fjellhei leside og tundra \n#>                                       853 \n#>                             Flomskogsmark \n#>                                         1 \n#>                          Grøftet torvmark \n#>                                         6 \n#>                        Grotte og overheng \n#>                                         1 \n#>               Hard sterkt endret fastmark \n#>                                         2 \n#>                   Helofytt-ferskvannssump \n#>                                         4 \n#>                       Historisk skredmark \n#>                                         3 \n#>                         Isinnfrysingsmark \n#>                                         2 \n#>                                 Kaldkilde \n#>                                         3 \n#>                               Kystlynghei \n#>                                        26 \n#>                Løs sterkt endret fastmark \n#>                                        43 \n#>                     Myr- og sumpskogsmark \n#>                                        53 \n#>                               Nakent berg \n#>                                       193 \n#>                                Nedbørsmyr \n#>                                        53 \n#>                       Oppdyrket varig eng \n#>                                        45 \n#>                           Oppfrysingsmark \n#>                                         3 \n#>                 Plener parker og liknende \n#>                                        19 \n#>                                     Rabbe \n#>                                        83 \n#>                                   Rasmark \n#>                                        58 \n#>                        Rasmarkhei og -eng \n#>                                         8 \n#>                         Semi-naturlig eng \n#>                                        45 \n#>                         Semi-naturlig myr \n#>                                        14 \n#>                      Semi-naturlig våteng \n#>                                         2 \n#>                                 Skogsmark \n#>                                      1288 \n#>                   Snø- og isdekt fastmark \n#>                                       105 \n#>                                   Snøleie \n#>                                       160 \n#>                                Strandberg \n#>                                         5 \n#>                                 Strandeng \n#>                                         2 \n#>                       Strandsumpskogsmark \n#>                                         2 \n#> Tørrlagte våtmarks- og ferskvannssystemer \n#>                                         7 \n#>                                   Torvtak \n#>                                         1 \n#>                              Treplantasje \n#>                                        13 \n#>                Våtsnøleie og snøleiekilde \n#>                                        13"},{"path":"areal-uten-død-eller-skadet-røsslyng-i-kystlynghei.html","id":"conclusion","chapter":"15 Areal uten død eller skadet røsslyng i kystlynghei","heading":"15.3 Conclusion","text":"random allocation sampling points, enough points fall coastal heathlands allow us create trustworthy indicator nature type. years data might end 100 points, borderline need order calculate condition values regional level level precision.","code":""},{"path":"naturtype.html","id":"naturtype","chapter":"16 Nature types","heading":"16 Nature types","text":"application nature type data setData exploration analyses thematic coverageAuthor:Anders L. KolstadMarch 2023Here investigate specific data set, Naturtyper - Miljødirektoratets instruks try evaluate usability designing indicators ecosystem condition. involves assessing spatial temporal representation, well conceptual alignment Norwegian system ecosystem condition assessments.precision field mapping assess . assume , even considerable, sampling error, inherent field data.first part analysis simply get overview data, making ready part 2 look thematic coverage nature types NiN variables used.","code":""},{"path":"naturtype.html","id":"import-data-and-general-summary-statistics","chapter":"16 Nature types","heading":"16.1 Import data and general summary statistics","text":"Fix non-valid polygons:data set 117k polygons, 37 variables:therefore takes little minute render plot, code :","code":"\ndir <- substr(getwd(), 1,2)\n\n# local path\n#path <- \"data/R:/GeoSpatialData/Habitats_biotopes/Norway_Miljodirektoratet_Naturtyper_nin/Original/Natur_Naturtyper_NiN_norge_med_svalbard_25833.gdb\"\n# temporary path \n#path <- \"/data/Egenutvikling/41001581_egenutvikling_anders_kolstad/data/Natur_Naturtyper_NiN_norge_med_svalbard_25833.g#db\"\n\n# server path pre 2022 data\n#path <- \"/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/Natur_Naturtyper_NiN_norge_med_svalbard_25833.gdb\"\npath <- ifelse(dir == \"C:\", \n               \"R:/GeoSpatialData/Habitats_biotopes/Norway_Miljodirektoratet_Naturtyper_nin/Original/Naturtyper_nin_0000_norge_25833_FILEGDB/Naturtyper_nin_0000_norge_25833_FILEGDB.gdb\",\n               \"/data/R/GeoSpatialData/Habitats_biotopes/Norway_Miljodirektoratet_Naturtyper_nin/Original/Naturtyper_nin_0000_norge_25833_FILEGDB/Naturtyper_nin_0000_norge_25833_FILEGDB.gdb\")\n\ndat <- sf::st_read(dsn = path)\ndat <- sf::st_make_valid(dat)\ndim(dat)\n#> [1] 117427     37\nnor <- sf::read_sf(\"data/outlineOfNorway_EPSG25833.shp\")\ntmap_mode(\"view\")\ntm_shape(dat) + \n  tm_polygons(col=\"tilstand\")+\n  tm_shape(nor)+\n  tm_polygons(alpha = 0,border.col = \"black\")"},{"path":"naturtype.html","id":"area","chapter":"16 Nature types","heading":"16.2 Area","text":"Calculating area polygon/localityThe smallest polygons 20 m2, biggest 15.8 km2.largest polygon Kalkfattig og intermediær fjellhei, leside og tundra , smallest polygon Sørlig kaldkilde.Sum mapped area divided Norwegian mainland area:0.6% Norway mapped (note bigger area surveyed, small fraction delineated). therefore essential 0.5% representative.","code":"\ndat$area <- sf::st_area(dat)\nsummary(dat$area)\n#>     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n#>       20      700     2810    17153     8674 15794178\n#Import outline of mainland Norway\nnor <- sf::read_sf(\"data/outlineOfNorway_EPSG25833.shp\")\nsum(dat$area)/sf::st_area(nor)\n#> 0.006184274 [1]"},{"path":"naturtype.html","id":"temporal-trend","chapter":"16 Nature types","heading":"16.3 Temporal trend","text":"\nFigure 16.1: Temproal trend nature type mapping using Miljødirektoratets Instruks\ndifferences field mapping instructions years. need decide whether include years, perhaps exclude first year.","code":"\ndat$kartleggingsår <- as.numeric(dat$kartleggingsår)\narea_year <- as.data.frame(tapply(dat$area, dat$kartleggingsår, sum))\nnames(area_year) <- \"area\"\narea_year$year <- row.names(area_year)\narea_year$area_km2 <- area_year$area/10^6\nggplot(area_year)+\n  geom_bar(aes(x = year, y = area_km2),\n           stat = \"identity\",\n           fill = \"grey\",\n           colour=\"black\",\n           size = 1.2)+\n  theme_bw(base_size = 12)+\n  labs(x = \"Year\", y = \"Total mapped area (km/2)\")\n#> Warning: Using `size` aesthetic for lines was deprecated in ggplot2\n#> 3.4.0.\n#> ℹ Please use `linewidth` instead.\n#> This warning is displayed once every 8 hours.\n#> Call `lifecycle::last_lifecycle_warnings()` to see where\n#> this warning was generated."},{"path":"naturtype.html","id":"condition","chapter":"16 Nature types","heading":"16.4 Condition","text":"quick overview condition scores\nFigure 3.2: overal distribution condition scores\nsites/polygons either good moderately good condition. ’m sure first class represents. seems like polygons don’t condition score. Looking just data set, also online faktaark localities, give answer:figure show cases restricted just one field season.\nFigure 16.2: Temporal trend localities without condition scores.\n\nFigure 4.1: Main ecosystems localities missing condition scores.\ncases restricted two main ecosystems, one class main ecosystem recorded. Looking cases clear relevant work , don’t know data set begin .\nFigure 16.3: Nature types localities missing condition scores.\nseven nature types (exclude mapped) don’t condition score.Snøleieblokkmark rabbeblokkmark protocol assessing condition status. Leirskredgrop, leirravine grotte nature types 2018 (mapped 2021), similarly assessed condition scores. Isinnfrysingsmark assessed condition now, 2018. Snøleieberg new 2022 mapped area. can therefore exclude localities data set:resulted deletion 370 rows, 0.32 % data.","code":"\ndat <- dat %>%\n  mutate(tilstand =  recode(tilstand, \n                            \"sværtRedusert\" = \"1 - Svært redusert\",\n                            \"dårlig\" = \"2 - Dårlig\",\n                            \"moderat\" = \"3 - Moderat\",\n                            \"god\" = \"4 - God\"))\n\nbarplot(tapply(dat$area/10^6, factor(dat$tilstand), sum))\nView(dat[dat$tilstand==\"\",])\nbarplot(table(dat$kartleggingsår[dat$tilstand==\"\"]), \n        ylab=\"Number of localities without condition scores\",\n        xlab=\"Year\")\npar(mar=c(5,20,1,1))\nbarplot(table(dat$hovedøkosystem[dat$tilstand==\"\"]),\n        horiz = T, las=2,\n        xlab=\"Number of localities without condition scores\")\npar(mar=c(5,20,1,1))\nbarplot(table(dat$naturtype[dat$tilstand==\"\"]),\n        horiz = T, las=2,\n        xlab=\"Number of localities without condition scores\")\ndat_rm <- dat\ndat <- dat_rm[dat_rm$tilstand!=\"\",]"},{"path":"naturtype.html","id":"mosaic-types","chapter":"16 Nature types","heading":"16.5 Mosaic types","text":"field mapping instruction include option delineating mosaic types. Let’s investigate cases.area displays repeating pattern mixed nature types smaller minimum mapping unit MMU, grouped many overlapping polygons unique nature types. Within nature type polygons, distribution NiN-grunntyper (online can see percentage distribution, data set presence/absence data) assigned different nature types (nature types Environmental agencies classification). condition scoring can unique overlapping nature type mosaic. don’t know precise location NiN-grunntyper part mosaic nature types.\nFigure 16.4: number mosaic localities relatively small.\nMosaic localities occur many main ecosystems (many nature types therein).\nFigure 3.9: Distribution mosaic nature types across hovedøkosystem\nconclusion thatMosaic localities used pin-point NiN grunntyper (e.g. remote sensing purposes).Mosaic localities CAN used extract condition scores nature types, tied NiN grunntype listed polygon, include belong part(s) mosaic.","code":"\nbarplot(table(dat$mosaikk),\n        xlab = \"Mosaic\", ylab=\"Number of localities\")\n# Fix duplicated `hovedøkosystem`\n#unique(dat$hovedøkosystem)\ndat$hovedøkosystem[dat$hovedøkosystem==\"naturligÅpneOmråderILavlandet\"] <- \"naturligÅpneOmråderUnderSkoggrensa\"\npar(mar=c(5,20,1,1))\nbarplot(table(dat$hovedøkosystem[dat$mosaikk==\"ja\"]),\n        horiz = T, las=2,\n        xlab=\"Number of mosaic localities\")"},{"path":"naturtype.html","id":"nin-types-across-main-ecosystems","chapter":"16 Nature types","heading":"16.6 NiN types across main ecosystems","text":"NiN main types can extracted column ninKartleggingsenheter. NiN mapping units recorded field. NiN main type makes first part mapping unit code. variable oddly concatenated. Let’s tease apart.\nFigure 16.5: number NiN main types within one locality normally one, except mosaic localities.\nMosaic localities (right pane) much higher likelihood including multiple NiN main types, also occurs non-mosaic localities (10 000 cases). , , nature types defined within single NiN main type, need see whats going .First need melt data frame order tally number NiN min types within hovedøkosystem.\nFigure 16.6: Figure showing number localities NiN main type. One locality can one NiN main type. Mosaic localities excluded figure.\nmessy figure, point , lot miss-match NiN main types hovedøkosystem. Taking one example: T2 (åpen grunnledt mark) found mountains, one case occurs. view case.. find online fact sheet locality, see actually mosaic. nature type called Kalkfattig og intermediær fjellhei, leside og tundra defined strictly T3, field surveyor recorded lots NiN mapping units (hence, main NiN types) addition. mistake. Online can see locality 50% T3, information data set available. Miljødirektoratet consider adding information downloadable dataset. order NiN types ninKartleggingsenheter column reflecting commonness types ether.way extract defining NiN type naturtype column, nice. Miljødirektoratet may consider adding well. exclude localities mosaics, multiple NiN main types (, ’re going , least), first need know naturtype allow multiple NiN main types.next figure show, cases restricted mapping year, hence changes field protocol.\nFigure 16.7: Temporal trend recording non-mosaic localities recorded consisting multiple NiN mapping units different NiN main types.\nLets look common nature types recorded way.\nFigure 16.8: ten common nature types number localities multiple NiN main types\n‘Hule eiker’ special case recorded points polygons, can found NiN main type hovedøkosystem.Kystlynghei often occurs mosaic, figure 16.8 excluded mosaic localities, kystlynghei strictly defined T34.\ntrue naturbeitemark restricted T32.\nMaybe localities recorded mosaic localities. case, automatically extract main NiN type rows now.remaining option manually assign defining NiN main type nature type. data included data set, need sourced mapping protocols different field seasons.deeper analyses causes localities mapped NiN main types outside definition nature type, see Appendix 1.","code":"\n#dat$ninKartleggingsenheter  [1:10]\n# remove NA prefix:\ndat$ninKartleggingsenheter2 <- gsub(\"NA_\", dat$ninKartleggingsenheter, replacement = \"\")\n#dat$ninKartleggingsenheter2[1:30]\n\ndat$ninKartleggingsenheter2 <- str_replace_all(dat$ninKartleggingsenheter2, \".[CE].[\\\\d]{1,}\", replacement = \"\")\n#dat$ninKartleggingsenheter2[1:30]\ndat$ninKartleggingsenheter2 <- str_replace_all(dat$ninKartleggingsenheter2, \"-.\", replacement = \"\")\nuni <- function(x){paste(unique(unlist(strsplit(x, \",\"))), collapse = \",\")}\ndat$ninKartleggingsenheter3 <- lapply(dat$ninKartleggingsenheter2, uni)\nn_uni <- function(x){length(unique(unlist(strsplit(x, \",\"))))}\ndat$n_ninKartleggingsenheter <- lapply(dat$ninKartleggingsenheter2, n_uni)\ndat$n_ninKartleggingsenheter <- as.numeric(dat$n_ninKartleggingsenheter) \n\npar(mfrow=c(1,3))\nbarplot(table(dat$n_ninKartleggingsenheter),\n        xlab = \"Number of NiN main types\",\n        ylab = \"Number of localities\")\nbarplot(table(dat$n_ninKartleggingsenheter[dat$mosaikk==\"nei\"]),\n        xlab = \"Number of NiN main types\\n(Mosaic localities excluded)\")\nbarplot(table(dat$n_ninKartleggingsenheter[dat$mosaikk==\"ja\"]),\n        xlab = \"Number of NiN main types\\n(Mosaic localities only)\")\ndat_melt <- tidyr::separate_rows(dat, ninKartleggingsenheter3)\nggplot(dat_melt[dat_melt$mosaikk!=\"ja\",])+\n  geom_bar(aes(x = ninKartleggingsenheter3))+\n  coord_flip()+\n  theme_bw(base_size = 12)+\n  facet_wrap(\"hovedøkosystem\",\n             scales = \"free\")\nView(dat_melt[dat_melt$mosaikk!=\"Ja\" & dat_melt$hovedøkosystem==\"Fjell\" & dat_melt$ninKartleggingsenheter3==\"T2\",])\npar(mar=c(2,6,2,2))\ntemp <- dat[dat$n_ninKartleggingsenheter>1 & dat$mosaikk!=\"ja\",]\nbarplot(table(temp$kartleggingsår), ylab=\"Number of localities with more than one NiN main type\\n(mosaic localitie excluded) \")\ntemp2 <- as.data.frame(table(temp$naturtype, temp$n_ninKartleggingsenheter))\ntemp2 <- temp2[base::order(temp2$Freq, decreasing = T),][1:10,]\npar(mar=c(8,20,1,1))\nbarplot(temp2$Freq, names.arg = temp2$Var1, las=2,\n        horiz = T, xlab = \"Number of localities with >1 NiN main type\")\nDT::datatable(\n  dat[dat$naturtype==\"Hule eiker\",][1:5,c(\"naturtype\", \"hovedøkosystem\", \"ninKartleggingsenheter\")])"},{"path":"naturtype.html","id":"assigning-nin-main-types-to-nature-types","chapter":"16 Nature types","heading":"16.7 Assigning NiN main types to Nature types","text":"NiN main types need added manually nature types, field recorded data error prone, defining NiN units nature type included data set.start excluding three target ecosystems.also exclude Hule eiker, nature type easy tie single main ecosystem. scenarios, one might wish keep hule eiker depending main ecosystem recorded field.Get unique nature typesExtract year mappedExtract associated ecosystemCombine one data frameWe 69 nature types consider.wetland types can actually excluded way limited ecosystem mean open wetland:\nFigure 16.9: List nature types showing years nature type mapped.\nalso now exclude nature types mapped 2018 /2019 . nature types get data future, also mapped time methodology quite unstable.removed 12 nature types.Next want add NiN main types. need look definition nature type get NiN code . also extract NiN sub types (grunntyper), become messy. Therefor create second column textual/categorical description degree thematic coverage.look definitions nature type first last year type mapped, years .","code":"\ntarget <- c(\"semi-naturligMark\",\n            \"våtmark\",\n            \"naturligÅpneOmråderUnderSkoggrensa\")\ndat <- dat[dat$hovedøkosystem %in% target,]\ndat <- dat[dat$naturtype != \"Hule eiker\",]\nntyp <- unique(dat$naturtype)\nyears <- NULL\nfor(i in 1:length(ntyp)){\nyears[i] <- paste(sort(unique(dat$kartleggingsår[dat$naturtype == ntyp[i]])), collapse = \", \")\n}\neco <- NULL\nfor(i in 1:length(ntyp)){\neco[i] <- paste(unique(dat$hovedøkosystem[dat$naturtype == ntyp[i]]), collapse = \", \")\n}\nntypDF <- data.frame(\n  \"Nature_type\" = ntyp,\n  \"Year\"        = years,\n  \"Ecosystem\"   = eco\n)\nexcl_nt <- c(\"Kalkrik myr- og sumpskogsmark\",\n             #\"Flommyr, myrkant og myrskogsmark\",  # Only V9 is relevant. This type also includes V2 and V8\n             \"Gammel fattig sumpskog\",\n             \"Rik gransumpskog\",\n             \"Grankildeskog\",\n             \"Rik svartorsumpskog\",\n             \"Rik gråorsumpskog\",\n             \"Rik svartorstrandskog\",\n             \"Saltpåvirket svartorstrandskog\",\n             \"Kilde-edellauvskog\",\n             \"Saltpåvirket strand- og sumpskogsmark\",\n             \"Svak kilde og kildeskogsmark\",\n             \"Rik vierstrandskog\",\n             \"Varmekjær kildelauvskog\"\n             )\nntypDF$Nature_type <- trimws(ntypDF$Nature_type)\nntypDF <- ntypDF[!ntypDF$Nature_type %in% excl_nt,]\nDT::datatable(ntypDF)\nntypDF2 <- ntypDF[ntypDF$Year != \"2018\" &\n                  ntypDF$Year != \"2019\" & \n                  ntypDF$Year != \"2018, 2019\"# no types were mappend in 2018 & 2019 only\n                  ,]"},{"path":"naturtype.html","id":"add-nin-main-type-and-degree-of-representativity","chapter":"16 Nature types","heading":"16.7.1 Add NiN main type and degree of representativity","text":"Split new column two.","code":"\n#remove trailing white spaces\nntypDF2$Nature_type <- trimws(ntypDF2$Nature_type)\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Aktiv skredmark\"                                    ] <- \"T17 | all (if including sub-types)\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Åpen flomfastmark\"                                  ] <- \"T18 | all\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Åpen grunnlendt kalkrik mark i boreonemoral sone\"   ] <- \"T2  | calcareous\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Åpen grunnlendt kalkrik mark i sørboreal sone\"      ] <- \"T2  | calcareous\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Atlantisk høymyr\"                                   ] <- \"V3  | all (if including sub-types)\" # can also include smaller areas of V1\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Boreal hei\"                                         ] <- \"T31 | all\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Eksentrisk høymyr\"                                  ] <- \"V3  | all (if including sub-types)\" # can also include smaller areas of V1\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Eng-aktig sterkt endret fastmark\"                   ] <- \"T41 | all\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Fosse-eng\"                                          ] <- \"T15 | all\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Fosseberg\"                                          ] <- \"T1  | extra wet\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Fossepåvirket berg\"                                 ] <- \"T1  | extra wet\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Fuglefjell-eng og fugletopp\"                        ] <- \"T8  | all\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Hagemark\"                                           ] <- \"T32 | all (if including sub-types)\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Høgereligende og nordlig nedbørsmyr\"                ] <- \"V3  | all (if including sub-types)\" # torvmarksformene are excluded\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Isinnfrysingsmark\"                                  ] <- \"T20 | all\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Kalkrik helofyttsump\"                               ] <- \"L4 | calcareous\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Kanthøymyr\"                                         ] <- \"V3  | all (if including sub-types)\" # can also include smaller areas of V1\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Konsentrisk høymyr\"                                 ] <- \"V3  | all (if including sub-types)\" # can also include smaller areas of V1\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Kystlynghei\"                                        ] <- \"T34 | all\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Lauveng\"                                            ] <- \"T32 | all (if including sub-types)\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Nakent tørkeutsatt kalkberg\"                        ] <- \"T1  | calcareous and dry\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Naturbeitemark\"                                     ] <- \"T32 | all (if including sub-types)\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Øvre sandstrand uten pionervegetasjon\"              ] <- \"T29 | sandy and vegetated\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Øyblandingsmyr\"                                     ] <- \"V1  | partial\" # also includes V3\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Palsmyr\"                                            ] <- \"V3  | all (if including sub-types)\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Platåhøymyr\"                                        ] <- \"V3  | all (if including sub-types)\" # can also include smaller areas of V1\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Rik åpen jordvannsmyr i mellomboreal sone\"          ] <- \"V1  | calcareous\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Rik åpen jordvannsmyr i nordboreal og lavalpin sone\"] <- \"V1  | calcareous\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Rik åpen sørlig jordvannsmyr\"                       ] <- \"V1  | calcareous\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Sanddynemark\"                                       ] <- \"T21 | all (if including sub-types)\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Semi-naturlig eng\"                                  ] <- \"T32 | all (if including sub-types)\"\n# This might be called Kulturmarkseng in the 2018 protocol, but Semi-naturlig eng in the data set. \n# Kulturmarkseng also includes V10\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Semi-naturlig myr\"                                  ] <- \"V9  | all (if including sub-types)\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Semi-naturlig strandeng\"                            ] <- \"T33 | all (-2018)\" # could perhaps be used in 2018, but it's defined awkwardly\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Semi-naturlig våteng\"                               ] <- \"V10 | all (-2018)\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Silt og leirskred\"                                  ] <- \"T17 | all (if including sub-types)\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Slåttemark\"                                         ] <- \"T32 | all (if including sub-types)\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Slåttemyr\"                                          ] <- \"V9  | all (if including sub-types)\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Sørlig etablert sanddynemark\"                       ] <- \"T21 | all (if including sub-types)\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Sørlig kaldkilde\"                                   ] <- \"V4  | southern\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Sørlig nedbørsmyr\"                                  ] <- \"V3  | all (if including sub-types)\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Sørlig slåttemyr\"                                   ] <- \"V9  | all (if including sub-types)\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Strandeng\"                                          ] <- \"T12 | all (-2018)\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Svært tørkeutsatt sørlig kalkberg\"                  ] <- \"T1  | calcareous and dry\"\nntypDF2$hovedgruppe[ntypDF2$Nature_type == \"Terrengdekkende myr\"                                ] <- \"V3  | all (if including sub-types)\"\nntypDF2 <- ntypDF2 %>%\n  tidyr::separate(col = hovedgruppe,\n                  into = c(\"NiN_mainType\", \"NiN_mainTypeCoverage\"),\n                  #sep = \"|\",\n                  remove=T,\n                  extra = \"merge\"\n              )"},{"path":"naturtype.html","id":"add-nin-variables","chapter":"16 Nature types","heading":"16.8 Add NiN variables","text":"Preparing data:NiN variable codes:Converting NiN_variable_value numeric also introduced NA’s categories:now go variable codes separately also judge NA’s real, example coded zeros something. exclude variables part biodiversity assessment localities, since assessed localities poor condition (bias possible correct).","code":"\n#Exclude non-relevant forest wetland types\ndat2 <- dat[!dat$naturtype %in% excl_nt,]\n\n# Melt data\ndat2L <- tidyr::separate_rows(dat2, ninBeskrivelsesvariable, sep=\",\")\n\n# Split the code and the value into separate columns\ndat2L <- tidyr::separate(dat2L, \n                              col = ninBeskrivelsesvariable,\n                              into = c(\"NiN_variable_code\", \"NiN_variable_value\"),\n                              sep = \"_\",\n                              remove=F\n                              )\n#> Warning: Expected 2 pieces. Missing pieces filled with `NA` in 1\n#> rows [189800].\n# One NA produced here, but I check it, and it's fine.\n\n# Convert values to numeric. This causes some NA's which I will go through below\ndat2L$NiN_variable_value <- as.numeric(dat2L$NiN_variable_value)\n#> Warning: NAs introduced by coercion\nunique(sort(dat2L$NiN_variable_code))\n#>  [1] \"1AG-A-0\"   \"1AG-A-E\"   \"1AG-A-G\"   \"1AG-B\"    \n#>  [5] \"1AG-C\"     \"1AR-A-E\"   \"1AR-C-L\"   \"3TO-BØ\"   \n#>  [9] \"3TO-HA\"    \"3TO-HE\"    \"3TO-HK\"    \"3TO-HN\"   \n#> [13] \"3TO-HP\"    \"3TO-PA\"    \"3TO-TE\"    \"4DL-S-0\"  \n#> [17] \"4DL-SS-0\"  \"4TG-BL\"    \"4TG-EL\"    \"4TG-GF\"   \n#> [21] \"4TL-BS\"    \"4TL-HE\"    \"4TL-HL\"    \"4TL-RB\"   \n#> [25] \"4TL-SB\"    \"4TS-TS\"    \"5AB-0\"     \"5AB-DO-TT\"\n#> [29] \"5BY-0\"     \"6SE\"       \"6SO\"       \"7FA\"      \n#> [33] \"7GR-GI\"    \"7JB-BA\"    \"7JB-BT\"    \"7JB-GJ\"   \n#> [37] \"7JB-HT-SL\" \"7JB-HT-ST\" \"7JB-KU-BY\" \"7JB-KU-DE\"\n#> [41] \"7JB-KU-MO\" \"7JB-KU-PI\" \"7RA-BH\"    \"7RA-SJ\"   \n#> [45] \"7SD-0\"     \"7SD-NS\"    \"7SE\"       \"7SN-BE\"   \n#> [49] \"7TK\"       \"7VR-RE\"    \"7VR-RI\"    \"LKMKI\"    \n#> [53] \"LKMSP\"     \"PRAK\"      \"PRAM\"      \"PRH\"      \n#> [57] \"PRHA\"      \"PRHT\"      \"PRKA\"      \"PRKU\"     \n#> [61] \"PRMY\"      \"PRRL-CR\"   \"PRRL-DD\"   \"PRRL-EN\"  \n#> [65] \"PRRL-NT\"   \"PRRL-VU\"   \"PRSE-KA\"   \"PRSE-PA\"  \n#> [69] \"PRSE-SH\"   \"PRSL\"      \"PRTK\"      \"PRTO\"     \n#> [73] \"PRVS\"\nsort(unique(dat2L$NiN_variable_code[is.na(dat2L$NiN_variable_value)]))\n#>  [1] \"4DL-S-0\"   \"4DL-SS-0\"  \"4TL-HL\"    \"5AB-0\"    \n#>  [5] \"5BY-0\"     \"7FA\"       \"7GR-GI\"    \"7JB-BA\"   \n#>  [9] \"7JB-BT\"    \"7JB-GJ\"    \"7JB-KU-BY\" \"7JB-KU-DE\"\n#> [13] \"7JB-KU-MO\" \"7JB-KU-PI\" \"7RA-SJ\"    \"7SD-0\"    \n#> [17] \"7SD-NS\"    \"7SE\"       \"7SN-BE\"    \"7TK\"      \n#> [21] \"7VR-RE\"    \"7VR-RI\"    \"LKMKI\"     \"LKMSP\"    \n#> [25] \"PRH\"       \"PRVS\""},{"path":"naturtype.html","id":"ag-a-sjiktdekningsvariabler","chapter":"16 Nature types","heading":"16.8.1 1AG-A (sjiktdekningsvariabler)","text":"different variables describing cover different vegetation strata /species1AG--0 = Total tre canopy cover1AG-B = Total shrub cover1AG-C = Total field layer cover1AG--E = ‘Overstandere’1AG--G = ‘gjenveksttrær’","code":""},{"path":"naturtype.html","id":"ar-c-l-andel-vedvekster-i-fletsjiktet","chapter":"16 Nature types","heading":"16.8.2 1AR-C-L (Andel vedvekster i fletsjiktet)","text":"condition variable mire nature types","code":""},{"path":"naturtype.html","id":"to-torvmarksformer","chapter":"16 Nature types","heading":"16.8.3 3TO (Torvmarksformer)","text":"defining variables, part condition assessment.","code":"\nexclude <- c(\"3TO-BØ\",\n             \"3TO-HA\",\n             \"3TO-HE\",\n             \"3TO-HK\",\n             \"3TO-HN\",\n             \"3TO-HP\",\n             \"3TO-PA\",\n             \"3TO-TE\")"},{"path":"naturtype.html","id":"dl-coarse-dead-wood","chapter":"16 Nature types","heading":"16.8.4 4DL (Coarse dead wood)","text":"4DL-SS-0 4DL-S-0 total amount coarse woody debris/logs. recorded one nature type 2018, biodiversity variable, state variable.","code":"\nexclude <- c(exclude,\n             \"4DL-SS-0\",\n             \"4DL-S-0\")"},{"path":"naturtype.html","id":"tg-old-trees","chapter":"16 Nature types","heading":"16.8.5 4TG (old trees)","text":"three variables used biodiversity variables 2018.","code":"\nexclude <- c(exclude,\n             \"4TG-BL\",\n             \"4TG-EL\",\n             \"4TG-GF\")"},{"path":"naturtype.html","id":"tl-trees-with-fire-scars","chapter":"16 Nature types","heading":"16.8.6 4TL (trees with fire scars)","text":"five variables used together 4TG biodiversity variables 2018.","code":"\nexclude <- c(exclude,\n             \"4TL-BS\",\n             \"4TL-HE\",\n             \"4TL-HL\",\n             \"4TL-RB\",\n             \"4TL-SB\")"},{"path":"naturtype.html","id":"ab-and-5by-arealbruksklasser-og-byggningstyper","chapter":"16 Nature types","heading":"16.8.7 5AB and 5BY (arealbruksklasser og byggningstyper)","text":"area land use types building types, respectively, values numeric, categorical, represents presence absence land uses objects. suited automatically determining ecosystem condition done subjectively field.","code":"\nexclude <- c(exclude,\n             \"5AB-0\",\n             \"5AB-DO-TT\",\n             \"5BY-0\"\n             )"},{"path":"naturtype.html","id":"se-and-6so-bioclimatical-sections-and-sones","chapter":"16 Nature types","heading":"16.8.8 6SE and 6SO (Bioclimatical sections and sones)","text":"relevant condition variables.","code":"\nexclude <- c(exclude,\n             \"6SE\",\n             \"6SO\")"},{"path":"naturtype.html","id":"fa-fremmedartsinnslag","chapter":"16 Nature types","heading":"16.8.9 7FA (fremmedartsinnslag)","text":"allowed value X, Ok keep NA.","code":""},{"path":"naturtype.html","id":"gr-gi","chapter":"16 Nature types","heading":"16.8.10 7GR-GI","text":"7GR-GI (grøftingsintensitet) value X either, OK exclude NA’s. keep variable, even though clearly pressure indicator, might want use surrogate mire hydrology.","code":""},{"path":"naturtype.html","id":"jb-ba-aktuell-bruksintensitet","chapter":"16 Nature types","heading":"16.8.11 7JB-BA (Aktuell bruksintensitet)","text":"common condition/pressure variable semi-natural nature types.Overview cases value set X.just cases, mostly 2018. OK treat NA.","code":"\ntemp <- dat2L[dat2L$ninBeskrivelsesvariable == \"7JB-BA_X\",]\ntable(temp$kartleggingsår, temp$naturtype)\n#>       \n#>        Eng-aktig sterkt endret fastmark Hagemark\n#>   2018                                0        0\n#>   2020                                1        0\n#>   2021                                0        1\n#>       \n#>        Semi-naturlig eng Semi-naturlig strandeng Slåttemark\n#>   2018                 0                       0          0\n#>   2020                 0                       0          0\n#>   2021                 1                       1          1\n#>       \n#>        Strandeng\n#>   2018        27\n#>   2020         0\n#>   2021         0"},{"path":"naturtype.html","id":"jb-bt-beitetrykk","chapter":"16 Nature types","heading":"16.8.12 7JB-BT (Beitetrykk)","text":"Similar variable .OK treat X’s NA’s.","code":"\ntemp <- dat2L[dat2L$ninBeskrivelsesvariable == \"7JB-BT_X\",]\ntable(temp$kartleggingsår, temp$naturtype)\n#>       \n#>        Åpen flomfastmark Kystlynghei Sanddynemark\n#>   2019                 3           0            0\n#>   2020                 1           1            2\n#>   2021                 3           0            0"},{"path":"naturtype.html","id":"jb-gj-gjødsling","chapter":"16 Nature types","heading":"16.8.13 7JB-GJ (Gjødsling)","text":"Similar variable two .OK treat X’s NA’s.variable used condition indicator, perhaps strictly speaking pressure indicator. Secondly, many semi-natural areas fertilized, also reference condition. people made meadows probably agree productive field/meadow poor condition. condition variable therefor directly tuned towards maintenance biodiversity.","code":"\ntemp <- dat2L[dat2L$ninBeskrivelsesvariable == \"7JB-BT_X\",]\ntable(temp$kartleggingsår, temp$naturtype)\n#>       \n#>        Åpen flomfastmark Kystlynghei Sanddynemark\n#>   2019                 3           0            0\n#>   2020                 1           1            2\n#>   2021                 3           0            0"},{"path":"naturtype.html","id":"jb-ht-høsting-av-tresjiktet","chapter":"16 Nature types","heading":"16.8.14 7JB-HT (Høsting av tresjiktet)","text":"Used Lauveng 2019 2020.marginal exclude already now.","code":"\ntemp <- dat2L[dat2L$NiN_variable_code == \"7JB-HT-ST\" | \n               dat2L$NiN_variable_code == \"7JB-HT-SL\" ,]\ntable(temp$kartleggingsår, temp$naturtype)\n#>       \n#>        Lauveng\n#>   2019      14\n#>   2020       8\n#>   2022       2\nexclude <- c(exclude,\n             \"7JB-HT-SL\",\n             \"7JB-HT-ST\")"},{"path":"naturtype.html","id":"jb-ku-kystlyngheias-utviklingsfaser","chapter":"16 Nature types","heading":"16.8.15 7JB-KU (Kystlyngheias utviklingsfaser)","text":"= byggefaseDE = degenereringsfaseMO = moden fasePI = pionerfaseThis variable used biodiversity assessment, can therefore used condition assessment localities poor conditions mapped/assessed.nonetheless explore variable bit since variable suggested previously condition variable.\nNiN defines possible values numeric 0 4 (shifted become 1-5 data set), 998 cases given value X.reason variable used biodiversity assessment, performed condition poor, following table shows localities variable given value X spread across condition scores:can also make note big proportion total number localities Kystlynghei poor (svært redusert) condition, therefore variable 7JB-KU recorded large proportion localities.\nFigure 5.15: distribution condition scores Kystlynghei.\npercentage localities poor condition 0%.kystlynghei locality values four parameters (7BA-/DE/MO/PI), look cases detail, understand values set X (probably means left blank), example like :… can see sometimes <4 >0 variables/phases given score, sometimes none . makes problematic set NA’s zeros.variable used indicator Ecological Condition future, variable needs assessed localities, field protocol /field app needs revised possible record blank NA values.","code":"\nexclude <- c(exclude, \n             \"7JB-KU-BY\", \n             \"7JB-KU-DE\", \n             \"7JB-KU-MO\", \n             \"7JB-KU-PI\")\ntemp <- dat2L[dat2L$ninBeskrivelsesvariable == \"7JB-KU-BY_X\" |\n                     dat2L$ninBeskrivelsesvariable == \"7JB-KU-DE_X\" |\n                dat2L$ninBeskrivelsesvariable == \"7JB-KU-MO_X\" |\n                     dat2L$ninBeskrivelsesvariable == \"7JB-KU-PI_X\",]\ntable(temp$kartleggingsår, temp$naturtype)\n#>       \n#>        Kystlynghei\n#>   2018         510\n#>   2019         132\n#>   2020          21\n#>   2021         326\n#>   2022           7\ntable(temp$tilstand)\n#> \n#> 1 - Svært redusert         2 - Dårlig        3 - Moderat \n#>                  9                181                733 \n#>            4 - God \n#>                 73\nKU <- dat2[dat2$naturtype==\"Kystlynghei\",]\nbarplot(table(KU$tilstand))\n#View(dat2L[dat2L$NiN_variable_code == \"7JB-KU-BY\" & is.na(dat2L$NiN_variable_value),])\n#View(dat2L[dat2L$identifikasjon_lokalid ==\"NINFP1810002975\",]) # None of the 7JB-KU variables have values\n#View(dat2L[dat2L$identifikasjon_lokalid ==\"NINFP2110057689\",]) # Two of the 7JB-KU variables have values"},{"path":"naturtype.html","id":"ra-bh-and-7ra-sj-rask-suksesjon-i-boreal-hei-og-i-i-semi-naturlig-og-sterkt-endret-jordbruksmark-inkludert-våteng","chapter":"16 Nature types","heading":"16.8.16 7RA-BH and 7RA-SJ (rask suksesjon i boreal hei og i i semi-naturlig og sterkt endret jordbruksmark inkludert våteng)","text":"Condition variables.\ncases 7RA-SJ value X. numeric 1-4, value X mistake think. can exclude (.e. allow NA’s).","code":""},{"path":"naturtype.html","id":"sd-0-and-7sd--ns-natur--og-normalskogsdynamikk","chapter":"16 Nature types","heading":"16.8.17 7SD-0 and 7SD- NS (Natur- og normalskogsdynamikk)","text":"7SD-NS 7SD-0 also used one nature type (forest), wooded localities Flommyr, myrkant og myrskogsmark. X therefore means relevant, can also exclude parameters dataset together.","code":"\nexclude <- c(exclude, \n             \"7SD-0\",     \n             \"7SD-NS\")"},{"path":"naturtype.html","id":"tk-and-7se-kjørespor-slitasje","chapter":"16 Nature types","heading":"16.8.18 7TK and 7SE (kjørespor & slitasje)","text":"7TK (kjørespor) 7SE (slitasje) allowed value X, happened rare occasions (24) anyhow. ’s fine treat NA’s.","code":""},{"path":"naturtype.html","id":"vr-ri-reguleringsintensitet","chapter":"16 Nature types","heading":"16.8.19 7VR-RI (Reguleringsintensitet)","text":"variable defined numeric 1-5. , however, quite cases X.explain , case, variable good indicator condition rather represents pressure/driver. OK treat NA’s.LKMs\nLKM’s (lokal kompleks miljøvariabel) relevant us .","code":"\ntemp <- dat2L[dat2L$ninBeskrivelsesvariable == \"7VR-RI_X\",]\ntable(temp$kartleggingsår, temp$naturtype)\n#>       \n#>        Åpen flomfastmark\n#>   2019                96\n#>   2020                 1\n#>   2021                11\n#>   2022                 1"},{"path":"naturtype.html","id":"lkmki","chapter":"16 Nature types","heading":"16.8.20 LKMKI","text":"","code":"+ Kalk (lime)\n+ Exclude"},{"path":"naturtype.html","id":"lkmsp","chapter":"16 Nature types","heading":"16.8.21 LKMSP","text":"MdirPR-variables\nMiljødirektoratets variables (usually variations existing NiN-variables)","code":"+ Slåttemarkspreg\n+ Exclude"},{"path":"naturtype.html","id":"prak","chapter":"16 Nature types","heading":"16.8.22 PRAK","text":"","code":"+ Antall NiN-kartleggingsenheter\n+ Used in the biodiversity assessment\n+ Exclude"},{"path":"naturtype.html","id":"pram","chapter":"16 Nature types","heading":"16.8.23 PRAM","text":"","code":"+ Menneskeskapte objekter\n+ Related to 5BY and 5AB\n+ Exclude (see 5BY and 5AB)"},{"path":"naturtype.html","id":"prh","chapter":"16 Nature types","heading":"16.8.24 PRH","text":"","code":"+ This is perhaps a mistake and should be PRHA or PRHT\n+ Exclude"},{"path":"naturtype.html","id":"prha","chapter":"16 Nature types","heading":"16.8.25 PRHA","text":"","code":"+ Habitat spesifikke arter\n+ Used in the biodiversity assessment\n+ Exclude"},{"path":"naturtype.html","id":"prht","chapter":"16 Nature types","heading":"16.8.26 PRHT","text":"","code":"+ Høsting av tresjiktet"},{"path":"naturtype.html","id":"prka","chapter":"16 Nature types","heading":"16.8.27 PRKA","text":"","code":"+ Kalkindikatorer\n+ Used in the biodiversity assessment\n+ Exclude"},{"path":"naturtype.html","id":"prku","chapter":"16 Nature types","heading":"16.8.28 PRKU","text":"","code":"+ Kystlyngheias utviklingsfaser\n+ Related to 7JB-KU\n+ Used in the biodiversity assessment\n+ Exclude"},{"path":"naturtype.html","id":"prmy","chapter":"16 Nature types","heading":"16.8.29 PRMY","text":"","code":"+ Myrstruktur\n+ Used in the biodiversity assessment\n+ Exclude"},{"path":"naturtype.html","id":"prrl-crddenntvu","chapter":"16 Nature types","heading":"16.8.30 PRRL-CR/DD/EN/NT/VU","text":"","code":"+ Red list categories\n+ Used in the biodiversity assessment\n+ Exclude"},{"path":"naturtype.html","id":"prse-ka","chapter":"16 Nature types","heading":"16.8.31 PRSE-KA","text":"","code":"+ Strukturer, elementer og torvmarksformer (in 2018)\n+ See PRSE-PA"},{"path":"naturtype.html","id":"prse-pa","chapter":"16 Nature types","heading":"16.8.32 PRSE-PA","text":"","code":"+ Strukturer, elementer og torvmarksformer\n+ Used in the biodiversity assessment\n+ Exclude"},{"path":"naturtype.html","id":"prse-sh","chapter":"16 Nature types","heading":"16.8.33 PRSE-SH","text":"","code":"+ Strukturer, elementer og torvmarksformer (in 2018)\n+ See PRSE-PA"},{"path":"naturtype.html","id":"prsl","chapter":"16 Nature types","heading":"16.8.34 PRSL","text":"","code":"+ Slitasje\n+ Related to 7SE"},{"path":"naturtype.html","id":"prtk","chapter":"16 Nature types","heading":"16.8.35 PRTK","text":"","code":"+ Spor av tunge kjøretøyer\n+ Related to 7TK"},{"path":"naturtype.html","id":"prto","chapter":"16 Nature types","heading":"16.8.36 PRTO","text":"","code":"+ Torvuttak\n+ Strictly speaking a pressure variable"},{"path":"naturtype.html","id":"prvs","chapter":"16 Nature types","heading":"16.8.37 PRVS","text":"","code":"+ Variasjon i vannsprutintensitet\n+ Used in the biodiversity assessment\n+ Exclude\nexclude <- c(exclude,\n             \"LKMKI\",     \n          \"LKMSP\",\n          \"PRAK\",\n          \"PRAM\",\n          \"PRH\",\n          \"PRHA\",\n          \"PRKA\",\n          \"PRKU\",\n          \"PRMY\",\n          \"PRRL-DD\",   \"PRRL-VU\",   \"PRRL-NT\",   \"PRRL-EN\",   \"PRRL-CR\",  \n          \"PRSE-KA\",\n          \"PRSE-PA\",\n          \"PRSE-SH\",\n          \"PRVS\"\n          )"},{"path":"naturtype.html","id":"subset","chapter":"16 Nature types","heading":"16.9 Subset","text":"Now now 24 possible condition variables.dat2L2 includes three target ecosystems. Hule eiker excluded. Mosaics included. Several non-relevant NiN variables excluded (forested wetlands). localities duplicated many rows NiN variables locality.","code":"\n# Exclude NAs\ndat2L2 <- dat2L[!is.na(dat2L$NiN_variable_value),]\n\n# Exclude selected NiN variables \ndat2L2 <- dat2L2[!dat2L2$NiN_variable_code %in% exclude,]"},{"path":"naturtype.html","id":"combine-naturetypes-nin-variables-and-nin-main-types","chapter":"16 Nature types","heading":"16.10 Combine Naturetypes, NiN variables and NiN main types","text":"Add column total number localities nature type get percentage localities NiN main type recorded.Cast get NiN codes columnsThis data set contains nature types mapped 2018 2019, removed ntypDF2. Let’s exclude nature types nowCombine data sets","code":"\nntyp_vars <- as.data.frame(table(dat2L2$naturtype, dat2L2$NiN_variable_code))\nnames(ntyp_vars) <- c(\"Nature_type\", \"NiN_variable_code\", \"NiN_variable_count\")\nntyp_vars <- ntyp_vars[ntyp_vars$NiN_variable_count >0,]\nhead(ntyp_vars)\n#>                                          Nature_type\n#> 3   Åpen grunnlendt kalkrik mark i boreonemoral sone\n#> 16                                          Hagemark\n#> 29                                    Naturbeitemark\n#> 73                                          Hagemark\n#> 83                                           Lauveng\n#> 156                                Semi-naturlig myr\n#>     NiN_variable_code NiN_variable_count\n#> 3             1AG-A-0                 41\n#> 16            1AG-A-0                348\n#> 29            1AG-A-0                  1\n#> 73            1AG-A-E               1706\n#> 83            1AG-A-E                 12\n#> 156           1AG-A-G                792\n#options(scipen=999) # suppress exp notation\ncount <- as.data.frame(table(dat2$naturtype))\nnames(count) <- c(\"Nature_type\", \"totalLocations\")\nntyp_vars$totalLocations <- count$totalLocations[match(ntyp_vars$Nature_type, count$Nature_type)]\nntyp_vars$percentageUse <- round((ntyp_vars$NiN_variable_count/ntyp_vars$totalLocations)*100, 1)\n# should switch to pivot_wider\nntyp_vars_wide <- data.table::dcast(setDT(ntyp_vars),\n                                    Nature_type~NiN_variable_code,\n                                    value.var = \"percentageUse\")\nntyp_vars_wide <- ntyp_vars_wide[ntyp_vars_wide$Nature_type %in% ntypDF2$Nature_type]\nntyp_fill <- cbind(ntypDF2, ntyp_vars_wide[,-1][match(ntypDF2$Nature_type, ntyp_vars_wide$Nature_type)])"},{"path":"naturtype.html","id":"add-number-of-location-and-total-area-mapped","chapter":"16 Nature types","heading":"16.10.1 Add number of location and total area mapped","text":"","code":"\ndat2$km2 <- units::drop_units(dat2$area/10^6)\n\nnum <- as.data.frame(dat2) %>%\n  group_by(naturtype)%>%\n  summarise(km2 = sum(km2),\n            numberOfLocalities = n())\n\nntyp_fill <- cbind(ntyp_fill, num[,-1][match(ntyp_fill$Nature_type, num$naturtype),])"},{"path":"naturtype.html","id":"plots","chapter":"16 Nature types","heading":"16.11 Plots","text":"","code":""},{"path":"naturtype.html","id":"the-total-mapped-area","chapter":"16 Nature types","heading":"16.11.1 The total mapped area","text":"\nFigure 16.10: total mapped area nature types associated three selected main ecosystems\n","code":"\n\nmySize <- 8\ngg_area <- ntyp_fill %>%\n  arrange(km2) %>%\n  mutate(Nature_type=factor(Nature_type, levels=Nature_type)) %>%   # This trick update the factor levels\n  ggplot( aes(x = Nature_type,\n                   y = km2)) +\n        geom_segment( aes(xend=Nature_type, yend=0)) +\n        geom_point( size=4, aes(group = Ecosystem,\n                                colour= Ecosystem)) +\n        coord_flip() +\n        theme_bw(base_size = mySize) +\n        xlab(\"\")+\n        ylab(expression(km^2))+\n      theme(legend.position = \"top\",\n        legend.key.size =  unit(.05, 'cm'),\n            legend.background = element_rect(fill = \"white\", color = \"black\")\n            )\n\ngg_locs <- ntyp_fill %>%\n  arrange(km2) %>%\n  mutate(Nature_type=factor(Nature_type, levels=Nature_type)) %>%    # also sorted after km2\n  ggplot( aes(x = Nature_type,\n                   y = numberOfLocalities)) +\n        geom_segment( aes(xend=Nature_type, yend=0)) +\n        geom_point( size=4, aes(group = Ecosystem,\n                                colour= Ecosystem)) +\n        coord_flip() +\n        theme_bw(base_size = mySize) +\n        xlab(\"\")+\n        ylab(\"Number of localities\")+\n  theme(legend.position = \"none\",\n        axis.text.y = element_blank())\n\n\negg::ggarrange(gg_area, gg_locs, \n                        ncol = 2)"},{"path":"naturtype.html","id":"area-of-localities-per-nin-main-type","chapter":"16 Nature types","heading":"16.11.2 Area of localities per NiN main type","text":"First add NiN main types covered nature types.Adding non-mapped open typesAdding non-mapped semi-natural typesAdding non-mapped wetland typesV6 Våtsnøleie, guess mapped, grouped alpine ecosystem. ’ll therefore add , mention figure caption .\nFigure 16.11: areas mapped NiN main type, degree spatial representativity (coverage) mapping units (nature types). V6 Våtsnøleie og snøleiekilde included.\n","code":"\nopen <- c(\n  \"T1\",\n  \"T2\",\n  \"T6\",\n  \"T8\",\n  \"T11\",\n  \"T12\",\n  \"T13\",\n  \"T15\",\n  \"T16\",\n  \"T17\",\n  \"T18\",\n  \"T20\",\n  \"T21\",\n  \"T23\",\n  \"T24\",\n  \"T25\",\n  \"T26\",\n  \"T27\",\n  \"T29\"\n)\n\nsemi <- c(\n  \"T31\",\n  \"T32\",\n  \"T33\",\n  \"T34\",\n  \"T40\",  # are these included\n  \"T41\"   # are these included\n)\n\nwetland <- c(\n  \"V1\",\n  \"V3\",\n  \"V4\",\n  \"V6\",\n  \"V9\",\n  \"V10\",\n  \"L4\"    # this will probably not be part of the assessments\n  \n)\nopen[!open %in% ntyp_fill$NiN_mainType]\n#> [1] \"T6\"  \"T11\" \"T13\" \"T16\" \"T23\" \"T24\" \"T25\" \"T26\" \"T27\"\nntyp_fill2 <- ntyp_fill %>%\n  add_row(NiN_mainType = \"T6\",  Ecosystem = \"naturligÅpneOmråderUnderSkoggrensa\", NiN_mainTypeCoverage = \"Not mapped\", km2 = 0) %>%\n  add_row(NiN_mainType = \"T11\", Ecosystem = \"naturligÅpneOmråderUnderSkoggrensa\", NiN_mainTypeCoverage = \"Not mapped\", km2 = 0) %>%\n  add_row(NiN_mainType = \"T13\", Ecosystem = \"naturligÅpneOmråderUnderSkoggrensa\", NiN_mainTypeCoverage = \"Not mapped\", km2 = 0) %>%\n  add_row(NiN_mainType = \"T16\", Ecosystem = \"naturligÅpneOmråderUnderSkoggrensa\", NiN_mainTypeCoverage = \"Not mapped\", km2 = 0) %>%\n  add_row(NiN_mainType = \"T23\", Ecosystem = \"naturligÅpneOmråderUnderSkoggrensa\", NiN_mainTypeCoverage = \"Not mapped\", km2 = 0) %>%\n  add_row(NiN_mainType = \"T24\", Ecosystem = \"naturligÅpneOmråderUnderSkoggrensa\", NiN_mainTypeCoverage = \"Not mapped\", km2 = 0) %>%\n  add_row(NiN_mainType = \"T25\", Ecosystem = \"naturligÅpneOmråderUnderSkoggrensa\", NiN_mainTypeCoverage = \"Not mapped\", km2 = 0) %>%\n  add_row(NiN_mainType = \"T26\", Ecosystem = \"naturligÅpneOmråderUnderSkoggrensa\", NiN_mainTypeCoverage = \"Not mapped\", km2 = 0) %>%\n  add_row(NiN_mainType = \"T27\", Ecosystem = \"naturligÅpneOmråderUnderSkoggrensa\", NiN_mainTypeCoverage = \"Not mapped\", km2 = 0) \nsemi[!semi %in% ntyp_fill$NiN_mainType]\n#> [1] \"T40\"\nntyp_fill2 <- ntyp_fill2 %>%\n  add_row(NiN_mainType = \"T40\", Ecosystem = \"semi-naturligMark\", NiN_mainTypeCoverage = \"Not mapped\", km2 = 0)\nwetland[!wetland %in% ntyp_fill$NiN_mainType]\n#> [1] \"V6\"\nmySize <- 10\nntyp_fill2 %>%\n  # combining two classes to get a better colour palette\n  mutate(NiN_mainTypeCoverage = \n           replace(NiN_mainTypeCoverage, NiN_mainTypeCoverage == \"southern\", \"partial\"),\n         NiN_mainTypeCoverage = \n           replace(NiN_mainTypeCoverage, NiN_mainTypeCoverage == \"calcareous and dry\", \"calcareous\")) %>%\n  \n  group_by(NiN_mainType, NiN_mainTypeCoverage) %>%\n  mutate(km2 = sum(km2)) %>%\n  slice_head()%>%\n  select(Ecosystem,\n         NiN_mainType,\n         NiN_mainTypeCoverage,\n         km2)%>%\n  ungroup() %>%\n  mutate(NiN_mainType = forcats::fct_reorder(NiN_mainType, km2)) %>%\n  ggplot(aes(x = NiN_mainType,\n             y = km2,\n             fill = NiN_mainTypeCoverage))+\n    geom_bar(stat = \"identity\",\n             colour = \"grey40\",\n             position = \"stack\")+\n    theme_bw(base_size = mySize)+\n    coord_flip()+\n  labs(x = \"NiN main type\",\n       y = expression(km^2),\n       fill = \"Spatial coverage\")+\n  scale_fill_brewer(palette = \"Set1\")+\n  facet_wrap(vars(Ecosystem),\n             scales = \"free\",\n             labeller = label_wrap_gen(width=25))"},{"path":"naturtype.html","id":"number-of-localities-per-nin-main-type","chapter":"16 Nature types","heading":"16.11.3 Number of localities per NiN main type","text":"\nFigure 16.12: number localities mapped NiN main type, degree spatial representativity (coverage) mapping units (nature types). V6 Våtsnøleie og snøleiekilde included. NiN main types arranged rougly decreasing order, except types mapped , arranged top.\nfigure take Naturlig åpne områder poorly represented general many NiN main types completely missing data set. three common types area, however, complete thematic coverage (excluding year 2018 including sub-types). need investigate especially NiN variables nature types mapping T18 Åpen flomfastmark, T12 Strandeng T21 Sanddynemark can use.Semi-naturlig mark quite good thematic coverage three main types (area). three types probably makes considerably smaller area, note T33 coverage, classes (-2018). three main ecosystems, semi-naturlig mark dominates clearly terms area terms number localities.Våtmark good thematic coverage V3 nedbørsmyr V9 semi-naturlig myr, V1 åpen jordvassmyr calcareous localities mapped assessed. question whether, given NiN variable, calcareous localities can representative mires (poor rich) introduce much bias one way another. Another important bias main ecosystem related lower size limit mapping units (MMU), quite big V3. need think whether small bogs less prone different pressures compared big bogs.","code":"\nmySize <- 10\nntyp_fill2 %>%\n  # combining two classes to get a better colour palette\n  mutate(NiN_mainTypeCoverage = \n           replace(NiN_mainTypeCoverage, NiN_mainTypeCoverage == \"southern\", \"partial\"),\n         NiN_mainTypeCoverage = \n           replace(NiN_mainTypeCoverage, NiN_mainTypeCoverage == \"calcareous and dry\", \"calcareous\")) %>%\n  \n  group_by(NiN_mainType, NiN_mainTypeCoverage) %>%\n  mutate(count = sum(numberOfLocalities)) %>%\n  slice_head()%>%\n  select(Ecosystem,\n         NiN_mainType,\n         NiN_mainTypeCoverage,\n         count)%>%\n  ungroup() %>%\n  mutate(count = replace_na(count, 0)) %>%\n  mutate(NiN_mainType = fct_reorder(NiN_mainType, count)) %>%\n  ggplot(aes(x = NiN_mainType,\n             y = count,\n             fill = NiN_mainTypeCoverage))+\n    geom_bar(stat = \"identity\",\n             colour = \"grey40\",\n             position = \"stack\")+\n    theme_bw(base_size = mySize)+\n    coord_flip()+\n  labs(x = \"NiN main type\",\n       y = \"Number of localities\",\n       fill = \"Spatial coverage\")+\n  scale_fill_brewer(palette = \"Set1\")+\n  facet_wrap(vars(Ecosystem),\n             scales = \"free\",\n             labeller = label_wrap_gen(width=25))"},{"path":"naturtype.html","id":"commonness-of-nin-variables","chapter":"16 Nature types","heading":"16.11.4 Commonness of NiN variables","text":"want see common different NiN variables , can use select core variables \\(_kjernevariabler_\\).First get total area mapped per main ecosystem\nFigure 5.23: Barplot showing proportion area NiN variable recorded. total mapped area main ecosystem (facets) shown dashed red line. three dominant NiN main types ecosystem given uniqe colour, remaining grouped ‘’.\nfigure, combination , points obvious NiN variable candidates.7SE 7TK good candidates Naturlig åpne områder. 7JA-BT probably appropriately classed pressure indicator. 7VR-RI recorded T18 localities.two variables (7SE 7TK) best candidates also Semi-natural areas. 7JB-BT pressure variable (beitetrykk). 7RA-SJ/BH related gjengoing covered another indicator informed remote sensing (LiDAR), therefor don’t need describe field-based indicator well.Våtmark, 7GR-Gi common variables, pressure variable (grøfting). , perhaps used surrogate indicator. think justifiable, especially since relationship pressure (grøfting) condition (hydrology) well known. 7SE+PRSL 7TK+PRTK good candidates. PRTO relevant V3, covers relatively large area. , however,, like pressure indicator.","code":"\nareaSum <- ntyp_fill2 %>%\n  group_by(Ecosystem) %>%\n  summarise(km2 = sum(km2)) %>%\n  tibble::add_column(.before=1,\n                     NiN_code = rep(\"Combined\", 3))\nntyp_fill2 %>%\n  pivot_longer(cols = unique(ntyp_vars$NiN_variable_code)) %>%\n  drop_na(value) %>%\n  rename(NiN_code = name,\n         useFrequency = value) %>%\n  filter(useFrequency > 0) %>%\n  group_by(NiN_code, Ecosystem, NiN_mainType) %>%  # NiN main type could be replaced with Nature_type\n  summarise(km2 = sum(km2)) %>%\n  \n  # create a truncated fill variable \n  group_by(Ecosystem) %>%\n  mutate(myFill = fct_lump(NiN_mainType, 3, w = km2)) %>%\n  \n  # qick fix to sort variable across facets (dont work after adding 'Nature_type' in the first group_by)\n  #mutate(lab = paste(NiN_code, substr(Ecosystem, start = 1, stop = 1), sep = \" \")) %>%\n  #ungroup()%>%\n  #mutate(lab = forcats::fct_reorder(lab, km2)) %>%\n  \n  \n  # plot\n  ggplot(aes(x = NiN_code,\n              y = km2,\n             fill = myFill\n                ))+\n  geom_bar(stat = \"identity\",\n           colour = \"grey40\",\n           #fill = \"grey80\",\n           position = \"stack\")+\n  geom_hline(data = areaSum,\n             aes(yintercept = km2),\n             colour = \"red\",\n             linetype = \"dashed\")+\n  facet_wrap(vars(Ecosystem),\n             scales = \"free\",\n             labeller = label_wrap_gen(width=25))+\n  labs(x = \"\",\n       y = expression(km^2),\n       fill = \"\")+\n  coord_flip()+\n  scale_fill_brewer(palette = \"Set1\")+\n  theme_bw(base_size = mySize)\n#> `summarise()` has grouped output by 'NiN_code',\n#> 'Ecosystem'. You can override using the `.groups` argument.\n#> Warning in RColorBrewer::brewer.pal(n, pal): n too large, allowed maximum for palette Set1 is 9\n#> Returning the palette you asked for with that many colors"},{"path":"naturtype.html","id":"tables","chapter":"16 Nature types","heading":"16.12 Tables","text":"output tables numbers underlying figures.\nFigure 16.13: List 45 nature types additionam data, including proportion localities data NiN variables.\n\nFigure 5.24: List unique combinatios NiN variable codes naturetypes summed area data.\n","code":"\nDT::datatable(ntyp_fill2,\n              #extensions = \"FixedColumns\",\n  options = list(\n    scrollX = T,\n    scrollY=T,\n    pageLength = 10))\nDT::datatable(\n  ntyp_fill2 %>%\n  pivot_longer(cols = unique(ntyp_vars$NiN_variable_code)) %>%\n  drop_na(value) %>%\n  rename(NiN_code = name,\n         useFrequency = value) %>%\n  filter(useFrequency > 0) %>%\n  group_by(NiN_code, Ecosystem, NiN_mainType) %>%  # NiN main type could be replaced with Nature_type\n  summarise(km2 = sum(km2)),\n  options = list(\n    scrollX = T,\n    scrollY=T,\n    pageLength = 10))\n#> `summarise()` has grouped output by 'NiN_code',\n#> 'Ecosystem'. You can override using the `.groups` argument."},{"path":"naturtype.html","id":"exp-natureType-summary","chapter":"16 Nature types","heading":"16.13 Export data","text":"Exporting table summary statistics information compiled nature type three main ecosystems. can merged main data set order subset according specific research question.Note also main data set still contains localities mis-match nature type definition NiN mapping uits recorded field. researcher decide include exclude .main data set also includes mosaic localities, less suitable use ground truth data remote sensing methods.","code":"\nsaveRDS(ntyp_fill2, \"data/naturetypes/natureType_summary.rds\")"},{"path":"naturtype.html","id":"appendix-1","chapter":"16 Nature types","heading":"16.14 Appendix 1","text":"deeper look causes localities recorded seemingly erroneous NiN mapping units (hence NiN main types)Lets look NiN main types (recorded field) cover different hovedøkosystem exclude Hule eiker localities one NiN main type.Let’s focus three targeted ecosystems.\nFigure 16.14: Number localities combination main ecosystem NiN main type\nStill weird cases look turn , trying understand came recorded way.","code":"\ndat_red <- dat_melt[dat_melt$n_ninKartleggingsenheter==1 & \n                      dat_melt$naturtype != \"Hule eiker\" &\n                      dat_melt$mosaikk == \"nei\",]\ndat_red_tally <- stats::aggregate(data = dat_red,\n                                  area~hovedøkosystem+ninKartleggingsenheter3, FUN = length)\nnames(dat_red_tally)[3] <- \"count\"\nggplot(dat_red_tally[dat_red_tally$hovedøkosystem %in% target,],\n       aes(x = ninKartleggingsenheter3,\n               y = count))+\n  geom_bar(\n           fill=\"grey\",\n           colour=\"black\",\n           stat=\"identity\")+\n  coord_flip()+\n  theme_bw(base_size = 12)+\n  labs(y = \"Number of localities\",\n       x = \"NiN main types\")+\n  scale_y_continuous(position = \"left\",\n                   expand = expansion(mult=c(.0,.3)))+\n  geom_text(aes(label=count), hjust=-0.25)+\n    facet_wrap(\"hovedøkosystem\",\n             scales = \"free\",\n             ncol = 3)"},{"path":"naturtype.html","id":"naturligåpneområderunderskoggrensa","chapter":"16 Nature types","heading":"16.14.0.1 naturligÅpneOmråderUnderSkoggrensa","text":"Listing NiN main types recorded nature types belonging naturligÅpneOmråderUnderSkoggrensa, clearly don’t belong :V10 (semi-naturlig våteng)\nOne case Åpen flomfastmark wrongly associated V10 whan T18.\nOne case Åpen flomfastmark wrongly associated V10 whan T18.T33 (Semi naturlig strandeng)\ncases either naturtype semi-naturlig strandeng (hence hovedøkosystem Semi-nat), naturtype correctly recorded Strandeng NiN type T12.\ncases either naturtype semi-naturlig strandeng (hence hovedøkosystem Semi-nat), naturtype correctly recorded Strandeng NiN type T12.T32 (Semi-naturlig eng)\nObvious error\nObvious errorT30 (Flomskogsmark)\nObvious error\nObvious errorListing remaining NiN main types:\n* T8 (fulglefjelleng og fugltopp)\n* T6 (Standberg)\n* T29 (Grus og steindominert strand og strandlinje)\n* T21 (Sanddynemark)\n* T20 (Isinnfrysingsmark)\n* T2 (Åpen grunlendt mark)\n* T18 (Åpne flomfastmark)\n* T17 (Aktiv skredmark)\n* T15 (Fosse-eng)\n* T13 (Rasmark)\n* T12 (Strandeng)\n* T1 (Nakent berg)resulted deleting 20m localities.","code":"\n`%!in%` <- Negate(`%in%`)\ndat_red2 <- dat_red[\n  dat_red$hovedøkosystem!=\"naturligÅpneOmråderUnderSkoggrensa\" |\n  dat_red$hovedøkosystem==\"naturligÅpneOmråderUnderSkoggrensa\" & \n    dat_red$ninKartleggingsenheter3 %!in% c(\"T30\", \"T32\", \"T33\", \"V10\"),]"},{"path":"naturtype.html","id":"semi-naturlig-mark","chapter":"16 Nature types","heading":"16.14.0.2 Semi-naturlig mark","text":"Listing NiN main types recorded nature types belonging Semi-naturlig mark, clearly don’t belong :V9 (Semi-naturlig myr)\nKystlynghei recorded mire\nKystlynghei recorded mireT4 (Fastmarksskogsmark)\nT32 (naturbeitemark, lauveng, hagemark, +++)\nT32 (naturbeitemark, lauveng, hagemark, +++)T35 (Sterkt endret fastmark med løsmassedekke)\nWrong NiN type given eng-aktig sterkt endret fastmark (T40)\nWrong NiN type given eng-aktig sterkt endret fastmark (T40)T3 (Fjellhei, leside og tundra)\nBoreal hei (’ve T31)\nBoreal hei (’ve T31)T12 (Strandeng)\nprobably T33\nprobably T33T1 (Nakent berg)\nObvious mistake\nObvious mistakeListing remaining NiN-main types:\n* V10 (semi-nat våteng)\n* T41 (Oppdyrket mark med preg av semi-naturlig eng)\n* T40 (Sterkt endret fastmark med preg av semi-naturlig eng)\n* T31-34This resulted deletion 87 localities.","code":"\ndat_red3 <- dat_red2[\n  dat_red2$hovedøkosystem!=\"semi-naturligMark\" |\n  dat_red2$hovedøkosystem==\"semi-naturligMark\" & dat_red2$ninKartleggingsenheter3 %!in% c(\"V9\", \"T4\", \"T35\", \"T3\", \"T12\", \"T1\"),]"},{"path":"naturtype.html","id":"våtmark","chapter":"16 Nature types","heading":"16.14.0.3 Våtmark","text":"Listing NiN main types recorded nature types belonging Våtmark, clearly don’t belong .Våtmark doesn’t distinguish semi-natural natural, V-types correct, except strongly modified V11-V13.V11 (Torvtak)\nObvious mistake\nObvious mistakeV12 (Grøftet åpne torvmark)\nObvious mistake\nObvious mistakeV13 (Ny våtmark)\nObvious mistake\nObvious mistakeT4 (skog)\n’ve T2 strange things\n’ve T2 strange thingsT30-T32\nSomeone switching semi-natural natural equivalents\nSomeone switching semi-natural natural equivalentsThis resulted deletion 33 localities.total 140 localities, 0.2% localities, field-recorded NiN main don’t match definition nature type. see symptom bigger problem data validation.","code":"\ndat_red4 <- dat_red3[\n  dat_red3$hovedøkosystem!=\"våtmark\" |\n  dat_red3$hovedøkosystem==\"våtmark\" & dat_red3$ninKartleggingsenheter3 %!in% c(\"T4\", \"T30\", \"T31\", \"T32\", \"V11\", \"V12\", \"V13\"),]"},{"path":"scaling-functions.html","id":"scaling-functions","chapter":"17 Scaling functions","heading":"17 Scaling functions","text":"Author. Anders L. KolstadMarch 2023Superseeded : functionality explained moved eaTools package. Please see documentation updated examples.Indicator ecological condition may scaled reference value become normalised hence comparable. SEEA EA, un-scaled raw indicators called indicators , simply referred variables, use distinction . Scaling variables reference conditions can done many ways. examples, inspiration.Define plotting aestheticsCreate random raw data two variablesLets say reference condition variable1 equal 16, variable 2 35","code":"\nset.seed(123)\nlow <- \"red\"\nhigh <- \"green\"\nridge <- geom_density_ridges_gradient(scale = 3, size = .3)\nmyColour <- \"black\"\nmySize <- 10\nmyAlpha <- .7\nmyShape <- 21\ndat <- data.frame(variable1 = rnorm(50, 10, 4), \n                  variable2 = rnorm(50, 30, 3))\n\ntemp <- data.table::melt(setDT(dat))\n#> Warning in melt.data.table(setDT(dat)): id.vars and\n#> measure.vars are internally guessed when both are 'NULL'.\n#> All non-numeric/integer/logical type columns are considered\n#> id.vars, which in this case are columns []. Consider\n#> providing at least one of 'id' or 'measure' vars in future.\n\nggplot(temp,\n       aes(x = value,\n           y = variable,\n           fill = stat(x)))+\n  ridge+\n  scale_fill_gradient(low = low, high = high)\n#> Warning: `stat(x)` was deprecated in ggplot2 3.4.0.\n#> ℹ Please use `after_stat(x)` instead.\n#> This warning is displayed once every 8 hours.\n#> Call `lifecycle::last_lifecycle_warnings()` to see where\n#> this warning was generated.\n#> Picking joint bandwidth of 1.22\ndat$referenceHigh1 <- 16\ndat$referenceHigh2 <- 35"},{"path":"scaling-functions.html","id":"linear-with-a-natural-zero","chapter":"17 Scaling functions","heading":"17.1 Linear, with a natural zero","text":"can scale variable linearly, saying values 12 represents ‘perfect’ condition. also assume value zero worst possible condition variable. divide reference value, truncate values .reverse good bad condition: change sign add one.two indicators become comparable now normalised. least true around reference value. perhaps variable value around 25 variable2 actually quite bad. example assumed value zero worst possible value, may always case.","code":"\ndat$indicator1 <- dat$variable1/dat$referenceHigh1\ndat$indicator1[dat$indicator1>1] <- 1\n\ndat$indicator2 <- dat$variable2/dat$referenceHigh2\ndat$indicator2[dat$indicator2>1] <- 1\ntemp <- melt(setDT(dat),\n             measure.vars = c(\"indicator1\", \"indicator2\"))\nggplot(dat)+\n  geom_point(\n    aes(x = variable1, y = indicator1, fill = indicator1),\n             colour = myColour,\n             size   = mySize,\n             alpha  = myAlpha,\n             shape  = myShape)+\n  geom_vline(xintercept = dat$referenceHigh1[1],\n             linetype = \"dashed\",\n             size =2)+\n  \n  geom_point(aes(x = variable2, y = indicator2, fill = indicator2),\n             colour = myColour,\n             size   = mySize,\n             alpha  = myAlpha,\n             shape  = myShape)+\n  geom_vline(xintercept = dat$referenceHigh2,\n             linetype = \"dashed\",\n             size =2)+\n  ylab(\"Indicator values\")+\n  xlab(\"Variable values\")+\n  \n  scale_fill_gradient(\"Indicator values\", low = low, high = high)\n#> Warning: Using `size` aesthetic for lines was deprecated in ggplot2\n#> 3.4.0.\n#> ℹ Please use `linewidth` instead.\n#> This warning is displayed once every 8 hours.\n#> Call `lifecycle::last_lifecycle_warnings()` to see where\n#> this warning was generated.\nggplot(dat)+\n  geom_point(\n    aes(x = variable1, y = indicator1*(-1)+1, fill = indicator1*(-1)+1),\n             colour = myColour,\n             size   = mySize,\n             alpha  = myAlpha,\n             shape  = myShape)+\n  geom_vline(xintercept = dat$referenceHigh1[1],\n             linetype = \"dashed\",\n             size =2)+\n  \n  ylab(\"Indicator values\")+\n  xlab(\"Variable values\")+\n  \n  scale_fill_gradient(\"Indicator values\", low = low, high = high)"},{"path":"scaling-functions.html","id":"linear-with-defined-lower-limit","chapter":"17 Scaling functions","heading":"17.2 Linear, with defined lower limit","text":"can also say worst possible condition variables zero, example say 5 variable1 28 variable2.can normalise data two reference values.","code":"\ndat$referenceLow1 <- 5\ndat$referenceLow2 <- 28\ndat$indicator1_LowHigh <- (dat$variable1-dat$referenceLow1)/(dat$referenceHigh1 - dat$referenceLow1)\ndat$indicator1_LowHigh[dat$indicator1_LowHigh <0] <- 0\ndat$indicator1_LowHigh[dat$indicator1_LowHigh >1] <- 1\n\ndat$indicator2_LowHigh <- (dat$variable2-dat$referenceLow2)/(dat$referenceHigh2 - dat$referenceLow2)\ndat$indicator2_LowHigh[dat$indicator2_LowHigh <0] <- 0\ndat$indicator2_LowHigh[dat$indicator2_LowHigh >1] <- 1\nggplot(dat)+\n  geom_point(\n    aes(x = variable1, y = indicator1_LowHigh, fill = indicator1_LowHigh),\n             colour = myColour,\n             size   = mySize,\n             alpha  = myAlpha,\n             shape  = myShape)+\n  geom_vline(xintercept = 16,\n             linetype = \"dashed\",\n             size =2)+\n  geom_vline(xintercept = 5,\n             linetype = \"dashed\",\n             size =2)+\n  \n  geom_point(aes(x = variable2, y = indicator2_LowHigh, fill = indicator2_LowHigh),\n             colour = myColour,\n             size   = mySize,\n             alpha  = myAlpha,\n             shape  = myShape)+\n  geom_vline(xintercept = 35,\n             linetype = \"dashed\",\n             size =2)+\n  geom_vline(xintercept = 28,\n             linetype = \"dashed\",\n             size =2)+\n  ylab(\"Indicator values\")+\n  xlab(\"Variable values\")+\n  \n  scale_fill_gradient(\"Indicator values\", low = low, high = high)"},{"path":"scaling-functions.html","id":"break-point-scaling","chapter":"17 Scaling functions","heading":"17.3 Break point scaling","text":"can also define threshold good ecological condition. Lets example say variable1, ecosystem function really declines variable shows values 9.can normalise , using refer break point normalisation. maths, see .solid lines point indicator value variable equals threshold value.","code":"\ndat$thr1 <- 9\ndat$indicator1_breakPoint <- ifelse(\n  dat$variable1 < dat$thr1,\n    ((dat$variable1-dat$referenceLow1)/(dat$thr1 - dat$referenceLow1))*(0.6-0)+0,\n    ((dat$variable1-dat$thr1)/(dat$referenceHigh1 - dat$thr1))*(1-0.6)+0.6\n  )\n\ndat$indicator1_breakPoint[dat$indicator1_breakPoint<0] <- 0\ndat$indicator1_breakPoint[dat$indicator1_breakPoint>1] <- 1\nggplot(dat)+\n  geom_point(\n    aes(x = variable1, y = indicator1_breakPoint, fill = indicator1_breakPoint),\n             colour = myColour,\n             size   = mySize,\n             alpha  = myAlpha,\n             shape  = myShape)+\n  geom_vline(xintercept = dat$referenceHigh1[1],\n             linetype = \"dashed\",\n             size =2)+\n  geom_vline(xintercept = dat$referenceLow1,\n             linetype = \"dashed\",\n             size =2)+\n  geom_segment(aes(x = thr1, y = 0, xend = thr1, yend = 0.6),\n               linetype=\"solid\",\n               size=1.5)+\n  geom_segment(aes(x = 0, y = 0.6, xend = thr1, yend = 0.6),\n               linetype=\"solid\",\n               size=1.5)+\n  \n  ylab(\"Indicator values\")+\n  xlab(\"Variable values\")+\n  \n  scale_fill_gradient(\"Indicator values\", low = low, high = high)"},{"path":"scaling-functions.html","id":"two-sided-indicator","chapter":"17 Scaling functions","heading":"17.4 Two-sided indicator","text":"indicator may optimum value somewhere middle range, rather max min value. can define two-sided indicator. Lets say variable2 optimal level 30, values either lower high bad.","code":"\ndat$referenceMid2 <- 30\ndat$indicator2_twoSided <- ifelse(\n  dat$variable2<dat$referenceMid2,\n    (dat$variable2-dat$referenceLow2)/(dat$referenceMid2-dat$referenceLow2),\n    ((dat$variable2-dat$referenceMid2)/(dat$referenceHigh2-dat$referenceMid2))*(-1)+1\n  )\n\n# truncating\ndat$indicator2_twoSided[dat$indicator2_twoSided<0] <- 0\ndat$indicator2_twoSided[dat$indicator2_twoSided>1] <- 1\nggplot(dat)+\n  geom_point(\n    aes(x = variable2, y = indicator2_twoSided, fill = indicator2_twoSided),\n             colour = myColour,\n             size   = mySize,\n             alpha  = myAlpha,\n             shape  = myShape)+\n  geom_vline(xintercept = dat$referenceMid2[1],\n             linetype = \"dashed\",\n             size =2)+\n  geom_vline(xintercept = dat$referenceLow2[1],\n             linetype = \"dashed\",\n             size =2)+\n  geom_vline(xintercept = dat$referenceHigh2[1],\n             linetype = \"dashed\",\n             size =2)+\n \n  ylab(\"Indicator values\")+\n  xlab(\"Variable values\")+\n  \n  scale_fill_gradient(\"Indicator values\", low = low, high = high)"},{"path":"scaling-functions.html","id":"sigmoid-transformation","chapter":"17 Scaling functions","heading":"17.5 Sigmoid transformation","text":"many , non-linear ways normalise indicator. correct choice scaling function varies indicators depends nature indicator represents, also uncertainty around reference values. Personally, think sigmoid function often makes lot sense. less sensitive changes around min max reference values. slight deviation reference condition perhaps often described true reduction condition. true example reference communities (ecosystems defined , representing, good condition) show variation variable values, yet reference value fixed. linear scaling cases lead referred underestimation biaz (making thing look worse really ).equation sigmoid transformation use comes Oliver al. (2021); Eq. 1, Supplemetary Information S2.Finding transformed indicator value variable equals thresholdThe solid helperlines point indicator value variable value equals threshold. Later shift values indicator value becomes 0.6 point.Also plotted linearly normalised indicator values:dotted helper lines selve visual guides judge different scaled indicator value 0.6 two approaches.","code":"\ndat$indicator1_sigmoid <- 100.68*(1-exp(-5*(dat$indicator1_LowHigh)^2.5))/100\nsigmoid_thr <- 100.68*(1-exp(-5*((dat$thr1[1]-dat$referenceLow1[1])/(dat$referenceHigh1[1]-dat$referenceLow1[1]))^2.5))/100\nggplot(dat)+\n  geom_point(\n    aes(x = variable1, y = indicator1_sigmoid, fill = indicator1_sigmoid),\n             colour = myColour,\n             size   = mySize,\n             alpha  = myAlpha,\n             shape  = myShape)+\n  \n  geom_vline(xintercept = dat$referenceLow1[1],\n             linetype = \"dashed\",\n             size =2)+\n  geom_vline(xintercept = dat$referenceHigh1[1],\n             linetype = \"dashed\",\n             size =2)+\n  \n  geom_segment(aes(x = thr1, y = 0, xend = thr1, yend = sigmoid_thr),\n               linetype=\"solid\",\n               size=1)+\n  geom_segment(aes(x = 0, y = sigmoid_thr, xend = thr1, yend = sigmoid_thr),\n               linetype=\"solid\",\n               size=1)+\n  \n  \n  ylab(\"Indicator values\")+\n  xlab(\"Variable values\")+\n  \n  scale_fill_gradient(\"Indicator values\", low = low, high = high)\nggplot(dat)+\n  geom_point(\n    aes(x = indicator1_LowHigh, y = indicator1_sigmoid, fill = indicator1_sigmoid),\n             colour = myColour,\n             size   = mySize,\n             alpha  = myAlpha,\n             shape  = myShape)+\n  \n  geom_vline(xintercept = 0.6,\n             linetype = \"dashed\",\n             size =2)+\n   geom_hline(yintercept = 0.6,\n             linetype = \"dashed\",\n             size =2)+\n  \n  ylab(\"Sigmoid-transformed\\nIndicator values\")+\n  xlab(\"Linear indicatior values\")+\n  \n  scale_fill_gradient(\"Indicator values\", low = low, high = high)"},{"path":"scaling-functions.html","id":"accounting-for-the-threshold-value","chapter":"17 Scaling functions","heading":"17.5.1 Accounting for the threshold value","text":"can account threshold good ecological condition applying sigmoid transformation like thisThe grey circles horizonal line correspons sigmoid transformation without adjustment threshold value.","code":"\ndat$indicator1_sigmoid_thr <- ifelse(\n  dat$variable1<dat$thr1,\n    ((dat$indicator1_sigmoid-0)/(sigmoid_thr-0))*(0.6-0)+0,\n    ((dat$indicator1_sigmoid-sigmoid_thr)/(1-sigmoid_thr))*(1-0.6)+0.6\n  )\nggplot(dat)+\n  geom_point(\n    aes(x = variable1, y = indicator1_sigmoid),\n             fill   = \"grey\", \n             colour = myColour,\n             size   = 5,\n             alpha  = myAlpha,\n             shape  = myShape)+\n  \n  geom_point(\n    aes(x = variable1, y = indicator1_sigmoid_thr, fill = indicator1_sigmoid_thr),\n             colour = myColour,\n             size   = mySize,\n             alpha  = myAlpha,\n             shape  = myShape)+\n  \n  geom_vline(xintercept = dat$referenceLow1[1],\n             linetype = \"dashed\",\n             size =1)+\n  geom_vline(xintercept = dat$referenceHigh1[1],\n             linetype = \"dashed\",\n             size =1)+\n  \n  geom_segment(aes(x = 0, y = sigmoid_thr, xend = thr1, yend = sigmoid_thr),\n               linetype=\"solid\",\n               colour = \"grey\",\n               size=1)+\n  \n  geom_segment(aes(x = thr1, y = 0, xend = thr1, yend = 0.6),\n               linetype=\"solid\",\n               size=1)+\n  geom_segment(aes(x = 0, y = 0.6, xend = thr1, yend = 0.6),\n               linetype=\"solid\",\n               size=1)+\n  \n  \n  ylab(\"Indicator values\")+\n  xlab(\"Variable values\")+\n  \n  scale_fill_gradient(\"Indicator values\", low = low, high = high)"},{"path":"scaling-functions.html","id":"exponential-functoins","chapter":"17 Scaling functions","heading":"17.6 Exponential functoins","text":"two examples exponential transformation can also used:","code":"\ndat$indicator1_expConvex <- dat$indicator1_LowHigh^0.5\ndat$indicator1_expConcave <- dat$indicator1_LowHigh^2\n\nggplot(dat)+\n  geom_point(\n    aes(x = variable1, y = indicator1_expConvex, fill = indicator1_expConvex),\n             colour = myColour,\n             size   = mySize,\n             alpha  = myAlpha,\n             shape  = myShape)+\n  geom_point(\n    aes(x = variable1, y = indicator1_expConcave, fill = indicator1_expConcave),\n             colour = myColour,\n             size   = mySize,\n             alpha  = myAlpha,\n             shape  = myShape)+\n  \n  geom_vline(xintercept = dat$referenceLow1[1],\n             linetype = \"dashed\",\n             size =1)+\n  geom_vline(xintercept = dat$referenceHigh1[1],\n             linetype = \"dashed\",\n             size =1)+\n  ylab(\"Indicator values\")+\n  xlab(\"Variable values\")+\n  \n  scale_fill_gradient(\"Indicator values\", low = low, high = high)"},{"path":"homogeneous-impact-areas.html","id":"homogeneous-impact-areas","chapter":"18 Homogeneous Impact Areas","heading":"18 Homogeneous Impact Areas","text":"Author date:Anders Kolstad","code":""},{"path":"homogeneous-impact-areas.html","id":"intro-hia","chapter":"18 Homogeneous Impact Areas","heading":"18.1 Introduction","text":"chapter documents creation wall--wall map homogeneous impact areas Norway.\nmap produced binning values infrastructure index four discrete categories.\nlikely good predictor indicators, slitasje presence alien species.","code":""},{"path":"homogeneous-impact-areas.html","id":"about-the-underlying-data-9","chapter":"18 Homogeneous Impact Areas","heading":"18.2 About the underlying data","text":"infrastructure index explained .\nwall--wall raster Norway 100 m resolution.\npixel given value along continuous gradient 0 around 15.4, representing frequency surrounding cells within 500 m human infrastructure (houses, roads, ect).","code":""},{"path":"homogeneous-impact-areas.html","id":"representativity-in-time-and-space-10","chapter":"18 Homogeneous Impact Areas","heading":"18.2.1 Representativity in time and space","text":"infrastructure index calculated data slightly different dates, can said represent year 2015.\ndata covers mainland Norway.","code":""},{"path":"homogeneous-impact-areas.html","id":"references-13","chapter":"18 Homogeneous Impact Areas","heading":"18.2.2 References","text":"Bakkestuen, V., Dervo, B.K., Bærum, K.M. og Erikstad, L. 2022.\nPrediksjonsmodellering av naturtyper ferskvann.\nNINA Rapport 2079.\nNorsk institutt naturforskning.","code":""},{"path":"homogeneous-impact-areas.html","id":"analyses-7","chapter":"18 Homogeneous Impact Areas","heading":"18.3 Analyses","text":"","code":""},{"path":"homogeneous-impact-areas.html","id":"import-data","chapter":"18 Homogeneous Impact Areas","heading":"18.3.1 Import data","text":"path must conditional:Import stars proxy (data imported yet)Print coordinate reference system:","code":"\ndir <- substr(getwd(), 1,2)\npath <- ifelse(dir == \"C:\", \n        \"R:/GeoSpatialData/Utility_governmentalServices/Norway_Infrastructure_Index/Original/Infrastrukturindeks_UTM33/infra_tiff.tif\",\n        \"/data/R/GeoSpatialData/Utility_governmentalServices/Norway_Infrastructure_Index/Original/Infrastrukturindeks_UTM33/infra_tiff.tif\")\ninfra <- stars::read_stars(path)\nst_crs(infra)$input\n#> [1] \"WGS_1984_UTM_Zone_33N\""},{"path":"homogeneous-impact-areas.html","id":"trondheim-example","chapter":"18 Homogeneous Impact Areas","heading":"18.3.2 Trondheim example","text":"’s easier see ’s happening zoom bit.\nLets get boundary box around Trondheim.Cropping raster bbox","code":"\nmyBB <- st_bbox(c(xmin=260520.12, xmax = 278587.56,\n                ymin = 7032142.5, ymax = 7045245.27),\n                crs = st_crs(infra))\ninfra_trd <- sf::st_crop(infra, myBB)"},{"path":"homogeneous-impact-areas.html","id":"get-osm-highways","chapter":"18 Homogeneous Impact Areas","heading":"18.3.2.1 Get OSM highways","text":"Lets download base maps help validate contextualize infrastructure index.Transform lat long due osm requirementsGet boundary box cropped rasterDownload highways using bbox.Transforming highway data back utm, although strictly necessary.object contains many roads (30k).\n’ll take unnamed roads.","code":"\ninfra_trd_ll <- sf::st_transform(infra_trd, 4326)\nmyBB_ll <- sf::st_bbox(infra_trd_ll)\nhw <- \n  osmplotr::extract_osm_objects(\n    bbox = myBB_ll,\n    key = \"highway\",\n    sf = T)\nhw_utm <- sf::st_transform(hw, sf::st_crs(infra_trd)) \nhw_utm <- hw_utm[!is.na(hw_utm$name),]"},{"path":"homogeneous-impact-areas.html","id":"discretize","chapter":"18 Homogeneous Impact Areas","heading":"18.3.2.2 Discretize","text":"define simplified categorical typology infrastructure index using four classes.Lets plot two maps side side\nFigure 16.4: Infrastructure index Trondheim, comparing continous scale ordinal four-step scale. Major roads white.\ntweaked thresholds bins categories match knowledge land use intensity Trondheim, example forest next Trondheim (left map) second lowest class.\nlooks pretty good .\ndepicts gradient human presence high within built zone, low forests mountains west.\nNote still considerable human activity also form outdoor recreation even forestry.","code":"\nnames(infra_trd) <- \"infrastructureIndex\"\ninfra_trd_reclassed <-  infra_trd %>%\n  mutate(infrastructureIndex = case_when(\n    infrastructureIndex < 1 ~ 0,\n    infrastructureIndex < 6 ~ 1,\n    infrastructureIndex < 12 ~ 2,\n    infrastructureIndex >= 12 ~ 3\n  ))\nmap_trd_reclassed <- tm_shape(infra_trd_reclassed)+\n  tm_raster(title=\"Infrastructure Index\",\n            #palette = \"viridis\",\n            style=\"cat\")+\n  tm_layout(legend.outside = T)+\n  tm_shape(hw_utm)+\n  tm_lines(col=\"white\")\nmap_trd <- tm_shape(infra_trd)+\n  tm_raster(title=\"Infrastructure Index\",\n            style=\"cont\",\n            palette = \"viridis\")+\n  tm_layout(legend.outside = T)+\n  tm_shape(hw_utm)+\n  tm_lines(col=\"white\")\ntmap_arrange(map_trd,\n             map_trd_reclassed,\n             ncol=1)\n#> stars_proxy object shown at 181 by 132 cells.\n#> stars_proxy object shown at 181 by 132 cells."},{"path":"homogeneous-impact-areas.html","id":"aggregate","chapter":"18 Homogeneous Impact Areas","heading":"18.3.2.3 Aggregate","text":"resolution map need, size data implies next step, vectorization, take long.\ntherefore aggregate, reduce resolution.cell now average aggregated cells, hence value continuous .\nLet’s make discrete.\nFigure 16.6: Infrastrcture index Trondheim four-step discrete scale, aggregated 1x1 km resolution using mean function.\nresolution good enough purpose .\nsee map extends bit fjord. want cut away areas. can use map outline Norway .CRS needs identical\nFigure 3.10: Infrastrcture index Trondheim four-step discrete scale, aggregated 1x1 km resolution using mean function.\ntreated raster cells points cropping, cells center cell outside terrestrial delineation removed. think makes sense unbiased area statistics, coastal indicator data also excluded . errors smaller finer resolution raster, computation time problem.","code":"\ndim <- st_dimensions(infra)\npaste(\"Resolution is\", dim$x$delta, \"by\", dim$x$delta, \"meters\")\n#> [1] \"Resolution is 100 by 100 meters\"\ninfra_trd_reclassed_agg <- st_warp(infra_trd_reclassed, cellsize = c(1000, 1000), \n                                   crs = st_crs(infra_trd_reclassed), \n                                   use_gdal = TRUE,\n                                   method = \"average\")\ndim <- st_dimensions(infra_trd_reclassed_agg)\npaste(\"Resolution is\", dim$x$delta, \"by\", dim$x$delta, \"meters\")\n#> [1] \"Resolution is 1000 by 1000 meters\"\nnames(infra_trd_reclassed_agg) <- \"infrastructureIndex\"\ninfra_trd_reclassed_agg <-  infra_trd_reclassed_agg %>%\n  mutate(infrastructureIndex = case_when(\n    infrastructureIndex < 1 ~ 0,\n    infrastructureIndex < 6 ~ 1,\n    infrastructureIndex < 12 ~ 2,\n    infrastructureIndex >= 12 ~ 3\n  ))\ntm_shape(infra_trd_reclassed_agg)+\n  tm_raster(title=\"Infrastructure Index\",\n            style=\"cat\")+\n  tm_layout(legend.outside = T)+\n  tm_shape(hw_utm)+\n  tm_lines(col=\"white\")\noutline <- st_read(\"data/outlineOfNorway_EPSG25833.shp\")\n#> Reading layer `outlineOfNorway_EPSG25833' from data source \n#>   `/data/Egenutvikling/41001581_egenutvikling_anders_kolstad/github/ecosystemCondition/data/outlineOfNorway_EPSG25833.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 1 feature and 2 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -113472.7 ymin: 6448359 xmax: 1114618 ymax: 7939917\n#> Projected CRS: ETRS89 / UTM zone 33N\ninfra_trd_reclassed_agg <- st_transform(infra_trd_reclassed_agg, 25833)\ninfra_trd_reclassed_agg_terrestrial <- st_crop(infra_trd_reclassed_agg, outline)\n#> Warning in st_crop.stars(infra_trd_reclassed_agg, outline):\n#> crop only crops regular grids\ntm_shape(infra_trd_reclassed_agg_terrestrial)+\n  tm_raster(title=\"Infrastructure Index\",\n            style=\"cat\")+\n  tm_layout(legend.outside = T)+\n  tm_shape(hw_utm)+\n  tm_lines(col=\"white\")+\n  tm_shape(outline)+\n  tm_borders(lwd =2,\n             col = \"black\")"},{"path":"homogeneous-impact-areas.html","id":"aggregate-the-entire-map-to-1x1-km","chapter":"18 Homogeneous Impact Areas","heading":"18.3.3 Aggregate the entire map to 1x1 km","text":"","code":"\n# runtime about 30 sec\ninfra_agg <- st_warp(infra, cellsize = c(1000, 1000), \n                                   crs = st_crs(infra), \n                                   use_gdal = TRUE,\n                                   method = \"average\")\n# The CRS needs to be identical for st_crop\ninfra_agg <- st_transform(infra_agg, 25833)"},{"path":"homogeneous-impact-areas.html","id":"cut-out-marine-areas","chapter":"18 Homogeneous Impact Areas","heading":"18.3.4 Cut out marine areas","text":"see map extends bit fjord. want cut away areas. can use map outline Norway .","code":"\ninfra_agg_terrestrial <- st_crop(infra_agg, outline)\nsaveRDS(infra_agg_terrestrial, \"P:/41201785_okologisk_tilstand_2022_2023/data/cache/infra_agg_terrestrial.rds\")"},{"path":"homogeneous-impact-areas.html","id":"discretize-the-entire-map","chapter":"18 Homogeneous Impact Areas","heading":"18.3.5 Discretize the entire map","text":"","code":"\nnames(infra_agg_terrestrial) <- \"infrastructureIndex\"\n\ninfra_agg_discrete <- infra_agg_terrestrial %>%\n  mutate(infrastructureIndex = case_when(\n    infrastructureIndex < 1 ~ 0,\n    infrastructureIndex < 6 ~ 1,\n    infrastructureIndex < 12 ~ 2,\n    infrastructureIndex >= 12 ~ 3\n  ))"},{"path":"homogeneous-impact-areas.html","id":"vectorize","chapter":"18 Homogeneous Impact Areas","heading":"18.3.6 Vectorize","text":"step might seem rather stupid.\nwant vectorize rather large raster.\nmakes quite big data object.\nreason really good way burn polygon data raster grid cells disuse raster package.\nstraight forward either.\ncalculating intersections polygons fast easy.Let’s plot now.\nFirst, lets crop reduce computation time.\nFigure 18.1: vectorized version Infrastructure index Trondheim four-step discrete scale.\ncan seen figure , st_warp merges grid cells value, vectorized raster doesn’t end big end.","code":"\ninfra_agg_discrete_vect <- \n  eaTools::ea_homogeneous_area(infra_agg_discrete, \n                                groups = infrastructureIndex)\npath <- ifelse(dir == \"C:\", \n        \"P:/41201785_okologisk_tilstand_2022_2023/data/cache/\",\n        \"/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/cache/\")\n\nsaveRDS(infra_agg_discrete_vect, paste0(path, \"infra_agg_discrete_vect.rds\"))\nmyBB <- st_bbox(c(xmin=260520.12, xmax = 278587.56,\n                ymin = 7032142.5, ymax = 7045245.27),\n                crs = st_crs(infra_agg_discrete_vect))\n\ninfra_agg_discrete_vect_trd <- st_crop(infra_agg_discrete_vect, myBB)\n#> Warning: attribute variables are assumed to be spatially\n#> constant throughout all geometries\ntm_shape(infra_agg_discrete_vect_trd)+\n  tm_polygons(col=\"infrastructureIndex\",\n              style = \"cat\")+\n  tm_layout(legend.outside = T)+\n  tm_shape(hw_utm)+\n  tm_lines(col=\"white\")"},{"path":"homogeneous-impact-areas.html","id":"check-national-distribution","chapter":"18 Homogeneous Impact Areas","heading":"18.4 Check national distribution","text":"Since two layers completely overlapping, can get intersectionsLet’s calculate areas polygons compare HIF five regions.\nFigure 3.24: Stacked barplot showing distribution human impact factor across five regions Norway.\ndistribution looks reasonable. relative proportions similar five regions, Østlandet Sørlandet infrastructure general.numbers behind figure .","code":"\nregions <- sf::read_sf(\"data/regions.shp\", options = \"ENCODING=UTF8\")\nunique(regions$region)\n#> [1] \"Nord-Norge\" \"Midt-Norge\" \"Østlandet\"  \"Vestlandet\"\n#> [5] \"Sørlandet\"\nst_crs(infra_agg_discrete_vect) == st_crs(regions)\n#> [1] TRUE\ninfra_stats <- eaTools::ea_homogeneous_area(infra_agg_discrete_vect,\n                             regions,\n                             keep1 = \"infrastructureIndex\",\n                             keep2 = \"region\")\nsaveRDS(infra_stats, \"P:/41201785_okologisk_tilstand_2022_2023/data/cache/infra_stats.rds\")\ninfra_stats$area_km2 <- units::drop_units(sf::st_area(infra_stats))\ninfra_stats$area_km2 <- infra_stats$area_km2/1000\n\ntemp <- as.data.frame(infra_stats) %>%\n  group_by(region, infrastructureIndex) %>%\n  summarise(area_km2 = mean(area_km2))\n#> `summarise()` has grouped output by 'region'. You can\n#> override using the `.groups` argument.\n\nggarrange(\n  ggplot(temp, aes(x = region, y = area_km2, fill = factor(infrastructureIndex)))+\n    geom_bar(position = \"stack\", stat = \"identity\")+\n    guides(fill = \"none\")+\n    coord_flip()+\n    xlab(\"\")\n  ,\n  ggplot(temp, aes(x = region, y = area_km2, fill = factor(infrastructureIndex)))+\n    geom_bar(position = \"fill\", stat = \"identity\")+\n    guides(fill = guide_legend(\"HIF\"))+\n    coord_flip()+\n    ylab(\"Fraction of total area\")+\n    xlab(\"\")\n)\ntemp$area_km2 <- round(temp$area_km2,0)\nDT::datatable(temp)"},{"path":"homogeneous-impact-areas.html","id":"exp-hia","chapter":"18 Homogeneous Impact Areas","heading":"18.5 Export","text":"write data NINA P server.","code":"\nsaveRDS(infra_agg_discrete_vect, \"P:/41201785_okologisk_tilstand_2022_2023/data/infrastrukturindeks/homogeneous_impact_areas.rds\")\nHIA_returned <- readRDS(\"P:/41201785_okologisk_tilstand_2022_2023/data/infrastrukturindeks/homogeneous_impact_areas.rds\")"},{"path":"master-grid.html","id":"master-grid","chapter":"19 Master grid","heading":"19 Master grid","text":"Author:Anders L. KolstadMarch 2023","code":""},{"path":"master-grid.html","id":"introduction-7","chapter":"19 Master grid","heading":"19.1 Introduction","text":"chapter describes making master raster grid mainland Norway. grid used align ecosystem indicator maps becomes possible easy resamping, masking aggregating.: plan add examples use master grid real data.","code":""},{"path":"master-grid.html","id":"about-the-underlying-data-10","chapter":"19 Master grid","heading":"19.2 About the underlying data","text":"use statistical grid Norway (5x5km) resample higher resolution 50 x 50 meters.","code":""},{"path":"master-grid.html","id":"analyses-8","chapter":"19 Master grid","heading":"19.3 Analyses","text":"Import dataConfirming CRS EPSG25833:","code":"\n# Set up conditional file paths\ndir <- substr(getwd(), 1,2)\n\npData <- ifelse(dir == \"C:\", \n               \"P:/41201785_okologisk_tilstand_2022_2023/data/\",\n               \"/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/\")\n#st_layers(paste0(pData, \"Basisdata_0000_Norge_25833_StatistiskRutenett5km_FGDB.gdb\"))\ngrid_5km <- sf::read_sf(paste0(pData, \"Basisdata_0000_Norge_25833_StatistiskRutenett5km_FGDB.gdb\")) \ntmap_mode(\"view\")\ntm_shape(grid_5km$SHAPE)+\n  tm_borders()\nst_crs(grid_5km)\n#> Coordinate Reference System:\n#>   User input: ETRS89 / UTM zone 33N \n#>   wkt:\n#> PROJCRS[\"ETRS89 / UTM zone 33N\",\n#>     BASEGEOGCRS[\"ETRS89\",\n#>         ENSEMBLE[\"European Terrestrial Reference System 1989 ensemble\",\n#>             MEMBER[\"European Terrestrial Reference Frame 1989\"],\n#>             MEMBER[\"European Terrestrial Reference Frame 1990\"],\n#>             MEMBER[\"European Terrestrial Reference Frame 1991\"],\n#>             MEMBER[\"European Terrestrial Reference Frame 1992\"],\n#>             MEMBER[\"European Terrestrial Reference Frame 1993\"],\n#>             MEMBER[\"European Terrestrial Reference Frame 1994\"],\n#>             MEMBER[\"European Terrestrial Reference Frame 1996\"],\n#>             MEMBER[\"European Terrestrial Reference Frame 1997\"],\n#>             MEMBER[\"European Terrestrial Reference Frame 2000\"],\n#>             MEMBER[\"European Terrestrial Reference Frame 2005\"],\n#>             MEMBER[\"European Terrestrial Reference Frame 2014\"],\n#>             ELLIPSOID[\"GRS 1980\",6378137,298.257222101,\n#>                 LENGTHUNIT[\"metre\",1]],\n#>             ENSEMBLEACCURACY[0.1]],\n#>         PRIMEM[\"Greenwich\",0,\n#>             ANGLEUNIT[\"degree\",0.0174532925199433]],\n#>         ID[\"EPSG\",4258]],\n#>     CONVERSION[\"UTM zone 33N\",\n#>         METHOD[\"Transverse Mercator\",\n#>             ID[\"EPSG\",9807]],\n#>         PARAMETER[\"Latitude of natural origin\",0,\n#>             ANGLEUNIT[\"degree\",0.0174532925199433],\n#>             ID[\"EPSG\",8801]],\n#>         PARAMETER[\"Longitude of natural origin\",15,\n#>             ANGLEUNIT[\"degree\",0.0174532925199433],\n#>             ID[\"EPSG\",8802]],\n#>         PARAMETER[\"Scale factor at natural origin\",0.9996,\n#>             SCALEUNIT[\"unity\",1],\n#>             ID[\"EPSG\",8805]],\n#>         PARAMETER[\"False easting\",500000,\n#>             LENGTHUNIT[\"metre\",1],\n#>             ID[\"EPSG\",8806]],\n#>         PARAMETER[\"False northing\",0,\n#>             LENGTHUNIT[\"metre\",1],\n#>             ID[\"EPSG\",8807]]],\n#>     CS[Cartesian,2],\n#>         AXIS[\"(E)\",east,\n#>             ORDER[1],\n#>             LENGTHUNIT[\"metre\",1]],\n#>         AXIS[\"(N)\",north,\n#>             ORDER[2],\n#>             LENGTHUNIT[\"metre\",1]],\n#>     USAGE[\n#>         SCOPE[\"Engineering survey, topographic mapping.\"],\n#>         AREA[\"Europe between 12°E and 18°E: Austria; Denmark - offshore and offshore; Germany - onshore and offshore; Norway including Svalbard - onshore and offshore.\"],\n#>         BBOX[46.4,12,84.42,18]],\n#>     ID[\"EPSG\",25833]]"},{"path":"master-grid.html","id":"make-grid","chapter":"19 Master grid","heading":"19.3.1 Make grid","text":"Use bbox split 50 x 50 meter cellsThis file 6GB.Number cells, millions, :, quite lot. area accounts might consider using 10x10m.","code":"\n(masterGrid_50m <- st_as_stars(st_bbox(grid_5km), dx = 50, dy = 50))\n#> stars object with 2 dimensions and 1 attribute\n#> attribute(s), summary of first 1e+05 cells:\n#>         Min. 1st Qu. Median Mean 3rd Qu. Max.\n#> values     0       0      0    0       0    0\n#> dimension(s):\n#>   from    to  offset delta                refsys x/y\n#> x    1 24500  -1e+05    50 ETRS89 / UTM zone 33N [x]\n#> y    1 30800 7965000   -50 ETRS89 / UTM zone 33N [y]\n(nrow(masterGrid_50m)*ncol(masterGrid_50m))/10^6\n#>     x \n#> 754.6"},{"path":"master-grid.html","id":"eksport-file-final-product-3","chapter":"19 Master grid","heading":"19.3.2 Eksport file (final product)","text":"","code":"\nstars::write_stars(masterGrid_50m, paste0(pData, \"masterGrid_50m.tiff\"))"},{"path":"master-grid.html","id":"test-import","chapter":"19 Master grid","heading":"19.3.3 Test import","text":"","code":"\ntemp <- stars::read_stars(paste0(pData, \"masterGrid_50m.tiff\"))\nst_dimensions(temp)\n#>   from    to  offset delta                refsys point x/y\n#> x    1 24500  -1e+05    50 ETRS89 / UTM zone 33N FALSE [x]\n#> y    1 30800 7965000   -50 ETRS89 / UTM zone 33N FALSE [y]"},{"path":"climate-indicators-explained.html","id":"climate-indicators-explained","chapter":"20 Climate indicators explained","heading":"20 Climate indicators explained","text":"Author date:Anders L. KolstadMarch 2023","code":""},{"path":"climate-indicators-explained.html","id":"intro-cli","chapter":"20 Climate indicators explained","heading":"20.1 Introduction","text":"chapters describes development workflow generating preparing indicators based interpolated climate data SeNorge. describe process using dummy data also discuss alternate approaches dead ends occured development process. succinct workflow example specific indicator, see Median summer temperature.","code":""},{"path":"climate-indicators-explained.html","id":"about-the-underlying-data-11","chapter":"20 Climate indicators explained","heading":"20.2 About the underlying data","text":"data raster format extends back 1957 form multiple interpolated climate variables. spatial resolution 1 x 1 km.","code":""},{"path":"climate-indicators-explained.html","id":"representativity-in-time-and-space-11","chapter":"20 Climate indicators explained","heading":"20.2.1 Representativity in time and space","text":"data includes last normal period (1961-1990) defines reference condition climate variables. Therefore temporal resolution good. Also considering daily resolution data.Spatially, 1x1 km resolution sufficient climate variables, esp. homogeneous terrain, needs evaluation variable scenario specifically.","code":""},{"path":"climate-indicators-explained.html","id":"original-units-7","chapter":"20 Climate indicators explained","heading":"20.2.2 Original units","text":"Varied. Specified parameter.","code":""},{"path":"climate-indicators-explained.html","id":"temporal-coverage-9","chapter":"20 Climate indicators explained","heading":"20.2.3 Temporal coverage","text":"1957 - present","code":""},{"path":"climate-indicators-explained.html","id":"additional-comments-about-the-data-set-1","chapter":"20 Climate indicators explained","heading":"20.2.4 Additional comments about the data set","text":"data format recently changed .BIL .nc (netcdf) now single file contains rasters one year (365 days), sometimes multiple variables also.","code":""},{"path":"climate-indicators-explained.html","id":"ecosystem-characteristic-8","chapter":"20 Climate indicators explained","heading":"20.3 Ecosystem characteristic","text":"","code":""},{"path":"climate-indicators-explained.html","id":"norwegian-standard-5","chapter":"20 Climate indicators explained","heading":"20.3.1 Norwegian standard","text":"variables typically fall abiotiske egenskaper class.","code":""},{"path":"climate-indicators-explained.html","id":"seea-ea-1","chapter":"20 Climate indicators explained","heading":"20.3.2 SEEA EA","text":"SEEA EA, variables typically fall A1 - Physical state characteristics.","code":""},{"path":"climate-indicators-explained.html","id":"collinearities-with-other-indicators-11","chapter":"20 Climate indicators explained","heading":"20.4 Collinearities with other indicators","text":"Climate variables likely correlated (e.g. temperature snow). Also, climate variables better classed pressure indicators, might causal association several condition indicators.","code":""},{"path":"climate-indicators-explained.html","id":"reference-condition-and-values-6","chapter":"20 Climate indicators explained","heading":"20.5 Reference condition and values","text":"","code":""},{"path":"climate-indicators-explained.html","id":"reference-condition-6","chapter":"20 Climate indicators explained","heading":"20.5.1 Reference condition","text":"reference condition climate variables defined normal period 1961-1990.","code":""},{"path":"climate-indicators-explained.html","id":"ref-vals-cli","chapter":"20 Climate indicators explained","heading":"20.5.2 Reference values, thresholds for defining good ecological condition, minimum and/or maximum values","text":"Un-scaled indicator value = median value 5 year periods (5 years pragmatic choice. long enough smooth lot inter-annual variation, ’s long enough enable estimating errors)Un-scaled indicator value = median value 5 year periods (5 years pragmatic choice. long enough smooth lot inter-annual variation, ’s long enough enable estimating errors)Upper reference level (best possible condition) = median value reference periodUpper reference level (best possible condition) = median value reference periodThresholds good ecosystem condition = 2 standard deviation units away upper reference level climate variable reference period.Thresholds good ecosystem condition = 2 standard deviation units away upper reference level climate variable reference period.Lower reference values (two-directional) = 5 standard deviation units climate variable reference period (implies linear scaling).Lower reference values (two-directional) = 5 standard deviation units climate variable reference period (implies linear scaling).choice use 2 SD units threshold values subjective choice many ways, founded empirical known relationship indicators ecosystem integrity. value comes common practice calling something extreme weather outside 2 SD units current running average. , indicator value today <0.6 implies mean variable last year referred extreme occurred 1961 1990. think conservative threshold, since one /call extreme one year outside 2SD range, mean 5 years outside range really extreme.","code":""},{"path":"climate-indicators-explained.html","id":"uncertainties-10","chapter":"20 Climate indicators explained","heading":"20.6 Uncertainties","text":"indicator map (1 x 1 km raster) uncertainty associated indicator values. aggregated indicator values (e.g. regions), uncertainty indicator value calculated spatial variation indicator values via bootstrapping. might, however, changed later temporal variation five years period.","code":""},{"path":"climate-indicators-explained.html","id":"references-14","chapter":"20 Climate indicators explained","heading":"20.7 References","text":"https://senorge./rr tm download : https://thredds.met./thredds/catalog/senorge/seNorge_2018/Archive/catalog.html","code":""},{"path":"climate-indicators-explained.html","id":"additional-resources-1","chapter":"20 Climate indicators explained","heading":"20.7.1 Additional resources","text":"Stars packageR GIS economists chapter 7","code":""},{"path":"climate-indicators-explained.html","id":"analyses-cli","chapter":"20 Climate indicators explained","heading":"20.8 Analyses","text":"","code":""},{"path":"climate-indicators-explained.html","id":"data-set-1","chapter":"20 Climate indicators explained","heading":"20.8.1 Data set","text":"data downloaded local NINA server, updated regularly.folder contains folder different parametersThis table explains detail\nFigure 15.1: Table explaining available climate parameters data set.\ncontent one folders (first 10 entries)67 files, .e. 67 years data, one file per year.Importing (proxy) file:know CRS, setting manually. Although rule 32633, don’t think matters.data three dimensionInitially data four attributes, subsettet include tg.tg_1957 stars proxy object commands initiate change later, typically write file lazy operations done squeal. Therefore, prepare test data set, smaller can import memory. can perform operations data set can see results.","code":"\npath <- ifelse(dir == \"C:\", \n      \"R:/GeoSpatialData/Meteorology/Norway_SeNorge2018_v22.09/Original\",\n      \"/data/R/GeoSpatialData/Meteorology/Norway_SeNorge2018_v22.09/Original\")\n(files <- list.files(path))\n#>  [1] \"age\"        \"fsw\"        \"gwb_eva\"    \"gwb_gwtcl\" \n#>  [5] \"gwb_q\"      \"gwb_sssdev\" \"gwb_sssrel\" \"lwc\"       \n#>  [9] \"qsw\"        \"rr_tm\"      \"sd\"         \"sdfsw\"     \n#> [13] \"swe\"\nsenorgelayers <- read_delim(\"data/senorgelayers.txt\", \n    delim = \"\\t\", escape_double = FALSE, \n    trim_ws = TRUE)\nDT::datatable(senorgelayers)\n(files_tm <- list.files(paste0(path, \"/rr_tm\")))[1:10]\n#>  [1] \"seNorge2018_1957.nc\" \"seNorge2018_1958.nc\"\n#>  [3] \"seNorge2018_1959.nc\" \"seNorge2018_1960.nc\"\n#>  [5] \"seNorge2018_1961.nc\" \"seNorge2018_1962.nc\"\n#>  [7] \"seNorge2018_1963.nc\" \"seNorge2018_1964.nc\"\n#>  [9] \"seNorge2018_1965.nc\" \"seNorge2018_1966.nc\"\ntg_1957 <- stars::read_ncdf(paste0(path, \"/rr_tm/seNorge2018_1957.nc\"),\n                            var=\"tg\")\n#> Large netcdf source found, returning proxy object.\nst_crs(tg_1957) <- 25833\ndim(tg_1957)\n#>    X    Y time \n#> 1195 1550  365\nnames(tg_1957)\n#> [1] \"tg\""},{"path":"climate-indicators-explained.html","id":"dummy-data","chapter":"20 Climate indicators explained","heading":"20.8.1.1 Dummy data","text":"test data included {stars} packageA single attributeI can rename like thisAnd can add another dummy attribute.dummy data also four dimensionsX y area coordinates. Band integer:remove band dimension.Time four dates covering four months 1970:’ll add extra seasonal variation mixNow create another four copies data, adding random noise continuous decreasing trend.Saving file.","code":"\ntif = system.file(\"tif/L7_ETMs.tif\", package = \"stars\")\nt1 = as.Date(\"1970-05-31\")\nx = read_stars(c(tif, tif, tif, tif), along = \n                  list(time = c(t1, t1+1, t1+50, t1+100)), \n               RasterIO = list(nXOff = c(1), \n                               nYOff = c(1), \n                               nXSize = 50, \n                               nYSize = 50, \n                               bands = c(1:6)))\nnames(x)\n#> [1] \"L7_ETMs.tif\"\nx <- setNames(x, \"Attribute_A\")\nx <- x %>%\n  mutate(\"Attribute_B\" = Attribute_A/2)\ndim(x)\n#>    x    y band time \n#>   50   50    6    4\nst_get_dimension_values(x, \"band\")\n#> [1] 1 2 3 4 5 6\nx <- x %>% filter(band==1) %>% adrop()\n(oldTime <- st_get_dimension_values(x, \"time\"))\n#> [1] \"1970-05-31\" \"1970-06-01\" \"1970-07-20\" \"1970-09-08\"\nx$Attribute_A[,,2] <- x$Attribute_A[,,1]*1.2\nx$Attribute_A[,,3] <- x$Attribute_A[,,1]*1.4\nx$Attribute_A[,,4] <- x$Attribute_A[,,1]*1.1\n# Function to add random noise\nmyRandom <- function(x) x*rnorm(1,1,.05)\ny1 <- x\ny2 <- x %>% st_apply(1:3, myRandom) %>% st_set_dimensions(\"time\", values = oldTime %m+% years(-1)) %>% mutate(Attribute_A = Attribute_A*0.95)\ny3 <- x %>% st_apply(1:3, myRandom) %>% st_set_dimensions(\"time\", values = oldTime %m+% years(-2)) %>% mutate(Attribute_A = Attribute_A*0.90)\ny4 <- x %>% st_apply(1:3, myRandom) %>% st_set_dimensions(\"time\", values = oldTime %m+% years(-3)) %>% mutate(Attribute_A = Attribute_A*0.85)\ny5 <- x %>% st_apply(1:3, myRandom) %>% st_set_dimensions(\"time\", values = oldTime %m+% years(-4)) %>% mutate(Attribute_A = Attribute_A*0.80)\n# We combine the data into one cube for plotting:\ntemp <- c(y1, y2, y3, y4, y5) \n\nggplot() + \n  geom_stars(data = temp) +\n  coord_equal() +\n  theme_void() +\n  scale_fill_viridis_c(option = \"D\") +  \n  scale_x_discrete(expand = c(0, 0)) +\n  scale_y_discrete(expand = c(0, 0))+\n  facet_wrap(~time, ncol=4)\npath <- \"P:/41201785_okologisk_tilstand_2022_2023/data/climate_indicators/dummy_data\"\nsaveRDS(y1, paste0(path, \"/y1.rds\"))\nsaveRDS(y2, paste0(path, \"/y2.rds\"))\nsaveRDS(y3, paste0(path, \"/y3.rds\"))\nsaveRDS(y4, paste0(path, \"/y4.rds\"))\nsaveRDS(y5, paste0(path, \"/y5.rds\"))"},{"path":"climate-indicators-explained.html","id":"dummy-regions-and-et-map","chapter":"20 Climate indicators explained","heading":"20.8.1.1.1 Dummy regions and ET map","text":"dummy data accounting areas (regions) ecosystem occurrences well, case need later.\nFigure 16.7: Showing example account area delineation (raster format)\n\nFigure 20.1: Showing example Ecosystem type delineation data.\n","code":"\ndummy_aa <- x %>%\n  filter(time == oldTime[1]) %>%\n  adrop() %>%\n  mutate(accountingAreas = rep(c(1,2), each=length(Attribute_A)/2)) %>%\n  select(accountingAreas)\n\ntm_shape(dummy_aa) +\n  tm_raster(style=\"cat\")\ndummy_et <- x %>%\n  filter(time == oldTime[1]) %>%\n  adrop() %>%\n  mutate(ecosystemType = rep(c(1,NA), length.out = length(Attribute_A))) %>%\n  select(ecosystemType)\n\ntm_shape(dummy_et) +\n  tm_raster(style=\"cat\")"},{"path":"climate-indicators-explained.html","id":"regions-cli","chapter":"20 Climate indicators explained","heading":"20.8.1.2 Regions","text":"Importing shape file regional delineation.Outline NorwayRemove marine areas regions\nFigure 5.8: Five accounting areas (regions) Norway.\n","code":"\nreg <- sf::st_read(\"data/regions.shp\", options = \"ENCODING=UTF8\")\n#> options:        ENCODING=UTF8 \n#> Reading layer `regions' from data source \n#>   `/data/Egenutvikling/41001581_egenutvikling_anders_kolstad/github/ecosystemCondition/data/regions.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 5 features and 2 fields\n#> Geometry type: POLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -99551.21 ymin: 6426048 xmax: 1121941 ymax: 7962744\n#> Projected CRS: ETRS89 / UTM zone 33N\n#st_crs(reg)\nnor <- sf::st_read(\"data/outlineOfNorway_EPSG25833.shp\")\n#> Reading layer `outlineOfNorway_EPSG25833' from data source \n#>   `/data/Egenutvikling/41001581_egenutvikling_anders_kolstad/github/ecosystemCondition/data/outlineOfNorway_EPSG25833.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 1 feature and 2 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -113472.7 ymin: 6448359 xmax: 1114618 ymax: 7939917\n#> Projected CRS: ETRS89 / UTM zone 33N\nreg <- st_intersection(reg, nor)\n#> Warning: attribute variables are assumed to be spatially\n#> constant throughout all geometries\ntm_shape(reg) +\n  tm_polygons(col=\"region\")"},{"path":"climate-indicators-explained.html","id":"ecosystem-map-2","chapter":"20 Climate indicators explained","heading":"20.8.1.3 Ecosystem map","text":"Coming soon ….climate indicators need masked ecosystem type maps. step part chapter.","code":""},{"path":"climate-indicators-explained.html","id":"conceptual-workflow-1","chapter":"20 Climate indicators explained","heading":"20.8.2 Conceptual workflow","text":"general, conceptual workflow like :Collate variable data series\nImport .nc files (loop though year 1961-1990) subset correct attribute\nFilter data dates (optional) (dplyr::filter). means reading 365 rasters memory, much quicker filter correct rasters importing step (see examples later chapter)\nAggregate across time within year (stars::st_apply). time consuming operation workflow.\nJoin data one data cube (stars:c)\nCollate variable data seriesImport .nc files (loop though year 1961-1990) subset correct attributeImport .nc files (loop though year 1961-1990) subset correct attributeFilter data dates (optional) (dplyr::filter). means reading 365 rasters memory, much quicker filter correct rasters importing step (see examples later chapter)Filter data dates (optional) (dplyr::filter). means reading 365 rasters memory, much quicker filter correct rasters importing step (see examples later chapter)Aggregate across time within year (stars::st_apply). time consuming operation workflow.Aggregate across time within year (stars::st_apply). time consuming operation workflow.Join data one data cube (stars:c)Join data one data cube (stars:c)Calculate reference values\nAggregate (st_apply) across reference years (dplyr::filter) get median sd values\nJoin existing data cube (stars:c)\nCalculate reference valuesAggregate (st_apply) across reference years (dplyr::filter) get median sd valuesAggregate (st_apply) across reference years (dplyr::filter) get median sd valuesJoin existing data cube (stars:c)Join existing data cube (stars:c)Calculate indicator values\nNormalize climate variable individual grid cell level using three reference values (mutate(across()))\nCalculate indicator valuesNormalize climate variable individual grid cell level using three reference values (mutate(across()))Mask ecosystem type (also done step one, doesn’t speed things set cells NA)Mask ecosystem type (also done step one, doesn’t speed things set cells NA)Aggregate space (accounting areas) (zonal statistics)\nAggregate across 5 year time steps smooth random inter-annual variation leave climate signal\nIntersect accounting area polygons exactextrar::exact_extract get mean/median (spatial) sd. (Alternatively, get temporal sd grid cell level step .)\nAggregate space (accounting areas) (zonal statistics)Aggregate across 5 year time steps smooth random inter-annual variation leave climate signalAggregate across 5 year time steps smooth random inter-annual variation leave climate signalIntersect accounting area polygons exactextrar::exact_extract get mean/median (spatial) sd. (Alternatively, get temporal sd grid cell level step .)Intersect accounting area polygons exactextrar::exact_extract get mean/median (spatial) sd. (Alternatively, get temporal sd grid cell level step .)Make trend figure spatially aggregated maps,Make trend figure spatially aggregated maps,","code":""},{"path":"climate-indicators-explained.html","id":"collate-variable-data-series","chapter":"20 Climate indicators explained","heading":"20.8.3 Collate variable data series","text":"include loop importing .nc files end.","code":""},{"path":"climate-indicators-explained.html","id":"filter-data-by-dates","chapter":"20 Climate indicators explained","heading":"20.8.4 Filter data by dates","text":"Say want calculate mean summer temperature. want exclude data times withing definition summer.Let’s try dummy data. Remember data four time steps.real data 365 time steps year.First define start end dates. want keep summer data, defined jun - aug.iteration need get year wellThen can create time interval objectThen filterLater discover `dplyr::filter` work reading whole object file, therefor slow use. therefore filter data different way .","code":"\nst_get_dimension_values(x, \"time\")\n#> [1] \"1970-05-31\" \"1970-06-01\" \"1970-07-20\" \"1970-09-08\"\nstart_month <-  \"06\"\nend_month <- \"08\"\n(year_temp <- year(st_get_dimension_values(x, \"time\")[1]))\n#> [1] 1970\nstart <- ym(paste(year_temp, start_month, sep=\"-\"))\nend <-  ym(paste(year_temp, end_month, sep=\"-\"))\n(myInterval <- interval(start, end))\n#> [1] 1970-06-01 UTC--1970-08-01 UTC\nx_aug <- x %>%\n  select(Attribute_A) %>%\n  adrop() %>%\n  filter(time %within% myInterval)\nst_get_dimension_values(x_aug, \"time\")\n#> [1] \"1970-06-01\" \"1970-07-20\""},{"path":"climate-indicators-explained.html","id":"aggregate-across-time-within-a-year","chapter":"20 Climate indicators explained","heading":"20.8.5 Aggregate across time within a year","text":"example want calculate mean temperature summer. therefore need aggregate time. Many climate indicators need functionality. two ways, either using st_apply using aggregate.time dimension now gone aggregated across .\nFigure 20.2: Comparing computation tome two spatial aggregation functions.\nst_apply slightly faster, aggregate advantage retains time dimension, whereas st_apply need set attribute name year. try use st_apply.let see can save time masking ET operation.\nFigure 20.3: Demonstrating effect maskig dummy data using perfectly aligne raster ET map.\n\nFigure 20.4: Comparing computation time masking raster data. performance increase masking aggregating.\nSince increase performance masking, see Fig. @ref(fig: withMasking) basically means slower mask beforehand, since masking past benchmark assessment., solution:v_ follows naming convention developed .\nFigure 20.5: Plotting dummy data showing Attribute_A two dates small maps, larger map showing mean year 2018\n’s whole first step conceptual workflow action, dummy data.result.\nFigure 20.6: Temporal aggregation dummy data set.\nNow let’s try real data.initially tried read stars proxy object add steps call_list execute st_as_stars, still returned proxy objects. Therefore read whole file without proxy. save time can subset based Julian dates.use parallelization speed things .takes 20 sec per file/year, 22 min total. bad. 6000 raster read memory. ’s test effect splitting cores.cluster: 21.401 sec elapsedNo cluster: 21.401 sec elapsedTwo clusters: 21.546 sec elapsedTwo clusters: 21.546 sec elapsedSix clusters: 14.548 sec elapsedSix clusters: 14.548 sec elapsedTen clusters: 15.29 sec elapsedTen clusters: 15.29 sec elapsedTen clusters (second run): 13.617 sec elapsedTen clusters (second run): 13.617 sec elapsedThe RStudio server 48 cores. parallel cores probably average faster. NINA guidelines use max 10 cores, remember close parallel cluster done.files 500 MB, tiff file reads lot quicker rds file, now ’ll just export tiff. (perhaps solved gc(). Later tried saving RData speed issues problems, problem RData files seemingly becoming corrupted time - stars objects saved RData files bind together using c.stars() matching stars object think related time stamp RData format. , stick tiff).Note GTiff automatically renames third dimension band also renames attribute.can rename .\nFigure 5.13: Showing three random slices year dimension.\n","code":"\ntemp_names <- year(st_get_dimension_values(x_aug, \"time\")[1])\n\nmicroOut <- microbenchmark(\nst_apply =  x_aug %>%\n  st_apply(1:2, mean) %>%\n  setNames(paste0(\"v_\",temp_names)),\naggregate = x_aug %>%\n  aggregate(by = \"year\", mean),\ntimes=30\n)\nautoplot(microOut)\n#> Coordinate system already present. Adding new coordinate\n#> system, which will replace the existing one.\nx_masked <- x_aug\nx_masked[is.na(dummy_et)] <- NA\nplot(x_masked[,,,1])\nautoplot(\n  microbenchmark(\nNo_masking =  x_aug %>%\n  st_apply(1:2, mean) %>%\n  setNames(paste0(\"v_\",temp_names)),\nMasking =  x_masked %>%\n  st_apply(1:2, mean) %>%\n  setNames(paste0(\"v_\",temp_names))\n ), times=30\n)\n#> Coordinate system already present. Adding new coordinate\n#> system, which will replace the existing one.\n# setNames dont work on stars proxy obejct, so I use rename instead\nlookup <- setNames(\"mean\", paste0(\"v_\", temp_names))\n\nx_summerMean <-   x_aug %>%\n  st_apply(1:2, mean) %>%\n  rename(all_of(lookup))\nggarrange(\nggplot() + \n  geom_stars(data = x_aug) +\n  coord_equal() +\n  facet_wrap(~time) +\n  theme_void() +\n  scale_fill_viridis_c(option = \"D\") +  scale_x_discrete(expand = c(0, 0)) +\n  scale_y_discrete(expand = c(0, 0)),  \n  \n  \nggplot() + \n  geom_stars(data = x_summerMean) +\n  coord_equal() +\n  #facet_wrap(~time) +\n  theme_void() +\n  scale_fill_viridis_c(option = \"D\") +\n  scale_x_discrete(expand = c(0, 0)) +\n  scale_y_discrete(expand = c(0, 0))\n)\n\n# Setting up the parameters\ndir <- substr(getwd(), 1,2)\npath <- ifelse(dir == \"C:\",\n       \"P:/\", \n       \"/data/P-Prosjekter2/\")\npath2 <- paste0(path, \n                \"41201785_okologisk_tilstand_2022_2023/data/climate_indicators/dummy_data\")\nstart_month <-  \"06\"\nend_month <- \"08\"\nmyFiles <- list.files(path2, pattern=\".rds\", full.names = T)\nsummerTemp_fullSeries <- NULL\n\n# Looping though the files in the directory\nsystem.time({\nfor(i in 1:length(myFiles)){\n  \n  temp <- readRDS(myFiles[i]) %>%\n    select(Attribute_A)\n  \n  year_temp <- year(st_get_dimension_values(temp, \"time\")[1])\n  start <- ym(paste(year_temp, start_month, sep=\"-\"))\n  end <-  ym(paste(year_temp, end_month, sep=\"-\"))\n  myInterval <- interval(start, end)\n  lookup <- setNames(\"mean\", paste0(\"v_\", year_temp))\n\n  temp <- temp %>%\n    filter(time %within% myInterval) %>%\n    st_apply(1:2, mean) %>%\n    rename(all_of(lookup))\n  \n  summerTemp_fullSeries <- c(temp, summerTemp_fullSeries)\n  rm(temp) # same computation time with and without this function, but more tidy this way\n}\n\n\n# Turn the attributes into a dimension and rename the new attribute\nsummerTemp_fullSeries <- summerTemp_fullSeries %>%\n  merge(name=\"Year\") %>%\n  setNames(\"Attribute_A\")\n})\n#>    user  system elapsed \n#>   0.124   0.004   0.134\nggplot()+\n  geom_stars(data = summerTemp_fullSeries) +\n  coord_equal() +\n  theme_void() +\n  scale_fill_viridis_c(option = \"D\") +  \n  scale_x_discrete(expand = c(0, 0)) +\n  scale_y_discrete(expand = c(0, 0))+\n  facet_wrap(~Year)\npath <- path <- ifelse(dir == \"C:\", \n      \"R:/\",\n      \"/data/R/\")\n  \npath2 <- paste0(path, \"GeoSpatialData/Meteorology/Norway_SeNorge2018_v22.09/Original/rr_tm/\")\n\nmyFiles <- list.files(path2, pattern=\".nc$\",full.names = T)\n# The last file (the last year) is incomplete and don't include all julian dates that we select below, so I will not include it:\nmyFiles <- myFiles[-length(myFiles)]\n\nreal_temp_summer <- NULL\n\n# set up parallel cluster using 10 cores\ncl <- makeCluster(10L)\n\n# Get julian days after defining months\ntemp <- stars::read_ncdf(paste(myFiles[1]), var=\"tg\")\nstart_month_num <-  6\nend_month_num <- 8\n\njulian_start <- yday(st_get_dimension_values(temp, \"time\")[1] %m+%\n                       months(+start_month_num))\njulian_end <- yday(st_get_dimension_values(temp, \"time\")[1] %m+%\n                     months(+end_month_num))\nstep <- julian_end-julian_start\n\n\n\nfor(i in 1:length(myFiles)){\n  \n  tic(\"init\")\n  temp <- stars::read_ncdf(paste(myFiles[i]), var=\"tg\", proxy=F,\n                           ncsub = cbind(start = c(1, 1, julian_start), \n                              count = c(NA, NA, step)))\n  year_temp <- year(st_get_dimension_values(temp, \"time\")[1])\n  print(year_temp)\n  lookup <- setNames(\"mean\", paste0(\"v_\", year_temp)) \n    # Perhaps leave out the v_ to get a numeric vector instead, \n    # which is easier to subset\n  st_crs(temp) <- 25833\n  toc()\n\n  tic(\"filter and st_apply\")\n  temp <- temp %>%\n    #filter(time %within% myInterval) %>%\n    st_apply(1:2, mean, CLUSTER = cl) %>%\n    rename(all_of(lookup)) \n  toc()\n  \n  tic(\"c()\")\n  real_temp_summer <- c(temp, real_temp_summer)\n  #rm(temp)\n  toc()\n}\n\ntic(\"Merge\")\nreal_temp_summer <- real_temp_summer %>%\n  merge(name = \"Year\") %>%\n  setNames(\"climate_variable\")\ntoc()\n\nstopCluster(cl)\ncl <- makeCluster(2L)\ncl2 <- makeCluster(6L)\ncl3 <- makeCluster(10L)\n\n\ntic(\"No cluster\")\ntemp %>%\n    #filter(time %within% myInterval) %>%\n    st_apply(1:2, mean) %>%\n    rename(all_of(lookup)) \ntoc()\n\ntic(\"Two clusters\")\ntemp %>%\n    #filter(time %within% myInterval) %>%\n    st_apply(1:2, mean, CLUSTER = cl) %>%\n    rename(all_of(lookup)) \nstopCluster(cl)\ntoc()\n\ntic(\"Six clusters\")\ntemp %>%\n    #filter(time %within% myInterval) %>%\n    st_apply(1:2, mean, CLUSTER = cl2) %>%\n    rename(all_of(lookup)) \nstopCluster(cl2)\ntoc()\n\ntic(\"Ten clusters\")\ntemp %>%\n    #filter(time %within% myInterval) %>%\n    st_apply(1:2, mean, CLUSTER = cl3) %>%\n    rename(all_of(lookup)) \nstopCluster(cl3)\ntoc()\n  \n#saveRDS(real_temp_summer, \"/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/climate_indicators/aggregated_climate_time_series/real_temp_summer.rds\")\n#write_stars(real_temp_summer, \"/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/climate_indicators/aggregated_climate_time_series/real_temp_summer.tiff\")\nsummer_median_temp <- read_stars(paste0(pData, \"climate_indicators/aggregated_climate_time_series/real_temp_summer.tiff\"),\n                                 proxy=F)\nnames(summer_median_temp)\n#> [1] \"real_temp_summer.tiff\"\ndim(summer_median_temp)\n#>    x    y band \n#> 1195 1550   66\nst_get_dimension_values(summer_median_temp, \"Year\")\n#> NULL\nst_get_dimension_values(summer_median_temp, \"band\")\n#>  [1] \"v_2022\" \"v_2021\" \"v_2020\" \"v_2019\" \"v_2018\" \"v_2017\"\n#>  [7] \"v_2016\" \"v_2015\" \"v_2014\" \"v_2013\" \"v_2012\" \"v_2011\"\n#> [13] \"v_2010\" \"v_2009\" \"v_2008\" \"v_2007\" \"v_2006\" \"v_2005\"\n#> [19] \"v_2004\" \"v_2003\" \"v_2002\" \"v_2001\" \"v_2000\" \"v_1999\"\n#> [25] \"v_1998\" \"v_1997\" \"v_1996\" \"v_1995\" \"v_1994\" \"v_1993\"\n#> [31] \"v_1992\" \"v_1991\" \"v_1990\" \"v_1989\" \"v_1988\" \"v_1987\"\n#> [37] \"v_1986\" \"v_1985\" \"v_1984\" \"v_1983\" \"v_1982\" \"v_1981\"\n#> [43] \"v_1980\" \"v_1979\" \"v_1978\" \"v_1977\" \"v_1976\" \"v_1975\"\n#> [49] \"v_1974\" \"v_1973\" \"v_1972\" \"v_1971\" \"v_1970\" \"v_1969\"\n#> [55] \"v_1968\" \"v_1967\" \"v_1966\" \"v_1965\" \"v_1964\" \"v_1963\"\n#> [61] \"v_1962\" \"v_1961\" \"v_1960\" \"v_1959\" \"v_1958\" \"v_1957\"\nsummer_median_temp <- summer_median_temp %>% \n  st_set_dimensions(names = c(\"x\", \"y\", \"v_YEAR\")) %>%\n  setNames(\"temperature\")\ndim(summer_median_temp)\n#>      x      y v_YEAR \n#>   1195   1550     66\nggplot()+\n  geom_stars(data = summer_median_temp[,,,c(1,11,22)], downsample = c(10, 10, 0)) +\n  coord_equal() +\n  theme_void() +\n  scale_fill_viridis_c(option = \"D\") +  \n  scale_x_discrete(expand = c(0, 0)) +\n  scale_y_discrete(expand = c(0, 0))+\n  facet_wrap(~v_YEAR)"},{"path":"climate-indicators-explained.html","id":"calculate-reference-values","chapter":"20 Climate indicators explained","heading":"20.8.6 Calculate reference values","text":"","code":""},{"path":"climate-indicators-explained.html","id":"aggregate-across-reference-years","chapter":"20 Climate indicators explained","heading":"20.8.6.1 Aggregate across reference years","text":"need first define reference period subset data summer_median_temp. can practice dummy data y.Now aggregate across years, using st_apply.’s perhaps easier median sd unique attributes, rather levels dimension.attribute name mean can change something meaningful.\nFigure 3.21: Showing upper reference levels standard deviation dummy data set.\nLet’s transfer real data. First need rename dimension values turn back dates.can filter leave reference period.calculate median sd like aboveThis also something can export.Pivot turn dimension attributes:attribute name mean. can change something meaningful.\nFigure 20.7: Showing upper reference levels standard deviation actual data median summer temperatures.\n","code":"\ndir <- substr(getwd(), 1,2)\npath <- ifelse(dir == \"C:\",\n       \"P:/\", \n       \"/data/P-Prosjekter2/\")\npath2 <- paste0(path, \n                \"41201785_okologisk_tilstand_2022_2023/data/climate_indicators/dummy_data\")\nmyFiles <- list.files(path2, pattern=\".rds\", full.names = T)\ny <- NULL\n\n# Looping though the files in the directory\nfor(i in 1:length(myFiles)){\n  temp <- readRDS(myFiles[i])\n  y <- c(temp, y)\n}\nst_get_dimension_values(y, \"time\")\n#>  [1] \"1966-05-31\" \"1966-06-01\" \"1966-07-20\" \"1966-09-08\"\n#>  [5] \"1967-05-31\" \"1967-06-01\" \"1967-07-20\" \"1967-09-08\"\n#>  [9] \"1968-05-31\" \"1968-06-01\" \"1968-07-20\" \"1968-09-08\"\n#> [13] \"1969-05-31\" \"1969-06-01\" \"1969-07-20\" \"1969-09-08\"\n#> [17] \"1970-05-31\" \"1970-06-01\" \"1970-07-20\" \"1970-09-08\"\ny_filtered <- y %>%\n  select(Attribute_A) %>%\n  filter(time %within% interval(\"1961-01-01\", \"1990-12-31\"))\nmedian_sd <- function(x) { c(median = median(x), sd = sd(x))}\ny_ref <- y_filtered %>%\n  st_apply(c(\"x\", \"y\"), FUN =  median_sd)\ndim(y_ref)\n#> median_sd         x         y \n#>         2        50        50\nst_get_dimension_values(y_ref, \"median_sd\")\n#> [1] \"median\" \"sd\"\ny_ref <- y_ref %>% split(\"median_sd\")\ny_ref <- setNames(y_ref, c(\"reference_upper\", \"sd\"))\ntmap_arrange(\ntm_shape(y_ref)+\n  tm_raster(\"reference_upper\")\n,\ntm_shape(y_ref)+\n  tm_raster(\"sd\",\n            palette = \"-viridis\")\n)\nnew_dims <- as.Date(paste0(\n  substr(st_get_dimension_values(summer_median_temp, \"v_YEAR\"), 3, 6), \"-01-01\"))\nsummer_median_temp_ref <- summer_median_temp %>%\n  st_set_dimensions(\"v_YEAR\", values = new_dims)\nsummer_median_temp_ref <- summer_median_temp_ref %>%\n  filter(v_YEAR %within% interval(\"1961-01-01\", \"1990-12-31\"))\nst_get_dimension_values(summer_median_temp_ref, \"v_YEAR\")\n#>  [1] \"1990-01-01\" \"1989-01-01\" \"1988-01-01\" \"1987-01-01\"\n#>  [5] \"1986-01-01\" \"1985-01-01\" \"1984-01-01\" \"1983-01-01\"\n#>  [9] \"1982-01-01\" \"1981-01-01\" \"1980-01-01\" \"1979-01-01\"\n#> [13] \"1978-01-01\" \"1977-01-01\" \"1976-01-01\" \"1975-01-01\"\n#> [17] \"1974-01-01\" \"1973-01-01\" \"1972-01-01\" \"1971-01-01\"\n#> [21] \"1970-01-01\" \"1969-01-01\" \"1968-01-01\" \"1967-01-01\"\n#> [25] \"1966-01-01\" \"1965-01-01\" \"1964-01-01\" \"1963-01-01\"\n#> [29] \"1962-01-01\" \"1961-01-01\"\nsystem.time({\ncl <- makeCluster(10L)\nsummer_median_temp_ref <- summer_median_temp_ref %>%\n  st_apply(c(\"x\", \"y\"), \n           FUN =  median_sd,\n           CLUSTER = cl)\nstopCluster(cl)\n})\n# Note that write_stars can only export a single attribute, but we have put the 'attributes' as dimensions, and these will be read in as 'band' when importing tiff.\nwrite_stars(summer_median_temp_ref, \"/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/climate_indicators/aggregated_climate_time_series/summer_median_temp_ref.tiff\")\n\n# I initially saved as RData, like this, but ran into problems later when trying to bind stars objects using c.stars(). It appears RData becomes corrutpt in a sense, over time, perhaps due to some time stamp. If I recreated the object in the global environment and saved as RDatam I could read it in and work with it, but the next day it would not work again.\n#saveRDS(summer_median_temp_ref, \"/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/climate_indicators/aggregated_climate_time_series/summer_median_temp_ref.RData\")\nsummer_median_temp_ref_long <- summer_median_temp_ref %>% split(\"band\")\nsummer_median_temp_ref_long <- setNames(summer_median_temp_ref_long, c(\"reference_upper\", \"sd\"))\ntmap_arrange(\ntm_shape(st_downsample(summer_median_temp_ref_long, 10))+\n  tm_raster(\"reference_upper\")\n,\ntm_shape(st_downsample(summer_median_temp_ref_long, 10))+\n  tm_raster(\"sd\",\n            palette = \"-viridis\")\n)"},{"path":"climate-indicators-explained.html","id":"combine","chapter":"20 Climate indicators explained","heading":"20.8.6.2 Combine","text":"need combine variables ref values one data cube","code":"\ny_var <- summer_median_temp %>%\n  split(3) %>%\n  c(summer_median_temp_ref_long)"},{"path":"climate-indicators-explained.html","id":"normalise-variable","chapter":"20 Climate indicators explained","heading":"20.8.7 Normalise variable","text":"Writing file, time RData (use rds) tiff don’t allow multiple attributes, don’t need use c.stars() object.\nFigure 20.8: Example showing median summer tempretur 1970, upper lwoer reference temperture, .e. median 5 SD units temperature 1961-1990, finally, scaled indicator values.\nreal indicator values means 5 year periods. Calculating running mean time steps time consuming. Therefore, scaled, regional indicator values calculated distinct time steps. time series can perhaps best presented yearly resolution.","code":"\n# select the columns to normalise\ncols <- names(y_var)[!names(y_var) %in% c(\"reference_upper\", \"sd\") ]\ncols_new <- cols\nnames(cols_new) <- gsub(\"v_\", \"i_\", cols)\n# Mutate\n\n# The break point scaling is actually not needed here, since \n# having the lower ref value to be 5 sd implies that the threshold is\n# 2 sd in a linear scaling.\n\nsystem.time(\ny_var_norm <- y_var %>%\n  mutate(reference_low = reference_upper - 5*sd ) %>%\n  mutate(reference_low2 = reference_upper + 5*sd ) %>%\n  mutate(threshold_low = reference_upper -2*sd ) %>%\n  mutate(threshold_high = reference_upper +2*sd ) %>%\n  mutate(across(all_of(cols), ~ \n                  if_else(.x < reference_upper,\n                  if_else(.x < threshold_low, \n                                        (.x - reference_low) / (threshold_low - reference_low),\n                                        (.x - threshold_low) / (reference_upper - threshold_low),\n                                        ),\n                  if_else(.x > threshold_high, \n                                        (reference_low2 - .x) / (reference_low2 - threshold_high),\n                                        (threshold_high - .x) / (threshold_high - reference_upper),\n                                        )\n                ))) %>%\n  mutate(across(all_of(cols), ~ if_else(.x > 1, 1, .x))) %>%\n  mutate(across(all_of(cols), ~ if_else(.x < 0, 0, .x))) %>%\n  rename(all_of(cols_new)) %>%\n  c(select(y_var, all_of(cols)))\n)\ngc()\nsaveRDS(y_var_norm, \"/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/climate_indicators/aggregated_climate_time_series/summer_median_temp_normalised.RData\")\n\nlims <- c(-5, 22)\n\nggarrange(\nggplot() + \n  geom_stars(data = st_downsample(y_var_norm[\"v_1970\"],10)) +\n  coord_equal() +\n  theme_void() +\n  scale_fill_viridis_c(option = \"D\",\n                       limits = lims) +  \n  scale_x_discrete(expand = c(0, 0)) +\n  scale_y_discrete(expand = c(0, 0))\n,\nggplot() + \n  geom_stars(data = st_downsample(y_var_norm[\"reference_upper\"], 10)) +\n  coord_equal() +\n  theme_void() +\n  scale_fill_viridis_c(option = \"D\",\n                       limits = lims) +  \n  scale_x_discrete(expand = c(0, 0)) +\n  scale_y_discrete(expand = c(0, 0))\n,\nggplot() + \n  geom_stars(data = st_downsample(y_var_norm[\"reference_low\"], 10)) +\n  coord_equal() +\n  theme_void() +\n  scale_fill_viridis_c(option = \"D\",\n                       limits = lims) +  \n  scale_x_discrete(expand = c(0, 0)) +\n  scale_y_discrete(expand = c(0, 0))\n,\n\nggplot() + \n  geom_stars(data = st_downsample(y_var_norm[\"reference_low2\"], 10)) +\n  coord_equal() +\n  theme_void() +\n  scale_fill_viridis_c(option = \"D\",\n                       limits = lims) +  \n  scale_x_discrete(expand = c(0, 0)) +\n  scale_y_discrete(expand = c(0, 0))\n,\n\nggplot() + \n  geom_stars(data = st_downsample(y_var_norm[\"i_1970\"],10)) +\n  coord_equal() +\n  theme_void() +\n  scale_fill_viridis_c(option = \"A\",\n                       limits = c(0, 1)) +  \n  scale_x_discrete(expand = c(0, 0)) +\n  scale_y_discrete(expand = c(0, 0))\n, ncol=2, nrow=3, align = \"hv\"\n)"},{"path":"climate-indicators-explained.html","id":"plot-time-series-as-line-graphs","chapter":"20 Climate indicators explained","heading":"20.8.8 Plot time series as line graphs","text":"also plot time series series maps, need average 5 year time periods first. can get later.plot time series first need spatial aggregation. One option spatially aggregate stars object directly, using reg data set:However, preserve region name, subsequent st_intersection taks little gives boundary problems.can also convert pixels points intersection.also took long.can perhaps aggregate, turn points intersect, work perfect either.can rasterize regions data set, turn coded dimension use st_apply, tedious.Let try using exact_extract, alternative aggregate. requires us turn terra package bit.user; system; elapsed: 7.603; 3.071; 10.697That fast!also get sd:user; system; elapsed: 7.420; 2.921; 10.355Reshape plot\nFigure 20.9: Times series median summer temperature centered median value reference period. reference period indicated thick horizontal line. Dottet horisontal lines 2 sd units reference period.\ncan take mean last 5 years add spatial representation.\nFigure 20.10: Scaled indicator values, aggregated 5 year intervals. Errors represent spatial variation within regions across years.\nFinally, can add values sp object.\nFigure 20.11: Summer tempreature indicator values five accounting areas Norway. SD spatial variation.\n","code":"\ntemp <- y_var_norm[1,,] %>%\n  aggregate(reg, mean, na.rm=T)\nplot(temp)\ntemp2 <- temp %>%\n  st_as_sf() # too slowtemp_points <- y_var_norm[1,,] %>%\n  st_as_sf(as_points = TRUE, merge = FALSE)\ntemp_points2 <- temp_points %>%\n  st_intersection(reg) \" too slow\"\nsystem.time(\nregional_means <- rast(y_var_norm) %>%\n  exact_extract(reg, fun = 'mean', append_cols = \"region\", progress=T) %>%\n  setNames(c(\"region\", names(y_var_norm)))\n  )\nsystem.time(\nregional_sd <- rast(y_var_norm) %>%\n  exact_extract(reg, fun = 'stdev', append_cols = \"region\", progress=T) %>%\n  setNames(c(\"region\", names(y_var_norm)))\n  )\nsaveRDS(regional_means, \"temp/regional_means.rds\")\nsaveRDS(regional_sd, \"temp/regional_sd.rds\")\ndiv <- c(\"reference_upper\",\n         \"reference_low\",\n         \"reference_low2\",\n         \"threshold_low\",\n         \"threshold_high\",\n         \"sd\")\n\ntemp <- regional_means %>%\n  as.data.frame() %>%\n  select(region, div)\n  \nregional_means_long <- regional_means %>%\n  as.data.frame() %>%\n  select(!all_of(div)) %>%\n  pivot_longer(!region) %>%\n  separate(name, into=c(\"type\", \"year\")) %>%\n  pivot_wider(#id_cols = region,\n              names_from = type)  %>%\n  left_join(temp, by=join_by(region)) %>% \n  mutate(diff = v-reference_upper) %>%\n  mutate(threshold_low_centered = threshold_low-reference_upper) %>%\n  mutate(threshold_high_centered = threshold_high-reference_upper)\n\n#Adding the spatial sd\n(\nregional_means_long <- regional_sd %>%\n  select(!all_of(div)) %>%\n  pivot_longer(!region) %>%\n  separate(name, into=c(\"type\", \"year\")) %>%\n  pivot_wider(names_from = type) %>%\n  rename(i_sd = i,\n         v_sd = v) %>%\n  left_join(regional_means_long, by=join_by(region, year))\n)\n#> # A tibble: 330 × 15\n#>    region     year   i_sd  v_sd     i     v refere…¹ refer…²\n#>    <chr>      <chr> <dbl> <dbl> <dbl> <dbl>    <dbl>   <dbl>\n#>  1 Nord-Norge 2022  0.246  1.90 0.523  11.5     10.2    4.21\n#>  2 Nord-Norge 2021  0.255  1.65 0.672  10.8     10.2    4.21\n#>  3 Nord-Norge 2020  0.143  1.82 0.784  10.3     10.2    4.21\n#>  4 Nord-Norge 2019  0.290  1.77 0.623  10.8     10.2    4.21\n#>  5 Nord-Norge 2018  0.344  1.64 0.523  12.5     10.2    4.21\n#>  6 Nord-Norge 2017  0.145  1.79 0.794  10.1     10.2    4.21\n#>  7 Nord-Norge 2016  0.175  1.74 0.705  10.8     10.2    4.21\n#>  8 Nord-Norge 2015  0.198  1.61 0.682  10.6     10.2    4.21\n#>  9 Nord-Norge 2014  0.297  1.65 0.545  13.1     10.2    4.21\n#> 10 Nord-Norge 2013  0.202  1.65 0.479  11.4     10.2    4.21\n#> # … with 320 more rows, 7 more variables:\n#> #   reference_low2 <dbl>, threshold_low <dbl>,\n#> #   threshold_high <dbl>, sd <dbl>, diff <dbl>,\n#> #   threshold_low_centered <dbl>,\n#> #   threshold_high_centered <dbl>, and abbreviated variable\n#> #   names ¹​reference_upper, ²​reference_low\nregOrder = c(\"Østlandet\",\"Sørlandet\",\"Vestlandet\",\"Midt-Norge\",\"Nord-Norge\")\n\nregional_means_long %>%\n  mutate(col = if_else(diff>0, \"1\", \"2\")) %>%\n  ggplot(aes(x = as.numeric(year), \n           y = diff, fill = col))+\n  geom_bar(stat=\"identity\")+\n  geom_hline(aes(yintercept = threshold_low_centered),\n        linetype=2)+\n  geom_hline(aes(yintercept = threshold_high_centered),\n        linetype=2)+\n  geom_segment(x = 1961, xend=1990,\n               y = 0, yend = 0,\n               linewidth=2)+\n  scale_fill_hue(l=70, c=60)+\n  theme_bw(base_size = 12)+\n  ylab(\"Sommertempratur\\navvik fra 1961-1990\")+\n  xlab(\"\")+\n  guides(fill=\"none\")+\n  facet_wrap( .~ factor(region, levels = regOrder),\n              ncol=3,\n              scales = \"free_y\")\n(\ni_aggregatedToPeriods <- regional_means_long %>%\n  mutate(year = as.numeric(year)) %>%\n  mutate(period = case_when(\n    year %between% c(2018, 2022) ~ \"2018-2022\",\n    year %between% c(2013, 2017) ~ \"2013-2017\",\n    year %between% c(2008, 2012) ~ \"2008-2012\",\n    year %between% c(2003, 2007) ~ \"2003-2007\",\n    .default = \"pre 2003\"\n  )) %>%\n  mutate(period_rank = case_when(\n   period == \"2018-2022\" ~ 5,\n   period == \"2013-2017\" ~ 4,\n   period == \"2008-2012\" ~ 3,\n   period == \"2003-2007\" ~ 2,\n    .default = 1\n  )) %>%\n  group_by(region, period, period_rank) %>%\n  summarise(indicator = mean(i),\n            spatial_sd = sqrt(sum(i_sd^2))/length(i_sd)\n            #,\n            #spatial_sd_mean = mean(i_sd),\n            #spatial_sd2_max = max(i_sd),\n            #spatial_sd2_length = length(i_sd)\n            )\n)\n#> `summarise()` has grouped output by 'region', 'period'. You\n#> can override using the `.groups` argument.\n#> # A tibble: 25 × 5\n#> # Groups:   region, period [25]\n#>    region     period    period_rank indicator spatial_sd\n#>    <chr>      <chr>           <dbl>     <dbl>      <dbl>\n#>  1 Midt-Norge 2003-2007           2     0.427     0.101 \n#>  2 Midt-Norge 2008-2012           3     0.573     0.143 \n#>  3 Midt-Norge 2013-2017           4     0.536     0.0986\n#>  4 Midt-Norge 2018-2022           5     0.607     0.130 \n#>  5 Midt-Norge pre 2003            1     0.642     0.0277\n#>  6 Nord-Norge 2003-2007           2     0.460     0.122 \n#>  7 Nord-Norge 2008-2012           3     0.675     0.109 \n#>  8 Nord-Norge 2013-2017           4     0.641     0.0937\n#>  9 Nord-Norge 2018-2022           5     0.625     0.118 \n#> 10 Nord-Norge pre 2003            1     0.625     0.0266\n#> # … with 15 more rows\nlabs <- unique(i_aggregatedToPeriods$period[order(i_aggregatedToPeriods$period_rank)])\n\ni_aggregatedToPeriods %>%\n  ggplot(aes(x = period_rank, \n             y = indicator,\n             colour=region))+\n  geom_line() +\n  geom_point() +\n  geom_errorbar(aes(ymin=indicator-spatial_sd, \n                    ymax=indicator+spatial_sd), \n                    width=.2,\n                 position=position_dodge(0.2)) +\n  theme_bw(base_size = 12)+\n  scale_x_continuous(breaks = 1:5,\n                     labels = labs)+\n  labs(x = \"\", y = \"indikatorverdi\")\nreg2 <- reg %>%\n  left_join(i_aggregatedToPeriods[i_aggregatedToPeriods$period_rank==5,], by=join_by(region))\nnames(reg2)\n#> [1] \"id\"          \"region\"      \"GID_0\"       \"NAME_0\"     \n#> [5] \"period\"      \"period_rank\" \"indicator\"   \"spatial_sd\" \n#> [9] \"geometry\"\nmyCol <- \"RdYlGn\"\nmyCol2 <- \"-RdYlGn\"\n\ntm_main <- tm_shape(reg2)+\n  tm_polygons(col=\"indicator\",\n              title=\"Indikator:\\nsommertemperatur\",\n    palette = myCol,\n    style=\"fixed\",\n    breaks = seq(0,1,.2)) \n  \ntm_inset <- tm_shape(reg2)+\n  tm_polygons(col=\"spatial_sd\",\n              title=\"SD\",\n              palette = myCol2,\n              style=\"cont\")+\n  tm_layout(legend.format = list(digits=2))\n\ntmap_arrange(tm_main, \n             tm_inset)"}]
