<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 3 Anthropogenic disturbance to soils and vegetation (ADSV) | Indicators for Ecosystem Condition in Norway</title>
<meta name="author" content="Anders L. Kolstad">
<meta name="description" content="Author and date: Anders L. Kolstad September 2023 Norwegian indicator name: Slitasje Ecosystem Økologisk.egenskap ECT.class Våtmark, Naturlig åpne områder under skoggrensa, Semi-naturlig mark...">
<meta name="generator" content="bookdown 0.33 with bs4_book()">
<meta property="og:title" content="Chapter 3 Anthropogenic disturbance to soils and vegetation (ADSV) | Indicators for Ecosystem Condition in Norway">
<meta property="og:type" content="book">
<meta property="og:url" content="https://ninanor.github.io/ecosystemCondition/index.html/slitasje.html">
<meta property="og:image" content="https://ninanor.github.io/ecosystemCondition/index.html/images/Picture1.png">
<meta property="og:description" content="Author and date: Anders L. Kolstad September 2023 Norwegian indicator name: Slitasje Ecosystem Økologisk.egenskap ECT.class Våtmark, Naturlig åpne områder under skoggrensa, Semi-naturlig mark...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 3 Anthropogenic disturbance to soils and vegetation (ADSV) | Indicators for Ecosystem Condition in Norway">
<meta name="twitter:description" content="Author and date: Anders L. Kolstad September 2023 Norwegian indicator name: Slitasje Ecosystem Økologisk.egenskap ECT.class Våtmark, Naturlig åpne områder under skoggrensa, Semi-naturlig mark...">
<meta name="twitter:image" content="https://ninanor.github.io/ecosystemCondition/index.html/images/Picture1.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.6.1/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.27/datatables.js"></script><link href="libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Indicators for Ecosystem Condition in Norway</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">About </a></li>
<li class="book-part">INDICATORS</li>
<li><a class="" href="gjengroing.html"><span class="header-section-number">1</span> Enchroachment</a></li>
<li><a class="" href="nature-index-product.html"><span class="header-section-number">2</span> Nature index product</a></li>
<li><a class="active" href="slitasje.html"><span class="header-section-number">3</span> Anthropogenic disturbance to soils and vegetation (ADSV)</a></li>
<li><a class="" href="median-summer-temp.html"><span class="header-section-number">4</span> Median Summer Temperature</a></li>
<li><a class="" href="alien-species.html"><span class="header-section-number">5</span> Alien species</a></li>
<li><a class="" href="Functional-plant-indicators-wetland.html"><span class="header-section-number">6</span> Functional Plant Indicators - Wetlands</a></li>
<li><a class="" href="functional-plant-indicators-seminat.html"><span class="header-section-number">7</span> Functional Plant Indicators - Semi-Natural Ecosystems</a></li>
<li><a class="" href="functional-plant-indicators-open.html"><span class="header-section-number">8</span> Functional Plant Indicators - Naturally Open Ecosystems</a></li>
<li><a class="" href="trophic-level-biomass-ratios.html"><span class="header-section-number">9</span> Trophic level biomass ratios</a></li>
<li><a class="" href="insect-indicators.html"><span class="header-section-number">10</span> Insect indicators</a></li>
<li class="book-part">R &amp; D</li>
<li><a class="" href="NDVI-indicator-natopen.html"><span class="header-section-number">11</span> NDVI - Naturally Open Ecosystems</a></li>
<li><a class="" href="NDVI-indicator-seminat.html"><span class="header-section-number">12</span> NDVI - Semi-natural Ecosystems</a></li>
<li><a class="" href="NDVI-indicator-wetland.html"><span class="header-section-number">13</span> NDVI - wetland ecosystems</a></li>
<li class="book-part">INDICATORS FROM THE ALPINE ASSESSMENT</li>
<li><a class="" href="areal-av-isbreer.html"><span class="header-section-number">14</span> Areal av isbreer</a></li>
<li class="book-part">DEPRECATED</li>
<li><a class="" href="areal-uten-d%C3%B8d-eller-skadet-r%C3%B8sslyng-i-kystlynghei.html"><span class="header-section-number">15</span> Areal uten død eller skadet røsslyng i kystlynghei</a></li>
<li class="book-part">GENERAL TOPICS</li>
<li><a class="" href="naturtype.html"><span class="header-section-number">16</span> Nature types</a></li>
<li><a class="" href="scaling-functions.html"><span class="header-section-number">17</span> Scaling functions</a></li>
<li><a class="" href="homogeneous-impact-areas.html"><span class="header-section-number">18</span> Homogeneous Impact Areas</a></li>
<li><a class="" href="master-grid.html"><span class="header-section-number">19</span> Master grid</a></li>
<li><a class="" href="climate-indicators-explained.html"><span class="header-section-number">20</span> Climate indicators explained</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/NINAnor/ecosystemCondition">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="slitasje" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Anthropogenic disturbance to soils and vegetation (ADSV)<a class="anchor" aria-label="anchor" href="#slitasje"><i class="fas fa-link"></i></a>
</h1>
<p><em>Author and date:</em></p>
<p>Anders L. Kolstad</p>
<p>September 2023</p>
<p>Norwegian indicator name: Slitasje</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="48%">
<col width="29%">
<col width="22%">
</colgroup>
<thead><tr class="header">
<th align="left">Ecosystem</th>
<th align="left">Økologisk.egenskap</th>
<th align="left">ECT.class</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">Våtmark, Naturlig åpne områder under skoggrensa, Semi-naturlig mark</td>
<td align="left">Primærproduksjon (evt. Abiotiske fohold)</td>
<td align="left">Physical state characteristics</td>
</tr></tbody>
</table></div>
<hr>
<div id="introduction-1" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction-1"><i class="fas fa-link"></i></a>
</h2>
<p>This indicator represent human caused damage or <strong>disturbance to soils and vegetation</strong>, typically from things like recreational activities and off-road vehicle traffic. The data come from a combination non-random field surveys and area-representative surveys. Disturbance to soils and vegetation is recorded in the various data sets are NiN variables 7SE and 7TK, or as the similar, but more fine-scaled variable, PRSL and PRTK. Effects from domestic animals are not included in the definition of these variables, and the upper reference value is therefore set to 0% disturbance.</p>
<p>The indicator is calculated separately for the three ecosystems, but all nature types associated with the same ecosystem are pooled and treated equally. This means we assume the nature types that are mapped and which we have data from are, when pooled, representative for the main ecosystem. This is less true for Naturally open ecosystems than it is for the other two. You can read more about that <a href="naturtype.html#naturtype">here</a>.</p>
<p>Since the data is not sampled in a systematic or random way, we must take extra care not to over-extrapolate in space. We delineate <em>homogeneous impact areas</em> (HIA) based on four classes of increasing infrastructure, and we say that the field data is representative inside the HIA and region (<em>five regions in Norway</em>) where it was recorded. We then calculate an area weighted mean (and error) indicator value for each HIA and region combination, as long as there is more than 150 data points for a give combination of HIA and region.</p>
<p>Here is a general workflow for the calculation of the indicator.</p>
<ol style="list-style-type: decimal">
<li><p>Import <a href="slitasje.html#NTM">Nature type data</a> data set and <a href="slitasje.html#ANO-import">ANO data
set</a></p></li>
<li><p>Identify the <a href="naturtype.html#naturtype">relevant</a> nature types and <a href="slitasje.html#NTM">subset</a>
the data</p></li>
<li><p>Convert <a href="slitasje.html#ANO-points-to-poly">ANO points to polygons</a></p></li>
<li><p>For each polygon, extract the variable that has the lowest value
(one-out all-out principle), e.g. Fig. <a href="slitasje.html#fig:slitasje-naturetype">3.8</a>. The four variables are 7TK, 7SE (both NiN2-variables) and PRTK and PRSL (both defined by the Norwegain Environmental Agency)</p></li>
<li><p><a href="slitasje.html#combine-nt-ano">Combine</a> data sets (nature types and ANO) but keep ecosystems separate.</p></li>
<li><p><a href="slitasje.html#scale-slitasje-ind">Scale</a> the <code>slitasje</code> variable based on
reference values.</p></li>
<li><p>Define <a href="slitasje.html#HIA-slitasje">homogeneous impact areas</a> (HIA)</p></li>
<li><p><a href="slitasje.html#spread-slitasje">Aggregate and spread</a> indicator value across HIAs
and assessment regions</p></li>
<li><p>Confirm relationship between infrastructure index and indicator
values to <a href="slitasje.html#validate-slitasje">justify the extrapolation</a></p></li>
<li><p>TO DO: Prepare ecosystem delineation maps and us ethese to mask the extrapolated indicator maps</p></li>
<li><p>Spatial aggregation of indicator values and uncertainties to accounting areas</p></li>
<li><p>Export indicator maps and regional extrapolated maps</p></li>
</ol>
<p>Note that besides the wetland map, we do not have ecosystem delineation maps to complete step 10 in the workflow.</p>
<div class="inline-table"><table style="width:100%;" class="table table-sm">
<caption>Variables used in this composite ADSV indicator</caption>
<colgroup>
<col width="26%">
<col width="26%">
<col width="26%">
<col width="21%">
</colgroup>
<thead><tr class="header">
<th>Variable</th>
<th>Name</th>
<th>Measurement scale</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>7TK</td>
<td>Spor etter ferdsel med tunge kjøretøy</td>
<td>A4b</td>
<td>Det som skal registreres er andelen (tenkte) småruter á 10 × 10 m (100 m2) innenfor en kartfigur som inneholder kjøretøyspor.</td>
</tr>
<tr class="even">
<td>7SE</td>
<td>Spor etter slitasje og slitasjebetinget erosjon</td>
<td>A4b</td>
<td>Det som skal registreres er antall (tenkte) småruter á 2 × 2 m (4 m2) som inneholder spor etter slitasje og slitasjebetinget erosjon (slitasjespor).</td>
</tr>
<tr class="odd">
<td>PRTK</td>
<td>Kjørespor</td>
<td>A8</td>
<td>Same as 7TK, but with a finer measurement scale</td>
</tr>
<tr class="even">
<td>PRSL</td>
<td>Slitasje</td>
<td>A8</td>
<td>Same as 7SE, but with a finer measurement scale</td>
</tr>
</tbody>
</table></div>
</div>
<div id="about-the-underlying-data-1" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> About the underlying data<a class="anchor" aria-label="anchor" href="#about-the-underlying-data-1"><i class="fas fa-link"></i></a>
</h2>
<p>The indicator uses a data set from a standardised field survey of nature
types. You can read more about the preliminary analyses
<a href="naturtype.html#naturtype">here</a>. See also the <a href="https://www.miljodirektoratet.no/ansvarsomrader/overvaking-arealplanlegging/naturkartlegging/naturtyper/">official
site</a>
of the Environment Agency. I also import a data set called
<a href="slitasje.html#ANO-import">ANO</a>, which you can read about
<a href="https://www.miljodirektoratet.no/ansvarsomrader/overvaking-arealplanlegging/miljoovervaking/overvakingsprogrammer/natur-pa-land/arealrepresentativ-naturovervakning-ano/">here</a></p>
<div id="representativity-in-time-and-space-1" class="section level3" number="3.2.1">
<h3>
<span class="header-section-number">3.2.1</span> Representativity in time and space<a class="anchor" aria-label="anchor" href="#representativity-in-time-and-space-1"><i class="fas fa-link"></i></a>
</h3>
<p>The nature type mapping is not random and cannot be said to be area
representative. The ANO data set however, is area representative. The
data is from 2018 to present. The data from one field season usually
becomes available early the following year.</p>
</div>
<div id="original-units-1" class="section level3" number="3.2.2">
<h3>
<span class="header-section-number">3.2.2</span> Original units<a class="anchor" aria-label="anchor" href="#original-units-1"><i class="fas fa-link"></i></a>
</h3>
<p>The variables are recorded on a coarse four-step ordinal scale (Fig.
<a href="slitasje.html#fig:four-step">3.4</a>) or eigth-step scale.</p>
</div>
<div id="temoporal-sli" class="section level3" number="3.2.3">
<h3>
<span class="header-section-number">3.2.3</span> Temporal coverage<a class="anchor" aria-label="anchor" href="#temoporal-sli"><i class="fas fa-link"></i></a>
</h3>
<p>The data goes back to 2018. I therefore <a href="https://github.com/NINAnor/ecosystemCondition/issues/101#issuecomment-1719170208">bulk all the data from 2018 to 2022</a> into one time step. I then use the mean date for the raw data,
and define the variable as belonging to the year 2020 (read more
<a href="slitasje.html#scaled-slitasje-variable">here</a>).</p>
<p>Regarding update frequency, the Nature type data set is not replicated, nor will it be in the future. We must therefore trust that the selection criteria for which areas to survey will not change drastically and systematically over time. For example, we are now surveying a lot in pressure areas, meaning lowland areas close to human population centers. If we in the future allocate more time to surveying wilderness areas, then the indicator becomes biased. On the other hand, ANO is replicated every 5 years.</p>
</div>
<div id="aditional-comments-about-the-dataset-1" class="section level3" number="3.2.4">
<h3>
<span class="header-section-number">3.2.4</span> Aditional comments about the dataset<a class="anchor" aria-label="anchor" href="#aditional-comments-about-the-dataset-1"><i class="fas fa-link"></i></a>
</h3>
<p>For a run through of the nature type data set, see <a href="naturtype.html#naturtype">here</a>.</p>
</div>
</div>
<div id="ecosystem-characteristic-2" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Ecosystem characteristic<a class="anchor" aria-label="anchor" href="#ecosystem-characteristic-2"><i class="fas fa-link"></i></a>
</h2>
<div id="norwegain-standard-1" class="section level3" number="3.3.1">
<h3>
<span class="header-section-number">3.3.1</span> Norwegain standard<a class="anchor" aria-label="anchor" href="#norwegain-standard-1"><i class="fas fa-link"></i></a>
</h3>
<p>The indicator is tagged to the <em>Økologisk egenskap</em> called
<strong>Primærproduksjon</strong> (Primary productivity). This is <a href="https://github.com/NINAnor/ecosystemCondition/issues/96">somewhat tentative</a>, and
perhaps <em>abiotiske forhold</em> is more suited. But the thought behind the
choice is that <em>ADSV</em> affect the potential for primary productivity.</p>
</div>
<div id="un-standard" class="section level3" number="3.3.2">
<h3>
<span class="header-section-number">3.3.2</span> UN standard<a class="anchor" aria-label="anchor" href="#un-standard"><i class="fas fa-link"></i></a>
</h3>
<p>The indicator is tagged as a <strong>Physical state characteristics</strong>
indicator. This is quite clear. It’s a type of abiotic characteristic that
has to do with the physical structure rather than the chemical
composition.</p>
</div>
</div>
<div id="collinearities-with-other-indicators-2" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> Collinearities with other indicators<a class="anchor" aria-label="anchor" href="#collinearities-with-other-indicators-2"><i class="fas fa-link"></i></a>
</h2>
<p><em>ADSV</em> is not thought to exhibit collinearity with any other indicator at
the present.</p>
</div>
<div id="reference-condition-and-values-1" class="section level2" number="3.5">
<h2>
<span class="header-section-number">3.5</span> Reference condition and values<a class="anchor" aria-label="anchor" href="#reference-condition-and-values-1"><i class="fas fa-link"></i></a>
</h2>
<div id="reference-condition-1" class="section level3" number="3.5.1">
<h3>
<span class="header-section-number">3.5.1</span> Reference condition<a class="anchor" aria-label="anchor" href="#reference-condition-1"><i class="fas fa-link"></i></a>
</h3>
<p>The reference condition is one with minimal negative human impact. This
is also true for semi-natural ecosystems. For example, in the reference
condition, <em>ADSV</em> in semi-natural ecosystems is defined to be zero,
even though at no point in time would this condition be realized.</p>
</div>
<div id="reference-values-thresholds-for-defining-good-ecological-condition-minimum-andor-maximum-values-1" class="section level3" number="3.5.2">
<h3>
<span class="header-section-number">3.5.2</span> Reference values, thresholds for defining <em>good ecological condition</em>, minimum and/or maximum values<a class="anchor" aria-label="anchor" href="#reference-values-thresholds-for-defining-good-ecological-condition-minimum-andor-maximum-values-1"><i class="fas fa-link"></i></a>
</h3>
<p>For a further discussion on this topic, see <a href="https://github.com/NINAnor/ecosystemCondition/issues/88">GitHub issue 88</a>.</p>
<ul>
<li><p>Upper = 0%</p></li>
<li><p>Threshold = 10%</p></li>
<li><p>Lower = 100%</p></li>
</ul>
<p>The upper reference value is 0% (no <em>damage</em>), and the lower reference
value is 100%. Note that 100% <em>damage</em> does not mean that all the area
must be scarred or damaged, but that all hypothetical quadrats around a
point is affected (the variable is frequency-driven, and not
amount-driven).</p>
<p>The threshold for good ecosystem condition is set to 10%
damage. This is an expert judgement, and a rather weak one at that.
In the future we should try to empirically validate the dose-response relationship,
for example by comparing different variable scores with erosion rates or the potential for plant growth.
This would need to be done specifically for each nature type.</p>
<p>The indicator value could be interpreted differently at the polygon
<em>vs</em> landscape scale. At the polygon scale, 10% damage may seem
like not that much, whilst at the landscape scale, 10% seems more serious.</p>
<p>Read about the normalisation <a href="slitasje.html#scaled-slitasje-variable">here</a>.</p>
</div>
</div>
<div id="uncertainties-1" class="section level2" number="3.6">
<h2>
<span class="header-section-number">3.6</span> Uncertainties<a class="anchor" aria-label="anchor" href="#uncertainties-1"><i class="fas fa-link"></i></a>
</h2>
<p>Uncertainties/errors are estimated for aggregated indicator values by
bootstrapping individual indicator values 1000 times and calculating a
distribution of area weighted means. See the documentation for <code><a href="https://ninanor.github.io/eaTools/reference/ea_spread.html">eaTools::ea_spread</a></code> <a href="https://ninanor.github.io/eaTools/reference/ea_spread.html">here</a>.
This uncertainty is different from
the spatial variation which we could get more straight forward without
bootstrapping. When aggregating a second time,
from homogeneous impact areas to accounting areas, we assume a normal
distribution around the indicator values, with the already mentioned
errors, and sample <em>n</em> times from these and combine the resamples into an
a new, area weighted, distribution. The errors for the accounting areas
thus represents both the spatial variation, and the precision, of the
indicator values within the accounting areas.</p>
</div>
<div id="references-2" class="section level2" number="3.7">
<h2>
<span class="header-section-number">3.7</span> References<a class="anchor" aria-label="anchor" href="#references-2"><i class="fas fa-link"></i></a>
</h2>
<p>Halvorsen, R. &amp; Bratli, H. 2019. Dokumentasjon av NiN versjon 2.2 tilrettelagt for praktisk naturkartlegging: utvalgte variabler fra beskrivelsessystemet. – Natur i Norge, Artikkel 11 (versjon 2.2.0): 1–218 (Artsdatabanken, Trondheim; <a href="http://www.artsdatabanken.no" class="uri">http://www.artsdatabanken.no</a>.)</p>
<p>Miljødirektoratet 2022. Kartleggingsinstruks - kartlegging av terrestriske Naturtyper etter NiN2. URL: <a href="https://www.miljodirektoratet.no/publikasjoner/2022/januar/kartleggingsinstruks-kartlegging-av-terrestriske-naturtyper-etter-nin/" class="uri">https://www.miljodirektoratet.no/publikasjoner/2022/januar/kartleggingsinstruks-kartlegging-av-terrestriske-naturtyper-etter-nin/</a></p>
<p>Miljødirektoratet 2023. Arealrepresnetativ Naturovervåking. Webpage. URL: <a href="https://www.miljodirektoratet.no/ansvarsomrader/overvaking-arealplanlegging/miljoovervaking/overvakingsprogrammer/natur-pa-land/arealrepresentativ-naturovervakning-ano/" class="uri">https://www.miljodirektoratet.no/ansvarsomrader/overvaking-arealplanlegging/miljoovervaking/overvakingsprogrammer/natur-pa-land/arealrepresentativ-naturovervakning-ano/</a></p>
</div>
<div id="analyses-1" class="section level2" number="3.8">
<h2>
<span class="header-section-number">3.8</span> Analyses<a class="anchor" aria-label="anchor" href="#analyses-1"><i class="fas fa-link"></i></a>
</h2>
<div id="data-sets-1" class="section level3" number="3.8.1">
<h3>
<span class="header-section-number">3.8.1</span> Data sets<a class="anchor" aria-label="anchor" href="#data-sets-1"><i class="fas fa-link"></i></a>
</h3>
<div id="NTM" class="section level4" number="3.8.1.1">
<h4>
<span class="header-section-number">3.8.1.1</span> Nature type mapping<a class="anchor" aria-label="anchor" href="#NTM"><i class="fas fa-link"></i></a>
</h4>
<p>This indicator uses the data set
<code>Naturtyper etter Miljødirektoratets Instruks</code>, which can be found
<a href="https://kartkatalog.geonorge.no/metadata/naturtyper-miljoedirektoratets-instruks/eb48dd19-03da-41e1-afd9-7ebc3079265c">here</a>.
See also <a href="naturtype.html#naturtype">here</a> for a detailed description of the data set.</p>
<p>We also have a separate <a href="naturtype.html#exp-natureType-summary">summary file</a> where
the nature types are manually mapped to the correct NiN-main typesand to the NiN variables that are recorded in each nature type. We can use this to find the nature types associated with the NiN main types
that we are interested in.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">naturetypes_summary_import</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"data/naturetypes/natureType_summary.rds"</span><span class="op">)</span></span></code></pre></div>
<p>We are only interested in a mapping units that include our target variables.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myVars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'7TK'</span>, <span class="st">'7SE'</span>, <span class="st">'PRTK'</span>, <span class="st">'PRSL'</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">naturetypes_summary</span> <span class="op">&lt;-</span> <span class="va">naturetypes_summary_import</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>keepers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu">c_across</span><span class="op">(</span></span>
<span>    <span class="fu">all_of</span><span class="op">(</span><span class="va">myVars</span><span class="op">)</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">keepers</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">Nature_type</span>, <span class="va">NiN_mainType</span>, <span class="va">Year</span><span class="op">)</span></span></code></pre></div>
<p>This deleted 17 nature types and left us with these:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="va">naturetypes_summary</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-6d19ef792977ccd60115" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-6d19ef792977ccd60115">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37"],["Slåttemyr","Eng-aktig sterkt endret fastmark","Sørlig kaldkilde","Åpen flomfastmark","Høgereligende og nordlig nedbørsmyr","Øyblandingsmyr","Strandeng","Nakent tørkeutsatt kalkberg","Kystlynghei","Sørlig slåttemyr","Konsentrisk høymyr","Boreal hei","Sanddynemark","Semi-naturlig strandeng","Rik åpen jordvannsmyr i mellomboreal sone","Sørlig nedbørsmyr","Atlantisk høymyr","Terrengdekkende myr","Åpen grunnlendt kalkrik mark i boreonemoral sone","Rik åpen sørlig jordvannsmyr","Aktiv skredmark","Semi-naturlig myr","Silt og leirskred","Eksentrisk høymyr","Øvre sandstrand uten pionervegetasjon","Kalkrik helofyttsump","Fuglefjell-eng og fugletopp","Isinnfrysingsmark","Åpen grunnlendt kalkrik mark i sørboreal sone","Sørlig etablert sanddynemark","Rik åpen jordvannsmyr i nordboreal og lavalpin sone","Fossepåvirket berg","Fosse-eng","Svært tørkeutsatt sørlig kalkberg","Kanthøymyr","Platåhøymyr","Palsmyr"],["V9","T41","V4","T18","V3","V1","T12","T1","T34","V9","V3","T31","T21","T33","V1","V3","V3","V3","T2","V1","T17","V9","T17","V3","T29","L4","T8","T20","T2","T21","V1","T1","T15","T1","V3","V3","V3"],["2018, 2019, 2020, 2021, 2022","2018, 2019, 2020, 2021, 2022","2018, 2019, 2020, 2021, 2022","2018, 2019, 2020, 2021, 2022","2019, 2020, 2021, 2022","2019, 2020, 2021, 2022","2018, 2019, 2020, 2021, 2022","2019, 2020, 2021, 2022","2018, 2019, 2020, 2021, 2022","2019, 2020, 2021, 2022","2019, 2020, 2022","2018, 2019, 2020, 2021, 2022","2018, 2019, 2020, 2021, 2022","2018, 2019, 2020, 2021, 2022","2019, 2020, 2021, 2022","2019, 2020, 2021, 2022","2019, 2020, 2021, 2022","2019, 2020, 2021, 2022","2018, 2019, 2020, 2021, 2022","2018, 2019, 2020, 2021, 2022","2019, 2020, 2021, 2022","2019, 2020, 2021, 2022","2019, 2020, 2021, 2022","2019, 2020, 2021, 2022","2019, 2020, 2021, 2022","2019, 2020, 2021, 2022","2019, 2020, 2021, 2022","2018, 2019, 2020, 2021, 2022","2019, 2020, 2021","2018, 2019, 2020, 2021, 2022","2019, 2020, 2021, 2022","2019, 2020, 2021, 2022","2019, 2020, 2022","2019, 2020, 2021, 2022","2019, 2020, 2021, 2022","2019, 2020, 2021, 2022","2021, 2022"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Nature_type<\/th>\n      <th>NiN_mainType<\/th>\n      <th>Year<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p>Importing and sub-setting the main data file, fix duplicate <em>hovedøkosystem</em>, calculate area, split one column in two, make numeric, and select target variables:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">naturetypes</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span>dsn <span class="op">=</span> <span class="va">path</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">naturtype</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">naturetypes_summary</span><span class="op">$</span><span class="va">Nature_type</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>hovedøkosystem <span class="op">=</span> <span class="fu">recode</span><span class="op">(</span><span class="va">hovedøkosystem</span>,</span>
<span>                                 <span class="st">"naturligÅpneOmråderUnderSkoggrensa"</span> <span class="op">=</span> <span class="st">"naturligÅpneOmråderILavlandet"</span><span class="op">)</span>,</span>
<span>         area <span class="op">=</span> <span class="fu">st_area</span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">separate_rows</span><span class="op">(</span><span class="va">ninBeskrivelsesvariable</span>, sep<span class="op">=</span><span class="st">","</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">separate</span><span class="op">(</span>col <span class="op">=</span> <span class="va">ninBeskrivelsesvariable</span>,</span>
<span>           into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NiN_variable_code"</span>, <span class="st">"NiN_variable_value"</span><span class="op">)</span>,</span>
<span>           sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>           remove<span class="op">=</span><span class="cn">F</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>NiN_variable_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">NiN_variable_value</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">NiN_variable_code</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">myVars</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reading layer `Naturtyper_nin_0000_norge' from data source </span></span>
<span><span class="co">#&gt;   `/data/R/GeoSpatialData/Habitats_biotopes/Norway_Miljodirektoratet_Naturtyper_nin/Original/Naturtyper_nin_0000_norge_25833_FILEGDB/Naturtyper_nin_0000_norge_25833_FILEGDB.gdb' </span></span>
<span><span class="co">#&gt;   using driver `OpenFileGDB'</span></span>
<span><span class="co">#&gt; Simple feature collection with 117427 features and 36 fields</span></span>
<span><span class="co">#&gt; Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -74953.52 ymin: 6448986 xmax: 1075081 ymax: 7921284</span></span>
<span><span class="co">#&gt; Projected CRS: ETRS89 / UTM zone 33N</span></span>
<span><span class="co">#&gt; Warning: There was 1 warning in `stopifnot()`.</span></span>
<span><span class="co">#&gt; ℹ In argument: `NiN_variable_value =</span></span>
<span><span class="co">#&gt;   as.numeric(NiN_variable_value)`.</span></span>
<span><span class="co">#&gt; Caused by warning:</span></span>
<span><span class="co">#&gt; ! NAs introduced by coercion</span></span></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">naturetypes</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">naturtype</span>, fill <span class="op">=</span> <span class="va">hovedøkosystem</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>        legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>        legend.direction <span class="op">=</span> <span class="st">"vertical"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="co">#guides(fill = "none")+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">""</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Number of localities"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-8"></span>
<img src="slitasje_files/figure-html/unnamed-chunk-8-1.png" alt="An overview of the naturetypes for which we will calculate the indicator. Colours refer to the main ecosystem affiliation." width="672"><p class="caption">
Figure 3.1: An overview of the naturetypes for which we will calculate the indicator. Colours refer to the main ecosystem affiliation.
</p>
</div>
<p>Column names starting with a number is problematic, so adding a prefix</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">naturetypes</span><span class="op">$</span><span class="va">NiN_variable_code</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"var_"</span>, <span class="va">naturetypes</span><span class="op">$</span><span class="va">NiN_variable_code</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">naturetypes</span><span class="op">$</span><span class="va">kartleggingsår</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-10"></span>
<img src="slitasje_files/figure-html/unnamed-chunk-10-1.png" alt="Distribution of data points over time." width="672"><p class="caption">
Figure 3.2: Distribution of data points over time.
</p>
</div>
<p>Now I need to create a single row per locality with a new variable which
is a product/function of the four variables “7SE”, “7TK”, “PRTK” and
“PRSL”.</p>
<p>I initially baseed this indicator on whichever of the variables have the highest value (worst condition), but after some thought and discussion I now use an additive approach (adding the variable values togther). I first convert the ordinal scale to a continuous scale, using the median value of each ordinal step.</p>
<p>The variables use slightly different scales. PRSL and PRTK use this 8
step scale:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span><span class="op">(</span><span class="st">"images/ninAR8.PNG"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:eight-step"></span>
<img src="images/ninAR8.PNG" alt="Eight step condition scale" width="367"><p class="caption">
Figure 3.3: Eight step condition scale
</p>
</div>
<p>7TK and 7SE use a 4 step scale</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span><span class="op">(</span><span class="st">"images/ninAR4b.PNG"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:four-step"></span>
<img src="images/ninAR4b.PNG" alt="Four step condition scale" width="554"><p class="caption">
Figure 3.4: Four step condition scale
</p>
</div>
<p>I here transfer these ordinal variables over to a continuous scale. The data is strongly right skewed, so simply taking the center value of each value range will not work.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">naturetypes</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">NiN_variable_value</span><span class="op">)</span>,</span>
<span>                 binwidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">.</span><span class="op">~</span><span class="va">NiN_variable_code</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 20 rows containing non-finite values</span></span>
<span><span class="co">#&gt; (`stat_bin()`).</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:naturetypes-histogram-vars"></span>
<img src="slitasje_files/figure-html/naturetypes-histogram-vars-1.png" alt="Histogram showing the distribution of the four variables used in this indicator." width="672"><p class="caption">
Figure 3.5: Histogram showing the distribution of the four variables used in this indicator.
</p>
</div>
<p>The table below shows that, if I assume there is some ADSV and therefore exlude case with variable value &lt;1, the median value for all the variables is 1. The most common % value for each range category should then be the lower limit of that category. For example, when the category is <code>1/2 - 1</code> then the % value is most likely 50%, and not 75% which is the center value for that value range. One issue is when the variable value is 1, because there the lower limit is the same as when the variable value is 0. Here I think I must manually assign it to something a bit higher than 0.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">naturetypes</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">as.tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">NiN_variable_value</span> <span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">NiN_variable_code</span><span class="op">)</span><span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">NiN_variable_value</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>            median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">NiN_variable_value</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: `as.tibble()` was deprecated in tibble 2.0.0.</span></span>
<span><span class="co">#&gt; ℹ Please use `as_tibble()` instead.</span></span>
<span><span class="co">#&gt; ℹ The signature and semantics have changed, see</span></span>
<span><span class="co">#&gt;   `?as_tibble`.</span></span>
<span><span class="co">#&gt; This warning is displayed once every 8 hours.</span></span>
<span><span class="co">#&gt; Call `lifecycle::last_lifecycle_warnings()` to see where</span></span>
<span><span class="co">#&gt; this warning was generated.</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 3</span></span>
<span><span class="co">#&gt;   NiN_variable_code  mean median</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;             &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 var_7SE            1.18      1</span></span>
<span><span class="co">#&gt; 2 var_7TK            1.14      1</span></span>
<span><span class="co">#&gt; 3 var_PRSL           1.54      1</span></span>
<span><span class="co">#&gt; 4 var_PRTK           1.63      1</span></span></code></pre></div>
<p>You can read more about this issue <a href="https://github.com/NINAnor/ecosystemCondition/issues/100">here</a>.</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">naturetypes</span> <span class="op">&lt;-</span> <span class="va">naturetypes</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>NiN_variable_value <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>    <span class="va">NiN_variable_code</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"var_7TK"</span>, <span class="st">"var_7SE"</span><span class="op">)</span> <span class="op">~</span> </span>
<span>      <span class="fu">case_match</span><span class="op">(</span><span class="va">NiN_variable_value</span>,</span>
<span>             <span class="fl">0</span> <span class="op">~</span> <span class="fl">0</span>,</span>
<span>             <span class="fl">1</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">16</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span>,</span>
<span>             <span class="fl">2</span> <span class="op">~</span> <span class="fl">1</span><span class="op">/</span><span class="fl">16</span><span class="op">*</span><span class="fl">100</span>,</span>
<span>             <span class="fl">3</span> <span class="op">~</span> <span class="fl">50</span><span class="op">)</span>,</span>
<span>    <span class="va">NiN_variable_code</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'var_PRTK'</span>, <span class="st">'var_PRSL'</span><span class="op">)</span> <span class="op">~</span> </span>
<span>      <span class="fu">case_match</span><span class="op">(</span><span class="va">NiN_variable_value</span>,</span>
<span>             <span class="fl">0</span> <span class="op">~</span> <span class="fl">0</span>,</span>
<span>             <span class="fl">1</span> <span class="op">~</span> <span class="fl">1.5</span>,</span>
<span>             <span class="fl">2</span> <span class="op">~</span> <span class="fl">3</span>,</span>
<span>             <span class="fl">3</span> <span class="op">~</span> <span class="fl">6.25</span>,</span>
<span>             <span class="fl">4</span> <span class="op">~</span> <span class="fl">12.5</span>,</span>
<span>             <span class="fl">5</span> <span class="op">~</span> <span class="fl">25</span>,</span>
<span>             <span class="fl">6</span> <span class="op">~</span> <span class="fl">50</span>,</span>
<span>             <span class="fl">7</span> <span class="op">~</span> <span class="fl">75</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>This scaling of the variable implies that it very difficult to measure a location when it
is in its most degraded form (100% disturbed), since the highest % value one can use is 75% for PRSL and PRTK and just 50% for the other two.
This is a problem with the original data resolution.
But I will compensate somewhat for this by
using a non-linear transformation.</p>
<p>I will create a new data table where I calculate the new
variable which I then paste back into the sf object.</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">naturetypes_wide</span> <span class="op">&lt;-</span> <span class="fu">pivot_wider</span><span class="op">(</span><span class="va">naturetypes</span>,</span>
<span>                                names_from <span class="op">=</span> <span class="st">"NiN_variable_code"</span>,</span>
<span>                                values_from <span class="op">=</span> <span class="st">"NiN_variable_value"</span>,</span>
<span>                                id_cols <span class="op">=</span> <span class="st">"identifikasjon_lokalId"</span><span class="op">)</span></span>
<span><span class="va">naturetypes_wide</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">naturetypes_wide</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">naturetypes_wide</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;    identifikasjon_lokalId var_PRSL var_7TK var_7SE var_PRTK</span></span>
<span><span class="co">#&gt; 1         NINFP2210087853      0.0       0      NA       NA</span></span>
<span><span class="co">#&gt; 2         NINFP2210087857      0.0       0      NA       NA</span></span>
<span><span class="co">#&gt; 3         NINFP1910012022       NA      NA   0.000       NA</span></span>
<span><span class="co">#&gt; 4         NINFP1910005432      1.5      NA      NA       NA</span></span>
<span><span class="co">#&gt; 5         NINFP2210089748       NA       0   0.000       NA</span></span>
<span><span class="co">#&gt; 6         NINFP2210096062       NA      NA   0.000      0.0</span></span>
<span><span class="co">#&gt; 7         NINFP1910029434       NA      NA   3.125      1.5</span></span>
<span><span class="co">#&gt; 8         NINFP2010029112       NA       0   0.000       NA</span></span>
<span><span class="co">#&gt; 9         NINFP2010029325       NA       0   0.000       NA</span></span>
<span><span class="co">#&gt; 10        NINFP1910057556       NA      NA   0.000       NA</span></span></code></pre></div>
<p>First I will combine 7TK and PRTK, and also 7SE and PRSL.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">naturetypes_wide</span> <span class="op">&lt;-</span> <span class="va">naturetypes_wide</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>TK <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">var_PRTK</span><span class="op">)</span>, <span class="va">var_7TK</span>, <span class="va">var_PRTK</span><span class="op">)</span>,</span>
<span>    SE <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">var_PRSL</span><span class="op">)</span>, <span class="va">var_7SE</span>, <span class="va">var_PRSL</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p>SE has 10064
NA’s, and TK has
7007.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">naturetypes_wide</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">SE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>sum <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">temp</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">SE</span><span class="op">)</span>,</span>
<span>                 y <span class="op">=</span> <span class="va">sum</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span>,</span>
<span>           fill<span class="op">=</span><span class="st">"grey"</span>,</span>
<span>           colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"7SE or PRSL score"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Number of localities"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-15"></span>
<img src="slitasje_files/figure-html/unnamed-chunk-15-1.png" alt="7SE scores in the naturetype dataset" width="480"><p class="caption">
Figure 3.6: 7SE scores in the naturetype dataset
</p>
</div>
<p>The NA fraction is quite big. These are localities with 7TK or PRTK recorded,
but not 7SE or PRSL.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">naturetypes_wide</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">TK</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>sum <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">temp</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">TK</span><span class="op">)</span>,</span>
<span>                 y <span class="op">=</span> <span class="va">sum</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span>,</span>
<span>           fill<span class="op">=</span><span class="st">"grey"</span>,</span>
<span>           colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"7TK og PRTK score"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Number of localities"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-16"></span>
<img src="slitasje_files/figure-html/unnamed-chunk-16-1.png" alt="7TK scores in the nature type dataset" width="480"><p class="caption">
Figure 3.7: 7TK scores in the nature type dataset
</p>
</div>
<p>Then I can add these two variables together into a composite variable called
<code>slitasje</code></p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">naturetypes_wide</span><span class="op">$</span><span class="va">slitasje</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">naturetypes_wide</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"TK"</span>, <span class="st">"SE"</span><span class="op">)</span><span class="op">]</span>, <span class="fl">1</span>, <span class="va">sum</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p>Chekhing for -Inf</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">naturetypes_wide</span><span class="op">[</span><span class="va">naturetypes_wide</span><span class="op">$</span><span class="va">slitasje</span><span class="op">&lt;</span><span class="fl">0</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span></code></pre></div>
<p>No issues with that.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">naturetypes_wide</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">slitasje</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>sum <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">temp</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">slitasje</span>,</span>
<span>                 y <span class="op">=</span> <span class="va">sum</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span>,</span>
<span>           fill<span class="op">=</span><span class="st">"grey"</span>,</span>
<span>           colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"ADSV score converted to percentage"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Number of localities"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle<span class="op">=</span><span class="fl">90</span>, vjust<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html">label_number</a></span><span class="op">(</span>accuracy <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:slitasje-naturetype"></span>
<img src="slitasje_files/figure-html/slitasje-naturetype-1.png" alt="ADSV scores." width="480"><p class="caption">
Figure 3.8: ADSV scores.
</p>
</div>
<p>It appears most localities are in good condition. Note also that we theoretically can get &gt;100% for the unscaled variable.</p>
<p>I would also like to know, when both TK and SE was recorded,
which one is likely to be in the worst (or best) condition.
I can do this by taking the difference.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">diff</span> <span class="op">&lt;-</span> <span class="va">naturetypes_wide</span><span class="op">$</span><span class="va">SE</span> <span class="op">-</span> <span class="va">naturetypes_wide</span><span class="op">$</span><span class="va">TK</span></span>
<span></span>
<span><span class="va">diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">diff</span> <span class="op">==</span> <span class="fl">0</span>, <span class="st">"TK and SE"</span>,</span>
<span>               <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">diff</span> <span class="op">&lt;</span><span class="fl">0</span>, <span class="st">"TK"</span>, <span class="st">"SE"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">diff_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">diff</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">diff_tbl</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">diff</span>, y <span class="op">=</span> <span class="va">Freq</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>           colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>           fill <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Variable indicating the worst state"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Number of localities"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-19"></span>
<img src="slitasje_files/figure-html/unnamed-chunk-19-1.png" alt="Counting the number of cases where TK or SE was in the worst condition for a given locality." width="288"><p class="caption">
Figure 3.9: Counting the number of cases where TK or SE was in the worst condition for a given locality.
</p>
</div>
<p>Looks like SE (= 7SE or PRSL) is more likely to be in a detrimental state.</p>
<p>Now I will copy these ADVS-values into the sf object.</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">naturetypes</span><span class="op">$</span><span class="va">slitasje</span> <span class="op">&lt;-</span> <span class="va">naturetypes_wide</span><span class="op">$</span><span class="va">slitasje</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="va">naturetypes</span><span class="op">$</span><span class="va">identifikasjon_lokalId</span>, <span class="va">naturetypes_wide</span><span class="op">$</span><span class="va">identifikasjon_lokalId</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#nrow(naturetypes[is.na(naturetypes$slitasje),])  # 13 cases</span></span>
<span><span class="va">naturetypes</span> <span class="op">&lt;-</span> <span class="va">naturetypes</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">naturetypes</span><span class="op">$</span><span class="va">slitasje</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
</div>
<div id="gruk" class="section level4" number="3.8.1.2">
<h4>
<span class="header-section-number">3.8.1.2</span> GRUK<a class="anchor" aria-label="anchor" href="#gruk"><i class="fas fa-link"></i></a>
</h4>
<p>This variable is also recorded in
<a href="https://www.nina.no/Naturmangfold/Trua-natur/%C3%85pen-grunnlendt-kalkmark">GRUK</a>.
This is a stratified and intensive monitoring program for calcareous naturally open areas around the Oslo fjord.
The nature type data set I’m working on here includes some data from GRUK already
(presently only 2021 included). The full GRUK data set also contains a related variable:
<code>% cover in 5m radii circles</code>, which is much more detailed than the four variable we have looked at so far. This data is
not published. In any case it might be better to use the harmonized data set
in our case.</p>
</div>
<div id="ANO-import" class="section level4" number="3.8.1.3">
<h4>
<span class="header-section-number">3.8.1.3</span> ANO<a class="anchor" aria-label="anchor" href="#ANO-import"><i class="fas fa-link"></i></a>
</h4>
<p>Arealrepresentativ Naturovervåking (ANO) consist of 1000 systematically
placed locations each with 18 sample points. In each sample point a
circle of 250 m2 is visualised, and the main ecosystem is recorded.
Depending on the main ecosystem, certain NiN variables are also
recorded. 7SE is recorded for våtmark (wetlands), but not semi-natural areas or
naturally open areas. 7TK is recorded in wetlands and naturally open
areas only.</p>
<div class="inline-table"><table class="table table-sm">
<caption>Table showing which main ecosystems the two NiN variables 7SE and 7TK
is recorded in withing the ANO data set.</caption>
<thead><tr class="header">
<th>Variable</th>
<th>Våtmark</th>
<th>Naturlig åpne områder</th>
<th>Semi-naturlige områder</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>7SE</td>
<td>X</td>
<td>-</td>
<td>-</td>
</tr>
<tr class="even">
<td>7TK</td>
<td>X</td>
<td>X</td>
<td>-</td>
</tr>
</tbody>
</table></div>
<p>It would be very nice to have 7SE recorded for naturally open areas.
This variable is very relevant here.</p>
<p>I think I will only use wetlands here since my approach will be to the
‘worst value’ of the variable 7SE and 7TK (see below). I think not
having 7SE for naturally open areas will underestimate the degree of
degradation in these areas.</p>
<blockquote>
<p><em>ANO could harmonise better with the Naturetype data set if it included
7SE and 7TK for Naturally open and Semi natural ecosystem.</em></p>
</blockquote>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ano</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">pData</span>, <span class="st">"Naturovervaking_eksport.gdb"</span><span class="op">)</span>,</span>
<span>                   layer <span class="op">=</span> <span class="st">"ANO_SurveyPoint"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">hovedoekosystem_punkt</span> <span class="op">==</span> <span class="st">"vaatmark"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reading layer `ANO_SurveyPoint' from data source </span></span>
<span><span class="co">#&gt;   `/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/Naturovervaking_eksport.gdb' </span></span>
<span><span class="co">#&gt;   using driver `OpenFileGDB'</span></span>
<span><span class="co">#&gt; Simple feature collection with 8974 features and 71 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -51950 ymin: 6467050 xmax: 1094950 ymax: 7923950</span></span>
<span><span class="co">#&gt; Projected CRS: ETRS89 / UTM zone 33N</span></span></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ano</span><span class="op">$</span><span class="va">aar</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 2019 2021 </span></span>
<span><span class="co">#&gt;  130  558</span></span></code></pre></div>
<p>This data set only contains data from year 2019 and 2021. We need to
update this data set later. It is not clear why there is no data from
2020. This topic is maintained as a <a href="https://github.com/NINAnor/ecosystemCondition/issues/101">GitHub issue</a>.</p>
<p>Each point/row here is 250 square meters. The data also contains
information about how big a proportion of this area is made up of the
dominant main ecosystem. However, there are
130
NA’s here, which is 19% of the data.</p>
<p>It appears the proportion of each circle that is made up of the dominant
ecosystem was only recorded after year 2019. In fact, the main ecosystem
was not recorded at all in 2019:</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Hard coding name change</span></span>
<span><span class="co">#unique(ano$hovedtype_250m2)[3]</span></span>
<span><span class="co">#ano$hovedtype_250m2[ano$hovedtype_250m2==unique(ano$hovedtype_250m2)[3]] &lt;- "Aapen jordvassmyr"</span></span></code></pre></div>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ano</span><span class="op">$</span><span class="va">hovedtype_250m2</span>, <span class="va">ano</span><span class="op">$</span><span class="va">aar</span><span class="op">)</span></span>
<span><span class="co">#&gt;                             </span></span>
<span><span class="co">#&gt;                              2019 2021</span></span>
<span><span class="co">#&gt;   Åpen jordvannsmyr             0  416</span></span>
<span><span class="co">#&gt;   Boreal hei                    0    1</span></span>
<span><span class="co">#&gt;   Fjellhei leside og tundra     0    3</span></span>
<span><span class="co">#&gt;   Grøftet torvmark              0    5</span></span>
<span><span class="co">#&gt;   Helofytt-ferskvannssump       0    3</span></span>
<span><span class="co">#&gt;   Kaldkilde                     0    2</span></span>
<span><span class="co">#&gt;   Myr- og sumpskogsmark         0   51</span></span>
<span><span class="co">#&gt;   Nedbørsmyr                    0   53</span></span>
<span><span class="co">#&gt;   Rasmark                       0    1</span></span>
<span><span class="co">#&gt;   Semi-naturlig myr             0    7</span></span>
<span><span class="co">#&gt;   Semi-naturlig våteng          0    2</span></span>
<span><span class="co">#&gt;   Skogsmark                     0    2</span></span>
<span><span class="co">#&gt;   Strandsumpskogsmark           0    2</span></span>
<span><span class="co">#&gt;   Våtsnøleie og snøleiekilde    0    6</span></span></code></pre></div>
<p>I can remove the NA’s, and thus the 2019 data.</p>
<blockquote>
<p><em>All of 2019 ANO data is excluded because of missing information</em></p>
</blockquote>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ano</span> <span class="op">&lt;-</span> <span class="va">ano</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">ano</span><span class="op">$</span><span class="va">andel_hovedoekosystem_punkt</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<p>Let’s look at the variation in the recorded proportion of ecosystem
cover</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">4</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">ano</span><span class="op">$</span><span class="va">andel_hovedoekosystem_punkt</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">ano</span><span class="op">$</span><span class="va">andel_hovedoekosystem_punkt</span><span class="op">)</span><span class="op">]</span>,</span>
<span>     ylab<span class="op">=</span><span class="st">"Percentage of the 250 m2 area\ncovered by the main ecosystem"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-26"></span>
<img src="slitasje_files/figure-html/unnamed-chunk-26-1.png" alt="Distribution of the ANO variable andel_hovedoekosystem_punkt for wetland localities." width="672"><p class="caption">
Figure 3.10: Distribution of the ANO variable andel_hovedoekosystem_punkt for wetland localities.
</p>
</div>
<p>The zero in there is an obvious mistake.</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ano</span> <span class="op">&lt;-</span> <span class="va">ano</span><span class="op">[</span><span class="va">ano</span><span class="op">$</span><span class="va">andel_hovedoekosystem_punkt</span><span class="op">&gt;</span><span class="fl">20</span>,<span class="op">]</span></span></code></pre></div>
<p>Here’s another plot of the distribution of the same variable:</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">ano</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">andel_hovedoekosystem_punkt</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>         <span class="fu">geom_histogram</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"grey"</span>,</span>
<span>                        colour<span class="op">=</span><span class="st">"black"</span>,</span>
<span>                        binwidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Percentage cover of the Våtmark main ecosystem\n in the 250m2 circle"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">101</span><span class="op">)</span>,</span>
<span>                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-28"></span>
<img src="slitasje_files/figure-html/unnamed-chunk-28-1.png" alt="Percentage cover of the Våtmark main ecosystem in the 250m2 circle" width="672"><p class="caption">
Figure 3.11: Percentage cover of the Våtmark main ecosystem in the 250m2 circle
</p>
</div>
<p>We can see that people tend to record the variable in steps of 5%, and
that most sample points are 100% belonging to the same main ecosystem.</p>
<p>We want to use area weighting in this indicator, so we can use this
percentage cover data to calculate the area. Note that both data sets
use m<sup>2</sup> as area units.</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ano</span><span class="op">$</span><span class="va">area</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ano</span><span class="op">$</span><span class="va">andel_hovedoekosystem_punkt</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span><span class="op">*</span><span class="fl">250</span></span></code></pre></div>
<p>Let’s now look at the distribution of the variables. First I need to
separate the variable name from the values themselves. Now the data
looks like this:</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ano</span><span class="op">$</span><span class="va">bv_7se</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] "7SE_0" "7SE_0" "7SE_0" "7SE_0" "7SE_0" "7SE_0"</span></span></code></pre></div>
<p>So I create a new variable prefixed var_:</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ano</span><span class="op">$</span><span class="va">var_7SE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"7SE_"</span>,</span>
<span>                 replacement <span class="op">=</span> <span class="st">""</span>,</span>
<span>                 x <span class="op">=</span> <span class="va">ano</span><span class="op">$</span><span class="va">bv_7se</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: NAs introduced by coercion</span></span></code></pre></div>
<p>The NA’s is the case of blank cells. The field app should not allow
users leaving this field blank. I will need to remove these rows. There
are fourteen cases:</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">ano</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">ano</span><span class="op">$</span><span class="va">var_7SE</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 14</span></span></code></pre></div>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ano</span> <span class="op">&lt;-</span> <span class="va">ano</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">ano</span><span class="op">$</span><span class="va">var_7SE</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<p>Same with the other variable 7TK</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ano</span><span class="op">$</span><span class="va">var_7TK</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"7TK_"</span>,</span>
<span>                 replacement <span class="op">=</span> <span class="st">""</span>,</span>
<span>                 x <span class="op">=</span> <span class="va">ano</span><span class="op">$</span><span class="va">bv_7tk</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>No NA’s this time.</p>
<blockquote>
<p><em>The ANO field app should not allow user to leave blank cells. This
resulted in the exclusion of data.</em></p>
</blockquote>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ano</span><span class="op">$</span><span class="va">var_7TK</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">"7TK scores"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ano</span><span class="op">$</span><span class="va">var_7SE</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">"7SE scores"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-35"></span>
<img src="slitasje_files/figure-html/unnamed-chunk-35-1.png" alt="Distribution of 7TK and 7SE scores in the ANO data" width="672"><p class="caption">
Figure 3.12: Distribution of 7TK and 7SE scores in the ANO data
</p>
</div>
<p>The ANO sites seem to be in an even better condition than the localities in the naturtype data set.</p>
<p>Combining these two variables 7TK and 7SE into one, same as for the nature
type data.</p>
<p>First I convert the range categories into percentages, like I did previously for the nature type data set.</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ano</span> <span class="op">&lt;-</span> <span class="va">ano</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>var_7TK <span class="op">=</span> <span class="fu">case_match</span><span class="op">(</span><span class="va">var_7TK</span>,</span>
<span>             <span class="fl">0</span> <span class="op">~</span> <span class="fl">0</span>,</span>
<span>             <span class="fl">1</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">16</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span>,</span>
<span>             <span class="fl">2</span> <span class="op">~</span> <span class="fl">1</span><span class="op">/</span><span class="fl">16</span><span class="op">*</span><span class="fl">100</span>,</span>
<span>             <span class="fl">3</span> <span class="op">~</span> <span class="fl">50</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>var_7SE <span class="op">=</span> <span class="fu">case_match</span><span class="op">(</span><span class="va">var_7SE</span>,</span>
<span>             <span class="fl">0</span> <span class="op">~</span> <span class="fl">0</span>,</span>
<span>             <span class="fl">1</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">16</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span>,</span>
<span>             <span class="fl">2</span> <span class="op">~</span> <span class="fl">1</span><span class="op">/</span><span class="fl">16</span><span class="op">*</span><span class="fl">100</span>,</span>
<span>             <span class="fl">3</span> <span class="op">~</span> <span class="fl">50</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">ano</span><span class="op">)</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">slitasje</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">temp</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"var_7TK"</span>, <span class="st">"var_7SE"</span><span class="op">)</span><span class="op">]</span>, <span class="fl">1</span>, <span class="va">sum</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">ano</span><span class="op">$</span><span class="va">slitasje</span> <span class="op">&lt;-</span> <span class="va">temp</span><span class="op">$</span><span class="va">slitasje</span></span></code></pre></div>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ano</span><span class="op">$</span><span class="va">slitasje</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">"ADVS variable score"</span>, ylab <span class="op">=</span> <span class="st">"Number of localities"</span>, las<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-38"></span>
<img src="slitasje_files/figure-html/unnamed-chunk-38-1.png" alt="Distribution of slitasje scores in the ANO data" width="576"><p class="caption">
Figure 3.13: Distribution of slitasje scores in the ANO data
</p>
</div>
<div id="combine-nt-ano" class="section level5" number="3.8.1.3.1">
<h5>
<span class="header-section-number">3.8.1.3.1</span> Combine Naturtype data and ANO<a class="anchor" aria-label="anchor" href="#combine-nt-ano"><i class="fas fa-link"></i></a>
</h5>
<p>We need to combine the nature type data set with the ANO data set. I
will add a column <code>origin</code> to show where the data comes from. I will
also add a column with the main ecosystem.</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ano</span><span class="op">$</span><span class="va">origin</span> <span class="op">&lt;-</span> <span class="st">"ANO"</span></span>
<span><span class="va">naturetypes</span><span class="op">$</span><span class="va">origin</span> <span class="op">&lt;-</span> <span class="st">"Nature type mapping"</span></span>
<span><span class="va">ano</span><span class="op">$</span><span class="va">hovedøkosystem</span> <span class="op">&lt;-</span> <span class="st">"Våtmark"</span></span>
<span><span class="va">ano</span><span class="op">$</span><span class="va">kartleggingsår</span> <span class="op">&lt;-</span> <span class="va">ano</span><span class="op">$</span><span class="va">aar</span></span></code></pre></div>
<p>Fix class</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">naturetypes</span><span class="op">$</span><span class="va">kartleggingsår</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">naturetypes</span><span class="op">$</span><span class="va">kartleggingsår</span><span class="op">)</span></span>
<span><span class="va">naturetypes</span><span class="op">$</span><span class="va">area</span> <span class="op">&lt;-</span> <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/units/man/drop_units.html">drop_units</a></span><span class="op">(</span><span class="va">naturetypes</span><span class="op">$</span><span class="va">area</span><span class="op">)</span></span></code></pre></div>
<p>I use <code><a href="https://dplyr.tidyverse.org/reference/select.html">dplyr::select</a></code> to reduce the number of columns to keep things a
bit more tidy.</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slitasje_data</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span><span class="fu">select</span><span class="op">(</span><span class="va">ano</span>,</span>
<span>                                  <span class="va">GlobalID</span>,</span>
<span>                                  <span class="va">origin</span>,</span>
<span>                                  <span class="va">kartleggingsår</span>,</span>
<span>                                  <span class="va">hovedøkosystem</span>,</span>
<span>                                  <span class="va">area</span>,</span>
<span>                                  <span class="va">slitasje</span>,</span>
<span>                                  <span class="va">SHAPE</span><span class="op">)</span>, </span>
<span>                           <span class="fu">select</span><span class="op">(</span><span class="va">naturetypes</span>,</span>
<span>                                  <span class="va">identifikasjon_lokalId</span>,</span>
<span>                                  <span class="va">origin</span>,</span>
<span>                                  <span class="va">hovedøkosystem</span>,</span>
<span>                                  <span class="va">kartleggingsår</span>,</span>
<span>                                  <span class="va">area</span>,</span>
<span>                                  <span class="va">slitasje</span>,</span>
<span>                                  <span class="va">SHAPE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu">st_geometry_type</span><span class="op">(</span><span class="va">slitasje_data</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] POINT        MULTIPOLYGON</span></span>
<span><span class="co">#&gt; 18 Levels: GEOMETRY POINT LINESTRING POLYGON ... TRIANGLE</span></span></code></pre></div>
<div id="ANO-points-to-poly" class="section level6" number="3.8.1.3.1.1">
<h6>
<span class="header-section-number">3.8.1.3.1.1</span> Points to polygons<a class="anchor" aria-label="anchor" href="#ANO-points-to-poly"><i class="fas fa-link"></i></a>
</h6>
<p>The ANO data is point data, and the nature type data is <em>multipolygon</em>.
Because later we might want to save this as a shape file, we cannot have
a mixed class type. I will therefore convert the points to polygons. I
use the area column to calculate a radii that gives that area.</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slitasje_data_points</span> <span class="op">&lt;-</span> <span class="va">slitasje_data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>g_type <span class="op">=</span> <span class="fu">st_geometry_type</span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">g_type</span> <span class="op">==</span><span class="st">"POINT"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">st_buffer</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">slitasje_data</span><span class="op">$</span><span class="va">area</span><span class="op">/</span><span class="va">pi</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Checking now that the new polygons have the area corresponding to the
proportion of the point that was part of the same main ecosystem:</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slitasje_data_points</span><span class="op">$</span><span class="va">area2</span> <span class="op">&lt;-</span> <span class="fu">st_area</span><span class="op">(</span><span class="va">slitasje_data_points</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">slitasje_data_points</span><span class="op">$</span><span class="va">area</span>, <span class="va">slitasje_data_points</span><span class="op">$</span><span class="va">area2</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Target area"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Area of the new polygons"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:new-area"></span>
<img src="slitasje_files/figure-html/new-area-1.png" alt="Checking that the area of the new polygons fall in line with the proportion of each point which is part of the main ecosystem." width="672"><p class="caption">
Figure 3.14: Checking that the area of the new polygons fall in line with the proportion of each point which is part of the main ecosystem.
</p>
</div>
<p>The area calculation seems to have worked fine. Checking that the new
data set contains <strong>only polygons</strong>.</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slitasje_data_polygons</span> <span class="op">&lt;-</span> <span class="va">slitasje_data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>g_type <span class="op">=</span> <span class="fu">st_geometry_type</span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">g_type</span> <span class="op">!=</span><span class="st">"POINT"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">slitasje_data</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">slitasje_data_points</span>, <span class="va">slitasje_data_polygons</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu">st_geometry_type</span><span class="op">(</span><span class="va">slitasje_data</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] POLYGON      MULTIPOLYGON</span></span>
<span><span class="co">#&gt; 18 Levels: GEOMETRY POINT LINESTRING POLYGON ... TRIANGLE</span></span></code></pre></div>
<p>Ok.</p>
</div>
</div>
</div>
<div id="distribution-of-advs-scores" class="section level4" number="3.8.1.4">
<h4>
<span class="header-section-number">3.8.1.4</span> Distribution of ADVS scores<a class="anchor" aria-label="anchor" href="#distribution-of-advs-scores"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">slitasje_data</span><span class="op">$</span><span class="va">slitasje</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">Var1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">temp</span><span class="op">$</span><span class="va">Var1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">temp</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Var1</span>,</span>
<span>                 y <span class="op">=</span> <span class="va">Freq</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span>,</span>
<span>           fill<span class="op">=</span><span class="st">"grey"</span>,</span>
<span>           colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"ADVS score"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Number of localities"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html">label_number</a></span><span class="op">(</span>accuracy <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-44"></span>
<img src="slitasje_files/figure-html/unnamed-chunk-44-1.png" alt="ADVS variable scores (ANO Naturetype data combined). The score for a locality equals the sum of the related variables 7TK, 7SE, PRSL and PRTK." width="672"><p class="caption">
Figure 3.15: ADVS variable scores (ANO Naturetype data combined). The score for a locality equals the sum of the related variables 7TK, 7SE, PRSL and PRTK.
</p>
</div>
<p>Let’s see the proportion of data points (not area) origination from each
data set</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">slitasje_data</span><span class="op">$</span><span class="va">origin</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">temp</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Var1</span>,</span>
<span>                 y <span class="op">=</span> <span class="va">Freq</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span>,</span>
<span>           fill<span class="op">=</span><span class="st">"grey"</span>,</span>
<span>           colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Data origin"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Number of localities"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-45"></span>
<img src="slitasje_files/figure-html/unnamed-chunk-45-1.png" alt="Barplot show the contribution (number of localities) of different data sets to the ADVS indicator." width="384"><p class="caption">
Figure 3.16: Barplot show the contribution (number of localities) of different data sets to the ADVS indicator.
</p>
</div>
<p>So the ANO data is not very important here, but it can become more
important in the future so good to have them included in the workflow.</p>
</div>
<div id="outline-of-norway-and-regions" class="section level4" number="3.8.1.5">
<h4>
<span class="header-section-number">3.8.1.5</span> Outline of Norway and regions<a class="anchor" aria-label="anchor" href="#outline-of-norway-and-regions"><i class="fas fa-link"></i></a>
</h4>
<p>The GIS layers are used to crop out marine areas, and to define
accounting areas, respectively.</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outline</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">read_sf</a></span><span class="op">(</span><span class="st">"data/outlineOfNorway_EPSG25833.shp"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regions</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">read_sf</a></span><span class="op">(</span><span class="st">"data/regions.shp"</span>, options <span class="op">=</span> <span class="st">"ENCODING=UTF8"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">regions</span><span class="op">$</span><span class="va">region</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Nord-Norge" "Midt-Norge" "Østlandet"  "Vestlandet"</span></span>
<span><span class="co">#&gt; [5] "Sørlandet"</span></span></code></pre></div>
</div>
</div>
<div id="scale-slitasje-ind" class="section level3" number="3.8.2">
<h3>
<span class="header-section-number">3.8.2</span> Scaled indicator values<a class="anchor" aria-label="anchor" href="#scale-slitasje-ind"><i class="fas fa-link"></i></a>
</h3>
<p>I can scale the indicator for each polygon, or I can chose to aggregate
them first. If the scaled value is representative and precise at the
polygon level, then I could scale at that level. I think they are.</p>
<p>However, the combined surveyed area is a very small fraction of the
total area of Norway, so that only producing indicator values for the
mapped areas leaves the indicator without much value for regional
assessments. When we do regional assessments and calculate regional
indicator values, we cannot simply do an area weighting of the polygons
in each region. This is because we don’t want to assume that the
polygons are representative far outside of the mapped area. But perhaps
we can assume them to be representative inside <em>homogeneous ecological
areas,</em> or <em>Homoegeneous Impact Areas</em> (HIAs). That’s where the
infrastructure index comes in. Here’s the plan:</p>
<ol style="list-style-type: decimal">
<li><p>normalise the indicators at the polygon level.</p></li>
<li><p>take a simplified infrastructure index (vector data set with HIAs)
and extract the corresponding indicator values that intersect with a
given HIA, and extrapolate the area weighted mean of those values to
the entire HIA withing a given geographical region. Errors are
calculated from bootstrapping.</p></li>
<li><p>Take the new area weighted indicator values for the HIAs and match
them with ecosystem occurrences of the same HIA (possibly using
randomly sampled points from the available ecosystem occurrences).
The errors are the same as for the HIAs.</p></li>
<li><p>calculate an indicator value for a region (accounting area) by doing
a weighted average based of the relative area of ecosystem
occurrences. Errors should be carried somehow, perhaps via weighted
resampling.</p></li>
</ol>
<div id="scaled-slitasje-variable" class="section level4" number="3.8.2.1">
<h4>
<span class="header-section-number">3.8.2.1</span> Scaled variable<a class="anchor" aria-label="anchor" href="#scaled-slitasje-variable"><i class="fas fa-link"></i></a>
</h4>
<p>I will use the same reference levels/values for all of Norway:</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">upper</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">lower</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">threshold</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></code></pre></div>
<p>Also, the threshold value is set quite conservatively (I think), and should be
discussed.</p>
<p>I need to do a little trick and reverse the upper and lower reference
values for the normalisation to work. This is a bug which can be fixed
inside eaTools.</p>
<!-- THE BREAKPOINT IS AT 0.5 RATHER THAN 0.6. TEST CODE FROM HERE: https://ninanor.github.io/eaTools/articles/normalise-condition-variable.html -->
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">eaTools</span><span class="fu">::</span><span class="fu"><a href="https://ninanor.github.io/eaTools/reference/ea_normalise.html">ea_normalise</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">slitasje_data</span>,</span>
<span>                      vector <span class="op">=</span> <span class="st">"slitasje"</span>,</span>
<span>                      upper_reference_level <span class="op">=</span> <span class="va">lower</span>,</span>
<span>                      lower_reference_level <span class="op">=</span> <span class="va">upper</span>,</span>
<span>                      break_point <span class="op">=</span> <span class="va">threshold</span>,</span>
<span>                      plot<span class="op">=</span><span class="cn">T</span>,</span>
<span>                      reverse <span class="op">=</span> <span class="cn">T</span></span>
<span>                      <span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:slitasje-normalise"></span>
<img src="slitasje_files/figure-html/slitasje-normalise-1.png" alt="Performing a linear break-point type normalisation of the ADSV variable." width="480"><p class="caption">
Figure 3.17: Performing a linear break-point type normalisation of the ADSV variable.
</p>
</div>
<p>This normalisation seems reasonable to me. I can save it as indicator
values. There is no point yet making this a time series, and I will
assign all the indicator value to the average year of the data.</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">slitasje_data</span><span class="op">$</span><span class="va">kartleggingsår</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2020.254</span></span></code></pre></div>
<p>Assigning the indicator to year 2020.</p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slitasje_data</span><span class="op">$</span><span class="va">i_2020</span> <span class="op">&lt;-</span> <span class="fu">eaTools</span><span class="fu">::</span><span class="fu"><a href="https://ninanor.github.io/eaTools/reference/ea_normalise.html">ea_normalise</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">slitasje_data</span>,</span>
<span>                      vector <span class="op">=</span> <span class="st">"slitasje"</span>,</span>
<span>                      upper_reference_level <span class="op">=</span> <span class="va">lower</span>,</span>
<span>                      lower_reference_level <span class="op">=</span> <span class="va">upper</span>,</span>
<span>                      break_point <span class="op">=</span> <span class="va">threshold</span>,</span>
<span>                      reverse <span class="op">=</span> <span class="cn">T</span></span>
<span>                      <span class="op">)</span></span></code></pre></div>
</div>
</div>
<div id="HIA-slitasje" class="section level3" number="3.8.3">
<h3>
<span class="header-section-number">3.8.3</span> Homogeneous impact areas<a class="anchor" aria-label="anchor" href="#HIA-slitasje"><i class="fas fa-link"></i></a>
</h3>
<p>I want to use the <a href="homogeneous-impact-areas.html#homogeneous-impact-areas">Homogeneous Impact Areas</a> (HIA) to define
smaller regions into which I can extrapolate the indicator values. This
data is generated by discretizing the Norwegian Infrastructure Index. I
refer to the ordinal values of the four HIA classes as their <em>Human
Impact Factor</em> (HIF). This is just to keep the approach separate from
the Norwegian Infrastructure Index.</p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HIA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">pData</span>, <span class="st">"infrastrukturindeks/homogeneous_impact_areas.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>I want to check that HIF is in fact a good predictor for <em>slitasje</em>.</p>
<p>I also want to split these four HIA classes based on their region. To do
this I need the two layers to have the same CRS.</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">st_crs</span><span class="op">(</span><span class="va">HIA</span><span class="op">)</span> <span class="op">==</span> <span class="fu">st_crs</span><span class="op">(</span><span class="va">regions</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Since the HIA map and the <em>region</em> map are completely overlapping (HIA was masked using the region map), we can get the
intersections</p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HIA_regions</span> <span class="op">&lt;-</span> <span class="fu">eaTools</span><span class="fu">::</span><span class="fu"><a href="https://ninanor.github.io/eaTools/reference/ea_homogeneous_area.html">ea_homogeneous_area</a></span><span class="op">(</span><span class="va">HIA</span>,</span>
<span>                             <span class="va">regions</span>,</span>
<span>                             keep1 <span class="op">=</span> <span class="st">"infrastructureIndex"</span>,</span>
<span>                             keep2 <span class="op">=</span> <span class="st">"region"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">HIA_regions</span>, <span class="st">"P:/41201785_okologisk_tilstand_2022_2023/data/cache/HIA_regions.rds"</span><span class="op">)</span></span></code></pre></div>
<p>Create a new column by crossing region and HIF</p>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HIA_regions</span> <span class="op">&lt;-</span> <span class="va">HIA_regions</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>region_HIF <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">region</span>, <span class="va">infrastructureIndex</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div id="validate-slitasje" class="section level4" number="3.8.3.1">
<h4>
<span class="header-section-number">3.8.3.1</span> Validate<a class="anchor" aria-label="anchor" href="#validate-slitasje"><i class="fas fa-link"></i></a>
</h4>
<p>I now have 20 unique areas (for each main ecosystem) that I will, given
there is data, extrapolate indicator values over.</p>
<div id="subset-ets" class="section level6" number="3.8.3.1.0.1">
<h6>
<span class="header-section-number">3.8.3.1.0.1</span> Subset ETs<a class="anchor" aria-label="anchor" href="#subset-ets"><i class="fas fa-link"></i></a>
</h6>
<p>I will subset the <code>slitasje_data</code> into the three ecosystems. Note that
only for open wetland do we have good ecosystem delineation maps to base
a spatial averaging on.</p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Check spelling</span></span>
<span><span class="co">#unique(slitasje_data$hovedøkosystem)</span></span>
<span></span>
<span><span class="co"># Rename one level</span></span>
<span><span class="va">slitasje_data</span> <span class="op">&lt;-</span> <span class="va">slitasje_data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>hovedøkosystem <span class="op">=</span> <span class="fu">recode</span><span class="op">(</span><span class="va">hovedøkosystem</span>, <span class="st">"Våtmark"</span> <span class="op">=</span> <span class="st">"våtmark"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#make valid</span></span>
<span><span class="va">slitasje_data</span> <span class="op">&lt;-</span> <span class="fu">st_make_valid</span><span class="op">(</span><span class="va">slitasje_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#subset</span></span>
<span><span class="va">wetlands</span> <span class="op">&lt;-</span> <span class="va">slitasje_data</span><span class="op">[</span><span class="va">slitasje_data</span><span class="op">$</span><span class="va">hovedøkosystem</span> <span class="op">==</span> <span class="st">"våtmark"</span>,<span class="op">]</span></span>
<span><span class="va">seminat</span> <span class="op">&lt;-</span> <span class="va">slitasje_data</span><span class="op">[</span><span class="va">slitasje_data</span><span class="op">$</span><span class="va">hovedøkosystem</span> <span class="op">==</span> <span class="st">"semi-naturligMark"</span>,<span class="op">]</span></span>
<span><span class="va">natOpen</span> <span class="op">&lt;-</span> <span class="va">slitasje_data</span><span class="op">[</span><span class="va">slitasje_data</span><span class="op">$</span><span class="va">hovedøkosystem</span> <span class="op">==</span> <span class="st">"naturligÅpneOmråderILavlandet"</span>,<span class="op">]</span></span></code></pre></div>
<p>Creating some summary statistics.</p>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wetland_stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ninanor.github.io/eaTools/reference/ea_spread.html">ea_spread</a></span><span class="op">(</span>indicator_data <span class="op">=</span> <span class="va">wetlands</span>,</span>
<span>          indicator <span class="op">=</span> <span class="va">i_2020</span>,</span>
<span>          regions <span class="op">=</span> <span class="va">HIA_regions</span>,</span>
<span>          groups <span class="op">=</span> <span class="va">region_HIF</span>,</span>
<span>          summarise <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">seminat_stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ninanor.github.io/eaTools/reference/ea_spread.html">ea_spread</a></span><span class="op">(</span>indicator_data <span class="op">=</span> <span class="va">seminat</span>,</span>
<span>          indicator <span class="op">=</span> <span class="va">i_2020</span>,</span>
<span>          regions <span class="op">=</span> <span class="va">HIA_regions</span>,</span>
<span>          groups <span class="op">=</span> <span class="va">region_HIF</span>,</span>
<span>          summarise <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">natOpen_stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ninanor.github.io/eaTools/reference/ea_spread.html">ea_spread</a></span><span class="op">(</span>indicator_data <span class="op">=</span> <span class="va">natOpen</span>,</span>
<span>          indicator <span class="op">=</span> <span class="va">i_2020</span>,</span>
<span>          regions <span class="op">=</span> <span class="va">HIA_regions</span>,</span>
<span>          groups <span class="op">=</span> <span class="va">region_HIF</span>,</span>
<span>          summarise <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wetland_stats</span> <span class="op">&lt;-</span> <span class="va">wetland_stats</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">add_column</span><span class="op">(</span>eco <span class="op">=</span> <span class="st">"wetland"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">seminat_stats</span> <span class="op">&lt;-</span> <span class="va">seminat_stats</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">add_column</span><span class="op">(</span>eco <span class="op">=</span> <span class="st">"semi-natural"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">natOpen_stats</span> <span class="op">&lt;-</span> <span class="va">natOpen_stats</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">add_column</span><span class="op">(</span>eco <span class="op">=</span> <span class="st">"Naturally-open"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">all_stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">wetland_stats</span>,</span>
<span>                   <span class="va">seminat_stats</span>,</span>
<span>                   <span class="va">natOpen_stats</span><span class="op">)</span></span>
<span><span class="va">all_stats</span> <span class="op">&lt;-</span> <span class="va">all_stats</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">separate</span><span class="op">(</span><span class="va">region_HIF</span>,</span>
<span>           into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"region"</span>, <span class="st">"HIF"</span><span class="op">)</span>,</span>
<span>           sep <span class="op">=</span> <span class="st">" "</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">all_stats</span>, <span class="st">"/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/cache/all_stats.rds"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp_plot</span> <span class="op">&lt;-</span> <span class="va">all_stats</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>HIF_NA <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>    <span class="va">n</span> <span class="op">&gt;</span> <span class="fl">150</span> <span class="op">~</span> <span class="va">HIF</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">myColour_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">temp_plot</span><span class="op">$</span><span class="va">myColour</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">myColour_list</span><span class="op">)</span> <span class="op">&lt;-</span>   <span class="va">myColour_list</span></span>
<span></span>
<span><span class="fu">ggarrange</span><span class="op">(</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">temp_plot</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">region</span>, y <span class="op">=</span> <span class="va">n</span>, group <span class="op">=</span> <span class="va">HIF</span>, fill <span class="op">=</span> <span class="va">HIF_NA</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span>, stat <span class="op">=</span> <span class="st">"identity"</span>, col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_fill_brewer</span><span class="op">(</span>palette<span class="op">=</span><span class="st">"Oranges"</span>, na.translate<span class="op">=</span><span class="cn">F</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"HIF"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept<span class="op">=</span><span class="fl">150</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">.</span><span class="op">~</span><span class="va">eco</span><span class="op">)</span>,</span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">temp_plot</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">region</span>, y <span class="op">=</span> <span class="va">w_mean</span>, group <span class="op">=</span> <span class="va">HIF</span>, fill <span class="op">=</span> <span class="va">HIF_NA</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span>, stat <span class="op">=</span> <span class="st">"identity"</span>, col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_fill_brewer</span><span class="op">(</span>palette<span class="op">=</span><span class="st">"Oranges"</span>,  na.translate<span class="op">=</span><span class="cn">F</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"HIF"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">.</span><span class="op">~</span><span class="va">eco</span><span class="op">)</span>,</span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">temp_plot</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">region</span>, y <span class="op">=</span> <span class="va">sd</span>, group <span class="op">=</span> <span class="va">HIF</span>, fill <span class="op">=</span> <span class="va">HIF_NA</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span>, stat <span class="op">=</span> <span class="st">"identity"</span>, col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_fill_brewer</span><span class="op">(</span>palette<span class="op">=</span><span class="st">"Oranges"</span>,  na.translate<span class="op">=</span><span class="cn">F</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"HIF"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">.</span><span class="op">~</span><span class="va">eco</span><span class="op">)</span>,</span>
<span>ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:dense-stats"></span>
<img src="slitasje_files/figure-html/dense-stats-1.png" alt="Barplot showing the number of data points, the area weighted scaled indicator values and the sd for the ADSV indicator. Transparent bars represents categories with less than 150 data points, indicated by the vertical line in the top row of panes." width="672"><p class="caption">
Figure 3.18: Barplot showing the number of data points, the area weighted scaled indicator values and the sd for the ADSV indicator. Transparent bars represents categories with less than 150 data points, indicated by the vertical line in the top row of panes.
</p>
</div>
<p>In the figure above, colors refer to Human Impact Factor (amount or frequency of infrastructure)
and NA means that there are less than 150 data points which we set as a threshold for evaluating the indicator values.</p>
<p>In the top row
we see that the sample size (number of polygons) varies between
ecosystems. For naturally open ecosystems many polygons are from high
infrastructure areas, not surprisingly, and there are few points for the
lowest impact class (zero such polygons in <em>Sørlandet</em> for example). We
may therefore not be able to extrapolate indicator values for Naturally
open areas in in <em>Sørlandet</em> with low levels of infrastructure.</p>
<p>In semi-natural areas and wetlands, we have very little data from HIF
class 3.</p>
<p>We can also from the middle row see the association between the indicator
values (area weighted means) and the modified infrastructure index
(HIF). We should then not put any weight on the bars were there is
little data (transparent bars). Then we se the general pattern that the indicator
value decreases with increasing HIF. But there are exceptions, like for Semi-natural areas
in Vestlandet.</p>
<p>Let us look at the indicator to pressure relationship across all ecosystems.</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp_plot</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">HIF_NA</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">HIF_NA</span>, y <span class="op">=</span> <span class="va">w_mean</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size<span class="op">=</span><span class="fl">2</span>, position <span class="op">=</span> <span class="fu">position_dodge2</span><span class="op">(</span><span class="fl">.1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-59"></span>
<img src="slitasje_files/figure-html/unnamed-chunk-59-1.png" alt="Indicator to pressure relationship across all ecosystems." width="672"><p class="caption">
Figure 3.19: Indicator to pressure relationship across all ecosystems.
</p>
</div>
<p>The pattern is not perfect, and there is quite some noise. But this is perhaps also expected.</p>
<p>Let us look at the effect of sample size on the indicator uncertainty.</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp_plot</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">n</span>, y <span class="op">=</span> <span class="va">sd</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size<span class="op">=</span><span class="fl">2</span>, position <span class="op">=</span> <span class="fu">position_dodge2</span><span class="op">(</span><span class="fl">.1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">.</span><span class="op">~</span><span class="va">eco</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-60"></span>
<img src="slitasje_files/figure-html/unnamed-chunk-60-1.png" alt="Smaple size against indicator uncertainty." width="672"><p class="caption">
Figure 3.20: Smaple size against indicator uncertainty.
</p>
</div>
<p>This shows that the uncertainty is inflated with sample sizes less than about 300-500.</p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="va">all_stats</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-61"></span>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-1d17fd8aa5efb1d19c3c" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-1d17fd8aa5efb1d19c3c">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59"],["Midt-Norge","Midt-Norge","Midt-Norge","Midt-Norge","Nord-Norge","Nord-Norge","Nord-Norge","Nord-Norge","Sørlandet","Sørlandet","Sørlandet","Sørlandet","Vestlandet","Vestlandet","Vestlandet","Vestlandet","Østlandet","Østlandet","Østlandet","Østlandet","Midt-Norge","Midt-Norge","Midt-Norge","Midt-Norge","Nord-Norge","Nord-Norge","Nord-Norge","Nord-Norge","Sørlandet","Sørlandet","Sørlandet","Sørlandet","Vestlandet","Vestlandet","Vestlandet","Vestlandet","Østlandet","Østlandet","Østlandet","Østlandet","Midt-Norge","Midt-Norge","Midt-Norge","Midt-Norge","Nord-Norge","Nord-Norge","Nord-Norge","Nord-Norge","Sørlandet","Sørlandet","Sørlandet","Vestlandet","Vestlandet","Vestlandet","Vestlandet","Østlandet","Østlandet","Østlandet","Østlandet"],["0","1","2","3","0","1","2","3","0","1","2","3","0","1","2","3","0","1","2","3","0","1","2","3","0","1","2","3","0","1","2","3","0","1","2","3","0","1","2","3","0","1","2","3","0","1","2","3","1","2","3","0","1","2","3","0","1","2","3"],[20425516.793161,55942079.0852367,25271797.033968,402403.654717704,4177429.11487822,39799602.0218486,21289663.1377251,119342.520216003,1199953.10537375,2555863.89072861,1316446.89966768,28747.3798501565,2429070.74019894,7091916.84858253,1976037.38284999,83419.9734570635,1338836.52571996,10667431.8327424,12151597.8760085,777759.443905594,45082128.9721422,105282331.371692,65698434.9289448,1458536.77645433,12119453.8140127,39689431.8549581,23764139.6700521,560734.383622149,12833361.1414629,55230811.320468,21059796.7186225,281368.955707136,62771221.3693583,171913529.764963,89577387.4688441,2762081.96649456,22722135.5559064,72301565.3418464,46433821.8958926,531602.555394967,38617.3295027119,1088104.72301855,4085898.43293656,551146.817578847,1145883.34854498,6747952.7632901,6810143.31086301,90891.4412507273,109835.996095306,882962.104436279,674506.417532786,13843.1727794531,198525.028855817,436639.782215109,47244.6292264749,17970.0303946844,671054.025118375,5315089.41465925,1026810.93562918],[1001,2507,1463,43,548,2503,1513,16,129,457,132,10,272,723,329,24,151,768,912,119,764,2361,2314,101,399,1323,1279,69,153,737,713,56,484,2239,2218,181,251,1104,1650,143,55,298,1098,189,223,1419,1422,52,39,385,254,18,111,246,34,11,216,1419,416],[0.771750910678313,0.7875186612059,0.793527794730975,0.865720748692812,0.831477335386509,0.801232017375005,0.745740593748365,0.791099692645648,0.906027687414072,0.911013644607549,0.798963551938973,1,0.957236019313803,0.880727771695884,0.825256022857242,0.791359885839299,0.788313328500717,0.791395245167583,0.750731099672693,0.923119549784727,0.902593418006151,0.83593202285124,0.80467219237372,0.807328459520766,0.873503412863498,0.83350830318046,0.831318829695963,0.951610294891564,0.94985520619026,0.888240984238651,0.853134247523411,0.729140255239416,0.9098194463842,0.869385864286768,0.885433805699666,0.916486246113373,0.737934602429538,0.722254276853415,0.706036226775658,0.630459416309339,0.951417060773914,0.95003102838554,0.84863012352793,0.810123844078759,0.844666568065667,0.814820273682474,0.803164434951812,0.753302327707886,0.838687587547142,0.645133805861738,0.642709425559455,0.933046230074286,0.969736857282128,0.834162035025874,0.545331235282478,0.893416505831439,0.872053422790955,0.826622204638684,0.810474925985478],[0.920985067564015,0.867491969852833,0.825670935712487,0.792117503059976,0.898993469074145,0.855201757890531,0.826648693776742,0.743125,0.95453488372093,0.933700909823794,0.861945773524721,1,0.946281927244582,0.933323505860086,0.90592225243961,0.835635964912281,0.896889159986058,0.858679070723684,0.816871537396122,0.871275984077842,0.948676632681179,0.90910575358345,0.862583814765955,0.849241792600313,0.955019126764279,0.91984425349087,0.921706514135221,0.946414950419527,0.984117647058824,0.955265300292794,0.900607145493467,0.773397556390977,0.953312309699869,0.930312286970217,0.924071353993641,0.907515266065717,0.877254141329419,0.820020022883295,0.779115789473684,0.738916083916084,0.972727272727273,0.917387848816673,0.891231665228645,0.857699805068226,0.95627802690583,0.904449946218612,0.883170478939966,0.845394736842105,0.857962213225371,0.683749145591251,0.664680895151264,0.916666666666667,0.935277382645804,0.854032948224219,0.826625386996904,0.931818181818182,0.864918372319688,0.815831200623122,0.732730263157895],[0.00521180430068777,0.00434945752819324,0.00602063114291312,0.0357420655181531,0.00788601096109206,0.0043498025604811,0.0057907664431112,0.0530979110767958,0.00965832014067245,0.0072080861750764,0.0181116104747688,0,0.00837811441658417,0.0056414016696469,0.00896478394465009,0.0450854963918842,0.0140911117320106,0.00740041633236665,0.00744264089345736,0.0171829338414869,0.00503700280784231,0.00364269206680451,0.00430006747608547,0.0217928162646461,0.00637942868020546,0.00453240639310002,0.00462555044884439,0.0172207735139846,0.00604208609205063,0.00471198160238452,0.00680508640195998,0.0365666211196643,0.00605252356670952,0.00328820222512962,0.00347028570681106,0.0126362557588608,0.0120587689199437,0.00661779589544552,0.00566362941182635,0.0225870247899212,0.0139374336521784,0.0107014488006716,0.00607389080650256,0.0135282003589769,0.00776844313926837,0.00526458585632371,0.00529260013803737,0.0321211661039465,0.0374330986359293,0.0147547583391982,0.0175217575275686,0.0362045873291141,0.0172631766042164,0.013918519872522,0.0378085287908935,0.0438071664018427,0.0159270768134006,0.00686810399276487,0.0135103015633108],["wetland","wetland","wetland","wetland","wetland","wetland","wetland","wetland","wetland","wetland","wetland","wetland","wetland","wetland","wetland","wetland","wetland","wetland","wetland","wetland","semi-natural","semi-natural","semi-natural","semi-natural","semi-natural","semi-natural","semi-natural","semi-natural","semi-natural","semi-natural","semi-natural","semi-natural","semi-natural","semi-natural","semi-natural","semi-natural","semi-natural","semi-natural","semi-natural","semi-natural","Naturally-open","Naturally-open","Naturally-open","Naturally-open","Naturally-open","Naturally-open","Naturally-open","Naturally-open","Naturally-open","Naturally-open","Naturally-open","Naturally-open","Naturally-open","Naturally-open","Naturally-open","Naturally-open","Naturally-open","Naturally-open","Naturally-open"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>region<\/th>\n      <th>HIF<\/th>\n      <th>total_area<\/th>\n      <th>n<\/th>\n      <th>w_mean<\/th>\n      <th>mean<\/th>\n      <th>sd<\/th>\n      <th>eco<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p class="caption">
Figure 3.21: Summary statistics for the slitasje indicator.
</p>
</div>
<p>In addition to looking at the area weighted means and its relationship
with the pressure indicator (HIF), we can do the same at the polygon
level. Because the indicator is pseudo-continuous, boxplots for example
become useless, so I will present a relative frequency plot.</p>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">corrCheck</span> <span class="op">&lt;-</span> <span class="fu">st_intersection</span><span class="op">(</span><span class="va">slitasje_data</span>, <span class="va">HIA_regions</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">corrCheck</span>, <span class="st">"/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/cache/corrCheck.rds"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">corrCheck</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">infrastructureIndex</span><span class="op">)</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">i_2020</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>position<span class="op">=</span><span class="st">"fill"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">guides</span><span class="op">(</span>fill <span class="op">=</span> <span class="fu">guide_legend</span><span class="op">(</span><span class="st">"Scaled indicator values"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Fraction of data points"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"HIF"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_fill_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"RdYlGn"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">hovedøkosystem</span><span class="op">~</span><span class="va">region</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:slitasje-precentageplot"></span>
<img src="slitasje_files/figure-html/slitasje-precentageplot-1.png" alt="Relative frequency plot (conditioned on region and main ecosystem) showing the distribution of polygons with different scaled indicator values for the indicator named Anthropogenic disturbance to soils and vegetation." width="672"><p class="caption">
Figure 3.22: Relative frequency plot (conditioned on region and main ecosystem) showing the distribution of polygons with different scaled indicator values for the indicator named Anthropogenic disturbance to soils and vegetation.
</p>
</div>
<p>The figure above I think supports the indicator-pressure relationship
and justifies using the HIA+region intersections as local reference
areas. Especially when down-weighting the importance of those
groups/categories that have very little data.</p>
</div>
</div>
<div id="looking-at-the-hia" class="section level4" number="3.8.3.2">
<h4>
<span class="header-section-number">3.8.3.2</span> Looking at the HIA<a class="anchor" aria-label="anchor" href="#looking-at-the-hia"><i class="fas fa-link"></i></a>
</h4>
<p>Here is a view of the data zooming in on Trondheim</p>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myBB</span> <span class="op">&lt;-</span> <span class="fu">st_bbox</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>xmin<span class="op">=</span><span class="fl">260520.12</span>, xmax <span class="op">=</span> <span class="fl">278587.56</span>,</span>
<span>                ymin <span class="op">=</span> <span class="fl">7032142.5</span>, ymax <span class="op">=</span> <span class="fl">7045245.27</span><span class="op">)</span>,</span>
<span>                crs <span class="op">=</span> <span class="fu">st_crs</span><span class="op">(</span><span class="va">HIA_regions</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Cropping the raster to the bbox</p>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HIA_trd</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crop.html">st_crop</a></span><span class="op">(</span><span class="va">HIA_regions</span>, <span class="va">myBB</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: attribute variables are assumed to be spatially</span></span>
<span><span class="co">#&gt; constant throughout all geometries</span></span></code></pre></div>
<p>Get map of major roads, for context</p>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hw_utm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"data/cache/highways_trondheim.rds"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">HIA_trd</span> <span class="op">&lt;-</span> <span class="fu">tm_shape</span><span class="op">(</span><span class="va">HIA_trd</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_polygons</span><span class="op">(</span>col <span class="op">=</span> <span class="st">"infrastructureIndex"</span>,</span>
<span>    title<span class="op">=</span><span class="st">"Infrastructure index\n(modified 4-step scale)"</span>,</span>
<span>    palette <span class="op">=</span> <span class="st">"-viridis"</span>,</span>
<span>    style<span class="op">=</span><span class="st">"cat"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_layout</span><span class="op">(</span>legend.outside <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_shape</span><span class="op">(</span><span class="va">hw_utm</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_lines</span><span class="op">(</span>col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_shape</span><span class="op">(</span><span class="va">outline</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_borders</span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-67"></span>
<img src="slitasje_files/figure-html/unnamed-chunk-67-1.png" alt="A closer look at the HIA designation over Trondheim" width="672"><p class="caption">
Figure 3.23: A closer look at the HIA designation over Trondheim
</p>
</div>
<p>Let’s calculate the areas of these polygons and compare the HIF in the
five regions.</p>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HIA_regions</span><span class="op">$</span><span class="va">area</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html">st_area</a></span><span class="op">(</span><span class="va">HIA_regions</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">HIA_regions</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">region</span>, <span class="va">infrastructureIndex</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>area <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'region'. You can</span></span>
<span><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">temp</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">region</span>, y <span class="op">=</span> <span class="va">area</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">infrastructureIndex</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"stack"</span>, stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">guides</span><span class="op">(</span>fill <span class="op">=</span> <span class="fu">guide_legend</span><span class="op">(</span><span class="st">"HIF"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:HIF-region"></span>
<img src="slitasje_files/figure-html/HIF-region-1.png" alt="Stacked barplot showing the distribution of human impact factor across five regions in Norway." width="672"><p class="caption">
Figure 3.24: Stacked barplot showing the distribution of human impact factor across five regions in Norway.
</p>
</div>
<p>The figure above shows that <em>Nord-Norge</em> for example, has a lot of
relatively untouched areas, and that <em>Østlandet</em> has the highest
proportion of impacted areas. This is expected.</p>
</div>
</div>
<div id="spread-slitasje" class="section level3" number="3.8.4">
<h3>
<span class="header-section-number">3.8.4</span> Aggregate and spread (extrapolate)<a class="anchor" aria-label="anchor" href="#spread-slitasje"><i class="fas fa-link"></i></a>
</h3>
<p>I now want to find the mean indicator value for each HIA (i.e. to
aggregate) and to spread these out spatially to the entire HIA within
each region (i.e. to extrapolate).</p>
<p>I want to add a threshold so that we don’t end up over extrapolating
based on too few data points. I have previousl used 150 data pionts, and I think that was about right.</p>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wetlands_slitasje_extr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ninanor.github.io/eaTools/reference/ea_spread.html">ea_spread</a></span><span class="op">(</span>indicator_data <span class="op">=</span> <span class="va">wetlands</span>,</span>
<span>                         indicator <span class="op">=</span> <span class="va">i_2020</span>,</span>
<span>                         regions <span class="op">=</span> <span class="va">HIA_regions</span>,</span>
<span>                         groups <span class="op">=</span> <span class="va">region_HIF</span>,</span>
<span>                         threshold <span class="op">=</span> <span class="fl">150</span><span class="op">)</span></span>
<span></span>
<span><span class="va">seminat_slitasje_extr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ninanor.github.io/eaTools/reference/ea_spread.html">ea_spread</a></span><span class="op">(</span>indicator_data <span class="op">=</span> <span class="va">seminat</span>,</span>
<span>                         indicator <span class="op">=</span> <span class="va">i_2020</span>,</span>
<span>                         regions <span class="op">=</span> <span class="va">HIA_regions</span>,</span>
<span>                         groups <span class="op">=</span> <span class="va">region_HIF</span>,</span>
<span>                         threshold <span class="op">=</span> <span class="fl">150</span><span class="op">)</span></span>
<span></span>
<span><span class="va">natOpen_slitasje_extr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ninanor.github.io/eaTools/reference/ea_spread.html">ea_spread</a></span><span class="op">(</span>indicator_data <span class="op">=</span> <span class="va">natOpen</span>,</span>
<span>                         indicator <span class="op">=</span> <span class="va">i_2020</span>,</span>
<span>                         regions <span class="op">=</span> <span class="va">HIA_regions</span>,</span>
<span>                         groups <span class="op">=</span> <span class="va">region_HIF</span>,</span>
<span>                         threshold <span class="op">=</span> <span class="fl">150</span><span class="op">)</span></span>
<span><span class="co">#saveRDS(wetlands_slitasje_extr, "/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/cache/wetlands_slitasje_extr.rds")</span></span>
<span><span class="co">#saveRDS(seminat_slitasje_extr,  "/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/cache/seminat_slitasje_extr.rds")</span></span>
<span><span class="co">#saveRDS(natOpen_slitasje_extr,  "/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/cache/natOpen_slitasje_extr.rds")</span></span></code></pre></div>
<p>It’s easier to see what’s happening if we zoom in a bit. Lets get a
boundary box around Trondheim.</p>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myBB</span> <span class="op">&lt;-</span> <span class="fu">st_bbox</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>xmin<span class="op">=</span><span class="fl">260520.12</span>, xmax <span class="op">=</span> <span class="fl">278587.56</span>,</span>
<span>                ymin <span class="op">=</span> <span class="fl">7032142.5</span>, ymax <span class="op">=</span> <span class="fl">7045245.27</span><span class="op">)</span>,</span>
<span>                crs <span class="op">=</span> <span class="fu">st_crs</span><span class="op">(</span><span class="va">wetlands_slitasje_extr</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Cropping the data to the bbox</p>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wetlands_slitasje_extr_trd</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crop.html">st_crop</a></span><span class="op">(</span><span class="va">wetlands_slitasje_extr</span>, <span class="va">myBB</span><span class="op">)</span></span>
<span><span class="va">seminat_slitasje_extr_trd</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crop.html">st_crop</a></span><span class="op">(</span><span class="va">seminat_slitasje_extr</span>, <span class="va">myBB</span><span class="op">)</span></span>
<span><span class="va">natOpen_slitasje_extr_trd</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crop.html">st_crop</a></span><span class="op">(</span><span class="va">natOpen_slitasje_extr</span>, <span class="va">myBB</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myCol</span> <span class="op">&lt;-</span> <span class="st">"RdYlGn"</span></span>
<span><span class="fu">tmap_arrange</span><span class="op">(</span></span>
<span><span class="fu">tm_shape</span><span class="op">(</span><span class="va">wetlands_slitasje_extr_trd</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_polygons</span><span class="op">(</span>col <span class="op">=</span> <span class="st">"w_mean"</span>,</span>
<span>    title<span class="op">=</span><span class="st">"Indicator value"</span>,</span>
<span>    palette <span class="op">=</span> <span class="va">myCol</span>,</span>
<span>    style<span class="op">=</span><span class="st">"cont"</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_layout</span><span class="op">(</span>legend.outside <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_shape</span><span class="op">(</span><span class="va">hw_utm</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_lines</span><span class="op">(</span>col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_layout</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Wetland"</span><span class="op">)</span>,</span>
<span></span>
<span><span class="fu">tm_shape</span><span class="op">(</span><span class="va">seminat_slitasje_extr_trd</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_polygons</span><span class="op">(</span>col <span class="op">=</span> <span class="st">"w_mean"</span>,</span>
<span>    title<span class="op">=</span><span class="st">"Indicator value"</span>,</span>
<span>    palette <span class="op">=</span> <span class="va">myCol</span>,</span>
<span>    style<span class="op">=</span><span class="st">"cont"</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_layout</span><span class="op">(</span>legend.outside <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_shape</span><span class="op">(</span><span class="va">hw_utm</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_lines</span><span class="op">(</span>col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_layout</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Semi-natural areas"</span><span class="op">)</span>,</span>
<span></span>
<span><span class="fu">tm_shape</span><span class="op">(</span><span class="va">natOpen_slitasje_extr_trd</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_polygons</span><span class="op">(</span>col <span class="op">=</span> <span class="st">"w_mean"</span>,</span>
<span>    title<span class="op">=</span><span class="st">"Indicator value"</span>,</span>
<span>    palette <span class="op">=</span> <span class="va">myCol</span>,</span>
<span>    style<span class="op">=</span><span class="st">"cont"</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_layout</span><span class="op">(</span>legend.outside <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_shape</span><span class="op">(</span><span class="va">hw_utm</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_lines</span><span class="op">(</span>col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_layout</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Naturally open areas"</span><span class="op">)</span>,</span>
<span><span class="va">HIA_trd</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:extrapolated-slitasje"></span>
<img src="slitasje_files/figure-html/extrapolated-slitasje-1.png" alt="ADSV indicator extrapolated over Trondheim, with one map for each ecosystem. The map is not masked against ecosystem delineation maps, which make them easy to missinterpret." width="672"><p class="caption">
Figure 3.25: ADSV indicator extrapolated over Trondheim, with one map for each ecosystem. The map is not masked against ecosystem delineation maps, which make them easy to missinterpret.
</p>
</div>
<p>Note that for wetland and semi-natural areas we did not
extrapolate values for the most urban areas, and that for naturally open
areas we did not extrapolate to the least affected areas.
For the other regions we generally excluded more HIFs.</p>
<blockquote>
<p><em>The maps above are easy to misunderstand, and they should therefor be
communicated with caution. They should be considered as temporary
files or as by-products.</em></p>
</blockquote>
<p>The next step now is to</p>
<ol style="list-style-type: decimal">
<li><p>Prepare ecosystem delineation maps in EPSG25833 and perfectly aligned to a master grid</p></li>
<li><p>Rasterize the extrapolated indicator map, using the ET map as a template (see Fig. @ref(fig:#masking-example))</p></li>
<li><p>and mask it using the perfectly aligned ET map.</p></li>
</ol>
<p>A faster way could be to:</p>
<ol style="list-style-type: decimal">
<li><p>Draw <em>n</em> random point samples from the ET map, and</p></li>
<li><p>extract indicator values at those points (from the extrapolated
indicator map (a stars object)).</p></li>
</ol>
<p>… but his will not provide spatially explicit indicator values for the
entire ecosystem delineation.</p>
</div>
<div id="ecosystem-map" class="section level3" number="3.8.5">
<h3>
<span class="header-section-number">3.8.5</span> Ecosystem map<a class="anchor" aria-label="anchor" href="#ecosystem-map"><i class="fas fa-link"></i></a>
</h3>
<p>See <a href="https://github.com/NINAnor/ecosystemCondition/issues/34">here</a>.</p>
</div>
<div id="aggregate-to-region" class="section level3" number="3.8.6">
<h3>
<span class="header-section-number">3.8.6</span> Aggregate to region<a class="anchor" aria-label="anchor" href="#aggregate-to-region"><i class="fas fa-link"></i></a>
</h3>
<p>We need to aggreate the ET occurence and their indicator values, to a
regional delineation. This functionality can be developed in <code>eaTools</code>,
but will in any case build around <code>exactextratr::exact_extract()</code>.</p>
<p>To carry the errors, we can for example
produce distributions for the indicator values for each ET
occurrence (or groups of them) and resample the distributions with an
area weighting.</p>
</div>
<div id="uncertainty-1" class="section level3" number="3.8.7">
<h3>
<span class="header-section-number">3.8.7</span> Uncertainty<a class="anchor" aria-label="anchor" href="#uncertainty-1"><i class="fas fa-link"></i></a>
</h3>
<p>The calculations of indicator uncertainty is done with bootstrapping, as
is described in eaTools.</p>
</div>
</div>
<div id="eksport-files-final-product" class="section level2" number="3.9">
<h2>
<span class="header-section-number">3.9</span> Eksport files (final product)<a class="anchor" aria-label="anchor" href="#eksport-files-final-product"><i class="fas fa-link"></i></a>
</h2>
<p>According to the workflow specifications, I will export the indicator
map at its highest resolution, for use in various web interfaces etc.
For the finest resolution indicator map I will not include columns for
uncertainty (because this will only be estimated at the aggregated
level), or reference levels (because there is no spatial variation).</p>
<p>I can also export a map of the indicator where we extrapolate the
indicator values to the homogeneous areas (e.g. Fig. <a href="slitasje.html#fig:extrapolated-slitasje">3.25</a> . This map should be
interpreted with caution, since they appear as providing explicit indicator
values for areas where there is no data. This map is mainly for
aggregation purposes. I will mark this map with the prefix
<em>homogeneous-areas</em>. I will also export this same map after masking it
with the ET map, and this output must come with the same disclaimers.</p>
<p>Finally I will export a map of the five accounting areas with
wall-to-wall indicator value and errors (e.g. Fig <a href="median-summer-temp.html#fig:wall-to-wall-summer-temp-indicator">4.6</a>). This map can also contain data
covering other ETs. Otherwise the maps would not we visually
interpretative.</p>
<div id="adsv-in-wetlands" class="section level3" number="3.9.1">
<h3>
<span class="header-section-number">3.9.1</span> ADSV in wetlands<a class="anchor" aria-label="anchor" href="#adsv-in-wetlands"><i class="fas fa-link"></i></a>
</h3>
<p>This is how I plan to export the final product.</p>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># keep col names short and standardized</span></span>
<span><span class="va">exp_wetland</span> <span class="op">&lt;-</span> <span class="va">...</span></span></code></pre></div>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="slitasje.html#cb120-1" aria-hidden="true" tabindex="-1"></a>exp_wetland_HIAextrapolated <span class="ot">&lt;-</span> …</span></code></pre></div>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="slitasje.html#cb121-1" aria-hidden="true" tabindex="-1"></a>exp_wetland_AAextrapolated <span class="ot">&lt;-</span> …</span></code></pre></div>
<p>Write to file</p>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">st_write</span><span class="op">(</span><span class="va">exp_wetland</span>, <span class="st">"indicators/indicatorMaps/slitasje/wetland_slitasje.shp"</span>,</span>
<span>         append <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">st_write</span><span class="op">(</span><span class="va">exp_wetlandHIAextrapolated</span>, </span>
<span>         <span class="st">"indicators/indicatorMaps/extrapolated_to_homogeneous_areas/slitasje/homogeneous_areas_wetland_slitasje.shp"</span>,</span>
<span>         append <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">st_write</span><span class="op">(</span><span class="va">exp_wetland</span>, <span class="st">"indicators/indicatorMaps/extrapolated_to_accounting_areas/slitasje/accounting_areas_wetland_slitasje.shp"</span>,</span>
<span>         append <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="nature-index-product.html"><span class="header-section-number">2</span> Nature index product</a></div>
<div class="next"><a href="median-summer-temp.html"><span class="header-section-number">4</span> Median Summer Temperature</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#slitasje"><span class="header-section-number">3</span> Anthropogenic disturbance to soils and vegetation (ADSV)</a></li>
<li><a class="nav-link" href="#introduction-1"><span class="header-section-number">3.1</span> Introduction</a></li>
<li>
<a class="nav-link" href="#about-the-underlying-data-1"><span class="header-section-number">3.2</span> About the underlying data</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#representativity-in-time-and-space-1"><span class="header-section-number">3.2.1</span> Representativity in time and space</a></li>
<li><a class="nav-link" href="#original-units-1"><span class="header-section-number">3.2.2</span> Original units</a></li>
<li><a class="nav-link" href="#temoporal-sli"><span class="header-section-number">3.2.3</span> Temporal coverage</a></li>
<li><a class="nav-link" href="#aditional-comments-about-the-dataset-1"><span class="header-section-number">3.2.4</span> Aditional comments about the dataset</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#ecosystem-characteristic-2"><span class="header-section-number">3.3</span> Ecosystem characteristic</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#norwegain-standard-1"><span class="header-section-number">3.3.1</span> Norwegain standard</a></li>
<li><a class="nav-link" href="#un-standard"><span class="header-section-number">3.3.2</span> UN standard</a></li>
</ul>
</li>
<li><a class="nav-link" href="#collinearities-with-other-indicators-2"><span class="header-section-number">3.4</span> Collinearities with other indicators</a></li>
<li>
<a class="nav-link" href="#reference-condition-and-values-1"><span class="header-section-number">3.5</span> Reference condition and values</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#reference-condition-1"><span class="header-section-number">3.5.1</span> Reference condition</a></li>
<li><a class="nav-link" href="#reference-values-thresholds-for-defining-good-ecological-condition-minimum-andor-maximum-values-1"><span class="header-section-number">3.5.2</span> Reference values, thresholds for defining good ecological condition, minimum and/or maximum values</a></li>
</ul>
</li>
<li><a class="nav-link" href="#uncertainties-1"><span class="header-section-number">3.6</span> Uncertainties</a></li>
<li><a class="nav-link" href="#references-2"><span class="header-section-number">3.7</span> References</a></li>
<li>
<a class="nav-link" href="#analyses-1"><span class="header-section-number">3.8</span> Analyses</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#data-sets-1"><span class="header-section-number">3.8.1</span> Data sets</a></li>
<li><a class="nav-link" href="#scale-slitasje-ind"><span class="header-section-number">3.8.2</span> Scaled indicator values</a></li>
<li><a class="nav-link" href="#HIA-slitasje"><span class="header-section-number">3.8.3</span> Homogeneous impact areas</a></li>
<li><a class="nav-link" href="#spread-slitasje"><span class="header-section-number">3.8.4</span> Aggregate and spread (extrapolate)</a></li>
<li><a class="nav-link" href="#ecosystem-map"><span class="header-section-number">3.8.5</span> Ecosystem map</a></li>
<li><a class="nav-link" href="#aggregate-to-region"><span class="header-section-number">3.8.6</span> Aggregate to region</a></li>
<li><a class="nav-link" href="#uncertainty-1"><span class="header-section-number">3.8.7</span> Uncertainty</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#eksport-files-final-product"><span class="header-section-number">3.9</span> Eksport files (final product)</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#adsv-in-wetlands"><span class="header-section-number">3.9.1</span> ADSV in wetlands</a></li></ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/NINAnor/ecosystemCondition/blob/master/slitasje.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/NINAnor/ecosystemCondition/edit/master/slitasje.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Indicators for Ecosystem Condition in Norway</strong>" was written by Anders L. Kolstad. It was last built on 2023-10-13.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
