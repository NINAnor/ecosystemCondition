<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 19 Homogeneous Impact Areas | Indicators for Ecosystem Condition in Norway</title>
<meta name="author" content="Anders L. Kolstad">
<meta name="description" content="Author and date: Anders Kolstad   19.1 Introduction This chapter documents the creation of a wall-to-wall map of homogeneous impact areas in Norway. The map is produced by binning values in the...">
<meta name="generator" content="bookdown 0.33 with bs4_book()">
<meta property="og:title" content="Chapter 19 Homogeneous Impact Areas | Indicators for Ecosystem Condition in Norway">
<meta property="og:type" content="book">
<meta property="og:url" content="https://ninanor.github.io/ecosystemCondition/index.html/homogeneous-impact-areas.html">
<meta property="og:image" content="https://ninanor.github.io/ecosystemCondition/index.html/images/Picture1.png">
<meta property="og:description" content="Author and date: Anders Kolstad   19.1 Introduction This chapter documents the creation of a wall-to-wall map of homogeneous impact areas in Norway. The map is produced by binning values in the...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 19 Homogeneous Impact Areas | Indicators for Ecosystem Condition in Norway">
<meta name="twitter:description" content="Author and date: Anders Kolstad   19.1 Introduction This chapter documents the creation of a wall-to-wall map of homogeneous impact areas in Norway. The map is produced by binning values in the...">
<meta name="twitter:image" content="https://ninanor.github.io/ecosystemCondition/index.html/images/Picture1.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="libs/tabwid-1.1.3/tabwid.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.6.1/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.27/datatables.js"></script><link href="libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Indicators for Ecosystem Condition in Norway</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">About </a></li>
<li class="book-part">INDICATORS</li>
<li><a class="" href="gjengroing.html"><span class="header-section-number">1</span> Enchroachment</a></li>
<li><a class="" href="nature-index-product.html"><span class="header-section-number">2</span> Nature index product</a></li>
<li><a class="" href="slitasje.html"><span class="header-section-number">3</span> Anthropogenic disturbance to soils and vegetation (ADSV)</a></li>
<li><a class="" href="median-summer-temp.html"><span class="header-section-number">4</span> Median Summer Temperature</a></li>
<li><a class="" href="alien-species.html"><span class="header-section-number">5</span> Alien species</a></li>
<li><a class="" href="functional-plant-indicators-wetland.html"><span class="header-section-number">6</span> Functional Plant Indicators - Wetlands</a></li>
<li><a class="" href="functional-plant-indicators-seminat.html"><span class="header-section-number">7</span> Functional Plant Indicators - Semi-Natural Ecosystems</a></li>
<li><a class="" href="functional-plant-indicators-open.html"><span class="header-section-number">8</span> Functional Plant Indicators - Naturally Open Ecosystems</a></li>
<li><a class="" href="trophic-level-biomass-ratios.html"><span class="header-section-number">9</span> Trophic level biomass ratios</a></li>
<li><a class="" href="insect-indicators.html"><span class="header-section-number">10</span> Insect indicators</a></li>
<li><a class="" href="flood-frequency.html"><span class="header-section-number">11</span> Flood frequency</a></li>
<li class="book-part">R &amp; D</li>
<li><a class="" href="NDVI-indicator-natopen.html"><span class="header-section-number">12</span> NDVI - Naturally Open Ecosystems</a></li>
<li><a class="" href="NDVI-indicator-seminat.html"><span class="header-section-number">13</span> NDVI - Semi-natural Ecosystems</a></li>
<li><a class="" href="NDVI-indicator-wetland.html"><span class="header-section-number">14</span> NDVI - wetland ecosystems</a></li>
<li class="book-part">INDICATORS FROM THE ALPINE ASSESSMENT</li>
<li><a class="" href="areal-av-isbreer.html"><span class="header-section-number">15</span> Areal av isbreer</a></li>
<li class="book-part">DEPRECATED</li>
<li><a class="" href="areal-uten-d%C3%B8d-eller-skadet-r%C3%B8sslyng-i-kystlynghei.html"><span class="header-section-number">16</span> Areal uten død eller skadet røsslyng i kystlynghei</a></li>
<li class="book-part">GENERAL TOPICS</li>
<li><a class="" href="naturtype.html"><span class="header-section-number">17</span> Nature types</a></li>
<li><a class="" href="scaling-functions.html"><span class="header-section-number">18</span> Scaling functions</a></li>
<li><a class="active" href="homogeneous-impact-areas.html"><span class="header-section-number">19</span> Homogeneous Impact Areas</a></li>
<li><a class="" href="master-grid.html"><span class="header-section-number">20</span> Master grid</a></li>
<li><a class="" href="climate-indicators-explained.html"><span class="header-section-number">21</span> Climate indicators explained</a></li>
<li><a class="" href="oversikt-over-indikatorforslag.html"><span class="header-section-number">22</span> Oversikt over indikatorforslag</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/NINAnor/ecosystemCondition">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="homogeneous-impact-areas" class="section level1" number="19">
<h1>
<span class="header-section-number">19</span> Homogeneous Impact Areas<a class="anchor" aria-label="anchor" href="#homogeneous-impact-areas"><i class="fas fa-link"></i></a>
</h1>
<p><br></p>
<p><em>Author and date:</em></p>
<p>Anders Kolstad</p>
<p><br></p>
<!-- Load all your dependencies here -->
<div id="intro-hia" class="section level2" number="19.1">
<h2>
<span class="header-section-number">19.1</span> Introduction<a class="anchor" aria-label="anchor" href="#intro-hia"><i class="fas fa-link"></i></a>
</h2>
<p>This chapter documents the creation of a wall-to-wall map of homogeneous impact areas in Norway.
The map is produced by binning values in the infrastructure index into four discrete categories.
It is likely to be a good predictor for some indicators, such as <a href="slitasje.html#slitasje"><em>slitasje</em></a> and the presence of <a href="alien-species.html#alien-species"><em>alien species</em></a>.</p>
</div>
<div id="about-the-underlying-data-6" class="section level2" number="19.2">
<h2>
<span class="header-section-number">19.2</span> About the underlying data<a class="anchor" aria-label="anchor" href="#about-the-underlying-data-6"><i class="fas fa-link"></i></a>
</h2>
<p>The infrastructure index is explained <a href="https://brage.nina.no/nina-xmlui/handle/11250/2983607">here</a>.
It is a wall-to-wall raster over Norway with 100 m resolution.
Each pixel is given a value along a continuous gradient from 0 to around 15.4, representing the frequency of surrounding cells within 500 m with human infrastructure (houses, roads, ect).</p>
<div id="representativity-in-time-and-space-7" class="section level3" number="19.2.1">
<h3>
<span class="header-section-number">19.2.1</span> Representativity in time and space<a class="anchor" aria-label="anchor" href="#representativity-in-time-and-space-7"><i class="fas fa-link"></i></a>
</h3>
<p>The infrastructure index is calculated with data that have slightly different dates, but can be said to represent year 2015.
The data covers all of mainland Norway.</p>
</div>
<div id="references-12" class="section level3" number="19.2.2">
<h3>
<span class="header-section-number">19.2.2</span> References<a class="anchor" aria-label="anchor" href="#references-12"><i class="fas fa-link"></i></a>
</h3>
<p>Bakkestuen, V., Dervo, B.K., Bærum, K.M. og Erikstad, L. 2022.
Prediksjonsmodellering av naturtyper i ferskvann.
NINA Rapport 2079.
Norsk institutt for naturforskning.</p>
</div>
</div>
<div id="analyses-6" class="section level2" number="19.3">
<h2>
<span class="header-section-number">19.3</span> Analyses<a class="anchor" aria-label="anchor" href="#analyses-6"><i class="fas fa-link"></i></a>
</h2>
<div id="import-data" class="section level3" number="19.3.1">
<h3>
<span class="header-section-number">19.3.1</span> Import data<a class="anchor" aria-label="anchor" href="#import-data"><i class="fas fa-link"></i></a>
</h3>
<p>The path must be conditional:</p>
<div class="sourceCode" id="cb705"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, <span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb706"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">dir</span> <span class="op">==</span> <span class="st">"C:"</span>, </span>
<span>        <span class="st">"R:/GeoSpatialData/Utility_governmentalServices/Norway_Infrastructure_Index/Original/Infrastrukturindeks_UTM33/infra_tiff.tif"</span>,</span>
<span>        <span class="st">"/data/R/GeoSpatialData/Utility_governmentalServices/Norway_Infrastructure_Index/Original/Infrastrukturindeks_UTM33/infra_tiff.tif"</span><span class="op">)</span></span></code></pre></div>
<p>Import a stars proxy (no data imported yet)</p>
<div class="sourceCode" id="cb707"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">infra</span> <span class="op">&lt;-</span> <span class="fu">stars</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/stars/reference/read_stars.html">read_stars</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span></span></code></pre></div>
<p>Print the coordinate reference system:</p>
<div class="sourceCode" id="cb708"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">st_crs</span><span class="op">(</span><span class="va">infra</span><span class="op">)</span><span class="op">$</span><span class="va">input</span></span>
<span><span class="co">#&gt; [1] "WGS_1984_UTM_Zone_33N"</span></span></code></pre></div>
</div>
<div id="trondheim-example" class="section level3" number="19.3.2">
<h3>
<span class="header-section-number">19.3.2</span> Trondheim example<a class="anchor" aria-label="anchor" href="#trondheim-example"><i class="fas fa-link"></i></a>
</h3>
<p>It’s easier to see what’s happening if we zoom in a bit.
Lets get a boundary box around Trondheim.</p>
<div class="sourceCode" id="cb709"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myBB</span> <span class="op">&lt;-</span> <span class="fu">st_bbox</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>xmin<span class="op">=</span><span class="fl">260520.12</span>, xmax <span class="op">=</span> <span class="fl">278587.56</span>,</span>
<span>                ymin <span class="op">=</span> <span class="fl">7032142.5</span>, ymax <span class="op">=</span> <span class="fl">7045245.27</span><span class="op">)</span>,</span>
<span>                crs <span class="op">=</span> <span class="fu">st_crs</span><span class="op">(</span><span class="va">infra</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Cropping the raster to the bbox</p>
<div class="sourceCode" id="cb710"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">infra_trd</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crop.html">st_crop</a></span><span class="op">(</span><span class="va">infra</span>, <span class="va">myBB</span><span class="op">)</span></span></code></pre></div>
<div id="get-osm-highways" class="section level4" number="19.3.2.1">
<h4>
<span class="header-section-number">19.3.2.1</span> Get OSM highways<a class="anchor" aria-label="anchor" href="#get-osm-highways"><i class="fas fa-link"></i></a>
</h4>
<p>Lets download some base maps to help validate and contextualize the infrastructure index.</p>
<p>Transform to lat long due to osm requirements</p>
<div class="sourceCode" id="cb711"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">infra_trd_ll</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">infra_trd</span>, <span class="fl">4326</span><span class="op">)</span></span></code></pre></div>
<p>Get the boundary box of the cropped raster</p>
<div class="sourceCode" id="cb712"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myBB_ll</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html">st_bbox</a></span><span class="op">(</span><span class="va">infra_trd_ll</span><span class="op">)</span></span></code></pre></div>
<p>Download highways using the above bbox.</p>
<div class="sourceCode" id="cb713"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hw</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">osmplotr</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/osmplotr/reference/extract_osm_objects.html">extract_osm_objects</a></span><span class="op">(</span></span>
<span>    bbox <span class="op">=</span> <span class="va">myBB_ll</span>,</span>
<span>    key <span class="op">=</span> <span class="st">"highway"</span>,</span>
<span>    sf <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p>Transforming highway data back into utm, although not strictly necessary.</p>
<div class="sourceCode" id="cb714"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hw_utm</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">hw</span>, <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="va">infra_trd</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p>This object contains too many roads (about 30k).
I’ll take out the unnamed roads.</p>
<div class="sourceCode" id="cb715"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hw_utm</span> <span class="op">&lt;-</span> <span class="va">hw_utm</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">hw_utm</span><span class="op">$</span><span class="va">name</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
</div>
<div id="discretize" class="section level4" number="19.3.2.2">
<h4>
<span class="header-section-number">19.3.2.2</span> Discretize<a class="anchor" aria-label="anchor" href="#discretize"><i class="fas fa-link"></i></a>
</h4>
<p>Here I define a simplified categorical typology for the infrastructure index using four classes.</p>
<div class="sourceCode" id="cb716"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">infra_trd</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"infrastructureIndex"</span></span>
<span><span class="va">infra_trd_reclassed</span> <span class="op">&lt;-</span>  <span class="va">infra_trd</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>infrastructureIndex <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">infrastructureIndex</span> <span class="op">&lt;</span> <span class="fl">1</span> <span class="op">~</span> <span class="fl">0</span>,</span>
<span>    <span class="va">infrastructureIndex</span> <span class="op">&lt;</span> <span class="fl">6</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>    <span class="va">infrastructureIndex</span> <span class="op">&lt;</span> <span class="fl">12</span> <span class="op">~</span> <span class="fl">2</span>,</span>
<span>    <span class="va">infrastructureIndex</span> <span class="op">&gt;=</span> <span class="fl">12</span> <span class="op">~</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Lets plot these two maps side by side</p>
<div class="sourceCode" id="cb717"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">map_trd_reclassed</span> <span class="op">&lt;-</span> <span class="fu">tm_shape</span><span class="op">(</span><span class="va">infra_trd_reclassed</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_raster</span><span class="op">(</span>title<span class="op">=</span><span class="st">"Infrastructure Index"</span>,</span>
<span>            <span class="co">#palette = "viridis",</span></span>
<span>            style<span class="op">=</span><span class="st">"cat"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_layout</span><span class="op">(</span>legend.outside <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_shape</span><span class="op">(</span><span class="va">hw_utm</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_lines</span><span class="op">(</span>col<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb718"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">map_trd</span> <span class="op">&lt;-</span> <span class="fu">tm_shape</span><span class="op">(</span><span class="va">infra_trd</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_raster</span><span class="op">(</span>title<span class="op">=</span><span class="st">"Infrastructure Index"</span>,</span>
<span>            style<span class="op">=</span><span class="st">"cont"</span>,</span>
<span>            palette <span class="op">=</span> <span class="st">"viridis"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_layout</span><span class="op">(</span>legend.outside <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_shape</span><span class="op">(</span><span class="va">hw_utm</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_lines</span><span class="op">(</span>col<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb719"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tmap_arrange</span><span class="op">(</span><span class="va">map_trd</span>,</span>
<span>             <span class="va">map_trd_reclassed</span>,</span>
<span>             ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; stars_proxy object shown at 181 by 132 cells.</span></span>
<span><span class="co">#&gt; stars_proxy object shown at 181 by 132 cells.</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-17"></span>
<img src="homogeneous_impact_areas_files/figure-html/unnamed-chunk-17-1.png" alt="Infrastructure index over Trondheim, comparing the continous scale with the ordinal four-step scale. Major roads are in white." width="672"><p class="caption">
Figure 17.4: Infrastructure index over Trondheim, comparing the continous scale with the ordinal four-step scale. Major roads are in white.
</p>
</div>
<p>I tweaked the thresholds for the bins so that the categories match my knowledge about the land use intensity in Trondheim, for example that most of the forest next to Trondheim (to the left in the map) was in the second lowest class.
This looks pretty good to me.
It depicts a gradient in human presence from high within the built zone, to <em>no to very low</em> in the forests and mountains to the west.
Note that there is still considerable human activity also there in the form of outdoor recreation and even forestry.</p>
</div>
<div id="aggregate" class="section level4" number="19.3.2.3">
<h4>
<span class="header-section-number">19.3.2.3</span> Aggregate<a class="anchor" aria-label="anchor" href="#aggregate"><i class="fas fa-link"></i></a>
</h4>
<p>The resolution in this map is more than we need, and the size of the data implies that the next step, the vectorization, would take too long.
We therefore aggregate, or reduce the resolution.</p>
<div class="sourceCode" id="cb720"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dim</span> <span class="op">&lt;-</span> <span class="fu">st_dimensions</span><span class="op">(</span><span class="va">infra</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Resolution is"</span>, <span class="va">dim</span><span class="op">$</span><span class="va">x</span><span class="op">$</span><span class="va">delta</span>, <span class="st">"by"</span>, <span class="va">dim</span><span class="op">$</span><span class="va">x</span><span class="op">$</span><span class="va">delta</span>, <span class="st">"meters"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Resolution is 100 by 100 meters"</span></span></code></pre></div>
<div class="sourceCode" id="cb721"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">infra_trd_reclassed_agg</span> <span class="op">&lt;-</span> <span class="fu">st_warp</span><span class="op">(</span><span class="va">infra_trd_reclassed</span>, cellsize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">1000</span><span class="op">)</span>, </span>
<span>                                   crs <span class="op">=</span> <span class="fu">st_crs</span><span class="op">(</span><span class="va">infra_trd_reclassed</span><span class="op">)</span>, </span>
<span>                                   use_gdal <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                   method <span class="op">=</span> <span class="st">"average"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb722"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dim</span> <span class="op">&lt;-</span> <span class="fu">st_dimensions</span><span class="op">(</span><span class="va">infra_trd_reclassed_agg</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Resolution is"</span>, <span class="va">dim</span><span class="op">$</span><span class="va">x</span><span class="op">$</span><span class="va">delta</span>, <span class="st">"by"</span>, <span class="va">dim</span><span class="op">$</span><span class="va">x</span><span class="op">$</span><span class="va">delta</span>, <span class="st">"meters"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Resolution is 1000 by 1000 meters"</span></span></code></pre></div>
<p>Each cell is now the average of the aggregated cells, and hence the value is continuous again.
Let’s make it discrete.</p>
<div class="sourceCode" id="cb723"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">infra_trd_reclassed_agg</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"infrastructureIndex"</span></span>
<span><span class="va">infra_trd_reclassed_agg</span> <span class="op">&lt;-</span>  <span class="va">infra_trd_reclassed_agg</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>infrastructureIndex <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">infrastructureIndex</span> <span class="op">&lt;</span> <span class="fl">1</span> <span class="op">~</span> <span class="fl">0</span>,</span>
<span>    <span class="va">infrastructureIndex</span> <span class="op">&lt;</span> <span class="fl">6</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>    <span class="va">infrastructureIndex</span> <span class="op">&lt;</span> <span class="fl">12</span> <span class="op">~</span> <span class="fl">2</span>,</span>
<span>    <span class="va">infrastructureIndex</span> <span class="op">&gt;=</span> <span class="fl">12</span> <span class="op">~</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb724"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tm_shape</span><span class="op">(</span><span class="va">infra_trd_reclassed_agg</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_raster</span><span class="op">(</span>title<span class="op">=</span><span class="st">"Infrastructure Index"</span>,</span>
<span>            style<span class="op">=</span><span class="st">"cat"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_layout</span><span class="op">(</span>legend.outside <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_shape</span><span class="op">(</span><span class="va">hw_utm</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_lines</span><span class="op">(</span>col<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-22"></span>
<img src="homogeneous_impact_areas_files/figure-html/unnamed-chunk-22-1.png" alt="Infrastrcture index over Trondheim on a four-step discrete scale, aggregated to 1x1 km resolution using the mean function." width="672"><p class="caption">
Figure 17.6: Infrastrcture index over Trondheim on a four-step discrete scale, aggregated to 1x1 km resolution using the mean function.
</p>
</div>
<p>This resolution is more than good enough for our purpose here.
I see that the map extends a bit into the fjord. We want to cut away these areas. We can use a map of the outline of Norway to do this.</p>
<div class="sourceCode" id="cb725"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outline</span> <span class="op">&lt;-</span> <span class="fu">st_read</span><span class="op">(</span><span class="st">"data/outlineOfNorway_EPSG25833.shp"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reading layer `outlineOfNorway_EPSG25833' from data source </span></span>
<span><span class="co">#&gt;   `/data/Egenutvikling/41001581_egenutvikling_anders_kolstad/github/ecosystemCondition/data/outlineOfNorway_EPSG25833.shp' </span></span>
<span><span class="co">#&gt;   using driver `ESRI Shapefile'</span></span>
<span><span class="co">#&gt; Simple feature collection with 1 feature and 2 fields</span></span>
<span><span class="co">#&gt; Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -113472.7 ymin: 6448359 xmax: 1114618 ymax: 7939917</span></span>
<span><span class="co">#&gt; Projected CRS: ETRS89 / UTM zone 33N</span></span></code></pre></div>
<p>The CRS needs to be identical</p>
<div class="sourceCode" id="cb726"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">infra_trd_reclassed_agg</span> <span class="op">&lt;-</span> <span class="fu">st_transform</span><span class="op">(</span><span class="va">infra_trd_reclassed_agg</span>, <span class="fl">25833</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb727"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">infra_trd_reclassed_agg_terrestrial</span> <span class="op">&lt;-</span> <span class="fu">st_crop</span><span class="op">(</span><span class="va">infra_trd_reclassed_agg</span>, <span class="va">outline</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in st_crop.stars(infra_trd_reclassed_agg, outline):</span></span>
<span><span class="co">#&gt; crop only crops regular grids</span></span></code></pre></div>
<div class="sourceCode" id="cb728"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tm_shape</span><span class="op">(</span><span class="va">infra_trd_reclassed_agg_terrestrial</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_raster</span><span class="op">(</span>title<span class="op">=</span><span class="st">"Infrastructure Index"</span>,</span>
<span>            style<span class="op">=</span><span class="st">"cat"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_layout</span><span class="op">(</span>legend.outside <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_shape</span><span class="op">(</span><span class="va">hw_utm</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_lines</span><span class="op">(</span>col<span class="op">=</span><span class="st">"white"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_shape</span><span class="op">(</span><span class="va">outline</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_borders</span><span class="op">(</span>lwd <span class="op">=</span><span class="fl">2</span>,</span>
<span>             col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-26"></span>
<img src="homogeneous_impact_areas_files/figure-html/unnamed-chunk-26-1.png" alt="Infrastrcture index over Trondheim on a four-step discrete scale, aggregated to 1x1 km resolution using the mean function." width="672"><p class="caption">
Figure 3.10: Infrastrcture index over Trondheim on a four-step discrete scale, aggregated to 1x1 km resolution using the mean function.
</p>
</div>
<p>I have treated the raster cells as points when cropping, so that cells where the center of the cell is outside the terrestrial delineation are removed. I think this makes the most sense for unbiased area statistics, but some coastal indicator data could also be excluded because of this. The errors would be smaller with a finer resolution raster, but computation time is a problem.</p>
</div>
</div>
<div id="aggregate-the-entire-map-to-1x1-km" class="section level3" number="19.3.3">
<h3>
<span class="header-section-number">19.3.3</span> Aggregate the entire map to 1x1 km<a class="anchor" aria-label="anchor" href="#aggregate-the-entire-map-to-1x1-km"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb729"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># runtime about 30 sec</span></span>
<span><span class="va">infra_agg</span> <span class="op">&lt;-</span> <span class="fu">st_warp</span><span class="op">(</span><span class="va">infra</span>, cellsize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">1000</span><span class="op">)</span>, </span>
<span>                                   crs <span class="op">=</span> <span class="fu">st_crs</span><span class="op">(</span><span class="va">infra</span><span class="op">)</span>, </span>
<span>                                   use_gdal <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                   method <span class="op">=</span> <span class="st">"average"</span><span class="op">)</span></span>
<span><span class="co"># The CRS needs to be identical for st_crop</span></span>
<span><span class="va">infra_agg</span> <span class="op">&lt;-</span> <span class="fu">st_transform</span><span class="op">(</span><span class="va">infra_agg</span>, <span class="fl">25833</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="cut-out-marine-areas" class="section level3" number="19.3.4">
<h3>
<span class="header-section-number">19.3.4</span> Cut out marine areas<a class="anchor" aria-label="anchor" href="#cut-out-marine-areas"><i class="fas fa-link"></i></a>
</h3>
<p>I see that the map extends a bit into the fjord. We want to cut away these areas. We can use a map of the outline of Norway to do this.</p>
<div class="sourceCode" id="cb730"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">infra_agg_terrestrial</span> <span class="op">&lt;-</span> <span class="fu">st_crop</span><span class="op">(</span><span class="va">infra_agg</span>, <span class="va">outline</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">infra_agg_terrestrial</span>, <span class="st">"P:/41201785_okologisk_tilstand_2022_2023/data/cache/infra_agg_terrestrial.rds"</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="discretize-the-entire-map" class="section level3" number="19.3.5">
<h3>
<span class="header-section-number">19.3.5</span> Discretize the entire map<a class="anchor" aria-label="anchor" href="#discretize-the-entire-map"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb731"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">infra_agg_terrestrial</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"infrastructureIndex"</span></span>
<span></span>
<span><span class="va">infra_agg_discrete</span> <span class="op">&lt;-</span> <span class="va">infra_agg_terrestrial</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>infrastructureIndex <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">infrastructureIndex</span> <span class="op">&lt;</span> <span class="fl">1</span> <span class="op">~</span> <span class="fl">0</span>,</span>
<span>    <span class="va">infrastructureIndex</span> <span class="op">&lt;</span> <span class="fl">6</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>    <span class="va">infrastructureIndex</span> <span class="op">&lt;</span> <span class="fl">12</span> <span class="op">~</span> <span class="fl">2</span>,</span>
<span>    <span class="va">infrastructureIndex</span> <span class="op">&gt;=</span> <span class="fl">12</span> <span class="op">~</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="vectorize" class="section level3" number="19.3.6">
<h3>
<span class="header-section-number">19.3.6</span> Vectorize<a class="anchor" aria-label="anchor" href="#vectorize"><i class="fas fa-link"></i></a>
</h3>
<p>This step might seem rather stupid.
We want to vectorize a rather large raster.
This makes it a quite big data object.
The reason is that there is no really good way to burn polygon data on to raster grid cells after the disuse of the <a href="https://rspatial.org/raster">raster</a> package.
It was not straight forward then either.
But calculating intersections between polygons is very fast and easy.</p>
<div class="sourceCode" id="cb732"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">infra_agg_discrete_vect</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">eaTools</span><span class="fu">::</span><span class="fu"><a href="https://ninanor.github.io/eaTools/reference/ea_homogeneous_area.html">ea_homogeneous_area</a></span><span class="op">(</span><span class="va">infra_agg_discrete</span>, </span>
<span>                                groups <span class="op">=</span> <span class="va">infrastructureIndex</span><span class="op">)</span></span>
<span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">dir</span> <span class="op">==</span> <span class="st">"C:"</span>, </span>
<span>        <span class="st">"P:/41201785_okologisk_tilstand_2022_2023/data/cache/"</span>,</span>
<span>        <span class="st">"/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/cache/"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">infra_agg_discrete_vect</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">path</span>, <span class="st">"infra_agg_discrete_vect.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Let’s plot this now.
First, lets crop it to reduce computation time.</p>
<div class="sourceCode" id="cb733"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myBB</span> <span class="op">&lt;-</span> <span class="fu">st_bbox</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>xmin<span class="op">=</span><span class="fl">260520.12</span>, xmax <span class="op">=</span> <span class="fl">278587.56</span>,</span>
<span>                ymin <span class="op">=</span> <span class="fl">7032142.5</span>, ymax <span class="op">=</span> <span class="fl">7045245.27</span><span class="op">)</span>,</span>
<span>                crs <span class="op">=</span> <span class="fu">st_crs</span><span class="op">(</span><span class="va">infra_agg_discrete_vect</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">infra_agg_discrete_vect_trd</span> <span class="op">&lt;-</span> <span class="fu">st_crop</span><span class="op">(</span><span class="va">infra_agg_discrete_vect</span>, <span class="va">myBB</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: attribute variables are assumed to be spatially</span></span>
<span><span class="co">#&gt; constant throughout all geometries</span></span></code></pre></div>
<div class="sourceCode" id="cb734"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tm_shape</span><span class="op">(</span><span class="va">infra_agg_discrete_vect_trd</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_polygons</span><span class="op">(</span>col<span class="op">=</span><span class="st">"infrastructureIndex"</span>,</span>
<span>              style <span class="op">=</span> <span class="st">"cat"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_layout</span><span class="op">(</span>legend.outside <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_shape</span><span class="op">(</span><span class="va">hw_utm</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_lines</span><span class="op">(</span>col<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:test-2"></span>
<img src="homogeneous_impact_areas_files/figure-html/test-2-1.png" alt="A vectorized version of the Infrastructure index over Trondheim on a four-step discrete scale." width="672"><p class="caption">
Figure 19.1: A vectorized version of the Infrastructure index over Trondheim on a four-step discrete scale.
</p>
</div>
<p>As can be seen in the figure above, <code>st_warp</code> merges grid cells that have the same value, and the vectorized raster doesn’t end up being that big in the end.</p>
</div>
</div>
<div id="check-national-distribution" class="section level2" number="19.4">
<h2>
<span class="header-section-number">19.4</span> Check national distribution<a class="anchor" aria-label="anchor" href="#check-national-distribution"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb735"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regions</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">read_sf</a></span><span class="op">(</span><span class="st">"data/regions.shp"</span>, options <span class="op">=</span> <span class="st">"ENCODING=UTF8"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">regions</span><span class="op">$</span><span class="va">region</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Nord-Norge" "Midt-Norge" "Østlandet"  "Vestlandet"</span></span>
<span><span class="co">#&gt; [5] "Sørlandet"</span></span></code></pre></div>
<div class="sourceCode" id="cb736"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">st_crs</span><span class="op">(</span><span class="va">infra_agg_discrete_vect</span><span class="op">)</span> <span class="op">==</span> <span class="fu">st_crs</span><span class="op">(</span><span class="va">regions</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Since the two layers are completely overlapping, we can get the intersections</p>
<div class="sourceCode" id="cb737"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">infra_stats</span> <span class="op">&lt;-</span> <span class="fu">eaTools</span><span class="fu">::</span><span class="fu"><a href="https://ninanor.github.io/eaTools/reference/ea_homogeneous_area.html">ea_homogeneous_area</a></span><span class="op">(</span><span class="va">infra_agg_discrete_vect</span>,</span>
<span>                             <span class="va">regions</span>,</span>
<span>                             keep1 <span class="op">=</span> <span class="st">"infrastructureIndex"</span>,</span>
<span>                             keep2 <span class="op">=</span> <span class="st">"region"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">infra_stats</span>, <span class="st">"P:/41201785_okologisk_tilstand_2022_2023/data/cache/infra_stats.rds"</span><span class="op">)</span></span></code></pre></div>
<p>Let’s calculate the areas of these polygons and compare the HIF in the five regions.</p>
<div class="sourceCode" id="cb738"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">infra_stats</span><span class="op">$</span><span class="va">area_km2</span> <span class="op">&lt;-</span> <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/units/man/drop_units.html">drop_units</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html">st_area</a></span><span class="op">(</span><span class="va">infra_stats</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">infra_stats</span><span class="op">$</span><span class="va">area_km2</span> <span class="op">&lt;-</span> <span class="va">infra_stats</span><span class="op">$</span><span class="va">area_km2</span><span class="op">/</span><span class="fl">1000</span></span>
<span></span>
<span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">infra_stats</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">region</span>, <span class="va">infrastructureIndex</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>area_km2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">area_km2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'region'. You can</span></span>
<span><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span></span>
<span><span class="fu">ggarrange</span><span class="op">(</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="va">temp</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">region</span>, y <span class="op">=</span> <span class="va">area_km2</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">infrastructureIndex</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"stack"</span>, stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">guides</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">xlab</span><span class="op">(</span><span class="st">""</span><span class="op">)</span></span>
<span>  ,</span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="va">temp</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">region</span>, y <span class="op">=</span> <span class="va">area_km2</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">infrastructureIndex</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span>, stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">guides</span><span class="op">(</span>fill <span class="op">=</span> <span class="fu">guide_legend</span><span class="op">(</span><span class="st">"HIF"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">ylab</span><span class="op">(</span><span class="st">"Fraction of total area"</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">xlab</span><span class="op">(</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:HIF-region"></span>
<img src="homogeneous_impact_areas_files/figure-html/HIF-region-1.png" alt="Stacked barplot showing the distribution of human impact factor across five regions in Norway." width="672"><p class="caption">
Figure 3.24: Stacked barplot showing the distribution of human impact factor across five regions in Norway.
</p>
</div>
<p>This distribution looks reasonable. The relative proportions are similar in the five regions, but <em>Østlandet</em> and <em>Sørlandet</em> have more infrastructure in general.</p>
<p>Here are the numbers behind the figure above.</p>
<div class="sourceCode" id="cb739"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp</span><span class="op">$</span><span class="va">area_km2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">temp</span><span class="op">$</span><span class="va">area_km2</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-573cc812c1978f869ee9" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-573cc812c1978f869ee9">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"],["Midt-Norge","Midt-Norge","Midt-Norge","Midt-Norge","Nord-Norge","Nord-Norge","Nord-Norge","Nord-Norge","Sørlandet","Sørlandet","Sørlandet","Sørlandet","Vestlandet","Vestlandet","Vestlandet","Vestlandet","Østlandet","Østlandet","Østlandet","Østlandet"],[0,1,2,3,0,1,2,3,0,1,2,3,0,1,2,3,0,1,2,3],[31390,8661,4604,2005,63009,5979,2417,1504,15199,24127,5731,3257,30533,6988,3683,2258,17242,22154,9760,3295]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>region<\/th>\n      <th>infrastructureIndex<\/th>\n      <th>area_km2<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="exp-hia" class="section level2" number="19.5">
<h2>
<span class="header-section-number">19.5</span> Export<a class="anchor" aria-label="anchor" href="#exp-hia"><i class="fas fa-link"></i></a>
</h2>
<p>I will write this data to the NINA P server.</p>
<div class="sourceCode" id="cb740"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">infra_agg_discrete_vect</span>, <span class="st">"P:/41201785_okologisk_tilstand_2022_2023/data/infrastrukturindeks/homogeneous_impact_areas.rds"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb741"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HIA_returned</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"P:/41201785_okologisk_tilstand_2022_2023/data/infrastrukturindeks/homogeneous_impact_areas.rds"</span><span class="op">)</span></span></code></pre></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="scaling-functions.html"><span class="header-section-number">18</span> Scaling functions</a></div>
<div class="next"><a href="master-grid.html"><span class="header-section-number">20</span> Master grid</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#homogeneous-impact-areas"><span class="header-section-number">19</span> Homogeneous Impact Areas</a></li>
<li><a class="nav-link" href="#intro-hia"><span class="header-section-number">19.1</span> Introduction</a></li>
<li>
<a class="nav-link" href="#about-the-underlying-data-6"><span class="header-section-number">19.2</span> About the underlying data</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#representativity-in-time-and-space-7"><span class="header-section-number">19.2.1</span> Representativity in time and space</a></li>
<li><a class="nav-link" href="#references-12"><span class="header-section-number">19.2.2</span> References</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#analyses-6"><span class="header-section-number">19.3</span> Analyses</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#import-data"><span class="header-section-number">19.3.1</span> Import data</a></li>
<li><a class="nav-link" href="#trondheim-example"><span class="header-section-number">19.3.2</span> Trondheim example</a></li>
<li><a class="nav-link" href="#aggregate-the-entire-map-to-1x1-km"><span class="header-section-number">19.3.3</span> Aggregate the entire map to 1x1 km</a></li>
<li><a class="nav-link" href="#cut-out-marine-areas"><span class="header-section-number">19.3.4</span> Cut out marine areas</a></li>
<li><a class="nav-link" href="#discretize-the-entire-map"><span class="header-section-number">19.3.5</span> Discretize the entire map</a></li>
<li><a class="nav-link" href="#vectorize"><span class="header-section-number">19.3.6</span> Vectorize</a></li>
</ul>
</li>
<li><a class="nav-link" href="#check-national-distribution"><span class="header-section-number">19.4</span> Check national distribution</a></li>
<li><a class="nav-link" href="#exp-hia"><span class="header-section-number">19.5</span> Export</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/NINAnor/ecosystemCondition/blob/master/homogeneous_impact_areas.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/NINAnor/ecosystemCondition/edit/master/homogeneous_impact_areas.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Indicators for Ecosystem Condition in Norway</strong>" was written by Anders L. Kolstad. It was last built on 2023-10-23.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
