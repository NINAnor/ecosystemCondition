<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 13 NDVI - Semi-natural Ecosystems | Indicators for Ecosystem Condition in Norway</title>
<meta name="author" content="Anders L. Kolstad">
<meta name="description" content="NDVI (greenness) indicator, semi-natural ecosystems Norwegian name: Primærproduksjon Author and date: Joachim Töpper, Tessa Bargmann September 2023 ...">
<meta name="generator" content="bookdown 0.33 with bs4_book()">
<meta property="og:title" content="Chapter 13 NDVI - Semi-natural Ecosystems | Indicators for Ecosystem Condition in Norway">
<meta property="og:type" content="book">
<meta property="og:url" content="https://ninanor.github.io/ecosystemCondition/index.html/NDVI-indicator-seminat.html">
<meta property="og:image" content="https://ninanor.github.io/ecosystemCondition/index.html/images/Picture1.png">
<meta property="og:description" content="NDVI (greenness) indicator, semi-natural ecosystems Norwegian name: Primærproduksjon Author and date: Joachim Töpper, Tessa Bargmann September 2023 ...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 13 NDVI - Semi-natural Ecosystems | Indicators for Ecosystem Condition in Norway">
<meta name="twitter:description" content="NDVI (greenness) indicator, semi-natural ecosystems Norwegian name: Primærproduksjon Author and date: Joachim Töpper, Tessa Bargmann September 2023 ...">
<meta name="twitter:image" content="https://ninanor.github.io/ecosystemCondition/index.html/images/Picture1.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="libs/tabwid-1.1.3/tabwid.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.6.1/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.27/datatables.js"></script><link href="libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Indicators for Ecosystem Condition in Norway</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">About </a></li>
<li class="book-part">INDICATORS</li>
<li><a class="" href="gjengroing.html"><span class="header-section-number">1</span> Enchroachment</a></li>
<li><a class="" href="nature-index-product.html"><span class="header-section-number">2</span> Nature index product</a></li>
<li><a class="" href="slitasje.html"><span class="header-section-number">3</span> Anthropogenic disturbance to soils and vegetation (ADSV)</a></li>
<li><a class="" href="median-summer-temp.html"><span class="header-section-number">4</span> Median Summer Temperature</a></li>
<li><a class="" href="alien-species.html"><span class="header-section-number">5</span> Alien species</a></li>
<li><a class="" href="functional-plant-indicators-wetland.html"><span class="header-section-number">6</span> Functional Plant Indicators - Wetlands</a></li>
<li><a class="" href="functional-plant-indicators-seminat.html"><span class="header-section-number">7</span> Functional Plant Indicators - Semi-Natural Ecosystems</a></li>
<li><a class="" href="functional-plant-indicators-open.html"><span class="header-section-number">8</span> Functional Plant Indicators - Naturally Open Ecosystems</a></li>
<li><a class="" href="trophic-level-biomass-ratios.html"><span class="header-section-number">9</span> Trophic level biomass ratios</a></li>
<li><a class="" href="insect-indicators.html"><span class="header-section-number">10</span> Insect indicators</a></li>
<li><a class="" href="flood-frequency.html"><span class="header-section-number">11</span> Flood frequency</a></li>
<li class="book-part">R &amp; D</li>
<li><a class="" href="NDVI-indicator-natopen.html"><span class="header-section-number">12</span> NDVI - Naturally Open Ecosystems</a></li>
<li><a class="active" href="NDVI-indicator-seminat.html"><span class="header-section-number">13</span> NDVI - Semi-natural Ecosystems</a></li>
<li><a class="" href="NDVI-indicator-wetland.html"><span class="header-section-number">14</span> NDVI - wetland ecosystems</a></li>
<li class="book-part">INDICATORS FROM THE ALPINE ASSESSMENT</li>
<li><a class="" href="areal-av-isbreer.html"><span class="header-section-number">15</span> Areal av isbreer</a></li>
<li class="book-part">DEPRECATED</li>
<li><a class="" href="areal-uten-d%C3%B8d-eller-skadet-r%C3%B8sslyng-i-kystlynghei.html"><span class="header-section-number">16</span> Areal uten død eller skadet røsslyng i kystlynghei</a></li>
<li class="book-part">GENERAL TOPICS</li>
<li><a class="" href="naturtype.html"><span class="header-section-number">17</span> Nature types</a></li>
<li><a class="" href="scaling-functions.html"><span class="header-section-number">18</span> Scaling functions</a></li>
<li><a class="" href="homogeneous-impact-areas.html"><span class="header-section-number">19</span> Homogeneous Impact Areas</a></li>
<li><a class="" href="master-grid.html"><span class="header-section-number">20</span> Master grid</a></li>
<li><a class="" href="climate-indicators-explained.html"><span class="header-section-number">21</span> Climate indicators explained</a></li>
<li><a class="" href="oversikt-over-indikatorforslag.html"><span class="header-section-number">22</span> Oversikt over indikatorforslag</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/NINAnor/ecosystemCondition">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="NDVI-indicator-seminat" class="section level1" number="13">
<h1>
<span class="header-section-number">13</span> NDVI - Semi-natural Ecosystems<a class="anchor" aria-label="anchor" href="#NDVI-indicator-seminat"><i class="fas fa-link"></i></a>
</h1>
<p>NDVI (greenness) indicator, semi-natural ecosystems</p>
<p><br> Norwegian name: <strong>Primærproduksjon</strong> <br></p>
<p><em>Author and date:</em></p>
<p>Joachim Töpper, Tessa Bargmann</p>
<p>September 2023</p>
<p><br></p>
<!-- Load all you dependencies here -->
<div class="tabwid">
<style>.cl-21b3eaba{table-layout:auto;}.cl-21ac77b2{font-family:'DejaVu Sans';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-21ac77bc{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-21b01764{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-21b04446{background-color:rgba(173, 216, 230, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-21b04450{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<div class="inline-table"><table data-quarto-disable-processing="true" class="cl-21b3eaba">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-21b04446"><p class="cl-21b01764"><span class="cl-21ac77b2">Ecosystem</span></p></th>
<th class="cl-21b04446"><p class="cl-21b01764"><span class="cl-21ac77b2">Økologisk egenskap</span></p></th>
<th class="cl-21b04446"><p class="cl-21b01764"><span class="cl-21ac77b2">ECT class</span></p></th>
</tr></thead>
<tbody><tr style="overflow-wrap:break-word;">
<td class="cl-21b04450"><p class="cl-21b01764"><span class="cl-21ac77bc">semi-naturlig</span></p></td>
<td class="cl-21b04450"><p class="cl-21b01764"><span class="cl-21ac77bc">Primærproduksjon</span></p></td>
<td class="cl-21b04450"><p class="cl-21b01764"><span class="cl-21ac77bc">Structural state characteristics</span></p></td>
</tr></tbody>
</table></div>
</div>
<!-- Don't remove these three html lines -->
<p><br><br></p>
<hr>
<div id="intro-ndvis" class="section level2" number="13.1">
<h2>
<span class="header-section-number">13.1</span> Introduction<a class="anchor" aria-label="anchor" href="#intro-ndvis"><i class="fas fa-link"></i></a>
</h2>
<p>The Normalized difference vegetation index (NDVI) can be used to
describe the greenness of an area, and may thus represent a proxy for
the amount of chlorophyll and plant productivity in the given area.
Different ecosystem types naturally have greenness signals of different
intensity but also with a certain variance. Deviations beyond the
natural variation in either direction may indicate a reduction in
ecological condition of a given ecosystem. E.g. lower than normal NDVI
may indicate excessive disturbance, while higher than normal NDVI may
indicate regrowth and transitions towards more densely vegetated
systems. In recent assessments of ecological condition for forest and
mountain ecosystems, two different NDVI-based indicators were developed
and applied. For forests, NDVI-values across the country were compared
to a spatial reference NDVI-signal from protected areas (Framstad et al.
2020). For mountains, the extent and consistence of the temporal change
of NDVI-values over the last twenty years was assessed (Framstad et al
2021). In both cases, the NDVI-product from the MODIS satellite
reflectance imagery was used based on available maps of spatial
ecosystem extent in Norway (i.e. national maps for the forest and
mountain ecosystems).</p>
<p>Here, we explore the potential for developing an NDVI-indicator for
ecological condition representing open semi-natural ecosystems. For this
task, two initial challenges can be identified early on:</p>
<ol style="list-style-type: decimal">
<li>We don’t yet have a national map for semi-natural ecosystems, i.e.
we don’t know the exact locations of all semi-natural areas in
Norway, which is a prerequisite to extract satellite data for the
right locations and ecosystems, and thus achieve a good and unbiased
spatial representation for the assessment area.</li>
<li>The spatial extent of the single semi-natural ecosystem occurrences
(hereafter ‘polygons’) includes many areas which are way smaller
than the pixel size in the MODIS imagery (250 x 250 m) which was
used for forests and mountains and has a time series back to year
<ol start="2000" style="list-style-type: decimal">
<li>
</ol>
</li>
</ol>
<p>In this draft development for a NDVI indicator for ecological condition
in semi-natural systems we approach these challenges in the following
ways:</p>
<ol style="list-style-type: decimal">
<li>We use ecosystem occurrence data from NiN-mapping to guide the
extraction of satellite NDVI data for pixels representing the right
ecosystem. However, the ecosystem occurrences in the NiN data are
highly spatially biased and thus cannot provide a good and unbiased
spatial representation for the assessment area. Our work therefore
represents a concept and method development which may be applied in
an assessment of ecological condition once spatially unbiased
occurrence data or a national map of semi-natural ecosystems are
available.</li>
<li>We include Sentinel-2 imagery for semi-natural ecosystems as the
resolution for the bands underlying the NDVI product here is 10 x 10
m which is smaller than almost all semi-natural polygons in the
NiN-data. However, since Sentinel-2 only goes back to 2015, we lose
much of the time series aspect as compared to the MODIS data. In
addition, we include Landsat imagery which goes back to 1984 and has
a resolution of 30 x 30 m, but also has more variable data due to
less frequent seasonal measurements. We also still explore NDVI data
from MODIS (see more details below).</li>
</ol>
</div>
<div id="underlying-data-ndvis" class="section level2" number="13.2">
<h2>
<span class="header-section-number">13.2</span> About the underlying data<a class="anchor" aria-label="anchor" href="#underlying-data-ndvis"><i class="fas fa-link"></i></a>
</h2>
<p>In the NDVI project for semi-natural systems, we use two kinds of data
(coming as four datasets) for building indicators for ecological
condition:</p>
<ul>
<li>NiN ecosystem data from ‘Naturtypekartlegging etter
Miljødirektoratets instruks’ to guide extraction of NDVI data for
the right locations and to provide information on the field-assessed
ecological condition of mapped polygons</li>
<li>remote sensed NDVI data
<ul>
<li>Sentinel-2 satellite NDVI data</li>
<li>MODIS satellite NDVI data</li>
<li>Landsat satellite NDVI data</li>
</ul>
</li>
</ul>
<ol style="list-style-type: decimal">
<li><p>NiN ecosystem data: The NiN data in this study contain data about
the ecosystem categories (cf. Halvorsen et al. 2020) present at
mapped sites as wall as their spatial delimitation (in the form of
polygons). Since we use NiN data that were collected following
‘Miljødirektoratets instruks’, these data also include information
on the ecological condition and underlying condition variabels of
the mapped sites (see the Miljødirektoratets mapping manual for
details). Polygon sizes in these NiN data may vary from &lt;100 sqm to
the dimension of sqkm’s.</p></li>
<li><p>NDVI data: The NDVI data used in the work at hand are pixel means
for polygons in the NiN-data, i.e. each NiN polygon is represented
by one NDVI value per measurement time (see below for more details
on the temporal resolution of NDVI data). With respect to that, it
does only make sense to use NDVI data for polygons that are at least
of the same size as the resolution of the respective satellite, and
thus we excluded any polygons smaller than each satellite’s
resolution.</p></li>
</ol>
<p>(2a) Sentinel-2 satellite NDVI data: The Sentinel data have a resolution
of 10 x 10 m, and we thus excluded all NiN-polygons smaller than 100
sqm. Sentinel-2 has a revisit frequency of 10 days and should thus
provide enough measurements during peak growing season to provide a
robust measure of maximum greenness.</p>
<p>(2b) MODIS satellite NDVI data: The MODIS data have a resolution of 250
x 250 m, and we thus excluded all NiN-polygons smaller than 62500 sqm.
MODIS has a revisit frequency of 1-2 days and thus provides an extensive
sample to provide a robust measure of maximum greenness.</p>
<p>(2c) Landsat satellite NDVI data: The Landsat data have a resolution of
30 x 30 m, and we thus excluded all NiN-polygons smaller than 900 sqm.
Landsat has a revisit frequency of 16 days and thus provides the poorest
growing season sample among the available NDVI data for a robust measure
of maximum greenness.</p>
<div id="representativity-ndvis" class="section level3" number="13.2.1">
<h3>
<span class="header-section-number">13.2.1</span> Representativity in time and space<a class="anchor" aria-label="anchor" href="#representativity-ndvis"><i class="fas fa-link"></i></a>
</h3>
<p>For semi-natural systems, the NiN data contain 24494 semi-natural
polygons of known area size across mainland Norway. However, NiN-mapping
is not planned and performed in a spatially representative way and thus
both the ecosystem occurrences and their spatial extent have to be
treated as spatially biased. The 24494 semi-natural polygons are
distributed across regions and major ecosystem types in the following
way:</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Region</th>
<th>T31</th>
<th>T32</th>
<th>T33</th>
<th>T34</th>
<th>T40</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Northern Norway</td>
<td>1194</td>
<td>2081</td>
<td>14</td>
<td>1</td>
<td>15</td>
</tr>
<tr class="even">
<td>Central Norway</td>
<td>641</td>
<td>2518</td>
<td>210</td>
<td>2338</td>
<td>97</td>
</tr>
<tr class="odd">
<td>Western Norway</td>
<td>132</td>
<td>2922</td>
<td>94</td>
<td>2200</td>
<td>66</td>
</tr>
<tr class="even">
<td>Eastern Norway</td>
<td>1064</td>
<td>4488</td>
<td>10</td>
<td>10</td>
<td>371</td>
</tr>
<tr class="odd">
<td>Southern Norway</td>
<td>234</td>
<td>2317</td>
<td>112</td>
<td>749</td>
<td>111</td>
</tr>
</tbody>
</table></div>
<p>In addition, there are 10 T31s, 78 T32s, 15 T33s, 59 T34s, and 1 T40
that are not assigned to any region. (These polygons likely lie in water and thus outside of the regional polygons due to imprecise coordinates from the mapping device).</p>
<p>The NDVI data from either satellite follow the spatial distribution and
bias status of the NiN-data. Due to the larger number of excluded
polygons in the NDVI data from MODIS (because of the large pixel size in
MODIS, see above), the MODIS NDVI data for the semi-natural occurrences
in the NiN data are likely even more spatially biased than it is the
case for the NDVI data from Sentinel-2 and Landsat.</p>
</div>
<div id="temp-cov-ndvis" class="section level3" number="13.2.2">
<h3>
<span class="header-section-number">13.2.2</span> Temporal coverage<a class="anchor" aria-label="anchor" href="#temp-cov-ndvis"><i class="fas fa-link"></i></a>
</h3>
<p>The currently available NiN data on semi-natural ecosystems span a time
period from 2018-2021 and thus represent a contemporary sample of
ecosystem occurrences. Note that none of the polygons in the NiN-data
has been visited more than once during that period.</p>
<p>Available Sentinel-2 satellite NDVI data span the years 2015-2022.</p>
<p>Available MODIS satellite NDVI data span the years 2000-2022.</p>
<p>Available Landsat satellite NDVI data span the years 1984-2021.</p>
</div>
</div>
<div id="coll-ndvis" class="section level2" number="13.3">
<h2>
<span class="header-section-number">13.3</span> Collinearities with other indicators<a class="anchor" aria-label="anchor" href="#coll-ndvis"><i class="fas fa-link"></i></a>
</h2>
<p>The NDVI signal may likely be co-linear with <a href="https://ninanor.github.io/ecosystemCondition/gjengroing.html">the re-growth indicator</a>
based on LiDAR derived canopy height in abandoned semi-natural areas
under shrub and tree encroachment.</p>
</div>
<div id="ref-state-ndvis" class="section level2" number="13.4">
<h2>
<span class="header-section-number">13.4</span> Reference state and values<a class="anchor" aria-label="anchor" href="#ref-state-ndvis"><i class="fas fa-link"></i></a>
</h2>
<div id="ref-state2-ndvis" class="section level3" number="13.4.1">
<h3>
<span class="header-section-number">13.4.1</span> Reference state and scaling values<a class="anchor" aria-label="anchor" href="#ref-state2-ndvis"><i class="fas fa-link"></i></a>
</h3>
<p>This indicator project is mainly exploratory, mapping the possibilities
of and lacking prerequisites for satellite derived NDVI data to inform
ecological condition assessments. Therefore, we lack a concise strategy
for how to define the reference state, especially prior to having access
to an ecosystem map for semi-natural ecosystems (cf. Jakobsson et al.
2020, Töpper &amp; Jakobsson 2021). In this exploratory work, we will use
the condition classification in the NiN-data to explore (1) how NDVI
connects to semi-natural ecology and condition and (2) its applicability
for defining a reference state. We will use statistical models to test
whether or not NDVI varies systematically with condition and across
time.</p>
</div>
</div>
<div id="uncertainties-ndvis" class="section level2" number="13.5">
<h2>
<span class="header-section-number">13.5</span> Uncertainties<a class="anchor" aria-label="anchor" href="#uncertainties-ndvis"><i class="fas fa-link"></i></a>
</h2>
<p>Given a condition index can be achieved, we can calculate a mean
indicator value (after scaling) for every region (or any other delimited
area of interest) as well as its corresponding standard error and
standard deviation as a measure of spatial uncertainty for a
geographical area (see Töpper &amp; Jakobsson 2021).</p>
</div>
<div id="references-9" class="section level2" number="13.6">
<h2>
<span class="header-section-number">13.6</span> References<a class="anchor" aria-label="anchor" href="#references-9"><i class="fas fa-link"></i></a>
</h2>
<p>Framstad, E., Kolstad, A. L., Nybø, S., Töpper, J. &amp; Vandvik, V. 2022.
The condition of forest and mountain ecosystems in Norway. Assessment by
the IBECA method. NINA Report 2100. Norwegian Institute for Nature
Research.</p>
<p>Halvorsen, R., Skarpaas, O., Bryn, A., Bratli, H., Erikstad, L.,
Simensen, T., &amp; Lieungh, E. (2020). Towards a systematics of
ecodiversity: The EcoSyst framework. Global Ecology and Biogeography,
29(11), 1887-1906. <a href="doi:10.1111/geb.13164" class="uri">doi:10.1111/geb.13164</a></p>
<p>Jakobsson, S., Töpper, J.P., Evju, M., Framstad, E., Lyngstad, A.,
Pedersen, B., Sickel, H., Sverdrup-Thygeson, A., Vandvik. V., Velle,
L.G., Aarrestad, P.A. &amp; Nybø, S. 2020. Setting reference levels and
limits for good ecological condition in terrestrial ecosystems. Insights
from a case study based on the IBECA approach. Ecological Indicators
116: 106492.</p>
<p>Miljødiretoratets mapping manual:
<a href="https://www.miljodirektoratet.no/publikasjoner/2022/januar/kartleggingsinstruks-kartlegging-av-terrestriske-naturtyper-etter-nin/" class="uri">https://www.miljodirektoratet.no/publikasjoner/2022/januar/kartleggingsinstruks-kartlegging-av-terrestriske-naturtyper-etter-nin/</a></p>
<p>Töpper, J. &amp; Jakobsson, S. 2021. The Index-Based Ecological Condition
Assessment (IBECA) - Technical protocol, version 1.0. NINA Report 1967.
Norwegian Institute for Nature Research.</p>
</div>
<div id="analyses-ndvis" class="section level2" number="13.7">
<h2>
<span class="header-section-number">13.7</span> Analyses<a class="anchor" aria-label="anchor" href="#analyses-ndvis"><i class="fas fa-link"></i></a>
</h2>
<div id="datasets-ndvis" class="section level3" number="13.7.1">
<h3>
<span class="header-section-number">13.7.1</span> Data sets<a class="anchor" aria-label="anchor" href="#datasets-ndvis"><i class="fas fa-link"></i></a>
</h3>
<p>The analyses in this document make use of the following data sets:</p>
<ul>
<li>NiN data (Naturtyper etter Miljødirektoratets instruks)</li>
<li>Sentinel-2 NDVI data</li>
<li>MODIS NDVI data</li>
<li>Landsat NDVI data</li>
</ul>
<div id="nin-data-and-geometry-for-norway-and-the-five-regions-1" class="section level4" number="13.7.1.1">
<h4>
<span class="header-section-number">13.7.1.1</span> NiN data and geometry for Norway and the five regions<a class="anchor" aria-label="anchor" href="#nin-data-and-geometry-for-norway-and-the-five-regions-1"><i class="fas fa-link"></i></a>
</h4>
<p>We read the NiN data for this document from a cache at the GitHub
repository…</p>
<div class="sourceCode" id="cb453"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add NiN data from cache</span></span>
<span><span class="va">nin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"/data/cache/nin.RDS"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>…but it can also be directly downloaded from Miljødirektoratets
kartkatalog (<a href="https://kartkatalog.miljodirektoratet.no/Dataset" class="uri">https://kartkatalog.miljodirektoratet.no/Dataset</a>)</p>
<div class="sourceCode" id="cb454"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://nedlasting.miljodirektoratet.no/Miljodata//Naturtyper_nin/FILEGDB/4326/Naturtyper_nin_0000_norge_4326_FILEGDB.zip"</span></span>
<span><span class="fu">download</span><span class="op">(</span><span class="va">url</span>, dest <span class="op">=</span> <span class="st">"P:/41201785_okologisk_tilstand_2022_2023/data/Naturtyper_nin_0000_norge_4326_FILEGDB.zip"</span>, mode <span class="op">=</span> <span class="st">"wb"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/unzip.html">unzip</a></span><span class="op">(</span><span class="st">"P:/41201785_okologisk_tilstand_2022_2023/data/Naturtyper_nin_0000_norge_4326_FILEGDB.zip"</span>,</span>
<span>  exdir <span class="op">=</span> <span class="st">"P:/41201785_okologisk_tilstand_2022_2023/data/nin_data"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">st_layers</span><span class="op">(</span><span class="st">"P:/41201785_okologisk_tilstand_2022_2023/data/nin_data/Naturtyper_nin_0000_norge_4326_FILEGDB.gdb"</span><span class="op">)</span></span>
<span><span class="va">nin</span> <span class="op">&lt;-</span> <span class="fu">st_read</span><span class="op">(</span><span class="st">"P:/41201785_okologisk_tilstand_2022_2023/data/nin_data/Naturtyper_nin_0000_norge_4326_FILEGDB.gdb"</span>,</span>
<span>  layer <span class="op">=</span> <span class="st">"naturtyper_nin_omr"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>And we upload maps for Norway and the five regions: Southern, Western,
Eastern, Central, and Northern Norway</p>
<div class="sourceCode" id="cb455"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Import region- og Norgeskart, make sure they have the same geometry as the nin data</span></span>
<span><span class="va">nor</span> <span class="op">&lt;-</span> <span class="fu">st_read</span><span class="op">(</span><span class="st">"data/outlineOfNorway_EPSG25833.shp"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">st_as_sf</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">st_transform</span><span class="op">(</span>crs <span class="op">=</span> <span class="fu">st_crs</span><span class="op">(</span><span class="va">nin</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reading layer `outlineOfNorway_EPSG25833' from data source </span></span>
<span><span class="co">#&gt;   `/data/Egenutvikling/41001581_egenutvikling_anders_kolstad/github/ecosystemCondition/data/outlineOfNorway_EPSG25833.shp' </span></span>
<span><span class="co">#&gt;   using driver `ESRI Shapefile'</span></span>
<span><span class="co">#&gt; Simple feature collection with 1 feature and 2 fields</span></span>
<span><span class="co">#&gt; Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -113472.7 ymin: 6448359 xmax: 1114618 ymax: 7939917</span></span>
<span><span class="co">#&gt; Projected CRS: ETRS89 / UTM zone 33N</span></span>
<span></span>
<span><span class="va">reg</span> <span class="op">&lt;-</span> <span class="fu">st_read</span><span class="op">(</span><span class="st">"data/regions.shp"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">st_as_sf</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">st_transform</span><span class="op">(</span>crs <span class="op">=</span> <span class="fu">st_crs</span><span class="op">(</span><span class="va">nin</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reading layer `regions' from data source </span></span>
<span><span class="co">#&gt;   `/data/Egenutvikling/41001581_egenutvikling_anders_kolstad/github/ecosystemCondition/data/regions.shp' </span></span>
<span><span class="co">#&gt;   using driver `ESRI Shapefile'</span></span>
<span><span class="co">#&gt; Simple feature collection with 5 features and 2 fields</span></span>
<span><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -99551.21 ymin: 6426048 xmax: 1121941 ymax: 7962744</span></span>
<span><span class="co">#&gt; Projected CRS: ETRS89 / UTM zone 33N</span></span>
<span></span>
<span><span class="co"># change region names to something R-friendly</span></span>
<span><span class="va">reg</span><span class="op">$</span><span class="va">region</span></span>
<span><span class="co">#&gt; [1] "Nord-Norge"      "Midt-Norge"      "Ã\u0098stlandet"</span></span>
<span><span class="co">#&gt; [4] "Vestlandet"      "SÃ¸rlandet"</span></span>
<span><span class="va">reg</span><span class="op">$</span><span class="va">region</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Northern Norway"</span>, <span class="st">"Central Norway"</span>, <span class="st">"Eastern Norway"</span>, <span class="st">"Western Norway"</span>, <span class="st">"Southern Norway"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># combine the Norway and the region maps</span></span>
<span><span class="va">regnor</span> <span class="op">&lt;-</span> <span class="fu">st_intersection</span><span class="op">(</span><span class="va">reg</span>, <span class="va">nor</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: attribute variables are assumed to be spatially</span></span>
<span><span class="co">#&gt; constant throughout all geometries</span></span></code></pre></div>
</div>
<div id="ndvi-data" class="section level4" number="13.7.1.2">
<h4>
<span class="header-section-number">13.7.1.2</span> NDVI data<a class="anchor" aria-label="anchor" href="#ndvi-data"><i class="fas fa-link"></i></a>
</h4>
<p>All NDVI data are calculated mean NDVI values for each respective NiN
polygon from each available Sentinel-2, MODIS, or Landsat image in
Google Earth Engine (GEE).</p>
<!-- RUNTIME 30 sec -->
<div id="sentinel-2-ndvi-data-1" class="section level5" number="13.7.1.2.1">
<h5>
<span class="header-section-number">13.7.1.2.1</span> Sentinel-2 NDVI data<a class="anchor" aria-label="anchor" href="#sentinel-2-ndvi-data-1"><i class="fas fa-link"></i></a>
</h5>
<p>The GEE code can be seen here:
<a href="https://code.earthengine.google.com/2ceb0c3e03adade9e6f6d0903184b8c4" class="uri">https://code.earthengine.google.com/2ceb0c3e03adade9e6f6d0903184b8c4</a>
The image collection contains Sentinel imagery from June, July and
August 2015-2022 To not exceed GEE memory limits, the exported files had
to be iterated over a grid which resulted in 42 separate csv files. This
script merges them and then merges the dataframe to the NiN data.</p>
<div class="sourceCode" id="cb456"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Import Sentinel NDVI Data</span></span>
<span><span class="va">df.s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span><span class="st">"/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/NDVI_åpenlavland/NDVI_data_Sentinel/"</span>, pattern <span class="op">=</span> <span class="st">"*.csv"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">map_df</span><span class="op">(</span><span class="op">~</span> <span class="fu">fread</span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="modis-ndvi-data-1" class="section level5" number="13.7.1.2.2">
<h5>
<span class="header-section-number">13.7.1.2.2</span> MODIS NDVI data<a class="anchor" aria-label="anchor" href="#modis-ndvi-data-1"><i class="fas fa-link"></i></a>
</h5>
<p>The GEE code can be seen here:
<a href="https://code.earthengine.google.com/efb84013701f1d5f6e1e81345f389b84" class="uri">https://code.earthengine.google.com/efb84013701f1d5f6e1e81345f389b84</a>
The image collection contains MODIS imagery from June, July and August
2000-2022</p>
<div class="sourceCode" id="cb457"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Import MODIS NDVI Data</span></span>
<span><span class="co"># MODIS NDVI is scaled by 0.0001. Mean must be divided by 10000.</span></span>
<span><span class="va">df.m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"/data/P-Prosjekter241201785_okologisk_tilstand_2022_2023/data/NDVI_åpenlavland/NDVI_data_MODIS/modis_ndvi_ts_2000_2022.csv"</span>, <span class="op">)</span></span>
<span><span class="va">df.m</span><span class="op">$</span><span class="va">mean</span> <span class="op">&lt;-</span> <span class="va">df.m</span><span class="op">$</span><span class="va">mean</span> <span class="op">/</span> <span class="fl">10000</span></span></code></pre></div>
</div>
<div id="landsat-ndvi-data-1" class="section level5" number="13.7.1.2.3">
<h5>
<span class="header-section-number">13.7.1.2.3</span> Landsat NDVI data<a class="anchor" aria-label="anchor" href="#landsat-ndvi-data-1"><i class="fas fa-link"></i></a>
</h5>
<p>The GEE code can be seen here:
<a href="https://code.earthengine.google.com/da8a9279238ef26d14be08a43788b6b7" class="uri">https://code.earthengine.google.com/da8a9279238ef26d14be08a43788b6b7</a>
The image collection contains Landsat imagery from June, July and August
1984-2022 To not exceed GEE memory limits, the exported files had to be
iterated over a grid which resulted in 42 separate csv files. This
script merges them and then merges the dataframe to the NiN data.</p>
<div class="sourceCode" id="cb458"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Import Landsat NDVI Data</span></span>
<span><span class="co"># Set up conditional file paths</span></span>
<span><span class="va">dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">dir</span> <span class="op">==</span> <span class="st">"C:"</span>,</span>
<span>  <span class="st">"R:/GeoSpatialData/Habitats_biotopes/Norway_Miljodirektoratet_Naturtyper_nin/Original/versjon20221231/Natur_Naturtyper_nin_norge_med_svalbard_25833/Natur_Naturtyper_NiN_norge_med_svalbard_25833.gdb"</span>,</span>
<span>  <span class="st">"/data/R/GeoSpatialData/Habitats_biotopes/Norway_Miljodirektoratet_Naturtyper_nin/Original/versjon20221231/Natur_Naturtyper_nin_norge_med_svalbard_25833/Natur_Naturtyper_NiN_norge_med_svalbard_25833.gdb"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">pData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">dir</span> <span class="op">==</span> <span class="st">"C:"</span>,</span>
<span>  <span class="st">"P:/41201785_okologisk_tilstand_2022_2023/data/NDVI_åpenlavland/NDVI_data_Landsat"</span>,</span>
<span>  <span class="st">"/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/NDVI_åpenlavland/NDVI_data_Landsat"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Fread doesn't like the weird path to the server version of the P drive</span></span>
<span><span class="co"># hence this horrendous work around</span></span>
<span><span class="va">files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span><span class="va">pData</span>, pattern <span class="op">=</span> <span class="st">"*.csv"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># initialise a list of dataframes</span></span>
<span><span class="co"># read in a dataframe in each slot of the df_list</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">files</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"-"</span>, <span class="st">"."</span>, <span class="va">i</span><span class="op">)</span></span>
<span>  <span class="va">name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">".csv"</span>, <span class="st">""</span>, <span class="va">name</span><span class="op">)</span></span>
<span>  <span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">i</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span>  <span class="va">df_list</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">name</span>, <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="va">i</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">df.l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span><span class="va">df_list</span>, .id <span class="op">=</span> <span class="st">"column_label"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div id="data-handling-ndvis" class="section level3" number="13.7.2">
<h3>
<span class="header-section-number">13.7.2</span> Data handling<a class="anchor" aria-label="anchor" href="#data-handling-ndvis"><i class="fas fa-link"></i></a>
</h3>
<div id="nin-data-ndvis" class="section level4" number="13.7.2.1">
<h4>
<span class="header-section-number">13.7.2.1</span> NiN data<a class="anchor" aria-label="anchor" href="#nin-data-ndvis"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb459"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fixing variable- and ecosystem-names with special characters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">nin</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">nin</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">8</span>, <span class="fl">17</span>, <span class="fl">26</span>, <span class="fl">31</span>, <span class="fl">33</span>, <span class="fl">34</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"hovedoekosystem"</span>, <span class="st">"kartleggingsaar"</span>, <span class="st">"noyaktighet"</span>,</span>
<span>  <span class="st">"omraadenavn"</span>, <span class="st">"uk_naertruet"</span>, <span class="st">"uk_sentraloekosystemfunksjon"</span>,</span>
<span>  <span class="st">"uk_spesieltdaarligkartlagt"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">nin</span><span class="op">$</span><span class="va">hovedoekosystem</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nin</span> <span class="op">&lt;-</span> <span class="va">nin</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>hovedoekosystem <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode</a></span><span class="op">(</span><span class="va">hovedoekosystem</span>,</span>
<span>    <span class="st">"Våtmark"</span> <span class="op">=</span> <span class="st">"Vaatmark"</span>,</span>
<span>    <span class="st">"Semi-naturlig mark"</span> <span class="op">=</span> <span class="st">"Semi_naturlig"</span>,</span>
<span>    <span class="st">"Naturlig åpne områder i lavlandet"</span> <span class="op">=</span> <span class="st">"Naturlig-aapent"</span>,</span>
<span>    <span class="st">"Naturlig åpne områder under skoggrensa"</span> <span class="op">=</span> <span class="st">"Naturlig_aapent"</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>validGeo <span class="op">=</span> <span class="fu">st_is_valid</span><span class="op">(</span><span class="va">SHAPE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># checking how many polygons have multiple ecosystem types</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">nin</span><span class="op">$</span><span class="va">ninkartleggingsenheter</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">nin</span><span class="op">)</span></span>
<span><span class="co"># 95469 polygons altogether</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">nin</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">","</span>, <span class="va">ninkartleggingsenheter</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># 21094 polygons have more than 1 ecosystem type (they are separated by commas in the ninkartleggingsenheter-variable)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">nin</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">","</span>, <span class="va">ninkartleggingsenheter</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># 74375 polygons should have only 1 ecosystem type</span></span>
<span></span>
<span><span class="co"># there's no information on the proportion of ecosystem types in the polygons, so we got to omit all polygons with multiple ecosystem types :(</span></span>
<span><span class="va">nin</span> <span class="op">&lt;-</span> <span class="va">nin</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">","</span>, <span class="va">ninkartleggingsenheter</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fix the content in the ninkartleggingsenheter-variable</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">nin</span><span class="op">$</span><span class="va">ninkartleggingsenheter</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># get rid of the NA- in the beginning</span></span>
<span><span class="va">nin</span> <span class="op">&lt;-</span> <span class="va">nin</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>ninkartleggingsenheter <span class="op">=</span> <span class="fu">str_remove</span><span class="op">(</span><span class="va">ninkartleggingsenheter</span>, <span class="st">"NA_"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># making a main ecosystem type variable</span></span>
<span><span class="va">nin</span> <span class="op">&lt;-</span> <span class="va">nin</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>  hovedtype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">ninkartleggingsenheter</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  hovedtype <span class="op">=</span> <span class="fu">str_remove</span><span class="op">(</span><span class="va">hovedtype</span>, <span class="st">"-"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># checking mapping unit against main ecosystem type</span></span>
<span><span class="va">nin</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"hovedoekosystem"</span>, <span class="st">"hovedtype"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">nin</span><span class="op">$</span><span class="va">hovedtype</span><span class="op">[</span><span class="va">nin</span><span class="op">$</span><span class="va">hovedoekosystem</span> <span class="op">==</span> <span class="st">"Vaatmark"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">nin</span><span class="op">$</span><span class="va">hovedtype</span><span class="op">[</span><span class="va">nin</span><span class="op">$</span><span class="va">hovedoekosystem</span> <span class="op">==</span> <span class="st">"Semi_naturlig"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">nin</span><span class="op">$</span><span class="va">hovedtype</span><span class="op">[</span><span class="va">nin</span><span class="op">$</span><span class="va">hovedoekosystem</span> <span class="op">==</span> <span class="st">"Naturlig_aapne"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">nin</span><span class="op">$</span><span class="va">hovedtype</span><span class="op">[</span><span class="va">nin</span><span class="op">$</span><span class="va">hovedoekosystem</span> <span class="op">==</span> <span class="st">"Skog"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">nin</span><span class="op">$</span><span class="va">hovedtype</span><span class="op">[</span><span class="va">nin</span><span class="op">$</span><span class="va">hovedoekosystem</span> <span class="op">==</span> <span class="st">"Fjell"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># making a new variable for the overarching ecosystem types based on the main ecosystem types</span></span>
<span><span class="va">nin</span><span class="op">$</span><span class="va">hovedoekosystem.orig</span> <span class="op">&lt;-</span> <span class="va">nin</span><span class="op">$</span><span class="va">hovedoekosystem</span></span>
<span></span>
<span><span class="va">nin</span> <span class="op">&lt;-</span> <span class="va">nin</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>hovedoekosystem <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">hovedtype</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"V"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">7</span>, <span class="fl">9</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Vaatmark"</span>,</span>
<span>    <span class="va">hovedtype</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"V"</span>, <span class="fl">11</span><span class="op">:</span><span class="fl">13</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Vaatmark_sterkt_endret"</span>,</span>
<span>    <span class="va">hovedtype</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"T"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">31</span><span class="op">:</span><span class="fl">34</span>, <span class="fl">40</span><span class="op">:</span><span class="fl">41</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Semi_naturlig"</span>,</span>
<span>    <span class="va">hovedtype</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"T"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">12</span>, <span class="fl">18</span>, <span class="fl">20</span><span class="op">:</span><span class="fl">21</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Naturlig_aapent"</span>,</span>
<span>    <span class="va">hovedtype</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"T"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">30</span>, <span class="fl">38</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"V"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">8</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Skog"</span>,</span>
<span>    <span class="va">hovedtype</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"T"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">7</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">14</span>, <span class="fl">22</span>, <span class="fl">26</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"V"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">7</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Fjell"</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"NA"</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">nin</span><span class="op">$</span><span class="va">tilstand</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nin</span> <span class="op">&lt;-</span> <span class="va">nin</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>tilstand <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode</a></span><span class="op">(</span><span class="va">tilstand</span>,</span>
<span>  <span class="st">"Dårlig"</span> <span class="op">=</span> <span class="st">"Redusert"</span>,</span>
<span>  <span class="st">"Svært redusert"</span> <span class="op">=</span> <span class="st">"Svaert_redusert"</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">nin</span> <span class="op">&lt;-</span> <span class="va">nin</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>tilstand_num <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode</a></span><span class="op">(</span><span class="va">tilstand</span>,</span>
<span>  <span class="st">"God"</span> <span class="op">=</span> <span class="fl">0</span>, <span class="st">"Moderat"</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="st">"Redusert"</span> <span class="op">=</span> <span class="fl">2</span>, <span class="st">"Svaert_redusert"</span> <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">nin</span><span class="op">$</span><span class="va">tilstand</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">nin</span><span class="op">$</span><span class="va">tilstand_num</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## filter out only semi-natural data</span></span>
<span><span class="va">nin.seminat</span> <span class="op">&lt;-</span> <span class="va">nin</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">hovedoekosystem</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Semi_naturlig"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">identifikasjon_lokalid</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">validGeo</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">tilstand</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">hovedoekosystem</span>, <span class="va">hovedtype</span>, <span class="va">ninkartleggingsenheter</span>, <span class="va">lokalitetskvalitet</span>, <span class="va">tilstand</span>, <span class="va">tilstand_num</span>, <span class="va">ninbeskrivelsesvariabler</span>, <span class="va">kartleggingsaar</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># merge NiN-data with region</span></span>
<span><span class="va">nin.seminat</span> <span class="op">&lt;-</span> <span class="fu">st_join</span><span class="op">(</span><span class="va">nin.seminat</span>, <span class="va">regnor</span>, left <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">nin.seminat</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">nin.seminat</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"region_id"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># check that every nin-polygon still occurs only once</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">nin.seminat</span><span class="op">$</span><span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="co"># ok</span></span>
<span></span>
<span><span class="va">nin.seminat</span> <span class="op">&lt;-</span> <span class="va">nin.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>area_meters_nin <span class="op">=</span> <span class="fu">st_area</span><span class="op">(</span><span class="va">nin.seminat</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># check and edit the order of regions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">nin.seminat</span><span class="op">$</span><span class="va">region</span><span class="op">)</span></span>
<span><span class="va">nin.seminat</span><span class="op">$</span><span class="va">region</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">nin.seminat</span><span class="op">$</span><span class="va">region</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">nin.seminat</span><span class="op">$</span><span class="va">region</span><span class="op">)</span></span>
<span><span class="va">nin.seminat</span><span class="op">$</span><span class="va">region</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">nin.seminat</span><span class="op">$</span><span class="va">region</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Northern Norway"</span>, <span class="st">"Central Norway"</span>, <span class="st">"Eastern Norway"</span>, <span class="st">"Western Norway"</span>, <span class="st">"Southern Norway"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">nin.seminat</span><span class="op">$</span><span class="va">region</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># splitting content in the ninbeskrivelsesvariabler-column into separate rows per variable and then separating that column into two for the variable name and value</span></span>
<span><span class="va">nin.seminat2</span> <span class="op">&lt;-</span> <span class="va">nin.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate_rows.html">separate_rows</a></span><span class="op">(</span><span class="va">ninbeskrivelsesvariabler</span>, sep <span class="op">=</span> <span class="st">","</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html">separate</a></span><span class="op">(</span></span>
<span>    col <span class="op">=</span> <span class="va">ninbeskrivelsesvariabler</span>,</span>
<span>    into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NiN_variable_code"</span>, <span class="st">"NiN_variable_value"</span><span class="op">)</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>    remove <span class="op">=</span> <span class="cn">F</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>NiN_variable_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">NiN_variable_value</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>NiN_variable_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">NiN_variable_code</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span>select <span class="op">=</span> <span class="op">-</span><span class="va">ninbeskrivelsesvariabler</span><span class="op">)</span></span>
<span><span class="va">nin.seminat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">nin.seminat2</span><span class="op">)</span></span></code></pre></div>
<!-- RUNTIME 2 sec -->
</div>
<div id="ndvi-data-ndvis" class="section level4" number="13.7.2.2">
<h4>
<span class="header-section-number">13.7.2.2</span> NDVI data<a class="anchor" aria-label="anchor" href="#ndvi-data-ndvis"><i class="fas fa-link"></i></a>
</h4>
<!-- RUNTIME 4 min. Caching it. -->
<div class="sourceCode" id="cb460"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Sentinel-2</span></span>
<span><span class="co"># join nin.seminat &amp; Sentinel NDVI data</span></span>
<span><span class="va">SentinelNDVI.seminat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join</a></span><span class="op">(</span><span class="va">nin.seminat</span>, <span class="va">df.s</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span><span class="co"># summary(SentinelNDVI.seminat)</span></span>
<span><span class="va">SentinelNDVI.seminat</span> <span class="op">&lt;-</span> <span class="va">SentinelNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    hovedoekosystem <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">hovedoekosystem</span><span class="op">)</span>,</span>
<span>    hovedtype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">hovedtype</span><span class="op">)</span>,</span>
<span>    ninkartleggingsenheter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">ninkartleggingsenheter</span><span class="op">)</span>,</span>
<span>    lokalitetskvalitet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">lokalitetskvalitet</span><span class="op">)</span>,</span>
<span>    tilstand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">tilstand</span><span class="op">)</span>,</span>
<span>    area_meters <span class="op">=</span> <span class="fu">st_area</span><span class="op">(</span><span class="va">SentinelNDVI.seminat</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co"># summary(SentinelNDVI.seminat)</span></span>
<span><span class="co"># get rid of NAs (i.e. NDVI cells that were not in semi-natural polygons)</span></span>
<span><span class="va">SentinelNDVI.seminat</span> <span class="op">&lt;-</span> <span class="va">SentinelNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">hovedtype</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">SentinelNDVI.seminat</span> <span class="op">&lt;-</span> <span class="va">SentinelNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">mean</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># summary(SentinelNDVI.seminat)</span></span>
<span><span class="co"># get rid of any nin-polygons smaller than the Sentinel grid cell size (100 sqm)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">SentinelNDVI.seminat</span><span class="op">)</span></span>
<span><span class="va">SentinelNDVI.seminat</span> <span class="op">&lt;-</span> <span class="va">SentinelNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">area_meters</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">SentinelNDVI.seminat</span><span class="op">)</span></span>
<span><span class="co"># split date into year, month &amp; day</span></span>
<span><span class="va">SentinelNDVI.seminat</span> <span class="op">&lt;-</span> <span class="va">SentinelNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    year <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html">year</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>,</span>
<span>    month <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html">month</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>,</span>
<span>    day <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html">day</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co"># add column for sub-ecosystem types</span></span>
<span><span class="va">SentinelNDVI.seminat</span> <span class="op">&lt;-</span> <span class="va">SentinelNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>  subtype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substring</a></span><span class="op">(</span><span class="va">ninkartleggingsenheter</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  subtype <span class="op">=</span> <span class="fu">str_remove</span><span class="op">(</span><span class="va">subtype</span>, <span class="st">"-"</span><span class="op">)</span>,</span>
<span>  subtype <span class="op">=</span> <span class="fu">str_remove</span><span class="op">(</span><span class="va">subtype</span>, <span class="st">"-"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># we are using max NDVI per year in every NiN polygon</span></span>
<span><span class="va">SentinelNDVI.seminat</span> <span class="op">&lt;-</span> <span class="va">SentinelNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">mean</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">mean</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">SentinelNDVI.seminat</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## MODIS</span></span>
<span><span class="co"># join nin.seminat and Modis NDVI data</span></span>
<span><span class="va">ModisNDVI.seminat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join</a></span><span class="op">(</span><span class="va">nin.seminat</span>, <span class="va">df.m</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># summary(ModisNDVI.seminat)</span></span>
<span><span class="va">ModisNDVI.seminat</span> <span class="op">&lt;-</span> <span class="va">ModisNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    hovedoekosystem <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">hovedoekosystem</span><span class="op">)</span>,</span>
<span>    hovedtype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">hovedtype</span><span class="op">)</span>,</span>
<span>    ninkartleggingsenheter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">ninkartleggingsenheter</span><span class="op">)</span>,</span>
<span>    lokalitetskvalitet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">lokalitetskvalitet</span><span class="op">)</span>,</span>
<span>    tilstand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">tilstand</span><span class="op">)</span>,</span>
<span>    area_meters <span class="op">=</span> <span class="fu">st_area</span><span class="op">(</span><span class="va">ModisNDVI.seminat</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co"># summary(ModisNDVI.seminat)</span></span>
<span><span class="co"># get rid of NAs (i.e. NDVI cells that were not in semi-natural polygons)</span></span>
<span><span class="va">ModisNDVI.seminat</span> <span class="op">&lt;-</span> <span class="va">ModisNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">hovedtype</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ModisNDVI.seminat</span> <span class="op">&lt;-</span> <span class="va">ModisNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">mean</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># summary(ModisNDVI.seminat)</span></span>
<span><span class="co"># get rid of any nin-polygons smaller than the Modis grid cell size (62500 sqm)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">ModisNDVI.seminat</span><span class="op">)</span></span>
<span><span class="va">ModisNDVI.seminat</span> <span class="op">&lt;-</span> <span class="va">ModisNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">area_meters</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">62500</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">ModisNDVI.seminat</span><span class="op">)</span></span>
<span><span class="co"># split date into year, month &amp; day</span></span>
<span><span class="va">ModisNDVI.seminat</span> <span class="op">&lt;-</span> <span class="va">ModisNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    year <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html">year</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>,</span>
<span>    month <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html">month</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>,</span>
<span>    day <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html">day</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co"># we are using max NDVI per year in every NiN polygon</span></span>
<span><span class="va">ModisNDVI.seminat</span> <span class="op">&lt;-</span> <span class="va">ModisNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">mean</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">mean</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># summary(ModisNDVI.seminat)</span></span>
<span></span>
<span><span class="co">## Landsat</span></span>
<span><span class="co"># join nin.seminat &amp; Landsat NDVI data</span></span>
<span><span class="va">LandsatNDVI.seminat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join</a></span><span class="op">(</span><span class="va">nin.seminat</span>, <span class="va">df.l</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># summary(LandsatNDVI.seminat)</span></span>
<span><span class="va">LandsatNDVI.seminat</span> <span class="op">&lt;-</span> <span class="va">LandsatNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    hovedoekosystem <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">hovedoekosystem</span><span class="op">)</span>,</span>
<span>    hovedtype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">hovedtype</span><span class="op">)</span>,</span>
<span>    ninkartleggingsenheter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">ninkartleggingsenheter</span><span class="op">)</span>,</span>
<span>    lokalitetskvalitet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">lokalitetskvalitet</span><span class="op">)</span>,</span>
<span>    tilstand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">tilstand</span><span class="op">)</span>,</span>
<span>    area_meters <span class="op">=</span> <span class="fu">st_area</span><span class="op">(</span><span class="va">LandsatNDVI.seminat</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co"># summary(LandsatNDVI.seminat)</span></span>
<span><span class="co"># get rid of NAs (i.e. NDVI cells that were not in semi-natural polygons)</span></span>
<span><span class="va">LandsatNDVI.seminat</span> <span class="op">&lt;-</span> <span class="va">LandsatNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">hovedtype</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">LandsatNDVI.seminat</span> <span class="op">&lt;-</span> <span class="va">LandsatNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">mean</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># summary(LandsatNDVI.seminat)</span></span>
<span><span class="co"># get rid of any nin-polygons smaller than the Landsat grid cell size (900 sqm)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">LandsatNDVI.seminat</span><span class="op">)</span></span>
<span><span class="va">LandsatNDVI.seminat</span> <span class="op">&lt;-</span> <span class="va">LandsatNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">area_meters</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">900</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">LandsatNDVI.seminat</span><span class="op">)</span></span>
<span><span class="co"># split date into year, month &amp; day</span></span>
<span><span class="va">LandsatNDVI.seminat</span> <span class="op">&lt;-</span> <span class="va">LandsatNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    year <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html">year</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>,</span>
<span>    month <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html">month</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>,</span>
<span>    day <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html">day</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co"># we are using max NDVI per year in every NiN polygon</span></span>
<span><span class="va">LandsatNDVI.seminat</span> <span class="op">&lt;-</span> <span class="va">LandsatNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">mean</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">mean</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># summary(LandsatNDVI.seminat)</span></span></code></pre></div>
</div>
</div>
<div id="exploratory-analyses-sentinel-2" class="section level3" number="13.7.3">
<h3>
<span class="header-section-number">13.7.3</span> Exploratory analyses, Sentinel-2<a class="anchor" aria-label="anchor" href="#exploratory-analyses-sentinel-2"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Where are the seminat sites?</strong></p>
<div class="sourceCode" id="cb461"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tm_shape</span><span class="op">(</span><span class="va">regnor</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_fill</span><span class="op">(</span><span class="st">"GID_0"</span>, labels <span class="op">=</span> <span class="st">""</span>, title <span class="op">=</span> <span class="st">""</span>, legend.show <span class="op">=</span> <span class="cn">FALSE</span>, alpha<span class="op">=</span><span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_borders</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_shape</span><span class="op">(</span><span class="va">SentinelNDVI.seminat</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_dots</span><span class="op">(</span><span class="st">"hovedtype"</span>, midpoint <span class="op">=</span> <span class="cn">NA</span>, palette <span class="op">=</span> <span class="fu">tmaptools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tmaptools/man/get_brewer_pal.html">get_brewer_pal</a></span><span class="op">(</span><span class="st">"YlOrRd"</span>, <span class="fl">5</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, scale <span class="op">=</span> <span class="fl">2.5</span>, legend.show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_add_legend</span><span class="op">(</span></span>
<span>    type <span class="op">=</span> <span class="st">"symbol"</span>,</span>
<span>    col <span class="op">=</span> <span class="fu">tmaptools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tmaptools/man/get_brewer_pal.html">get_brewer_pal</a></span><span class="op">(</span><span class="st">"YlOrRd"</span>, <span class="fl">5</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"T31"</span>,</span>
<span>      <span class="st">"T32"</span>,</span>
<span>      <span class="st">"T33"</span>,</span>
<span>      <span class="st">"T34"</span>,</span>
<span>      <span class="st">"T40/41"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Major ecosystem type"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">1.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_layout</span><span class="op">(</span></span>
<span>    main.title <span class="op">=</span> <span class="st">"Semi-natural ecosystems \n(NiN, Miljødirektoratets instruks)"</span>,</span>
<span>    main.title.size <span class="op">=</span> <span class="fl">1.2</span>, legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"right"</span>, <span class="st">"bottom"</span><span class="op">)</span>,</span>
<span>    legend.text.size <span class="op">=</span> <span class="fl">1.3</span>, legend.title.size <span class="op">=</span> <span class="fl">1.4</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:where-are-seminat-sites"></span>
<img src="NDVI_seminat_files/figure-html/where-are-seminat-sites-1.png" alt="A map of Norway showing the location of the semi-natural ecosystem sites." width="672"><p class="caption">
Figure 13.1: A map of Norway showing the location of the semi-natural ecosystem sites.
</p>
</div>
<p>T31…Boreal heath, T32…semi-natural grasslands, T33…semi-natural coastal grasslands, T34…Coastal heathlands, T40/T41…previously heavily managed grasslands (now similar to T32)</p>
<p><strong>How are polygon sizes distributed?</strong></p>
<div class="sourceCode" id="cb462"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">SentinelNDVI.seminat</span><span class="op">$</span><span class="va">area_meters</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. </span></span>
<span><span class="co">#&gt;     111.6    1508.6    3714.9   15297.9   10059.0 2954478.0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">SentinelNDVI.seminat</span><span class="op">$</span><span class="va">area_meters</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20000</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fl">50000</span>,xlab<span class="op">=</span><span class="st">"Area"</span>,main<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">100</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:hist-sentinel-ndvis"></span>
<img src="NDVI_seminat_files/figure-html/hist-sentinel-ndvis-1.png" alt="A histogram showing the distribution of polygon sizes." width="672"><p class="caption">
Figure 13.2: A histogram showing the distribution of polygon sizes.
</p>
</div>
<p>Semi-natural polygons stretch a large number of sizes from just above
100 sqm to almost 3 million sqm. 75% of all polygons are below 15297
sqm.
The dashed line indicates the minimum size of the Sentinel-2 pixels for NDVI, all NiN-polygons smaller than that have been removed form the data.</p>
<p><strong>How does NDVI vary over the years</strong></p>
<div class="sourceCode" id="cb463"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SentinelNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">tilstand</span><span class="op">!=</span><span class="st">""</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">tilstand</span> <span class="op">~</span> <span class="va">hovedtype</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="op">-</span><span class="fl">45</span>, vjust <span class="op">=</span> <span class="fl">0.5</span>, hjust <span class="op">=</span> <span class="fl">0.2</span>, size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"NDVI across years for different ecosystem types in all condition classes"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"NDVI values (Sentinel-2)"</span>, x <span class="op">=</span> <span class="st">"Year"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:NDVI-values-over-time-ndvis"></span>
<img src="NDVI_seminat_files/figure-html/NDVI-values-over-time-ndvis-1.png" alt="A figure showing NDVI values for semi-natural ecosystem over time for six different main nature types in varying degrees of condition." width="672"><p class="caption">
Figure 13.3: A figure showing NDVI values for semi-natural ecosystem over time for six different main nature types in varying degrees of condition.
</p>
</div>
<p>2022 stands out with the highest NDVI values missing.
We omit 2022 for this analysis.</p>
<div class="sourceCode" id="cb464"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SentinelNDVI.seminat</span> <span class="op">&lt;-</span> <span class="va">SentinelNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">!=</span> <span class="st">"2022"</span><span class="op">)</span></span></code></pre></div>
<p><strong>How do NDVI values vary between major and basic ecosystem types for sites in good condition? (using only NDVI data matching NiN-mapping years)</strong></p>
<div class="sourceCode" id="cb465"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SentinelNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">tilstand</span> <span class="op">==</span> <span class="st">"God"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="va">kartleggingsaar</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">hovedtype</span>, y <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.7</span>, shape <span class="op">=</span> <span class="fl">16</span>, color <span class="op">=</span> <span class="st">"grey"</span>, position <span class="op">=</span> <span class="fu">position_jitter</span><span class="op">(</span><span class="fl">.1</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"NDVI for different ecosystem types in good condition"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"NDVI values (Sentinel-2)"</span>, x <span class="op">=</span> <span class="st">"Major ecosystem type"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:NDVI-major-basic-ndvis-1"></span>
<img src="NDVI_seminat_files/figure-html/NDVI-major-basic-ndvis-1.png" alt="NDVI values in major and basic semi natural ecosystem types in good condition." width="672"><p class="caption">
Figure 13.4: NDVI values in major and basic semi natural ecosystem types in good condition.
</p>
</div>
<div class="sourceCode" id="cb466"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">SentinelNDVI.seminat</span><span class="op">$</span><span class="va">subtype</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">SentinelNDVI.seminat</span><span class="op">$</span><span class="va">subtype</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"C1"</span>, <span class="st">"C2"</span>, <span class="st">"C3"</span>, <span class="st">"C4"</span>, <span class="st">"C5"</span>, <span class="st">"C6"</span>, <span class="st">"C7"</span>, <span class="st">"C8"</span>, <span class="st">"C9"</span>, <span class="st">"C10"</span>, <span class="st">"C11"</span>, <span class="st">"C12"</span>, <span class="st">"C13"</span>, <span class="st">"C14"</span>, <span class="st">"C15"</span>, <span class="st">"C16"</span>, <span class="st">"C17"</span>, <span class="st">"C18"</span>, <span class="st">"C19"</span>, <span class="st">"C20"</span>, <span class="st">"C21"</span>, <span class="st">"E1"</span>, <span class="st">"E2"</span>, <span class="st">"E3"</span>, <span class="st">"E4"</span>, <span class="st">"E5"</span>, <span class="st">"E6"</span>, <span class="st">"E7"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">SentinelNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">tilstand</span> <span class="op">==</span> <span class="st">"God"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="va">kartleggingsaar</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">subtype</span>, y <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.7</span>, shape <span class="op">=</span> <span class="fl">16</span>, color <span class="op">=</span> <span class="st">"grey"</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">hovedtype</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="op">-</span><span class="fl">45</span>, vjust <span class="op">=</span> <span class="fl">0.5</span>, hjust <span class="op">=</span> <span class="fl">0.2</span>, size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"NDVI for different ecosystem sub-types in good condition"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"NDVI values (Sentinel-2)"</span>, x <span class="op">=</span> <span class="st">"Ecosystem sub-type"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:NDVI-major-basic-ndvis-2"></span>
<img src="NDVI_seminat_files/figure-html/NDVI-major-basic-ndvis-2.png" alt="NDVI values in major and basic semi natural ecosystem types in good condition." width="672"><p class="caption">
Figure 13.5: NDVI values in major and basic semi natural ecosystem types in good condition.
</p>
</div>
<p>NDVI varies between major ecosystem types with the highest values in
semi-natural grasslands (T32) and in previously intensively used and
altered grasslands that today resemble a semi-natural grassland (T40,
T41), lowest values in coastal heathlands (T34). Other ecosystem types:
Boreal heath (T31), semi-natural coastal grasslands (T33). The overlaps
between the ecosystem types are considerable. With respect to basic
ecosystem types within the major types, NDVI appears to cover very
similar ranges across the subtypes, and those with deviating violin
plots have a smaller sample size. There is no obvious trend related to
the structuring environmental gradients withing the major types, and
also here the overlap is large.</p>
<p><strong>How does NDVI vary across regions in semi-natural ecosystems (major types) in good condition? (using only NDVI data matching NiN-mapping years)</strong></p>
<div class="sourceCode" id="cb467"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SentinelNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">tilstand</span> <span class="op">==</span> <span class="st">"God"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="va">kartleggingsaar</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">region</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">region</span>, y <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.7</span>, shape <span class="op">=</span> <span class="fl">16</span>, color <span class="op">=</span> <span class="st">"grey"</span>, position <span class="op">=</span> <span class="fu">position_jitter</span><span class="op">(</span><span class="fl">.1</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">hovedtype</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="op">-</span><span class="fl">45</span>, vjust <span class="op">=</span> <span class="fl">0.5</span>, hjust <span class="op">=</span> <span class="fl">0.2</span>, size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"NDVI for different ecosystems in good condition across regions"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"NDVI values (Sentinel-2)"</span>, x <span class="op">=</span> <span class="st">"Region"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:ndvi-regions-ndvis"></span>
<img src="NDVI_seminat_files/figure-html/ndvi-regions-ndvis-1.png" alt="DVI variation across regions in semi-natural ecosystems (major types) in good condition" width="672"><p class="caption">
Figure 13.6: DVI variation across regions in semi-natural ecosystems (major types) in good condition
</p>
</div>
<p>For the meadow systems (T32, T33, T40, T41) there is no obvious trends
in geography. In the heath systems (T31, T34) the distribution of NDVI
values in Central Norway is somewhat lower than in the other regions.</p>
<p><strong>How does NDVI vary across condition classes (for major types and NDVI data matching NiN-mapping years)</strong></p>
<div class="sourceCode" id="cb468"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SentinelNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="va">kartleggingsaar</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">tilstand</span>, y <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.7</span>, shape <span class="op">=</span> <span class="fl">16</span>, color <span class="op">=</span> <span class="st">"grey"</span>, position <span class="op">=</span> <span class="fu">position_jitter</span><span class="op">(</span><span class="fl">.1</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">hovedtype</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="op">-</span><span class="fl">45</span>, vjust <span class="op">=</span> <span class="fl">0.5</span>, hjust <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"NDVI for different ecosystems in different condition classes"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"NDVI values (Sentinel-2)"</span>, x <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:ndvi-condition-ndvis"></span>
<img src="NDVI_seminat_files/figure-html/ndvi-condition-ndvis-1.png" alt="NDVI values across semi-natural ecosystem sites in different ecological condition." width="672"><p class="caption">
Figure 13.7: NDVI values across semi-natural ecosystem sites in different ecological condition.
</p>
</div>
<p>In the coastal types (T33, T34, coastal meadows and heathlands,
respectively) NDVI seems to increase as condition deteriorates, but in
the remaining types such a pattern is absent. Overlaps between condition
classes are generally very large.</p>
<p><strong>Which ecological relevant variable(s) is the condition measure in the NiN data related to?</strong></p>
<div class="sourceCode" id="cb469"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nin.seminat2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">hovedtype</span> <span class="op">==</span> <span class="st">"T31"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">NiN_variable_code</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"7JB-BT"</span>, <span class="st">"7RA-BA"</span>, <span class="st">"7FA"</span>, <span class="st">"7TK"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>NiN_variable_des <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode</a></span><span class="op">(</span><span class="va">NiN_variable_code</span>,</span>
<span>    <span class="st">"7JB-BT"</span> <span class="op">=</span> <span class="st">"Grazing pressure"</span>,</span>
<span>    <span class="st">"7RA-BA"</span> <span class="op">=</span> <span class="st">"Succession"</span>,</span>
<span>    <span class="st">"7FA"</span> <span class="op">=</span> <span class="st">"Alien species"</span>,</span>
<span>    <span class="st">"7TK"</span> <span class="op">=</span> <span class="st">"Heavy vehicles"</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">NiN_variable_value</span>, y <span class="op">=</span> <span class="va">tilstand_num</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.25</span>, height <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">NiN_variable_des</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Condition variables in boreal heath (T31)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Condition level (0-3='good' to 'very reduced')"</span>, x <span class="op">=</span> <span class="st">"Condition variable score"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:important-variables-ndvis-1"></span>
<img src="NDVI_seminat_files/figure-html/important-variables-ndvis-1.png" alt="Which ecological relevant variable(s) is the condition measure in the NiN data related to?" width="672"><p class="caption">
Figure 13.8: Which ecological relevant variable(s) is the condition measure in the NiN data related to?
</p>
</div>
<div class="sourceCode" id="cb470"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">nin.seminat2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">hovedtype</span> <span class="op">==</span> <span class="st">"T32"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">NiN_variable_code</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"7JB-BA"</span>, <span class="st">"7RA-SJ"</span>, <span class="st">"7FA"</span>, <span class="st">"7SE"</span>, <span class="st">"7JB-GJ"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>NiN_variable_des <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode</a></span><span class="op">(</span><span class="va">NiN_variable_code</span>,</span>
<span>    <span class="st">"7JB-BA"</span> <span class="op">=</span> <span class="st">"Land-use intensity"</span>,</span>
<span>    <span class="st">"7RA-SJ"</span> <span class="op">=</span> <span class="st">"Succession"</span>,</span>
<span>    <span class="st">"7FA"</span> <span class="op">=</span> <span class="st">"Alien species"</span>,</span>
<span>    <span class="st">"7SE"</span> <span class="op">=</span> <span class="st">"Wear/tear"</span>,</span>
<span>    <span class="st">"7JB-GJ"</span> <span class="op">=</span> <span class="st">"Fertilization"</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">NiN_variable_value</span>, y <span class="op">=</span> <span class="va">tilstand_num</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.25</span>, height <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">NiN_variable_des</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Condition variables in semi-natural grasslands (T32)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Condition level (0-3='good' to 'very reduced')"</span>, x <span class="op">=</span> <span class="st">"Condition variable score"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:important-variables-ndvis-2"></span>
<img src="NDVI_seminat_files/figure-html/important-variables-ndvis-2.png" alt="Which ecological relevant variable(s) is the condition measure in the NiN data related to?" width="672"><p class="caption">
Figure 13.9: Which ecological relevant variable(s) is the condition measure in the NiN data related to?
</p>
</div>
<div class="sourceCode" id="cb471"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">nin.seminat2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">hovedtype</span> <span class="op">==</span> <span class="st">"T33"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">NiN_variable_code</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"7JB-BA"</span>, <span class="st">"7RA-SJ"</span>, <span class="st">"7FA"</span>, <span class="st">"7JB-GJ"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>NiN_variable_des <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode</a></span><span class="op">(</span><span class="va">NiN_variable_code</span>,</span>
<span>    <span class="st">"7JB-BA"</span> <span class="op">=</span> <span class="st">"Land-use intensity"</span>,</span>
<span>    <span class="st">"7RA-SJ"</span> <span class="op">=</span> <span class="st">"Succession"</span>,</span>
<span>    <span class="st">"7FA"</span> <span class="op">=</span> <span class="st">"Alien species"</span>,</span>
<span>    <span class="st">"7JB-GJ"</span> <span class="op">=</span> <span class="st">"Fertilization"</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">NiN_variable_value</span>, y <span class="op">=</span> <span class="va">tilstand_num</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.25</span>, height <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">NiN_variable_des</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Condition variables in semi-natural coastal grasslands (T33)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Condition level (0-3='good' to 'very reduced')"</span>, x <span class="op">=</span> <span class="st">"Condition variable score"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:important-variables-ndvis-3"></span>
<img src="NDVI_seminat_files/figure-html/important-variables-ndvis-3.png" alt="Which ecological relevant variable(s) is the condition measure in the NiN data related to?" width="672"><p class="caption">
Figure 13.10: Which ecological relevant variable(s) is the condition measure in the NiN data related to?
</p>
</div>
<div class="sourceCode" id="cb472"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">nin.seminat2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">hovedtype</span> <span class="op">==</span> <span class="st">"T34"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">NiN_variable_code</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"7JB-BT"</span>, <span class="st">"7RA-SJ"</span>, <span class="st">"7FA"</span>, <span class="st">"7TK"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>NiN_variable_des <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode</a></span><span class="op">(</span><span class="va">NiN_variable_code</span>,</span>
<span>    <span class="st">"7JB-BT"</span> <span class="op">=</span> <span class="st">"Grazing pressure"</span>,</span>
<span>    <span class="st">"7RA-SJ"</span> <span class="op">=</span> <span class="st">"Succession"</span>,</span>
<span>    <span class="st">"7FA"</span> <span class="op">=</span> <span class="st">"Alien species"</span>,</span>
<span>    <span class="st">"7TK"</span> <span class="op">=</span> <span class="st">"Heavy vehicles"</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">NiN_variable_value</span>, y <span class="op">=</span> <span class="va">tilstand_num</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.25</span>, height <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">NiN_variable_des</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Condition variables in coastal heathlands (T34)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Condition level (0-3='good' to 'very reduced')"</span>, x <span class="op">=</span> <span class="st">"Condition variable score"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:important-variables-ndvis-4"></span>
<img src="NDVI_seminat_files/figure-html/important-variables-ndvis-4.png" alt="Which ecological relevant variable(s) is the condition measure in the NiN data related to?" width="672"><p class="caption">
Figure 13.11: Which ecological relevant variable(s) is the condition measure in the NiN data related to?
</p>
</div>
<div class="sourceCode" id="cb473"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">nin.seminat2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">hovedtype</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"T40"</span>, <span class="st">"T41"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">NiN_variable_code</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"7JB-BA"</span>, <span class="st">"7RA-SJ"</span>, <span class="st">"7FA"</span>, <span class="st">"7SE"</span>, <span class="st">"7JB-GJ"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>NiN_variable_des <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode</a></span><span class="op">(</span><span class="va">NiN_variable_code</span>,</span>
<span>    <span class="st">"7JB-BA"</span> <span class="op">=</span> <span class="st">"Land-use intensity"</span>,</span>
<span>    <span class="st">"7RA-SJ"</span> <span class="op">=</span> <span class="st">"Succession"</span>,</span>
<span>    <span class="st">"7FA"</span> <span class="op">=</span> <span class="st">"Alien species"</span>,</span>
<span>    <span class="st">"7SE"</span> <span class="op">=</span> <span class="st">"Wear/tear"</span>,</span>
<span>    <span class="st">"7JB-GJ"</span> <span class="op">=</span> <span class="st">"Fertilization"</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">NiN_variable_value</span>, y <span class="op">=</span> <span class="va">tilstand_num</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.25</span>, height <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">NiN_variable_des</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Condition variables in previously heavily altered grasslands (T40/T41)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Condition level (0-3='good' to 'very reduced')"</span>, x <span class="op">=</span> <span class="st">"Condition variable score"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:important-variables-ndvis-5"></span>
<img src="NDVI_seminat_files/figure-html/important-variables-ndvis-5.png" alt="Which ecological relevant variable(s) is the condition measure in the NiN data related to?" width="672"><p class="caption">
Figure 13.12: Which ecological relevant variable(s) is the condition measure in the NiN data related to?
</p>
</div>
<p>In these plots, the panels for the different major ecosystem types
differ because Miljødirektoratets mapping manual (see reference list
above) uses different variables in these major ecosystem types to define
condition.</p>
<p>In the heath systems - T31 and T34 - reduced condition is mainly related
to low levels of grazing and ongoing succession (but also too intensive
grazing). In the meadow systems - T32, T33, T40, T41 - reduced condition
is related to low levels of land-use intensity and ongoing succession
(but also too intensive land use). In addition, reduced condition is
related to high abundance of alien species in all major semi-natural
ecosystem types.</p>
</div>
<div id="regression-analyses-sentinel-2-ndvi-as-a-function-of-condition" class="section level3" number="13.7.4">
<h3>
<span class="header-section-number">13.7.4</span> Regression analyses Sentinel-2, NDVI as a function of condition<a class="anchor" aria-label="anchor" href="#regression-analyses-sentinel-2-ndvi-as-a-function-of-condition"><i class="fas fa-link"></i></a>
</h3>
<p>We can investigate further how NDVI and condition are connected using
regression analyses.</p>
<p>First, we take a look at how balanced the data are across major
ecosystem types, regions and condition classes</p>
<div class="sourceCode" id="cb474"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># NDVI across hovedtyper, regions and condition classes (only for NDVI years data matching NiN-mapping years)</span></span>
<span><span class="va">SentinelNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">region</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="va">kartleggingsaar</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">tilstand</span>, y <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.7</span>, shape <span class="op">=</span> <span class="fl">16</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">region</span> <span class="op">~</span> <span class="va">hovedtype</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="op">-</span><span class="fl">45</span>, vjust <span class="op">=</span> <span class="fl">0.5</span>, hjust <span class="op">=</span> <span class="fl">0.2</span>, size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"NDVI values (Sentinel-2)"</span>, x <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:balanced-data-ndvis"></span>
<img src="NDVI_seminat_files/figure-html/balanced-data-ndvis-1.png" alt="NDVI values across a condition gradient, faceted by six semi natural ecosystem types in five regions in Norway. " width="672"><p class="caption">
Figure 13.13: NDVI values across a condition gradient, faceted by six semi natural ecosystem types in five regions in Norway.
</p>
</div>
<p>T41 is has only very few data and is present in 2 regions only, we omit
it. Northern Norway does not have any T34 occurrences and very few T33
and T40, we won’t be able to model it together with the other regions,
and might need to model T31 and T32 there only.</p>
<p>NDVI data are bounded between -1 and 1, and thus require modelling with
an appropriate method that can handle bounded data. We can transform the
variable to be bounded between 0 and 1 and use beta-regression models:</p>
<div class="sourceCode" id="cb475"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SentinelNDVI.seminat</span><span class="op">$</span><span class="va">mean_beta</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">SentinelNDVI.seminat</span><span class="op">$</span><span class="va">mean</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span><span class="co"># NDVI data from the year of NiN-mapping (and thus with condition assessment) to train the condition models</span></span>
<span><span class="co"># we drop T41 for the analysis as it lacks data for most combinations of condition and region, and thus would cause convergence issues</span></span>
<span><span class="va">SentinelNDVI.seminat.train</span> <span class="op">&lt;-</span> <span class="va">SentinelNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="va">kartleggingsaar</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">hovedtype</span> <span class="op">!=</span> <span class="st">"T41"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># check if there's any 0s or 1s (which beta cannot handle)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">SentinelNDVI.seminat.train</span><span class="op">$</span><span class="va">mean_beta</span><span class="op">)</span> <span class="co"># ok</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;  0.6286  0.8323  0.8627  0.8541  0.8847  0.9333</span></span>
<span><span class="va">LandsatNDVI.seminat</span><span class="op">$</span><span class="va">mean_beta</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">LandsatNDVI.seminat</span><span class="op">$</span><span class="va">mean</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span><span class="co"># replace 1s in Landsat data with 0.9999</span></span>
<span><span class="va">LandsatNDVI.seminat</span> <span class="op">&lt;-</span> <span class="va">LandsatNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>mean_beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/replace.html">replace</a></span><span class="op">(</span><span class="va">mean_beta</span>, <span class="va">mean_beta</span> <span class="op">==</span> <span class="fl">1</span>, <span class="fl">0.9999</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<!-- RUNTIME approx. 2 min -->
<div class="sourceCode" id="cb476"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We run a stepwise-function on the full model including condition, ecosystem type, and region to find the most parsimonious model</span></span>
<span><span class="va">model.seminat.cond.Sent</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/betareg/man/betareg.html">betareg</a></span><span class="op">(</span><span class="va">mean_beta</span> <span class="op">~</span> <span class="va">tilstand_num</span> <span class="op">*</span> <span class="va">region</span> <span class="op">*</span> <span class="va">hovedtype</span>, data <span class="op">=</span> <span class="va">SentinelNDVI.seminat.train</span><span class="op">[</span><span class="va">SentinelNDVI.seminat.train</span><span class="op">$</span><span class="va">region</span> <span class="op">!=</span> <span class="st">"Northern Norway"</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="va">model.seminat.cond.Sent</span> <span class="op">&lt;-</span> <span class="fu">StepBeta</span><span class="op">(</span><span class="va">model.seminat.cond.Sent</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.seminat.cond.Sent</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Caching</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">model.seminat.cond.Sent</span>, </span>
<span>        <span class="st">"/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/cache/model.seminat.cond.Sent.rds"</span><span class="op">)</span></span></code></pre></div>
<p>NDVI values do vary between: - Regions - Ecosystem types - Condition
classes</p>
<p>It is evident that there are differences between regions.
But since we are not interested in the statistics for region differences,
we run <strong>separate models for every region</strong> for ease of interpretation.</p>
<!-- RUNTIME 5 sec -->
<div class="sourceCode" id="cb477"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model.seminat.cond.Sent.N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/betareg/man/betareg.html">betareg</a></span><span class="op">(</span><span class="va">mean_beta</span> <span class="op">~</span> <span class="va">tilstand_num</span> <span class="op">*</span> <span class="va">hovedtype</span>, data <span class="op">=</span> <span class="va">SentinelNDVI.seminat.train</span><span class="op">[</span><span class="va">SentinelNDVI.seminat.train</span><span class="op">$</span><span class="va">region</span> <span class="op">==</span> <span class="st">"Northern Norway"</span> <span class="op">&amp;</span> <span class="va">SentinelNDVI.seminat.train</span><span class="op">$</span><span class="va">hovedtype</span> <span class="op">!=</span> <span class="st">"T34"</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="va">model.seminat.cond.Sent.C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/betareg/man/betareg.html">betareg</a></span><span class="op">(</span><span class="va">mean_beta</span> <span class="op">~</span> <span class="va">tilstand_num</span> <span class="op">*</span> <span class="va">hovedtype</span>, data <span class="op">=</span> <span class="va">SentinelNDVI.seminat.train</span><span class="op">[</span><span class="va">SentinelNDVI.seminat.train</span><span class="op">$</span><span class="va">region</span> <span class="op">==</span> <span class="st">"Central Norway"</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="va">model.seminat.cond.Sent.W</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/betareg/man/betareg.html">betareg</a></span><span class="op">(</span><span class="va">mean_beta</span> <span class="op">~</span> <span class="va">tilstand_num</span> <span class="op">*</span> <span class="va">hovedtype</span>, data <span class="op">=</span> <span class="va">SentinelNDVI.seminat.train</span><span class="op">[</span><span class="va">SentinelNDVI.seminat.train</span><span class="op">$</span><span class="va">region</span> <span class="op">==</span> <span class="st">"Western Norway"</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="va">model.seminat.cond.Sent.E</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/betareg/man/betareg.html">betareg</a></span><span class="op">(</span><span class="va">mean_beta</span> <span class="op">~</span> <span class="va">tilstand_num</span> <span class="op">*</span> <span class="va">hovedtype</span>, data <span class="op">=</span> <span class="va">SentinelNDVI.seminat.train</span><span class="op">[</span><span class="va">SentinelNDVI.seminat.train</span><span class="op">$</span><span class="va">region</span> <span class="op">==</span> <span class="st">"Eastern Norway"</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="va">model.seminat.cond.Sent.S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/betareg/man/betareg.html">betareg</a></span><span class="op">(</span><span class="va">mean_beta</span> <span class="op">~</span> <span class="va">tilstand_num</span> <span class="op">*</span> <span class="va">hovedtype</span>, data <span class="op">=</span> <span class="va">SentinelNDVI.seminat.train</span><span class="op">[</span><span class="va">SentinelNDVI.seminat.train</span><span class="op">$</span><span class="va">region</span> <span class="op">==</span> <span class="st">"Southern Norway"</span>, <span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><strong>Northern Norway</strong></p>
<div class="sourceCode" id="cb478"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SentinelNDVI.seminat.train</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">region</span> <span class="op">==</span> <span class="st">"Northern Norway"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">tilstand</span>, y <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.7</span>, shape <span class="op">=</span> <span class="fl">16</span>, color <span class="op">=</span> <span class="st">"grey"</span>, position <span class="op">=</span> <span class="fu">position_jitter</span><span class="op">(</span><span class="fl">.1</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="op">-</span><span class="fl">45</span>, vjust <span class="op">=</span> <span class="fl">0.5</span>, hjust <span class="op">=</span> <span class="fl">0.2</span>, size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Northern Norway"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"NDVI values (Sentinel-2)"</span>, x <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">hovedtype</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:north-nvdi-vs-tilstand-ndvis"></span>
<img src="NDVI_seminat_files/figure-html/north-nvdi-vs-tilstand-ndvis-1.png" alt="NDVI agains ecosystm condition for five semi-natural ecosystems in Northern Norway." width="672"><p class="caption">
Figure 13.14: NDVI agains ecosystm condition for five semi-natural ecosystems in Northern Norway.
</p>
</div>
<div class="sourceCode" id="cb479"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.seminat.cond.Sent.N</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;                              Estimate  Std. Error</span></span>
<span><span class="co">#&gt; (Intercept)                1.64415534 0.010995779</span></span>
<span><span class="co">#&gt; tilstand_num               0.07658679 0.007020091</span></span>
<span><span class="co">#&gt; hovedtypeT32               0.32588773 0.015169077</span></span>
<span><span class="co">#&gt; hovedtypeT33              -0.04037829 0.079834264</span></span>
<span><span class="co">#&gt; hovedtypeT40              -0.09084877 0.054787510</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT32 -0.06323568 0.008606086</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT33  0.04215782 0.056292800</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT40 -0.01336016 0.080919730</span></span>
<span><span class="co">#&gt;                               z value      Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; (Intercept)               149.5260480  0.000000e+00</span></span>
<span><span class="co">#&gt; tilstand_num               10.9096585  1.036450e-27</span></span>
<span><span class="co">#&gt; hovedtypeT32               21.4836879 2.212261e-102</span></span>
<span><span class="co">#&gt; hovedtypeT33               -0.5057765  6.130136e-01</span></span>
<span><span class="co">#&gt; hovedtypeT40               -1.6582023  9.727665e-02</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT32  -7.3477868  2.015156e-13</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT33   0.7489025  4.539160e-01</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT40  -0.1651039  8.688622e-01</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $precision</span></span>
<span><span class="co">#&gt;       Estimate Std. Error  z value Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; (phi) 208.7112   5.124613 40.72722        0</span></span></code></pre></div>
<p>NDVI in good condition: T32 &gt; T31/T33 &gt; T40 (last not sig. but very
few data)</p>
<p>T31,T33,T40: NDVI increases as condition deteriorates T32: NDVI does not
change with condition</p>
<p><strong>Central Norway</strong></p>
<div class="sourceCode" id="cb480"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SentinelNDVI.seminat.train</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">region</span> <span class="op">==</span> <span class="st">"Central Norway"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">tilstand</span>, y <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.7</span>, shape <span class="op">=</span> <span class="fl">16</span>, color <span class="op">=</span> <span class="st">"grey"</span>, position <span class="op">=</span> <span class="fu">position_jitter</span><span class="op">(</span><span class="fl">.1</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="op">-</span><span class="fl">45</span>, vjust <span class="op">=</span> <span class="fl">0.5</span>, hjust <span class="op">=</span> <span class="fl">0.2</span>, size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Central Norway"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"NDVI values (Sentinel-2)"</span>, x <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">hovedtype</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:central-nvdi-vs-tilstand-ndvis"></span>
<img src="NDVI_seminat_files/figure-html/central-nvdi-vs-tilstand-ndvis-1.png" alt="NDVI against ecosystem condition for five semi-natural ecosystems in Central Norway." width="672"><p class="caption">
Figure 13.15: NDVI against ecosystem condition for five semi-natural ecosystems in Central Norway.
</p>
</div>
<div class="sourceCode" id="cb481"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.seminat.cond.Sent.C</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;                              Estimate Std. Error   z value</span></span>
<span><span class="co">#&gt; (Intercept)                1.22774728 0.01731295 70.914970</span></span>
<span><span class="co">#&gt; tilstand_num               0.15691924 0.01329505 11.802830</span></span>
<span><span class="co">#&gt; hovedtypeT32               0.62582634 0.01963605 31.871297</span></span>
<span><span class="co">#&gt; hovedtypeT33               0.27267266 0.02650528 10.287483</span></span>
<span><span class="co">#&gt; hovedtypeT34               0.07427412 0.01938164  3.832189</span></span>
<span><span class="co">#&gt; hovedtypeT40               0.26718403 0.03474356  7.690173</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT32 -0.09927187 0.01432066 -6.932074</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT33 -0.08603560 0.02475601 -3.475341</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT34 -0.07170670 0.01439664 -4.980793</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT40 -0.12411621 0.03869858 -3.207255</span></span>
<span><span class="co">#&gt;                                Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; (Intercept)                0.000000e+00</span></span>
<span><span class="co">#&gt; tilstand_num               3.774033e-32</span></span>
<span><span class="co">#&gt; hovedtypeT32              6.673860e-223</span></span>
<span><span class="co">#&gt; hovedtypeT33               8.024663e-25</span></span>
<span><span class="co">#&gt; hovedtypeT34               1.270081e-04</span></span>
<span><span class="co">#&gt; hovedtypeT40               1.469358e-14</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT32  4.147161e-12</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT33  5.102038e-04</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT34  6.332410e-07</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT40  1.340081e-03</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $precision</span></span>
<span><span class="co">#&gt;       Estimate Std. Error  z value Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; (phi) 119.0685   2.215105 53.75297        0</span></span></code></pre></div>
<p>NDVI in good condition: T32 &gt; T33/T34/T40 &gt; T31</p>
<p>T31: NDVI increases as condition deteriorates T32/T33/T34/T40: NDVI
increases sig. less than in T31 as condition deteriorates, but it still
increases</p>
<p><strong>Western Norway</strong></p>
<div class="sourceCode" id="cb482"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SentinelNDVI.seminat.train</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">region</span> <span class="op">==</span> <span class="st">"Western Norway"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">tilstand</span>, y <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.7</span>, shape <span class="op">=</span> <span class="fl">16</span>, color <span class="op">=</span> <span class="st">"grey"</span>, position <span class="op">=</span> <span class="fu">position_jitter</span><span class="op">(</span><span class="fl">.1</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="op">-</span><span class="fl">45</span>, vjust <span class="op">=</span> <span class="fl">0.5</span>, hjust <span class="op">=</span> <span class="fl">0.2</span>, size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Western Norway"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"NDVI values (Sentinel-2)"</span>, x <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">hovedtype</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:west-nvdi-vs-tilstand-ndvis"></span>
<img src="NDVI_seminat_files/figure-html/west-nvdi-vs-tilstand-ndvis-1.png" alt="NDVI agains ecosystm condition for five semi-natural ecosystems in W-Norway." width="672"><p class="caption">
Figure 13.16: NDVI agains ecosystm condition for five semi-natural ecosystems in W-Norway.
</p>
</div>
<div class="sourceCode" id="cb483"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.seminat.cond.Sent.W</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;                               Estimate Std. Error</span></span>
<span><span class="co">#&gt; (Intercept)                1.735847267 0.05313826</span></span>
<span><span class="co">#&gt; tilstand_num               0.057295177 0.02511492</span></span>
<span><span class="co">#&gt; hovedtypeT32               0.083194970 0.05376401</span></span>
<span><span class="co">#&gt; hovedtypeT33              -0.334452794 0.06349165</span></span>
<span><span class="co">#&gt; hovedtypeT34              -0.260143425 0.05477030</span></span>
<span><span class="co">#&gt; hovedtypeT40              -0.085010435 0.06743251</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT32 -0.005239066 0.02561689</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT33 -0.018241211 0.03678248</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT34  0.003840380 0.02579273</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT40 -0.039969775 0.04700781</span></span>
<span><span class="co">#&gt;                              z value      Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; (Intercept)               32.6666195 4.654419e-234</span></span>
<span><span class="co">#&gt; tilstand_num               2.2813203  2.252950e-02</span></span>
<span><span class="co">#&gt; hovedtypeT32               1.5474100  1.217644e-01</span></span>
<span><span class="co">#&gt; hovedtypeT33              -5.2676656  1.381695e-07</span></span>
<span><span class="co">#&gt; hovedtypeT34              -4.7497167  2.037018e-06</span></span>
<span><span class="co">#&gt; hovedtypeT40              -1.2606743  2.074262e-01</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT32 -0.2045161  8.379502e-01</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT33 -0.4959212  6.199500e-01</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT34  0.1488939  8.816373e-01</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT40 -0.8502795  3.951697e-01</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $precision</span></span>
<span><span class="co">#&gt;       Estimate Std. Error  z value Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; (phi) 128.1346    2.73882 46.78459        0</span></span></code></pre></div>
<p>NDVI in good condition: T31/T32/T40 &gt; T33/T34</p>
<p>all types: NDVI increases slightly as condition deteriorates, but just
about sig.</p>
<p><strong>Eastern Norway</strong></p>
<div class="sourceCode" id="cb484"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SentinelNDVI.seminat.train</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">region</span> <span class="op">==</span> <span class="st">"Eastern Norway"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">tilstand</span>, y <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.7</span>, shape <span class="op">=</span> <span class="fl">16</span>, color <span class="op">=</span> <span class="st">"grey"</span>, position <span class="op">=</span> <span class="fu">position_jitter</span><span class="op">(</span><span class="fl">.1</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="op">-</span><span class="fl">45</span>, vjust <span class="op">=</span> <span class="fl">0.5</span>, hjust <span class="op">=</span> <span class="fl">0.2</span>, size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Eastern Norway"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"NDVI values (Sentinel-2)"</span>, x <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">hovedtype</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:east-nvdi-vs-tilstand-ndvis"></span>
<img src="NDVI_seminat_files/figure-html/east-nvdi-vs-tilstand-ndvis-1.png" alt="NDVI against ecosystem condition for five semi-natural ecosystems in E-Norway." width="672"><p class="caption">
Figure 13.17: NDVI against ecosystem condition for five semi-natural ecosystems in E-Norway.
</p>
</div>
<div class="sourceCode" id="cb485"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.seminat.cond.Sent.E</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;                                Estimate  Std. Error</span></span>
<span><span class="co">#&gt; (Intercept)                1.6546047246 0.016449665</span></span>
<span><span class="co">#&gt; tilstand_num               0.0263501777 0.008052426</span></span>
<span><span class="co">#&gt; hovedtypeT32               0.2002941827 0.018021762</span></span>
<span><span class="co">#&gt; hovedtypeT33              -0.2773641962 0.036663349</span></span>
<span><span class="co">#&gt; hovedtypeT34              -0.8724991879 0.173082055</span></span>
<span><span class="co">#&gt; hovedtypeT40              -0.0002143578 0.025184855</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT32  0.0081680904 0.008958606</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT33  0.0737223863 0.025204980</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT34  0.0361838511 0.116924722</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT40  0.0067977292 0.018495037</span></span>
<span><span class="co">#&gt;                                 z value     Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; (Intercept)               100.585920439 0.000000e+00</span></span>
<span><span class="co">#&gt; tilstand_num                3.272327931 1.066658e-03</span></span>
<span><span class="co">#&gt; hovedtypeT32               11.114017527 1.072244e-28</span></span>
<span><span class="co">#&gt; hovedtypeT33               -7.565162528 3.873799e-14</span></span>
<span><span class="co">#&gt; hovedtypeT34               -5.040956959 4.632096e-07</span></span>
<span><span class="co">#&gt; hovedtypeT40               -0.008511377 9.932090e-01</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT32   0.911759109 3.618955e-01</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT33   2.924913468 3.445520e-03</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT34   0.309462793 7.569695e-01</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT40   0.367543424 7.132137e-01</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $precision</span></span>
<span><span class="co">#&gt;       Estimate Std. Error  z value Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; (phi) 146.5212   2.806937 52.19967        0</span></span></code></pre></div>
<p>NDVI in good condition: T32 &gt; T31/T40 &gt; T33 &gt; T34</p>
<p>T31/T32/T34/T40: NDVI increases slightly as condition deteriorates T33:
NDVI increases as condition deteriorates, more strongly than in the
other types</p>
<p><strong>Southern Norway</strong></p>
<div class="sourceCode" id="cb486"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SentinelNDVI.seminat.train</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">region</span> <span class="op">==</span> <span class="st">"Southern Norway"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">tilstand</span>, y <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.7</span>, shape <span class="op">=</span> <span class="fl">16</span>, color <span class="op">=</span> <span class="st">"grey"</span>, position <span class="op">=</span> <span class="fu">position_jitter</span><span class="op">(</span><span class="fl">.1</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="op">-</span><span class="fl">45</span>, vjust <span class="op">=</span> <span class="fl">0.5</span>, hjust <span class="op">=</span> <span class="fl">0.2</span>, size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Southern Norway"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"NDVI values (Sentinel-2)"</span>, x <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">hovedtype</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:south-nvdi-vs-tilstand-ndvis"></span>
<img src="NDVI_seminat_files/figure-html/south-nvdi-vs-tilstand-ndvis-1.png" alt="NDVI against ecosystem condition for five semi-natural ecosystems in S-Norway." width="672"><p class="caption">
Figure 13.18: NDVI against ecosystem condition for five semi-natural ecosystems in S-Norway.
</p>
</div>
<div class="sourceCode" id="cb487"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.seminat.cond.Sent.S</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;                               Estimate Std. Error</span></span>
<span><span class="co">#&gt; (Intercept)                1.659442006 0.02805242</span></span>
<span><span class="co">#&gt; tilstand_num               0.031677650 0.01582980</span></span>
<span><span class="co">#&gt; hovedtypeT32               0.209644262 0.03143978</span></span>
<span><span class="co">#&gt; hovedtypeT33              -0.141424820 0.05424488</span></span>
<span><span class="co">#&gt; hovedtypeT34              -0.095889437 0.07510055</span></span>
<span><span class="co">#&gt; hovedtypeT40              -0.135125543 0.05475481</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT32  0.003853678 0.01755278</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT33  0.052543902 0.02912373</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT34  0.095449312 0.03230053</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT40 -0.049736550 0.06712609</span></span>
<span><span class="co">#&gt;                              z value     Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; (Intercept)               59.1550299 0.000000e+00</span></span>
<span><span class="co">#&gt; tilstand_num               2.0011409 4.537721e-02</span></span>
<span><span class="co">#&gt; hovedtypeT32               6.6681208 2.590995e-11</span></span>
<span><span class="co">#&gt; hovedtypeT33              -2.6071554 9.129791e-03</span></span>
<span><span class="co">#&gt; hovedtypeT34              -1.2768141 2.016679e-01</span></span>
<span><span class="co">#&gt; hovedtypeT40              -2.4678295 1.359350e-02</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT32  0.2195480 8.262232e-01</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT33  1.8041611 7.120606e-02</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT34  2.9550388 3.126297e-03</span></span>
<span><span class="co">#&gt; tilstand_num:hovedtypeT40 -0.7409422 4.587285e-01</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $precision</span></span>
<span><span class="co">#&gt;       Estimate Std. Error  z value      Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; (phi) 153.2421   5.511914 27.80198 4.105499e-170</span></span></code></pre></div>
<p>NDVI in good condition: T32 &gt; T31/T40 &gt; T33/T34</p>
<p>T31/T32: borderline NDVI increases as condition deteriorates T33/T34:
NDVI increases as condition deteriorates T40: insufficient power</p>
<br><br><hr>
<blockquote>
<p>Overall take home messages:</p>
<p>In semi-natural ecosystems NDVI increases as ecosystem condition deteriorates, but the effect sizes vary with major ecosystem types. Boreal heath shows the most consistent increases, and also coastal meadows and coastal heathlands show increases in parts of the country. Semi-natural and semi-natural-looking meadows show very tiny increases if any at all.</p>
</blockquote>
<hr>
</div>
<div id="ndvi-across-time---sentinel-modis-landsat" class="section level3" number="13.7.5">
<h3>
<span class="header-section-number">13.7.5</span> NDVI across time - Sentinel, MODIS &amp; LandSat<a class="anchor" aria-label="anchor" href="#ndvi-across-time---sentinel-modis-landsat"><i class="fas fa-link"></i></a>
</h3>
<p>As a last step, we can investigate how NDVI has changed over time. For
this we include data from both MODIS and Landsat in addition to
Sentinel-2.</p>
<p>First, there’s again some data handling to do. We merge the Sentinel,
MODIS, and Landsat data to show the full picture across time. Then we
model the time series for each Satellite separately.</p>
<div class="sourceCode" id="cb488"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## data handling for time series analysis</span></span>
<span><span class="co"># Sentinel time series checked in exploratory analysis script</span></span>
<span></span>
<span><span class="co"># checking time series for MODIS</span></span>
<span>   <span class="co">#ModisNDVI.seminat %&gt;%</span></span>
<span>   <span class="co">#  group_by(id, year) %&gt;%</span></span>
<span>   <span class="co">#  filter(mean == max(mean, na.rm = TRUE)) %&gt;%</span></span>
<span>   <span class="co">#  ggplot(aes(x = year, y = mean)) +</span></span>
<span>   <span class="co">#  geom_point() +</span></span>
<span>   <span class="co">#  facet_wrap(~hovedtype)</span></span>
<span><span class="co"># 2022 does not stand out as in the Sentinel data, so we keep it</span></span>
<span><span class="va">ModisNDVI.seminat</span> <span class="op">&lt;-</span> <span class="va">ModisNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">mean</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">mean</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># checking time series for Landsat</span></span>
<span>   <span class="co">#LandsatNDVI.seminat %&gt;%</span></span>
<span>   <span class="co">#  group_by(id, year) %&gt;%</span></span>
<span>   <span class="co">#  filter(mean == max(mean, na.rm = TRUE)) %&gt;%</span></span>
<span>   <span class="co">#  ggplot(aes(x = year, y = mean)) +</span></span>
<span>   <span class="co">#  geom_point() +</span></span>
<span>   <span class="co">#  facet_wrap(~hovedtype)</span></span>
<span><span class="co"># nothing worrying to see here either</span></span>
<span><span class="va">LandsatNDVI.seminat</span> <span class="op">&lt;-</span> <span class="va">LandsatNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">mean</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">mean</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># transformation of NDVI scale to beta scale</span></span>
<span><span class="co"># SentinelNDVI.seminat$mean_beta &lt;- (SentinelNDVI.seminat$mean + 1) / 2</span></span>
<span><span class="va">ModisNDVI.seminat</span><span class="op">$</span><span class="va">mean_beta</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ModisNDVI.seminat</span><span class="op">$</span><span class="va">mean</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span><span class="va">LandsatNDVI.seminat</span><span class="op">$</span><span class="va">mean_beta</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">LandsatNDVI.seminat</span><span class="op">$</span><span class="va">mean</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span></span>
<span><span class="co"># check if there's any 0s or 1s (which beta cannot handle)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">SentinelNDVI.seminat</span><span class="op">$</span><span class="va">mean_beta</span><span class="op">)</span> <span class="co"># ok</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">ModisNDVI.seminat</span><span class="op">$</span><span class="va">mean_beta</span><span class="op">)</span> <span class="co"># ok</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">LandsatNDVI.seminat</span><span class="op">$</span><span class="va">mean_beta</span><span class="op">)</span> <span class="co"># has 1's</span></span>
<span><span class="co"># replace 1s in Landsat data with 0.9999</span></span>
<span><span class="va">LandsatNDVI.seminat</span> <span class="op">&lt;-</span> <span class="va">LandsatNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>mean_beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/replace.html">replace</a></span><span class="op">(</span><span class="va">mean_beta</span>, <span class="va">mean_beta</span> <span class="op">==</span> <span class="fl">1</span>, <span class="fl">0.9999</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># check if the three Satellite objects have the same structure (for concatenating them)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">SentinelNDVI.seminat</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">ModisNDVI.seminat</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">LandsatNDVI.seminat</span><span class="op">)</span></span>
<span><span class="co"># Sentinel and Landsat have each an extra column -&gt; omit them when concatenating further below</span></span>
<span><span class="co"># one column is named slightly differently in the Sentinel data -&gt; rename it</span></span>
<span><span class="va">SentinelNDVI.seminat</span> <span class="op">&lt;-</span> <span class="va">SentinelNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="st">"system.index"</span> <span class="op">=</span> <span class="st">"system:index"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># check if they have the same geometry</span></span>
<span><span class="fu">st_crs</span><span class="op">(</span><span class="va">SentinelNDVI.seminat</span><span class="op">)</span></span>
<span><span class="fu">st_crs</span><span class="op">(</span><span class="va">ModisNDVI.seminat</span><span class="op">)</span></span>
<span><span class="fu">st_crs</span><span class="op">(</span><span class="va">LandsatNDVI.seminat</span><span class="op">)</span></span>
<span><span class="co"># all good</span></span>
<span></span>
<span><span class="co"># add an increment to the year variable to avoid overlapping data being hidden in figures</span></span>
<span><span class="va">SentinelNDVI.seminat</span><span class="op">$</span><span class="va">year_jit</span> <span class="op">&lt;-</span> <span class="va">SentinelNDVI.seminat</span><span class="op">$</span><span class="va">year</span> <span class="op">+</span> <span class="fl">0.3</span></span>
<span><span class="va">ModisNDVI.seminat</span><span class="op">$</span><span class="va">year_jit</span> <span class="op">&lt;-</span> <span class="va">ModisNDVI.seminat</span><span class="op">$</span><span class="va">year</span> <span class="op">-</span> <span class="fl">0.3</span></span>
<span><span class="va">LandsatNDVI.seminat</span><span class="op">$</span><span class="va">year_jit</span> <span class="op">&lt;-</span> <span class="va">LandsatNDVI.seminat</span><span class="op">$</span><span class="va">year</span></span>
<span></span>
<span><span class="co"># concatenate the three Satellite objects</span></span>
<span><span class="va">allSatNDVI.seminat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span></span>
<span>  <span class="va">SentinelNDVI.seminat</span><span class="op">[</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">SentinelNDVI.seminat</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="st">"subtype"</span><span class="op">]</span>,</span>
<span>  <span class="va">ModisNDVI.seminat</span>,</span>
<span>  <span class="va">LandsatNDVI.seminat</span><span class="op">[</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">LandsatNDVI.seminat</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="st">"column_label"</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># add variable for Satellite identity</span></span>
<span><span class="va">allSatNDVI.seminat</span><span class="op">$</span><span class="va">Sat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Sentinel"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">SentinelNDVI.seminat</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Modis"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">ModisNDVI.seminat</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Landsat"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">LandsatNDVI.seminat</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">allSatNDVI.seminat</span><span class="op">$</span><span class="va">Sat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">allSatNDVI.seminat</span><span class="op">$</span><span class="va">Sat</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sentinel"</span>, <span class="st">"Modis"</span>, <span class="st">"Landsat"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">allSatNDVI.seminat</span><span class="op">$</span><span class="va">Sat</span><span class="op">)</span></span></code></pre></div>
<p>Now we can plot the time series for each main ecosystem type, showing
each satellite time series separately:</p>
<div class="sourceCode" id="cb489"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot</span></span>
<span><span class="va">allSatNDVI.seminat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year_jit</span>, y <span class="op">=</span> <span class="va">mean</span>, color <span class="op">=</span> <span class="va">Sat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"NDVI across time"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"NDVI values"</span>, x <span class="op">=</span> <span class="st">"Year"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">hovedtype</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:ndvi-time-series-comparison-ndvis"></span>
<img src="NDVI_seminat_files/figure-html/ndvi-time-series-comparison-ndvis-1.png" alt="Comparing the NDVI time series in the three data sets." width="672"><p class="caption">
Figure 13.19: Comparing the NDVI time series in the three data sets.
</p>
</div>
<p>It is quite obvious that the NDVI values from the three satellites are
not quantitatively comparable. They vary both in their placement along
the y-axis and in their variance. Modis data are absent from the
T40/T41-ecosystem types because of a too large pixel size compared to
the NiN-polygon sizes. In the other types, Modis is poorly represented
for the same reason.</p>
<p>We can test if there are consistent temporal changes in NDVI by running
regressions including year as a covariate.</p>
<p>We first investigate a model testing NDVI as a function of year and main
ecosystem type for polygons in good condition, and we do so separately
for each satellite.</p>
<!-- RUNTIME 10 min -->
<div class="sourceCode" id="cb490"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model.seminat.time.GodTilst.Sent</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/glmmTMB.html">glmmTMB</a></span><span class="op">(</span><span class="va">mean_beta</span> <span class="op">~</span> <span class="va">year</span> <span class="op">*</span> <span class="va">hovedtype</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/nbinom2.html">beta_family</a></span><span class="op">(</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">SentinelNDVI.seminat</span><span class="op">[</span><span class="va">SentinelNDVI.seminat</span><span class="op">$</span><span class="va">tilstand</span> <span class="op">==</span> <span class="st">"God"</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="va">model.seminat.time.GodTilst.Modi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/glmmTMB.html">glmmTMB</a></span><span class="op">(</span><span class="va">mean_beta</span> <span class="op">~</span> <span class="va">year</span> <span class="op">*</span> <span class="va">hovedtype</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/nbinom2.html">beta_family</a></span><span class="op">(</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">ModisNDVI.seminat</span><span class="op">[</span><span class="va">ModisNDVI.seminat</span><span class="op">$</span><span class="va">tilstand</span> <span class="op">==</span> <span class="st">"God"</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="va">model.seminat.time.GodTilst.Land</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/glmmTMB.html">glmmTMB</a></span><span class="op">(</span><span class="va">mean_beta</span> <span class="op">~</span> <span class="va">year</span> <span class="op">*</span> <span class="va">hovedtype</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/nbinom2.html">beta_family</a></span><span class="op">(</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">LandsatNDVI.seminat</span><span class="op">[</span><span class="va">LandsatNDVI.seminat</span><span class="op">$</span><span class="va">tilstand</span> <span class="op">==</span> <span class="st">"God"</span>, <span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb491"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.seminat.time.GodTilst.Sent</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">cond</span></span>
<span><span class="co">#&gt;                        Estimate   Std. Error     z value</span></span>
<span><span class="co">#&gt; (Intercept)       -45.780951305  3.081255872 -14.8578869</span></span>
<span><span class="co">#&gt; year                0.023458652  0.001526906  15.3635239</span></span>
<span><span class="co">#&gt; hovedtypeT32       26.244560360  3.242217032   8.0946340</span></span>
<span><span class="co">#&gt; hovedtypeT33       12.760090321  4.237644667   3.0111280</span></span>
<span><span class="co">#&gt; hovedtypeT34      -19.042562520  3.602208159  -5.2863582</span></span>
<span><span class="co">#&gt; hovedtypeT40       28.738193372  4.289513342   6.6996396</span></span>
<span><span class="co">#&gt; hovedtypeT41      -15.690936569 31.070809016  -0.5050057</span></span>
<span><span class="co">#&gt; year:hovedtypeT32  -0.012861099  0.001606667  -8.0048299</span></span>
<span><span class="co">#&gt; year:hovedtypeT33  -0.006381392  0.002099939  -3.0388456</span></span>
<span><span class="co">#&gt; year:hovedtypeT34   0.009328309  0.001785065   5.2257530</span></span>
<span><span class="co">#&gt; year:hovedtypeT40  -0.014212323  0.002125635  -6.6861550</span></span>
<span><span class="co">#&gt; year:hovedtypeT41   0.008020360  0.015397374   0.5208914</span></span>
<span><span class="co">#&gt;                       Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; (Intercept)       6.184530e-50</span></span>
<span><span class="co">#&gt; year              2.875127e-53</span></span>
<span><span class="co">#&gt; hovedtypeT32      5.743676e-16</span></span>
<span><span class="co">#&gt; hovedtypeT33      2.602791e-03</span></span>
<span><span class="co">#&gt; hovedtypeT34      1.247755e-07</span></span>
<span><span class="co">#&gt; hovedtypeT40      2.089342e-11</span></span>
<span><span class="co">#&gt; hovedtypeT41      6.135548e-01</span></span>
<span><span class="co">#&gt; year:hovedtypeT32 1.196319e-15</span></span>
<span><span class="co">#&gt; year:hovedtypeT33 2.374866e-03</span></span>
<span><span class="co">#&gt; year:hovedtypeT34 1.734478e-07</span></span>
<span><span class="co">#&gt; year:hovedtypeT40 2.291104e-11</span></span>
<span><span class="co">#&gt; year:hovedtypeT41 6.024424e-01</span></span></code></pre></div>
<div class="sourceCode" id="cb492"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.seminat.time.GodTilst.Modi</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">cond</span></span>
<span><span class="co">#&gt;                        Estimate  Std. Error    z value</span></span>
<span><span class="co">#&gt; (Intercept)        0.9417938119 2.404923160  0.3916108</span></span>
<span><span class="co">#&gt; year               0.0005957467 0.001195488  0.4983291</span></span>
<span><span class="co">#&gt; hovedtypeT32      -0.7198852149 3.147259223 -0.2287340</span></span>
<span><span class="co">#&gt; hovedtypeT33      -9.0494604384 6.513110325 -1.3894223</span></span>
<span><span class="co">#&gt; hovedtypeT34      10.4299968766 2.611678729  3.9935987</span></span>
<span><span class="co">#&gt; year:hovedtypeT32  0.0004530230 0.001564548  0.2895551</span></span>
<span><span class="co">#&gt; year:hovedtypeT33  0.0044483793 0.003237828  1.3738775</span></span>
<span><span class="co">#&gt; year:hovedtypeT34 -0.0053189040 0.001298233 -4.0970321</span></span>
<span><span class="co">#&gt;                       Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; (Intercept)       6.953458e-01</span></span>
<span><span class="co">#&gt; year              6.182521e-01</span></span>
<span><span class="co">#&gt; hovedtypeT32      8.190757e-01</span></span>
<span><span class="co">#&gt; hovedtypeT33      1.647044e-01</span></span>
<span><span class="co">#&gt; hovedtypeT34      6.507796e-05</span></span>
<span><span class="co">#&gt; year:hovedtypeT32 7.721566e-01</span></span>
<span><span class="co">#&gt; year:hovedtypeT33 1.694797e-01</span></span>
<span><span class="co">#&gt; year:hovedtypeT34 4.184809e-05</span></span></code></pre></div>
<div class="sourceCode" id="cb493"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.seminat.time.GodTilst.Land</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">cond</span></span>
<span><span class="co">#&gt;                        Estimate   Std. Error     z value</span></span>
<span><span class="co">#&gt; (Intercept)       -2.178073e+01 0.4411725413 -49.3701030</span></span>
<span><span class="co">#&gt; year               1.171816e-02 0.0002202274  53.2093510</span></span>
<span><span class="co">#&gt; hovedtypeT32       5.090566e+00 0.4696298758  10.8395273</span></span>
<span><span class="co">#&gt; hovedtypeT33       6.886573e+00 0.7448223401   9.2459269</span></span>
<span><span class="co">#&gt; hovedtypeT34       8.433829e+00 0.5162507377  16.3366909</span></span>
<span><span class="co">#&gt; hovedtypeT40      -3.864882e-01 0.8262214619  -0.4677779</span></span>
<span><span class="co">#&gt; year:hovedtypeT32 -2.395131e-03 0.0002344365 -10.2165460</span></span>
<span><span class="co">#&gt; year:hovedtypeT33 -3.499599e-03 0.0003717377  -9.4141633</span></span>
<span><span class="co">#&gt; year:hovedtypeT34 -4.304575e-03 0.0002576806 -16.7050824</span></span>
<span><span class="co">#&gt; year:hovedtypeT40  1.969451e-04 0.0004124556   0.4774941</span></span>
<span><span class="co">#&gt;                       Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; (Intercept)       0.000000e+00</span></span>
<span><span class="co">#&gt; year              0.000000e+00</span></span>
<span><span class="co">#&gt; hovedtypeT32      2.236234e-27</span></span>
<span><span class="co">#&gt; hovedtypeT33      2.332105e-20</span></span>
<span><span class="co">#&gt; hovedtypeT34      5.411108e-60</span></span>
<span><span class="co">#&gt; hovedtypeT40      6.399434e-01</span></span>
<span><span class="co">#&gt; year:hovedtypeT32 1.671925e-24</span></span>
<span><span class="co">#&gt; year:hovedtypeT33 4.768650e-21</span></span>
<span><span class="co">#&gt; year:hovedtypeT34 1.203615e-62</span></span>
<span><span class="co">#&gt; year:hovedtypeT40 6.330103e-01</span></span></code></pre></div>
<p>There’s an increase in NDVI over time in mainly the Sentinel and Landsat
time series in boreal heath in good condition, but this pattern is
reduced or absent in the other semi-natural ecosystem types. MODIS does
not show any trends in time but also has way less statistical power
compared to Sentinel and Landsat.</p>
<p>Given the consistently higher NDVI-values with decreasing condition in
<strong>boreal heath</strong>, We may ask the question if the temporal NDVI increase
might be stronger under reduced condition?</p>
<!-- RUNTIME 10 min -->
<div class="sourceCode" id="cb494"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model.seminat.time.tilst.T31.Sent</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/glmmTMB.html">glmmTMB</a></span><span class="op">(</span><span class="va">mean_beta</span> <span class="op">~</span> <span class="va">year</span> <span class="op">*</span> <span class="va">tilstand</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/nbinom2.html">beta_family</a></span><span class="op">(</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">SentinelNDVI.seminat</span><span class="op">[</span><span class="va">SentinelNDVI.seminat</span><span class="op">$</span><span class="va">hovedtype</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"T31"</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="va">model.seminat.time.tilst.T31.Modi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/glmmTMB.html">glmmTMB</a></span><span class="op">(</span><span class="va">mean_beta</span> <span class="op">~</span> <span class="va">year</span> <span class="op">*</span> <span class="va">tilstand</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/nbinom2.html">beta_family</a></span><span class="op">(</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">ModisNDVI.seminat</span><span class="op">[</span><span class="va">ModisNDVI.seminat</span><span class="op">$</span><span class="va">hovedtype</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"T31"</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="va">model.seminat.time.tilst.T31.Land</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/glmmTMB.html">glmmTMB</a></span><span class="op">(</span><span class="va">mean_beta</span> <span class="op">~</span> <span class="va">year</span> <span class="op">*</span> <span class="va">tilstand</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/nbinom2.html">beta_family</a></span><span class="op">(</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">LandsatNDVI.seminat</span><span class="op">[</span><span class="va">LandsatNDVI.seminat</span><span class="op">$</span><span class="va">hovedtype</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"T31"</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb495"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.seminat.time.tilst.T31.Sent</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">cond</span></span>
<span><span class="co">#&gt;                                   Estimate  Std. Error</span></span>
<span><span class="co">#&gt; (Intercept)                  -4.575579e+01 3.120798729</span></span>
<span><span class="co">#&gt; year                          2.344589e-02 0.001546508</span></span>
<span><span class="co">#&gt; tilstandModerat               6.019395e-02 3.297959059</span></span>
<span><span class="co">#&gt; tilstandRedusert              1.011284e+01 3.577419807</span></span>
<span><span class="co">#&gt; tilstandSvaert_redusert      -9.457218e-01 3.651673254</span></span>
<span><span class="co">#&gt; year:tilstandModerat         -2.646114e-05 0.001634299</span></span>
<span><span class="co">#&gt; year:tilstandRedusert        -4.942408e-03 0.001772783</span></span>
<span><span class="co">#&gt; year:tilstandSvaert_redusert  5.537298e-04 0.001809584</span></span>
<span><span class="co">#&gt;                                   z value     Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; (Intercept)                  -14.66156419 1.136249e-48</span></span>
<span><span class="co">#&gt; year                          15.16054003 6.453651e-52</span></span>
<span><span class="co">#&gt; tilstandModerat                0.01825188 9.854379e-01</span></span>
<span><span class="co">#&gt; tilstandRedusert               2.82685399 4.700776e-03</span></span>
<span><span class="co">#&gt; tilstandSvaert_redusert       -0.25898313 7.956483e-01</span></span>
<span><span class="co">#&gt; year:tilstandModerat          -0.01619112 9.870819e-01</span></span>
<span><span class="co">#&gt; year:tilstandRedusert         -2.78793699 5.304486e-03</span></span>
<span><span class="co">#&gt; year:tilstandSvaert_redusert   0.30599834 7.596059e-01</span></span></code></pre></div>
<div class="sourceCode" id="cb496"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.seminat.time.tilst.T31.Modi</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">cond</span></span>
<span><span class="co">#&gt;                                   Estimate   Std. Error</span></span>
<span><span class="co">#&gt; (Intercept)                   0.9376760636 1.9284718315</span></span>
<span><span class="co">#&gt; year                          0.0005998599 0.0009586688</span></span>
<span><span class="co">#&gt; tilstandModerat               0.8882297240 2.0971098697</span></span>
<span><span class="co">#&gt; tilstandRedusert              4.3529934686 2.3864880714</span></span>
<span><span class="co">#&gt; tilstandSvaert_redusert       1.3122148220 2.3407551762</span></span>
<span><span class="co">#&gt; year:tilstandModerat         -0.0004437392 0.0010424992</span></span>
<span><span class="co">#&gt; year:tilstandRedusert        -0.0020959207 0.0011863530</span></span>
<span><span class="co">#&gt; year:tilstandSvaert_redusert -0.0006143634 0.0011636174</span></span>
<span><span class="co">#&gt;                                 z value   Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; (Intercept)                   0.4862275 0.62680587</span></span>
<span><span class="co">#&gt; year                          0.6257218 0.53149746</span></span>
<span><span class="co">#&gt; tilstandModerat               0.4235494 0.67189443</span></span>
<span><span class="co">#&gt; tilstandRedusert              1.8240164 0.06814959</span></span>
<span><span class="co">#&gt; tilstandSvaert_redusert       0.5605946 0.57507390</span></span>
<span><span class="co">#&gt; year:tilstandModerat         -0.4256494 0.67036332</span></span>
<span><span class="co">#&gt; year:tilstandRedusert        -1.7666923 0.07727977</span></span>
<span><span class="co">#&gt; year:tilstandSvaert_redusert -0.5279772 0.59751516</span></span></code></pre></div>
<div class="sourceCode" id="cb497"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.seminat.time.tilst.T31.Land</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">cond</span></span>
<span><span class="co">#&gt;                                   Estimate   Std. Error</span></span>
<span><span class="co">#&gt; (Intercept)                  -2.179185e+01 0.4337005742</span></span>
<span><span class="co">#&gt; year                          1.172387e-02 0.0002165269</span></span>
<span><span class="co">#&gt; tilstandModerat               9.872640e-01 0.4581637325</span></span>
<span><span class="co">#&gt; tilstandRedusert              1.055443e+00 0.4974375073</span></span>
<span><span class="co">#&gt; tilstandSvaert_redusert       5.571359e+00 0.5074515791</span></span>
<span><span class="co">#&gt; year:tilstandModerat         -4.819522e-04 0.0002287408</span></span>
<span><span class="co">#&gt; year:tilstandRedusert        -4.465030e-04 0.0002483586</span></span>
<span><span class="co">#&gt; year:tilstandSvaert_redusert -2.684806e-03 0.0002533521</span></span>
<span><span class="co">#&gt;                                 z value     Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; (Intercept)                  -50.246300 0.000000e+00</span></span>
<span><span class="co">#&gt; year                          54.145093 0.000000e+00</span></span>
<span><span class="co">#&gt; tilstandModerat                2.154828 3.117531e-02</span></span>
<span><span class="co">#&gt; tilstandRedusert               2.121760 3.385794e-02</span></span>
<span><span class="co">#&gt; tilstandSvaert_redusert       10.979095 4.817235e-28</span></span>
<span><span class="co">#&gt; year:tilstandModerat          -2.106980 3.511935e-02</span></span>
<span><span class="co">#&gt; year:tilstandRedusert         -1.797815 7.220627e-02</span></span>
<span><span class="co">#&gt; year:tilstandSvaert_redusert -10.597132 3.072578e-26</span></span></code></pre></div>
<p>The temporal NDVI increase in boreal heath has NOT been stronger with
reduced ecological condition. So a temporal NDVI approach does not seem
like a promising way to go.</p>
<p>We could check for the same pattern in T32 and
T34, just because they are the other semi-natural major ecosystem types
with a substantial number of occurrences in the the NiN data. Here’s the code for that, stored for later.</p>
<div class="sourceCode" id="cb498"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model.seminat.time.tilst.T32.Sent</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/glmmTMB.html">glmmTMB</a></span><span class="op">(</span><span class="va">mean_beta</span> <span class="op">~</span> <span class="va">year</span> <span class="op">*</span> <span class="va">tilstand</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/nbinom2.html">beta_family</a></span><span class="op">(</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">SentinelNDVI.seminat</span><span class="op">[</span><span class="va">SentinelNDVI.seminat</span><span class="op">$</span><span class="va">hovedtype</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"T32"</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="va">model.seminat.time.tilst.T32.Modi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/glmmTMB.html">glmmTMB</a></span><span class="op">(</span><span class="va">mean_beta</span> <span class="op">~</span> <span class="va">year</span> <span class="op">*</span> <span class="va">tilstand</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/nbinom2.html">beta_family</a></span><span class="op">(</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">ModisNDVI.seminat</span><span class="op">[</span><span class="va">ModisNDVI.seminat</span><span class="op">$</span><span class="va">hovedtype</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"T32"</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="va">model.seminat.time.tilst.T32.Land</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/glmmTMB.html">glmmTMB</a></span><span class="op">(</span><span class="va">mean_beta</span> <span class="op">~</span> <span class="va">year</span> <span class="op">*</span> <span class="va">tilstand</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/nbinom2.html">beta_family</a></span><span class="op">(</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">LandsatNDVI.seminat</span><span class="op">[</span><span class="va">LandsatNDVI.seminat</span><span class="op">$</span><span class="va">hovedtype</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"T32"</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.seminat.time.tilst.T32.Sent</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">cond</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.seminat.time.tilst.T32.Modi</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">cond</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.seminat.time.tilst.T32.Land</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">cond</span></span>
<span></span>
<span><span class="va">model.seminat.time.tilst.T34.Sent</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/glmmTMB.html">glmmTMB</a></span><span class="op">(</span><span class="va">mean_beta</span> <span class="op">~</span> <span class="va">year</span> <span class="op">*</span> <span class="va">tilstand</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/nbinom2.html">beta_family</a></span><span class="op">(</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">SentinelNDVI.seminat</span><span class="op">[</span><span class="va">SentinelNDVI.seminat</span><span class="op">$</span><span class="va">hovedtype</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"T34"</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="va">model.seminat.time.tilst.T34.Modi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/glmmTMB.html">glmmTMB</a></span><span class="op">(</span><span class="va">mean_beta</span> <span class="op">~</span> <span class="va">year</span> <span class="op">*</span> <span class="va">tilstand</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/nbinom2.html">beta_family</a></span><span class="op">(</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">ModisNDVI.seminat</span><span class="op">[</span><span class="va">ModisNDVI.seminat</span><span class="op">$</span><span class="va">hovedtype</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"T34"</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="va">model.seminat.time.tilst.T34.Land</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/glmmTMB.html">glmmTMB</a></span><span class="op">(</span><span class="va">mean_beta</span> <span class="op">~</span> <span class="va">year</span> <span class="op">*</span> <span class="va">tilstand</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/nbinom2.html">beta_family</a></span><span class="op">(</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">LandsatNDVI.seminat</span><span class="op">[</span><span class="va">LandsatNDVI.seminat</span><span class="op">$</span><span class="va">hovedtype</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"T34"</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.seminat.time.tilst.T34.Sent</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">cond</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.seminat.time.tilst.T34.Modi</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">cond</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.seminat.time.tilst.T34.Land</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">cond</span></span></code></pre></div>
<p>But again, patterns are only identifiable with Sentinel and Landsat data,
but not with Modis. Semi-natural grasslands (T32) do indeed show a
stronger increase in NDVI as condition deteriorates, so here a temporal
approach may be useful under a reduced
land-management/shrub-/tree-encroachment scenario. Coastal heathlands
(T34), on the other hand, do not show stronger temporal increases with
reduced condition. Coastal heathlands are subject to a management cycle,
which includes developmental and successional changes over a course of
15-25 years followed by prescribed burning which resets that process.
So, we have to expect increases in greenness in coastal heathlands over
time also in well-managed areas, and thus temporal changes in NDVI are
largely irrelevant for assessing ecological condition.</p>
</div>
</div>
<div id="overall-conclusion-1" class="section level2" number="13.8">
<h2>
<span class="header-section-number">13.8</span> Overall conclusion<a class="anchor" aria-label="anchor" href="#overall-conclusion-1"><i class="fas fa-link"></i></a>
</h2>
<p>NDVI in semi-natural ecosystem does vary with condition and also with
ecosystem type, but the variance and thus overlap between condition
classes and ecosystem types is large. Especially in boreal heath and
semi-natural grasslands greenness and its change over time appear to be
indicative of the ecological condition of local ecosystems, linking well
to the registered condition variables behind the lower condition scores
(shrub/tree encroachment, low land-use intensity, succession) and thus
reduced land-use as the main pressure identified for these systems.
However, the large variance and thus overlap between condition classes
and ecosystem types makes it generally difficult to define useful
scaling values for absolute NDVI values. Since ecological condition also
relates to the temporal development of NDVI values in semi-natural
grasslands, a potential way way to approach this can be to define
scaling values for time slopes as for instance has been done for the
NDVI indicator in the ecological condition assessment for Norwegian
mountains (Framstad et al. 2022 in references above, see coded example
at <a href="https://ninanor.github.io/IBECA/ndvi-trend_fjell.html" class="uri">https://ninanor.github.io/IBECA/ndvi-trend_fjell.html</a>).</p>
<p>Beyond these considerations, there are two general issues which limit a
more comprehensive and robust application of satellite based NDVI-data
in an ecological condition context:</p>
<ol style="list-style-type: decimal">
<li>We are lacking ecosystem maps for semi-natural ecosystems
The analysis at hand clearly shows that different semi-natural ecosystem
types display different greenness levels and thus need to be evaluated
separately. Thus, we need ecosystem maps, that allow us to treat NDVI
values, and temporal changes of these, for at least the different major
ecosystem types within semi-natural systems separately.</li>
<li>We are lacking a good ecological understanding and ground-truthing for NDVI in
semi-natural ecosystems Unlike for ecosystems like forests, tundra,
savannah and similar, there is little empirical work and ground-truthing
data documented that link NDVI values to ecological phenomena in
semi-natural systems. Here, we need field studies investigating more
thoroughly how NDVI and ecological drivers, like for example shrub-/tree
encroachment, are connected. This includes a need for understanding
temporal increases in NDVI in ecosystems in good condition.</li>
</ol>
<p>In addition, further investigations should test how NDVI-condition
pattern vary across biogeographic regions in addition to administrative
regions (which are ecologically irrelevant), in order to better
understand the results for the administrative regions.</p>
<div id="eksport-file-final-product-2" class="section level3" number="13.8.1">
<h3>
<span class="header-section-number">13.8.1</span> Eksport file (final product)<a class="anchor" aria-label="anchor" href="#eksport-file-final-product-2"><i class="fas fa-link"></i></a>
</h3>
<!-- Export final file. Ideally a georeferenced shape or raster wit indicators values (raw and normalised), reference values and errors. -->

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="NDVI-indicator-natopen.html"><span class="header-section-number">12</span> NDVI - Naturally Open Ecosystems</a></div>
<div class="next"><a href="NDVI-indicator-wetland.html"><span class="header-section-number">14</span> NDVI - wetland ecosystems</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#NDVI-indicator-seminat"><span class="header-section-number">13</span> NDVI - Semi-natural Ecosystems</a></li>
<li><a class="nav-link" href="#intro-ndvis"><span class="header-section-number">13.1</span> Introduction</a></li>
<li>
<a class="nav-link" href="#underlying-data-ndvis"><span class="header-section-number">13.2</span> About the underlying data</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#representativity-ndvis"><span class="header-section-number">13.2.1</span> Representativity in time and space</a></li>
<li><a class="nav-link" href="#temp-cov-ndvis"><span class="header-section-number">13.2.2</span> Temporal coverage</a></li>
</ul>
</li>
<li><a class="nav-link" href="#coll-ndvis"><span class="header-section-number">13.3</span> Collinearities with other indicators</a></li>
<li>
<a class="nav-link" href="#ref-state-ndvis"><span class="header-section-number">13.4</span> Reference state and values</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#ref-state2-ndvis"><span class="header-section-number">13.4.1</span> Reference state and scaling values</a></li></ul>
</li>
<li><a class="nav-link" href="#uncertainties-ndvis"><span class="header-section-number">13.5</span> Uncertainties</a></li>
<li><a class="nav-link" href="#references-9"><span class="header-section-number">13.6</span> References</a></li>
<li>
<a class="nav-link" href="#analyses-ndvis"><span class="header-section-number">13.7</span> Analyses</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#datasets-ndvis"><span class="header-section-number">13.7.1</span> Data sets</a></li>
<li><a class="nav-link" href="#data-handling-ndvis"><span class="header-section-number">13.7.2</span> Data handling</a></li>
<li><a class="nav-link" href="#exploratory-analyses-sentinel-2"><span class="header-section-number">13.7.3</span> Exploratory analyses, Sentinel-2</a></li>
<li><a class="nav-link" href="#regression-analyses-sentinel-2-ndvi-as-a-function-of-condition"><span class="header-section-number">13.7.4</span> Regression analyses Sentinel-2, NDVI as a function of condition</a></li>
<li><a class="nav-link" href="#ndvi-across-time---sentinel-modis-landsat"><span class="header-section-number">13.7.5</span> NDVI across time - Sentinel, MODIS &amp; LandSat</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#overall-conclusion-1"><span class="header-section-number">13.8</span> Overall conclusion</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#eksport-file-final-product-2"><span class="header-section-number">13.8.1</span> Eksport file (final product)</a></li></ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/NINAnor/ecosystemCondition/blob/master/NDVI_seminat.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/NINAnor/ecosystemCondition/edit/master/NDVI_seminat.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Indicators for Ecosystem Condition in Norway</strong>" was written by Anders L. Kolstad. It was last built on 2023-10-23.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
