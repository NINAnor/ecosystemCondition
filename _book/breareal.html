<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>breareal.knit</title>

  
   
   <meta name="generator" content="placeholder" />
  <meta property="og:title" content="breareal.knit" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="breareal.knit" />
  
  
  
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script>
    <script src="libs/bs3compat-0.3.1/transition.js"></script>
    <script src="libs/bs3compat-0.3.1/tabs.js"></script>
    <script src="libs/bs3compat-0.3.1/bs3compat.js"></script>
    <link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book-1.0.0/bs4_book.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script>

  <!-- CSS -->
  <style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
      <link rel="stylesheet" href="style.css" />
  
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<!--bookdown:title:start-->
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title=""></a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="areal-av-isbreer" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Areal av isbreer</h1>
<p><br /></p>
<p><em>Author and date:</em> Anders Kolstad</p>
<pre><code>## [1] &quot;2023-01-05&quot;</code></pre>
<p><br /></p>
<table>
<thead>
<tr class="header">
<th align="left">Ecosystem</th>
<th align="left">Økologisk.egenskap</th>
<th align="left">ECT.class</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Fjell</td>
<td align="left">Landskapsøkologiske mønstre</td>
<td align="left">Landscape and seascape characteristics</td>
</tr>
</tbody>
</table>
<p><br /> <br /></p>
<hr />
<div id="introduction" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Introduction</h2>
<p>This indicator describes the relative change in glacial extent for each of fire regions in Norway. A <a href="https://ninanor.github.io/IBECA/faktaark.html#Areal_av_isbreer">slightly different indicator</a> was used in the alpine assessment.</p>
</div>
<div id="about-the-underlying-data" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> About the underlying data</h2>
<p>The indicator uses the maps of glacier extent ( <em>breatlas</em> ) from <a href="https://www.nve.no/vann-og-vassdrag/vannets-kretsloep/bre/publikasjoner-publications/breatlas-glacier-inventories/">2018-2019</a> and compares it to a similar map from 1947-1985. Both maps are owned by NVE (Norsk vassdrags og energidirektorat). The new map is based on Sentinel images, and the old map is a digitised version of the N50 maps, with some additional areal photo interpretation on top.</p>
<div id="representativity-in-time-and-space" class="section level3" number="1.2.1">
<h3><span class="header-section-number">1.2.1</span> Representativity in time and space</h3>
<p>The data set (map) covers the entire Norwegian mainland. There are only two time steps, but we expect changes in glacial extent to be relatively linear or consistent over time. The older map may have underestimated the glacial extent due to a better chance of smaller snow and ice patches being captured by Sentinel contra aerial photo interpretations.</p>
</div>
<div id="original-units" class="section level3" number="1.2.2">
<h3><span class="header-section-number">1.2.2</span> Original units</h3>
<p>Area units (e.g. km2)</p>
</div>
<div id="temporal-coverage" class="section level3" number="1.2.3">
<h3><span class="header-section-number">1.2.3</span> Temporal coverage</h3>
<p>1947-2019</p>
</div>
<div id="aditional-comments-about-the-dataset" class="section level3" number="1.2.4">
<h3><span class="header-section-number">1.2.4</span> Aditional comments about the dataset</h3>
<p>None</p>
</div>
</div>
<div id="ecosystem-characteristic" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Ecosystem characteristic</h2>
<div id="norwegian-standard" class="section level3" number="1.3.1">
<h3><span class="header-section-number">1.3.1</span> Norwegian standard</h3>
<p>The indicator was initially assigned the <em>Abiotiske forhold</em> characteristic, but now it is considered under <em>Landskapsøkologiske mønstre</em>. The initial justificaton was that glacial melting would influence water availability downstream. Now we put more weight on glaciers as not just resevoirs of ice and water, but as a habitat, and the presence or abundance of a specific habitat can be though of as an aspect of landscape state.</p>
</div>
<div id="seea-ect" class="section level3" number="1.3.2">
<h3><span class="header-section-number">1.3.2</span> SEEA ECT</h3>
<p>The indicator is similarly assiged to the SEEA ECT class <em>C1 Landscape characteristics</em>.</p>
</div>
</div>
<div id="collinearities-with-other-indicators" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Collinearities with other indicators</h2>
<p>None that are known.</p>
</div>
<div id="reference-state-and-values" class="section level2" number="1.5">
<h2><span class="header-section-number">1.5</span> Reference state and values</h2>
<div id="reference-state" class="section level3" number="1.5.1">
<h3><span class="header-section-number">1.5.1</span> Reference state</h3>
<p>The indicator uses the same reference state as all or most of the indicators developed in this and in similar projects, and is defined in <a href="https://www.regjeringen.no/no/dokumenter/fagsystem-for-fastsetting-av-god-okologisk-tilstand/id2558481/">Nybø et al (2017): Fagsystem for fastsetting av god økologisk tilstand</a>. As glacial extent is primarily, or solely, dependent on climate, we are in a case where we have actual data from the climatic reference period which is the previous normal period 1961-1990.</p>
</div>
<div id="reference-values-thresholds-for-defining-good-ecological-condition-minimum-andor-maximum-values" class="section level3" number="1.5.2">
<h3><span class="header-section-number">1.5.2</span> Reference values, thresholds for defining <em>good ecological condition</em>, minimum and/or maximum values</h3>
<p>The reference value is zero change in glacial extent over time. The threshold for defining good ecological condition as set at a 40% reduction in glacial extent, as a default solution. This normalization follows a linear model, although a sigmoidal weibull function might be more appropriate.</p>
<p>The minimum value is set to zero.</p>
</div>
</div>
<div id="uncertainties" class="section level2" number="1.6">
<h2><span class="header-section-number">1.6</span> Uncertainties</h2>
<p>Here we add a 3% error on each side of the estimates, same as what is reported for the glacier maps from NVE.</p>
</div>
<div id="references" class="section level2" number="1.7">
<h2><span class="header-section-number">1.7</span> References</h2>
<ul>
<li><p>Andreassen, L.M., &amp; Winsvold, S.H. (eds.). 2012. Inventory of Norwegian glaciers. NVE Rapport 38, Norges Vassdrags- og energidirektorat, 236 s</p></li>
<li><p>Andreassen, L.M., Elvehøy, H., Kjøllmoen, B. &amp; Belart, J.M.C. 2020. Glacier change in Norway since the 1960s – an overview of mass balance, area, length and surface elevation changes. Journal of Glaciology 66: 313–328</p></li>
<li><p>Andreassen, L.M., Nagy, T., Kjøllmoen, B. &amp; Leigh, J.R. 2022. A Sentinel-2 based inventory of Norway’s glaciers and ice-marginal lakes 2018/2019. Journal of Glaciology (in review)</p></li>
<li><p>Winsvold, S.H., Andreassen, L.M. &amp; Kienholz, C.. 2014. Glacier area and length changes in Norway from repeat inventories. The Cryosphere 8: 1885-1903</p></li>
</ul>
</div>
<div id="analyses" class="section level2" number="1.8">
<h2><span class="header-section-number">1.8</span> Analyses</h2>
<div id="importing-the-data-sets" class="section level3" number="1.8.1">
<h3><span class="header-section-number">1.8.1</span> Importing the data sets</h3>
<p>There are four data sets:</p>
<ul>
<li>glacial atlas</li>
<li>n50 (the old glacial atlas)</li>
<li>the regional delineation for Norway (fire regions)</li>
<li>an outline of mainland Norway</li>
</ul>
<p>We are assuming all glaciers are found in the mountins, se we do not need to mask the glacial atlas data using an ecosystem delineation map.</p>
<div id="glacial-atlas" class="section level4" number="1.8.1.1">
<h4><span class="header-section-number">1.8.1.1</span> Glacial atlas</h4>
<p>This is the new glacial atlas from 2018 and 2019 based on Sentinell (ref. Liss Marie Andreassen, NVE)</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># server path</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>breatlas_path <span class="ot">&lt;-</span> <span class="st">&#39;/data/P-Prosjekter/41201042_okologisk_tilstand_fastlandsnorge_2020_dataanaly/fjell2021/data/breatlas/breatlas_2018_2019/Breatlas_20182019_temp20210922_lma.shp&#39;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># local path </span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#breatlas_path &lt;- &#39;P:/41201042_okologisk_tilstand_fastlandsnorge_2020_dataanaly/fjell2021/data/breatlas/breatlas_2018_2019/Breatlas_20182019_temp20210922_lma.shp&#39;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>breatlas <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_read</span>(breatlas_path)</span></code></pre></div>
<pre><code>## Reading layer `Breatlas_20182019_temp20210922_lma&#39; from data source 
##   `/data/P-Prosjekter/41201042_okologisk_tilstand_fastlandsnorge_2020_dataanaly/fjell2021/data/breatlas/breatlas_2018_2019/Breatlas_20182019_temp20210922_lma.shp&#39; 
##   using driver `ESRI Shapefile&#39;
## Simple feature collection with 6915 features and 27 fields (with 4 geometries empty)
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -9874.591 ymin: 6624398 xmax: 810132 ymax: 7836994
## Projected CRS: ETRS89 / UTM zone 33N</code></pre>
<p>All maps made in this project need to have the same CRS: EPSG:25833 - ETRS89 / UTM zone 33N. This one is in UTM 33N ETRS89, even if it is defined in the old Proj.4 way.</p>
<p>There are 6915 polygons. Let’s calculate the area of the polygons and study the distribution of size classes.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>breatlas<span class="sc">$</span>area <span class="ot">&lt;-</span> <span class="fu">st_area</span>(breatlas)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(breatlas<span class="sc">$</span>area)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(breatlas<span class="sc">$</span>area)</span></code></pre></div>
<p><img src="breareal_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Most polygons are small, and then there are a couple of very big ones. The largest polygon is 50 km2, but note that some polygons are somewhat arbitrarily split.</p>
</div>
<div id="map-of-norway" class="section level4" number="1.8.1.2">
<h4><span class="header-section-number">1.8.1.2</span> Map of Norway</h4>
<p>This map is stored on the GitHub repository under <em>indicators/data/</em>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>nor <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">read_sf</span>(<span class="st">&quot;data/outlineOfNorway_EPSG25833.shp&quot;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nor<span class="sc">$</span>geometry, <span class="at">axes=</span>T, <span class="at">main =</span> <span class="st">&quot;Breatlas 2018-2019&quot;</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(breatlas<span class="sc">$</span>geometry, <span class="at">add=</span>T, <span class="at">border =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="breareal_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="n50" class="section level4" number="1.8.1.3">
<h4><span class="header-section-number">1.8.1.3</span> N50</h4>
<p>This is the old glacial extent map. Import it and transform it, same as before.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># server path</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>n50_path <span class="ot">&lt;-</span> <span class="st">&#39;/data/P-Prosjekter/41201042_okologisk_tilstand_fastlandsnorge_2020_dataanaly/fjell2021/data/breatlas/n50/cryoclim_GAO_NO_1952_1985_UTM_33N.shp&#39;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># local path</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#n50_path &lt;- &#39;P:/41201042_okologisk_tilstand_fastlandsnorge_2020_dataanaly/fjell2021/data/breatlas/n50/cryoclim_GAO_NO_1952_1985_UTM_33N.shp&#39;</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>n50 <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_read</span>(n50_path)<span class="sc">%&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="fu">crs</span>(breatlas))</span></code></pre></div>
<pre><code>## Reading layer `cryoclim_GAO_NO_1952_1985_UTM_33N&#39; from data source 
##   `/data/P-Prosjekter/41201042_okologisk_tilstand_fastlandsnorge_2020_dataanaly/fjell2021/data/breatlas/n50/cryoclim_GAO_NO_1952_1985_UTM_33N.shp&#39; 
##   using driver `ESRI Shapefile&#39;
## Simple feature collection with 7141 features and 30 fields
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: -7278.562 ymin: 6623024 xmax: 812207.8 ymax: 7841654
## Projected CRS: WGS 84 / UTM zone 33N</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nor<span class="sc">$</span>geometry, <span class="at">axes=</span>T, <span class="at">main =</span> <span class="st">&quot;n50 - 1952-1985&quot;</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(n50<span class="sc">$</span>geometry, <span class="at">add=</span>T, <span class="at">border =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="breareal_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Let’s now plot it all on top of each other.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define some boundary boxes for zooming in on specific regions</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>myExt <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">extent</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100000</span>, <span class="dv">6840000</span>, <span class="dv">6900000</span>))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>myExt2 <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">extent</span>(<span class="fu">c</span>(<span class="dv">5000</span>, <span class="dv">10000</span>, <span class="dv">6880000</span>, <span class="dv">6885000</span>))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare plotting device with one row, three columns</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create three maps, each zooming in a bit further.</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nor<span class="sc">$</span>geometry, <span class="at">axes=</span>T)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(n50<span class="sc">$</span>geometry,  <span class="at">border =</span> <span class="st">&quot;orange&quot;</span>, <span class="at">col =</span> scales<span class="sc">::</span><span class="fu">alpha</span>(<span class="st">&quot;orange&quot;</span>, <span class="dv">1</span>), <span class="at">add=</span>T)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(myExt, <span class="at">add=</span>T, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nor<span class="sc">$</span>geometry, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100000</span>),</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">6840000</span>, <span class="dv">6900000</span>),</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">axes=</span>T)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(n50<span class="sc">$</span>geometry, <span class="at">add=</span>T, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(myExt2, <span class="at">add=</span>T, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;orange&quot;</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co"># for this last map I plot the old extent in red and the new as grey on top. The red areas still visible will be areas where the glaciers have retreated.        </span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nor<span class="sc">$</span>geometry, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">5000</span>, <span class="dv">10000</span>),</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">6880000</span>, <span class="dv">6885000</span>),</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">axes=</span>T)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(n50<span class="sc">$</span>geometry, <span class="at">add=</span>T, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(breatlas<span class="sc">$</span>geometry, <span class="at">add=</span>T, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>)</span></code></pre></div>
<p><img src="breareal_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>The red areas in the map to the far right is where the ice has retreated for a selected glacier on the west coast. Now we need to devide the map into regions to then compare the area in n50 with the new glacial extent map <em>breatlas</em>.</p>
</div>
<div id="regions" class="section level4" number="1.8.1.4">
<h4><span class="header-section-number">1.8.1.4</span> Regions</h4>
<p>Importing a shape file with the regional delineation.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>reg <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;data/regions.shp&quot;</span>)</span></code></pre></div>
<pre><code>## Reading layer `regions&#39; from data source 
##   `/data/Egenutvikling/41001581_egenutvikling_anders_kolstad/github/ecosystemCondition/data/regions.shp&#39; 
##   using driver `ESRI Shapefile&#39;
## Simple feature collection with 5 features and 2 fields
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: -99551.21 ymin: 6426048 xmax: 1121941 ymax: 7962744
## Projected CRS: ETRS89 / UTM zone 33N</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(reg)</span></code></pre></div>
<pre><code>## Coordinate Reference System:
##   User input: ETRS89 / UTM zone 33N 
##   wkt:
## PROJCRS[&quot;ETRS89 / UTM zone 33N&quot;,
##     BASEGEOGCRS[&quot;ETRS89&quot;,
##         DATUM[&quot;European Terrestrial Reference System 1989&quot;,
##             ELLIPSOID[&quot;GRS 1980&quot;,6378137,298.257222101,
##                 LENGTHUNIT[&quot;metre&quot;,1]]],
##         PRIMEM[&quot;Greenwich&quot;,0,
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
##         ID[&quot;EPSG&quot;,4258]],
##     CONVERSION[&quot;UTM zone 33N&quot;,
##         METHOD[&quot;Transverse Mercator&quot;,
##             ID[&quot;EPSG&quot;,9807]],
##         PARAMETER[&quot;Latitude of natural origin&quot;,0,
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
##             ID[&quot;EPSG&quot;,8801]],
##         PARAMETER[&quot;Longitude of natural origin&quot;,15,
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
##             ID[&quot;EPSG&quot;,8802]],
##         PARAMETER[&quot;Scale factor at natural origin&quot;,0.9996,
##             SCALEUNIT[&quot;unity&quot;,1],
##             ID[&quot;EPSG&quot;,8805]],
##         PARAMETER[&quot;False easting&quot;,500000,
##             LENGTHUNIT[&quot;metre&quot;,1],
##             ID[&quot;EPSG&quot;,8806]],
##         PARAMETER[&quot;False northing&quot;,0,
##             LENGTHUNIT[&quot;metre&quot;,1],
##             ID[&quot;EPSG&quot;,8807]]],
##     CS[Cartesian,2],
##         AXIS[&quot;(E)&quot;,east,
##             ORDER[1],
##             LENGTHUNIT[&quot;metre&quot;,1]],
##         AXIS[&quot;(N)&quot;,north,
##             ORDER[2],
##             LENGTHUNIT[&quot;metre&quot;,1]],
##     USAGE[
##         SCOPE[&quot;unknown&quot;],
##         AREA[&quot;Europe - 12°E to 18°E and ETRS89 by country&quot;],
##         BBOX[46.4,12,84.01,18.01]],
##     ID[&quot;EPSG&quot;,25833]]</code></pre>
<p>Let’s plot it to make sure it is correct.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nor<span class="sc">$</span>geometry, <span class="at">axes=</span>T)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(reg<span class="sc">$</span>geometry, <span class="at">add=</span>T, <span class="at">border =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> scales<span class="sc">::</span><span class="fu">alpha</span>(<span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;red&quot;</span>, </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;green&quot;</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;yellow&quot;</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;brown&quot;</span>), .<span class="dv">2</span>))</span></code></pre></div>
<p><img src="breareal_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>Get the region names</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(reg<span class="sc">$</span>region)</span></code></pre></div>
<pre><code>## [1] &quot;Nord-Norge&quot;      &quot;Midt-Norge&quot;      &quot;Ã\u0098stlandet&quot; &quot;Vestlandet&quot;     
## [5] &quot;SÃ¸rlandet&quot;</code></pre>
<p>These are odd. Let me fix the Norwegian letters manually.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>reg<span class="sc">$</span>region[reg<span class="sc">$</span>region<span class="sc">==</span><span class="st">&quot;Ã\u0098stlandet&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Østlandet&quot;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>reg<span class="sc">$</span>region[reg<span class="sc">$</span>region<span class="sc">==</span><span class="st">&quot;SÃ¸rlandet&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Sørlandet&quot;</span></span></code></pre></div>
<p>Before going any further I need to fix a problem with glacier polygons crossing themselves.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">st_is_valid</span>(breatlas))</span></code></pre></div>
<pre><code>## 
## FALSE  TRUE 
##    68  6847</code></pre>
<p>68 polygons are not valid. Let’s look at the first four reasons for why that is.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(<span class="fu">st_is_valid</span>(breatlas, <span class="at">reason=</span>T))[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code></pre></div>
<pre><code>## [1] &quot;Valid Geometry&quot;                                       
## [2] &quot;Ring Self-intersection[100236.4931 6912507.5864]&quot;     
## [3] &quot;Ring Self-intersection[92500.2095999997 6900940.8003]&quot;
## [4] &quot;Ring Self-intersection[91965.6612 6883260.4912]&quot;      
## [5] &quot;Ring Self-intersection[120595.9254 6853573.4955]&quot;</code></pre>
<p>There is a convinient function to fix this.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># requires lwgeom</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>breatlas2 <span class="ot">&lt;-</span> <span class="fu">st_make_valid</span>(breatlas)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">st_is_valid</span>(breatlas2))</span></code></pre></div>
<pre><code>## 
## TRUE 
## 6915</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same result:</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co">#breatlas2 &lt;- st_buffer(breatlas, 0.0)</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co">#table(st_is_valid(breatlas2))</span></span></code></pre></div>
<p>Let me plot the new, fixed map on top of the old to see if they match. I give the new valid map a blue transparent colour, and the old map a yellow and transparent colour.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nor<span class="sc">$</span>geometry, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">5000</span>, <span class="dv">10000</span>),</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">6880000</span>, <span class="dv">6885000</span>),</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">axes=</span>T)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(breatlas2<span class="sc">$</span>geometry, <span class="at">add=</span>T, <span class="at">col =</span> scales<span class="sc">::</span><span class="fu">alpha</span>(<span class="st">&quot;blue&quot;</span>,<span class="fl">0.5</span>))</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(breatlas<span class="sc">$</span>geometry, <span class="at">add=</span>T, <span class="at">col =</span> scales<span class="sc">::</span><span class="fu">alpha</span>(<span class="st">&quot;yellow&quot;</span>,<span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="breareal_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>This seems to have worked. Notice also how some of these larger polygons are somewhat arbitrarely divided into several adjoining polygons. This is only so for the new map, not the old n50 map.</p>
<p>Delete the invalid data set.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>breatlas <span class="ot">&lt;-</span> breatlas2</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(breatlas2)</span></code></pre></div>
</div>
</div>
<div id="glacial-area-per-region" class="section level3" number="1.8.2">
<h3><span class="header-section-number">1.8.2</span> Glacial area per region</h3>
<div id="contemporary-area" class="section level4" number="1.8.2.1">
<h4><span class="header-section-number">1.8.2.1</span> Contemporary area</h4>
<p>Here is one method for getting the glacial area for each region.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This intersection operation is a bit heavy, so I do it once and store it locally so that I can import it again quickly. </span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co">#brealtas_reg &lt;- st_intersection(breatlas, reg)</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co">#saveRDS(brealtas_reg, &quot;indicators/data/brealtas_reg_helperfile.rds&quot;)</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Importing what I create above</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>brealtas_reg <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data/brealtas_reg_helperfile.rds&quot;</span>)</span></code></pre></div>
<p>Checking what happens to polygons that span to regions. Central Norway in red and western Norway in green. 50% transparency means we should get a third colour where and if they overlap.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(brealtas_reg<span class="sc">$</span>geometry[brealtas_reg<span class="sc">$</span>region<span class="sc">==</span><span class="st">&quot;Midt-Norge&quot;</span>], </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> scales<span class="sc">::</span><span class="fu">alpha</span>(<span class="st">&quot;red&quot;</span>,<span class="fl">0.5</span>), <span class="at">border=</span><span class="cn">NA</span>, <span class="at">axes=</span>T, </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">6900000</span>, <span class="dv">6905000</span>),</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">85000</span>, <span class="dv">100000</span>))</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(brealtas_reg<span class="sc">$</span>geometry[brealtas_reg<span class="sc">$</span>region<span class="sc">==</span><span class="st">&quot;Vestlandet&quot;</span>], </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> scales<span class="sc">::</span><span class="fu">alpha</span>(<span class="st">&quot;green&quot;</span>,<span class="fl">0.5</span>), <span class="at">border=</span><span class="cn">NA</span>, <span class="at">add=</span>T)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(nor<span class="sc">$</span>geometry, <span class="at">add=</span>T)</span></code></pre></div>
<p><img src="breareal_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>It worked fine.</p>
<p>Calculating the area of the polygons</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculating the area of the polygons</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>brealtas_reg<span class="sc">$</span>area_crop <span class="ot">&lt;-</span> <span class="fu">st_area</span>(brealtas_reg)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># summing the area for each region</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>bretabell <span class="ot">&lt;-</span> <span class="fu">tapply</span>(</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>       brealtas_reg<span class="sc">$</span>area_crop,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>       brealtas_reg<span class="sc">$</span>region,</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">FUN =</span> sum)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co"># converting from m2 to km2</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>bretabell <span class="ot">&lt;-</span> bretabell<span class="sc">/</span><span class="dv">1000000</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  bretabell,</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab=</span><span class="st">&quot;Breareal (km2)&quot;</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="breareal_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>Southern Norway has &lt;1km2 of glaciers in 2018-2019.</p>
</div>
<div id="same-for-n50" class="section level4" number="1.8.2.2">
<h4><span class="header-section-number">1.8.2.2</span> Same for N50</h4>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>n50x <span class="ot">&lt;-</span> <span class="fu">st_make_valid</span>(n50)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co">#n50_reg &lt;- st_intersection(n50x, reg)</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co">#saveRDS(n50_reg, &quot;indicators/data/n50_helperfile.rds&quot;)</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>n50_reg <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data/n50_helperfile.rds&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n50_reg<span class="sc">$</span>geometry[n50_reg<span class="sc">$</span>region<span class="sc">==</span><span class="st">&quot;Midt-Norge&quot;</span>], </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> scales<span class="sc">::</span><span class="fu">alpha</span>(<span class="st">&quot;red&quot;</span>,<span class="fl">0.5</span>), <span class="at">border=</span><span class="cn">NA</span>, <span class="at">axes=</span>T, </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">6900000</span>, <span class="dv">6905000</span>),</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">85000</span>, <span class="dv">100000</span>))</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n50_reg<span class="sc">$</span>geometry[n50_reg<span class="sc">$</span>region<span class="sc">==</span><span class="st">&quot;Vestlandet&quot;</span>], </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> scales<span class="sc">::</span><span class="fu">alpha</span>(<span class="st">&quot;green&quot;</span>,<span class="fl">0.5</span>), <span class="at">border=</span><span class="cn">NA</span>, <span class="at">add=</span>T)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(nor<span class="sc">$</span>geometry, <span class="at">add=</span>T)</span></code></pre></div>
<p><img src="breareal_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>Thats good. Now I will plot the reference values (n50) and the contemporary data together.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>n50_reg<span class="sc">$</span>area_crop <span class="ot">&lt;-</span> <span class="fu">st_area</span>(n50_reg)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>n50tabell <span class="ot">&lt;-</span> <span class="fu">tapply</span>(</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>       n50_reg<span class="sc">$</span>area_crop,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>       n50_reg<span class="sc">$</span>region,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">FUN =</span> sum)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>n50tabell <span class="ot">&lt;-</span> n50tabell<span class="sc">/</span><span class="dv">1000000</span> </span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  n50tabell,</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab=</span><span class="st">&quot;Breareal (km2)&quot;</span>,</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">col=</span><span class="st">&quot;grey&quot;</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  bretabell,</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab=</span><span class="st">&quot;Breareal (km2)&quot;</span>,</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">add=</span>T,</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">col=</span><span class="st">&quot;grey30&quot;</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="breareal_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>In the figure above, the glacial area in the reference periond is in light grey and todays area is in dark grey. The height of the light grey bar depicts the reduction in glacial area.</p>
<p>There was a little more glaicers in southern Norway in the reference period, but only 4 km2. The condition here will be very poor! I’m not entirely sure this is representative. The alternative is to set it to be NA, and I think I will do this - one could argue that glaciers are not as important of central to the alpine ecosystems in the south.</p>
</div>
</div>
<div id="scaled-indicator-values" class="section level3" number="1.8.3">
<h3><span class="header-section-number">1.8.3</span> Scaled indicator values</h3>
<p>Making a table with the indicator values.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>myTbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">region           =</span> <span class="fu">names</span>(bretabell),</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">indikator        =</span> bretabell,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">referanseverdi   =</span> n50tabell)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>myTbl<span class="sc">$</span>skalert_indikator <span class="ot">&lt;-</span> myTbl<span class="sc">$</span>indikator<span class="sc">/</span>myTbl<span class="sc">$</span>referanseverdi</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(myTbl)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">region</th>
<th align="right">indikator</th>
<th align="right">referanseverdi</th>
<th align="right">skalert_indikator</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Midt-Norge</td>
<td align="right">69.8685069</td>
<td align="right">173.436069</td>
<td align="right">0.4028488</td>
</tr>
<tr class="even">
<td align="left">Nord-Norge</td>
<td align="right">928.5326204</td>
<td align="right">1409.196007</td>
<td align="right">0.6589095</td>
</tr>
<tr class="odd">
<td align="left">Østlandet</td>
<td align="right">251.3490789</td>
<td align="right">365.357472</td>
<td align="right">0.6879538</td>
</tr>
<tr class="even">
<td align="left">Sørlandet</td>
<td align="right">0.7033655</td>
<td align="right">3.739583</td>
<td align="right">0.1880866</td>
</tr>
<tr class="odd">
<td align="left">Vestlandet</td>
<td align="right">1077.9902876</td>
<td align="right">1372.939792</td>
<td align="right">0.7851694</td>
</tr>
</tbody>
</table>
<p>Scaling and clipping the regions against the outline of Norway</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># paste the scaled indicato values into the shape file with the regions, using the match function to make sure the align correctly</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>reg<span class="sc">$</span>skalert_indikator <span class="ot">&lt;-</span> myTbl<span class="sc">$</span>skalert_indikator[<span class="fu">match</span>(reg<span class="sc">$</span>region, myTbl<span class="sc">$</span>region)]</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># cutting away the marine areas</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>reg_clipped <span class="ot">&lt;-</span> <span class="fu">st_intersection</span>(reg, nor)</span></code></pre></div>
<pre><code>## Warning: attribute variables are assumed to be spatially constant throughout all
## geometries</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># round of to 2 decimals</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>reg_clipped<span class="sc">$</span>skalert_indikator_r <span class="ot">&lt;-</span> <span class="fu">round</span>(reg_clipped<span class="sc">$</span>skalert_indikator, <span class="dv">2</span>)</span></code></pre></div>
<p>Plotting a static map with scaled indicator values</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>) <span class="co"># mode &#39;view&#39; takes a lot longer to render, but looks better</span></span></code></pre></div>
<pre><code>## tmap mode set to plotting</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(reg_clipped) <span class="sc">+</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col=</span><span class="st">&quot;skalert_indikator&quot;</span>, </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">border.col =</span> <span class="st">&quot;white&quot;</span>)<span class="sc">+</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="st">&quot;skalert_indikator_r&quot;</span>, <span class="at">size=</span><span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(nor)<span class="sc">+</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">alpha =</span> <span class="dv">0</span>,<span class="at">border.col =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="breareal_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># removing the value for souther norway</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>reg_clipped<span class="sc">$</span>skalert_indikator[reg_clipped<span class="sc">$</span>region<span class="sc">==</span><span class="st">&quot;Sørlandet&quot;</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span></code></pre></div>
<p>Calculating total change of glacier extent</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(bretabell)<span class="sc">/</span><span class="fu">sum</span>(n50tabell)</span></code></pre></div>
<pre><code>## [1] 0.7003536</code></pre>
<p>We’ve lost 30% of the glacial area over this time.</p>
</div>
<div id="uncertainty" class="section level3" number="1.8.4">
<h3><span class="header-section-number">1.8.4</span> Uncertainty</h3>
<p>NVE reports a 3% uncertainty with their method. This is interpret as if +- 3% represent a 99.9%CI for the estimate (ca 2 SD). In the <a href="https://ninanor.github.io/IBECA/areal-av-isbreer.html">original indicator</a> I re-sampled the indicator value 10000 times here, with a 0.015sd, to get a distribution of indicator values. This time I will settle for reporting the sd as a single value below.</p>
</div>
</div>
<div id="prepare-export" class="section level2" number="1.9">
<h2><span class="header-section-number">1.9</span> Prepare export</h2>
<p>Now I can prepare the final exported data file. It will be a shape file with raw and scaled indicator values, reference reference values, and uncertainties.</p>
<p>The names of the columns are standardised (region, v_YYYY, sd_YYYY, i_YYYY, and reference).</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(reg_clipped)</span></code></pre></div>
<pre><code>## [1] &quot;id&quot;                  &quot;region&quot;              &quot;skalert_indikator&quot;  
## [4] &quot;GID_0&quot;               &quot;NAME_0&quot;              &quot;geometry&quot;           
## [7] &quot;skalert_indikator_r&quot;</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># paste the raw variable estimates</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>reg_clipped<span class="sc">$</span>v_2019 <span class="ot">&lt;-</span> myTbl<span class="sc">$</span>indikator[<span class="fu">match</span>(reg_clipped<span class="sc">$</span>region, myTbl<span class="sc">$</span>region)]              </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># paste the reference values</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>reg_clipped<span class="sc">$</span>reference <span class="ot">&lt;-</span> myTbl<span class="sc">$</span>referanseverdi[<span class="fu">match</span>(reg_clipped<span class="sc">$</span>region, myTbl<span class="sc">$</span>region)]      </span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co"># add 3% (one-sided) errors (SD=1.5% so that 1.95SD equals about 3%). </span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>reg_clipped<span class="sc">$</span>sd_2019 <span class="ot">&lt;-</span> reg_clipped<span class="sc">$</span>v_2019<span class="sc">*</span><span class="fl">0.015</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="co"># subset the shape file to include only the columns of interest, and rename the column with the scaled indicator values, assigning the value to year 2019.</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>exp <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(reg_clipped,</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>                     region,</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>                     v_2019,</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>                     sd_2019,</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>                     reference,</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">i_2019 =</span> skalert_indikator,</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>                     geometry)</span></code></pre></div>
<div id="eksport-shape-file-final-product" class="section level3" number="1.9.1">
<h3><span class="header-section-number">1.9.1</span> Eksport shape file (final product)</h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>sf<span class="sc">::</span><span class="fu">st_write</span>(exp, <span class="st">&quot;indicators/indicatorMaps/breareal.shp&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(exp[,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span></code></pre></div>
<table>
<colgroup>
<col width="12%" />
<col width="14%" />
<col width="13%" />
<col width="13%" />
<col width="11%" />
<col width="34%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">region</th>
<th align="right">v_2019</th>
<th align="right">sd_2019</th>
<th align="right">reference</th>
<th align="right">i_2019</th>
<th align="left">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Nord-Norge</td>
<td align="right">928.5326204</td>
<td align="right">13.92798931</td>
<td align="right">1409.196007</td>
<td align="right">0.6589095</td>
<td align="left">MULTIPOLYGON (((353306.9 72…</td>
</tr>
<tr class="even">
<td align="left">Midt-Norge</td>
<td align="right">69.8685069</td>
<td align="right">1.04802760</td>
<td align="right">173.436069</td>
<td align="right">0.4028488</td>
<td align="left">MULTIPOLYGON (((148486.5 69…</td>
</tr>
<tr class="odd">
<td align="left">Østlandet</td>
<td align="right">251.3490789</td>
<td align="right">3.77023618</td>
<td align="right">365.357472</td>
<td align="right">0.6879538</td>
<td align="left">MULTIPOLYGON (((236682.8 66…</td>
</tr>
<tr class="even">
<td align="left">Vestlandet</td>
<td align="right">1077.9902876</td>
<td align="right">16.16985431</td>
<td align="right">1372.939792</td>
<td align="right">0.7851694</td>
<td align="left">MULTIPOLYGON (((880.5802 64…</td>
</tr>
<tr class="odd">
<td align="left">Sørlandet</td>
<td align="right">0.7033655</td>
<td align="right">0.01055048</td>
<td align="right">3.739583</td>
<td align="right">NA</td>
<td align="left">MULTIPOLYGON (((-4601.286 6…</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<!--bookdown:body:end-->
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong></strong>" was written by . </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


</body>

</html>
